/** 
 * X3DOM 1.8.3
 * Build : 7482
 * Revision: 03da6d38708e4eafc94c2305fdc175312a880321
 * Date: Tue Aug 1 11:18:17 2023 +0200
 */
var x3dom={canvases:[],x3dNS:"http://www.web3d.org/specifications/x3d-namespace",x3dextNS:"http://philip.html5.org/x3d/ext",xsltNS:"http://www.w3.org/1999/XSL/x3dom.Transform",xhtmlNS:"http://www.w3.org/1999/xhtml"};function defineClass(e,t,A){if(e){function i(){}i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.superClass=e}if(A)for(var o in A)t.prototype[o]=A[o];return t}function array_to_object(e){for(var t={},A=0;A<e.length;A++)t[e[A]]="";return t}x3dom.about={version:"1.8.3",build:"7482",revision:"03da6d38708e4eafc94c2305fdc175312a880321",date:"Tue Aug 1 11:18:17 2023 +0200"},x3dom.nodeTypes={},x3dom.nodeTypesLC={},x3dom.components={},x3dom.geoCache=[],x3dom.BUFFER_IDX={INDEX:0,POSITION:1,NORMAL:2,TEXCOORD:3,TEXCOORD_0:3,COLOR:4,COLOR_0:4,ID:5,TANGENT:6,BITANGENT:7,TEXCOORD_1:8},x3dom.BRDF_LUT="data:image/png;base64,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",x3dom.caps={PLATFORM:navigator.platform,AGENT:navigator.userAgent,RENDERMODE:"HARDWARE"},x3dom.registerNodeType=function(e,t,A){void 0===x3dom.components[t]&&(x3dom.components[t]={}),A._typeName=e,A._compName=t,x3dom.components[t][e]=A,x3dom.nodeTypes[e]=A,x3dom.nodeTypesLC[e.toLowerCase()]=A},x3dom.isX3DElement=function(e){var t=e.nodeType===Node.ELEMENT_NODE&&e.localName?e.localName.toLowerCase():null;return t&&(x3dom.nodeTypes[e.localName]||x3dom.nodeTypesLC[t]||"x3d"==t||"websg"==t||"route"==t||"import"==t||"export"==t)},x3dom.extend=function(e){function t(){}return t.prototype=e.prototype||e,new t},x3dom.getStyle=function(e,t){var A="",i=document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):null;return i?A=i.getPropertyValue(t):e.currentStyle&&(t=t.replace(/\-(\w)/g,(function(e,t){return t.toUpperCase()})),A=e.currentStyle[t]),A},x3dom.isa=function(e,t){return e instanceof t},x3dom.getGlobal=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")},window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,16)},x3dom.toggleFullScreen=function(){if(document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen)document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen();else{var e=document.documentElement;e.requestFullScreen?e.requestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen()}},x3dom.debug={INFO:"INFO",WARNING:"WARNING",ERROR:"ERROR",EXCEPTION:"EXCEPTION",isActive:!1,isFirebugAvailable:!1,isSetup:!1,isAppend:!1,numLinesLogged:0,maxLinesToLog:1e4,logContainer:null,setup:function(){if(!x3dom.debug.isSetup){try{void 0!==window.console.firebug&&(x3dom.debug.isFirebugAvailable=!0)}catch(e){x3dom.debug.isFirebugAvailable=!1}x3dom.debug.setupLogContainer(),x3dom.debug.isSetup=!0}},activate:function(e){x3dom.debug.isActive=!0,x3dom.debug.logContainer.style.display=e?"block":"none"},setupLogContainer:function(){x3dom.debug.logContainer=document.createElement("div"),x3dom.debug.logContainer.setAttribute("class","x3dom-log")},appendElement:function(e){e.appendChild(x3dom.debug.logContainer)},doLog:function(e,t){if(x3dom.debug.isActive&&(x3dom.debug.numLinesLogged===x3dom.debug.maxLinesToLog&&(e="Maximum number of log lines (="+x3dom.debug.maxLinesToLog+") reached. Deactivating logging..."),!(x3dom.debug.numLinesLogged>x3dom.debug.maxLinesToLog))){var A=document.createElement("p");switch(A.style.margin=0,t){case x3dom.debug.INFO:A.style.color="#00ff00";break;case x3dom.debug.WARNING:A.style.color="#cd853f";break;case x3dom.debug.ERROR:A.style.color="#ff4500";break;case x3dom.debug.EXCEPTION:A.style.color="#ffff00";break;default:A.style.color="#00ff00"}try{A.innerHTML=t+": "+e,x3dom.debug.logContainer.insertBefore(A,x3dom.debug.logContainer.firstChild)}catch(t){void 0!==window.console.firebug&&window.console.warn(e)}if(x3dom.debug.isFirebugAvailable)switch(t){case x3dom.debug.INFO:window.console.info(e);break;case x3dom.debug.WARNING:window.console.warn(e);break;case x3dom.debug.ERROR:window.console.error(e);break;case x3dom.debug.EXCEPTION:window.console.debug(e)}x3dom.debug.numLinesLogged++}},logInfo:function(e){x3dom.debug.doLog(e,x3dom.debug.INFO)},logWarning:function(e){x3dom.debug.doLog(e,x3dom.debug.WARNING)},logError:function(e){x3dom.debug.doLog(e,x3dom.debug.ERROR)},logException:function(e){x3dom.debug.doLog(e,x3dom.debug.EXCEPTION)},assert:function(e,t){e||x3dom.debug.doLog("Assertion failed in "+x3dom.debug.assert.caller.name+": "+t,x3dom.debug.ERROR)},typeOf:function(e){var t=typeof e;return"object"!==t||e?t:"null"},exists:function(e,t,A){return A=A||"function",(e?this.typeOf(e[t]):"null")===A},dumpFields:function(e){var t="";for(var A in e)t+=A+", ";return t+="\n",x3dom.debug.logInfo(t),t}},x3dom.debug.setup(),x3dom.X3DCanvas=function(e,t){var A=this;if(this._canvasIdx=t,this.x3dElem=e,this._current_dim=[0,0],this.fps_t0=(new Date).getTime(),this.lastTimeFPSWasTaken=0,this.framesSinceLastTime=0,this._totalTime=0,this._elapsedTime=0,this.doc=null,this.isSessionSupportedPromise=null,this.xrSession=null,this.xrReferenceSpace=null,this.supportsPassiveEvents=!1,this.devicePixelRatio=window.devicePixelRatio||1,this.lastMousePos={x:0,y:0},x3dom.caps.DOMNodeInsertedEvent_perSubtree=!(-1!=navigator.userAgent.indexOf("MSIE")||-1!=navigator.userAgent.indexOf("Trident")),e.__setAttribute=e.setAttribute,e.setAttribute=function(e,t){switch(this.__setAttribute(e,t),t=parseInt(t),e){case"width":A.canvas.setAttribute("width",t*A.devicePixelRatio),A.doc&&A.doc._viewarea&&(A.doc._viewarea._width=parseInt(A.canvas.getAttribute("width"),0),A.doc.needRender=!0);break;case"height":A.canvas.setAttribute("height",t*A.devicePixelRatio),A.doc&&A.doc._viewarea&&(A.doc._viewarea._height=parseInt(A.canvas.getAttribute("height"),0),A.doc.needRender=!0)}},this.backend=this.x3dElem.getAttribute("backend"),this.backend=this.backend?this.backend.toLowerCase():"none",this.canvas=this._createHTMLCanvas(e),x3dom.debug.appendElement(e),this.canvas.parent=this,this.gl=this._initContext(this.canvas),this.backend="webgl",null==this.gl)return this.hasRuntime=!1,void this._createInitFailedDiv(e);x3dom.caps.BACKEND=this.backend;var i=e.getAttribute("runtimeEnabled");this.hasRuntime=null!==i?"true"==i.toLowerCase():e.hasRuntime,this.showStat=e.getAttribute("showStat"),this.stateViewer=new x3dom.States(e),null!==this.showStat&&"true"==this.showStat&&this.stateViewer.display(!0),this.x3dElem.appendChild(this.stateViewer.viewer),this.showProgress=e.getAttribute("showProgress"),this.progressDiv=this._createProgressDiv(),this.progressDiv.style.display=null!==this.showProgress&&"true"==this.showProgress?"flex":"none",this.x3dElem.appendChild(this.progressDiv),this.vrDiv=this._createVRDiv(),this.x3dElem.appendChild(this.vrDiv),this.showTouchpoints=e.getAttribute("showTouchpoints"),this.showTouchpoints=!!this.showTouchpoints&&this.showTouchpoints,this.disableTouch=e.getAttribute("disableTouch"),this.disableTouch=!!this.disableTouch&&"true"==this.disableTouch.toLowerCase(),this.disableKeys=e.getAttribute("disableKeys"),this.disableKeys=!!this.disableKeys&&"true"==this.disableKeys.toLowerCase(),this.disableRightDrag=e.getAttribute("disableRightDrag"),this.disableRightDrag=!!this.disableRightDrag&&"true"==this.disableRightDrag.toLowerCase(),this.disableLeftDrag=e.getAttribute("disableLeftDrag"),this.disableLeftDrag=!!this.disableLeftDrag&&"true"==this.disableLeftDrag.toLowerCase(),this.disableMiddleDrag=e.getAttribute("disableMiddleDrag"),this.disableMiddleDrag=!!this.disableMiddleDrag&&"true"==this.disableMiddleDrag.toLowerCase(),this.detectPassiveEvents(),this.bindEventListeners()},x3dom.X3DCanvas.prototype.detectPassiveEvents=function(){if("undefined"!=typeof window&&"function"==typeof window.addEventListener){var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}}),A=function(){};window.addEventListener("testPassiveEventSupport",A,t),window.removeEventListener("testPassiveEventSupport",A,t),this.supportsPassiveEvents=e}},x3dom.X3DCanvas.prototype.bindEventListeners=function(){var e=this;if(this.onMouseDown=function(t){if(!this.isMulti){switch(this.focus(),this.classList.add("x3dom-canvas-mousedown"),t.button){case 0:this.mouse_button=1;break;case 1:this.mouse_button=4;break;case 2:this.mouse_button=2;break;default:this.mouse_button=0}t.shiftKey&&(this.mouse_button=1),t.ctrlKey&&(this.mouse_button=4),t.altKey&&(this.mouse_button=2);var A=this.parent.mousePosition(t);this.mouse_drag_x=A.x,this.mouse_drag_y=A.y,this.mouse_dragging=!0,this.parent.doc.onMousePress(e.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button),this.parent.doc.needRender=!0}},this.onMouseUp=function(t){if(!this.isMulti){var A=this.mouse_button;this.classList.remove("x3dom-canvas-mousedown"),this.mouse_button=0,this.mouse_dragging=!1,this.parent.doc.onMouseRelease(e.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button,A),this.parent.doc.needRender=!0}},this.onMouseOver=function(t){this.isMulti||(this.mouse_button=0,this.mouse_dragging=!1,this.parent.doc.onMouseOver(e.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button),this.parent.doc.needRender=!0)},this.onMouseOut=function(t){this.isMulti||(this.mouse_button=0,this.mouse_dragging=!1,this.classList.remove("x3dom-canvas-mousedown"),this.parent.doc.onMouseOut(e.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button),this.parent.doc.needRender=!0)},this.onDoubleClick=function(t){if(!this.isMulti){this.mouse_button=0;var A=this.parent.mousePosition(t);this.mouse_drag_x=A.x,this.mouse_drag_y=A.y,this.mouse_dragging=!1,this.parent.doc.onDoubleClick(e.gl,this.mouse_drag_x,this.mouse_drag_y),this.parent.doc.needRender=!0}},this.onMouseMove=function(t){if(!this.isMulti){var A=this.parent.mousePosition(t);A.x==e.lastMousePos.x&&A.y==e.lastMousePos.y||(e.lastMousePos=A,this.mouse_drag_x=A.x,this.mouse_drag_y=A.y,this.mouse_dragging?(t.shiftKey&&(this.mouse_button=1),t.ctrlKey&&(this.mouse_button=4),t.altKey&&(this.mouse_button=2),(1==this.mouse_button&&!this.parent.disableLeftDrag||2==this.mouse_button&&!this.parent.disableRightDrag||4==this.mouse_button&&!this.parent.disableMiddleDrag)&&this.parent.doc.onDrag(e.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button)):this.parent.doc.onMove(e.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button),this.parent.doc.needRender=!0,t.preventDefault(),t.stopPropagation())}},this.onDOMMouseScroll=function(t){if(!this.isMulti){this.focus();var A=this.parent.mousePosition(t).y;1==this.parent.doc._scene.getNavigationInfo()._vf.reverseScroll?this.mouse_drag_y-=2*t.detail:this.mouse_drag_y+=2*t.detail,this.parent.doc.onWheel(e.gl,this.mouse_drag_x,this.mouse_drag_y,A),this.parent.doc.needRender=!0,t.preventDefault(),t.stopPropagation()}},this.onKeyPress=function(e){this.parent.disableKeys||(e.preventDefault(),this.parent.doc.onKeyPress(e.charCode)),this.parent.doc.needRender=!0},this.onMouseWheel=function(t){if(!this.isMulti){this.focus();var A=this.parent.mousePosition(t).y;1==this.parent.doc._scene.getNavigationInfo()._vf.reverseScroll?this.mouse_drag_y+=.1*t.wheelDelta:this.mouse_drag_y-=.1*t.wheelDelta,this.parent.doc.onWheel(e.gl,this.mouse_drag_x,this.mouse_drag_y,A),this.parent.doc.needRender=!0,t.preventDefault(),t.stopPropagation()}},this.onKeyUp=function(e){this.parent.disableKeys||this.parent.doc.onKeyUp(e.keyCode),this.parent.doc.needRender=!0},this.onKeyDown=function(e){this.parent.disableKeys||this.parent.doc.onKeyDown(e.keyCode),this.parent.doc.needRender=!0},null!==this.canvas&&null!==this.gl&&this.hasRuntime){this.canvas.mouse_dragging=!1,this.canvas.mouse_button=0,this.canvas.mouse_drag_x=0,this.canvas.mouse_drag_y=0,this.canvas.isMulti=!1,this.canvas.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),!1},this.canvas.addEventListener("webglcontextlost",(function(e){x3dom.debug.logError("WebGL context lost"),e.preventDefault()}),!1),this.canvas.addEventListener("webglcontextrestored",(function(e){x3dom.debug.logError("recover WebGL state and resources on context lost NYI"),e.preventDefault()}),!1),this.canvas.addEventListener("mousedown",this.onMouseDown,!1),this.canvas.addEventListener("mouseup",this.onMouseUp,!1),this.canvas.addEventListener("mouseover",this.onMouseOver,!1),this.canvas.addEventListener("mouseout",this.onMouseOut,!1),this.canvas.addEventListener("dblclick",this.onDoubleClick,!1),this.canvas.addEventListener("mousemove",this.onMouseMove,!1),this.canvas.addEventListener("DOMMouseScroll",this.onDOMMouseScroll,!1),this.canvas.addEventListener("mousewheel",this.onMouseWheel,!!this.supportsPassiveEvents&&{passive:!1}),this.canvas.addEventListener("keypress",this.onKeyPress,!0),this.canvas.addEventListener("keyup",this.onKeyUp,!0),this.canvas.addEventListener("keydown",this.onKeyDown,!0);var t={numTouches:0,firstTouchTime:(new Date).getTime(),firstTouchPoint:new x3dom.fields.SFVec2f(0,0),lastPos:new x3dom.fields.SFVec2f,lastDrag:new x3dom.fields.SFVec2f,lastMiddle:new x3dom.fields.SFVec2f,lastSquareDistance:0,lastAngle:0,lastLayer:[],examineNavType:1,calcAngle:function(e){var t=e.normalize().dot(new x3dom.fields.SFVec2f(1,0));return t=Math.acos(t),e.y<0&&(t=Math.PI+(Math.PI-t)),t},disableTouch:this.disableTouch,visMarker:this.showTouchpoints,visMarkerBag:[],visualizeTouches:function(e){if(this.visMarker){for(var t=[],A=null,i=0;i<e.touches.length;i++){var o=e.touches[i].identifier||e.touches[i].streamId;o||(o=0);var s=this.visMarkerBag.indexOf(o);s>=0?((A=document.getElementById("visMarker"+o)).style.left=e.touches[i].pageX+"px",A.style.top=e.touches[i].pageY+"px"):((A=document.createElement("div")).appendChild(document.createTextNode("#"+o)),A.id="visMarker"+o,A.className="x3dom-touch-marker",document.body.appendChild(A),s=this.visMarkerBag.length,this.visMarkerBag[s]=o),t.push(o)}for(var n=this.visMarkerBag.length-1;n>=0;n--){var r=this.visMarkerBag[n];t.indexOf(r)<0&&(this.visMarkerBag.splice(n,1),A=document.getElementById("visMarker"+r),document.body.removeChild(A))}}}};this.disableTouch||(this.canvas.addEventListener("touchstart",(function(A,i){var o,s;switch(this.isMulti=!0,A.preventDefault(),t.visualizeTouches(A),this.focus(),null==i&&(i=this.parent.doc),i._scene.getNavigationInfo().getType()){case"examine":t.examineNavType=1;break;case"turntable":t.examineNavType=2;break;default:t.examineNavType=0}for(t.lastLayer=[],o=0;o<A.touches.length;o++)s=this.parent.mousePosition(A.touches[o]),t.lastLayer.push([A.touches[o].identifier,new x3dom.fields.SFVec2f(s.x,s.y)]);if(t.numTouches<1&&1==A.touches.length)t.numTouches=1,t.lastDrag=new x3dom.fields.SFVec2f(A.touches[0].screenX,A.touches[0].screenY);else if(t.numTouches<2&&A.touches.length>=2){t.numTouches=2;var n=new x3dom.fields.SFVec2f(A.touches[0].screenX,A.touches[0].screenY),r=new x3dom.fields.SFVec2f(A.touches[1].screenX,A.touches[1].screenY).subtract(n),a=r.multiply(.5).add(n),d=r.dot(r);t.lastMiddle=a,t.lastSquareDistance=d,t.lastAngle=t.calcAngle(r),t.lastPos=this.parent.mousePosition(A.touches[0])}if(i._scene.updateVolume(),1==t.examineNavType)for(o=0;o<A.touches.length;o++)s=this.parent.mousePosition(A.touches[o]),i.onPick(e.gl,s.x,s.y),i._viewarea.prepareEvents(s.x,s.y,0,"onmouseover"),i._viewarea.prepareEvents(s.x,s.y,1,"onmousedown"),i._viewarea._pickingInfo.lastClickObj=i._viewarea._pickingInfo.pickObj;else A.touches.length&&(s=this.parent.mousePosition(A.touches[0]),i.onMousePress(e.gl,s.x,s.y,1));i.needRender=!0}),!this.supportsPassiveEvents||{passive:!1}),this.canvas.addEventListener("touchmove",(function(A,i){A.preventDefault(),t.visualizeTouches(A),null==i&&(i=this.parent.doc);var o,s,n,r,a,d,h,g=null,l=null;if(1==t.examineNavType){if(1==A.touches.length){var I=new x3dom.fields.SFVec2f(A.touches[0].screenX,A.touches[0].screenY),c=I.subtract(t.lastDrag);t.lastDrag=I;var f=x3dom.fields.SFMatrix4f.rotationY(c.x/100),u=x3dom.fields.SFMatrix4f.rotationX(c.y/100);l=f.mult(u),i.onMoveView(e.gl,A,t,null,l),g=this.parent.mousePosition(A.touches[0]),i.onPick(e.gl,g.x,g.y),i._viewarea.prepareEvents(g.x,g.y,1,"onmousemove")}else if(A.touches.length>=2){o=new x3dom.fields.SFVec2f(A.touches[0].screenX,A.touches[0].screenY),n=(s=new x3dom.fields.SFVec2f(A.touches[1].screenX,A.touches[1].screenY).subtract(o)).multiply(.5).add(o),r=s.dot(s),a=n.subtract(t.lastMiddle),d=r-t.lastSquareDistance,h=new x3dom.fields.SFVec3f(a.x/screen.width,-a.y/screen.height,d/(screen.width*screen.height*.2));var C=t.calcAngle(s),_=t.lastAngle-C;t.lastAngle=C,l=x3dom.fields.SFMatrix4f.rotationZ(_),t.lastMiddle=n,t.lastSquareDistance=r,i.onMoveView(e.gl,A,t,h,l)}}else A.touches.length&&(2==t.examineNavType&&A.touches.length>=2?(o=new x3dom.fields.SFVec2f(A.touches[0].screenX,A.touches[0].screenY),d=((r=(s=new x3dom.fields.SFVec2f(A.touches[1].screenX,A.touches[1].screenY).subtract(o)).dot(s))-t.lastSquareDistance)/(.1*(screen.width+screen.height)),t.lastPos.y+=d,t.lastSquareDistance=r,i.onDrag(e.gl,t.lastPos.x,t.lastPos.y,2)):(g=this.parent.mousePosition(A.touches[0]),i.onDrag(e.gl,g.x,g.y,1)));i.needRender=!0}),!this.supportsPassiveEvents||{passive:!1}),this.canvas.addEventListener("touchend",(function(A,i){if(this.isMulti=!1,A.cancelable&&A.preventDefault(),t.visualizeTouches(A),null==i&&(i=this.parent.doc),i._viewarea._isMoving=!1,2==t.numTouches&&1==A.touches.length&&(t.lastDrag=new x3dom.fields.SFVec2f(A.touches[0].screenX,A.touches[0].screenY)),0==A.touches.length){for(var o=i._nodeBag.affectedPointingSensors,s=0;s<o.length;++s)o[s].pointerReleased();i._nodeBag.affectedPointingSensors=[]}var n=!1;if(A.touches.length<2&&(1==t.numTouches&&(n=!0),t.numTouches=A.touches.length),1==t.examineNavType){for(s=0;s<t.lastLayer.length;s++){var r=t.lastLayer[s][1];if(i.onPick(e.gl,r.x,r.y),"box"!==i._scene._vf.pickMode.toLowerCase())i._viewarea.prepareEvents(r.x,r.y,1,"onmouseup"),i._viewarea._pickingInfo.lastClickObj=i._viewarea._pickingInfo.pickObj,i._viewarea._pickingInfo.pickObj&&i._viewarea._pickingInfo.pickObj===i._viewarea._pickingInfo.lastClickObj&&i._viewarea.prepareEvents(r.x,r.y,1,"onclick");else{var a=i._viewarea.calcViewRay(r.x,r.y),d=i._scene.doIntersect(a),h=a.hitObject;d&&h&&(i._viewarea._pick.setValues(a.hitPoint),i._viewarea.checkEvents(h,r.x,r.y,1,"onclick"),x3dom.debug.logInfo("Hit '"+h._xmlNode.localName+"/ "+h._DEF+"' at pos "+i._viewarea._pick))}}if(n){var g=(new Date).getTime();t.firstTouchPoint.subtract(t.lastDrag).length()<18&&g-t.firstTouchTime<180&&i.onDoubleClick(e.gl,0,0),t.firstTouchTime=g,t.firstTouchPoint=t.lastDrag}}else t.lastLayer.length&&(r=t.lastLayer[0][1],i.onMouseRelease(e.gl,r.x,r.y,0,1));i.needRender=!0}),!0))}},x3dom.X3DCanvas.prototype._initContext=function(e){x3dom.debug.logInfo("Initializing X3DCanvas for ["+e.id+"]");var t=x3dom.gfx_webgl(e,this.x3dElem);return t?(parseFloat(x3dom.caps.VERSION.match(/\d+\.\d+/)[0])<1&&x3dom.debug.logError("WebGL version "+x3dom.caps.VERSION+" lacks important WebGL/GLSL features needed for shadows, special vertex attribute types, etc.!"),t):(x3dom.debug.logError("No 3D context found..."),this.x3dElem.removeChild(e),null)},x3dom.X3DCanvas.prototype.appendParam=function(e,t,A){var i=document.createElement("param");i.setAttribute("name",t),i.setAttribute("value",A),e.appendChild(i)},x3dom.X3DCanvas.prototype._createInitFailedDiv=function(e){var t=document.createElement("div");t.setAttribute("id","x3dom-create-init-failed"),t.style.width=e.getAttribute("width"),t.style.height=e.getAttribute("height"),t.style.backgroundColor="#C00",t.style.color="#FFF",t.style.fontSize="20px",t.style.fontWidth="bold",t.style.padding="10px 10px 10px 10px",t.style.display="inline-block",t.style.fontFamily="Helvetica",t.style.textAlign="center",t.appendChild(document.createTextNode("Your Browser does not support X3DOM")),t.appendChild(document.createElement("br")),t.appendChild(document.createTextNode("Read more about Browser support on:")),t.appendChild(document.createElement("br"));var A=document.createElement("a");A.setAttribute("href","http://www.x3dom.org/?page_id=9"),A.appendChild(document.createTextNode("X3DOM | Browser Support")),t.appendChild(A);var i=e.getAttribute("altImg")||null;i&&((new Image).src=i,t.style.backgroundImage="url("+i+")",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="50% 50%");e.appendChild(t),x3dom.debug.logError("Your Browser does not support X3DOM!")},x3dom.X3DCanvas.prototype._createHTMLCanvas=function(e){x3dom.debug.logInfo("Creating canvas for (X)3D element...");var t=document.createElement("canvas");t.setAttribute("class","x3dom-canvas"),e.getAttribute("style")&&x3dom.debug.logInfo("Inline X3D styles detected");for(var A=["onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onclick","ondblclick","onkeydown","onkeypress","onkeyup","ontouchstart","ontouchmove","ontouchend","ontouchcancel","ontouchleave","ontouchenter","ondragstart","ondrop","ondragover"],i=0;i<A.length;i++){var o=A[i],s=e.getAttribute(o);s&&(x3dom.debug.logInfo(o+", "+s),t.setAttribute(o,s),e.removeAttribute(o))}var n=e.getAttribute("draggable");n&&(x3dom.debug.logInfo("draggable="+n),t.setAttribute("draggable",n)),e.__addEventListener||e.__removeEventListener||(e.__addEventListener=e.addEventListener,e.__removeEventListener=e.removeEventListener,e.addEventListener=function(e,i,o){var s,n=!1;for(s=0;s<A.length&&!n;s++)A[s]===e&&(n=!0);n?(x3dom.debug.logInfo("addEventListener for div.on"+e),t.addEventListener(e,i,o)):(x3dom.debug.logInfo("addEventListener for X3D.on"+e),this.__addEventListener(e,i,o))},e.removeEventListener=function(e,i,o){var s,n=!1;for(s=0;s<A.length&&!n;s++)A[s]===e&&(n=!0);n?(x3dom.debug.logInfo("removeEventListener for div.on"+e),t.removeEventListener(e,i,o)):(x3dom.debug.logInfo("removeEventListener for X3D.on"+e),this.__removeEventListener(e,i,o))}),e.hasAttribute("ondownloadsfinished")&&e.addEventListener("downloadsfinished",(function(){var t={target:e,type:"downloadsfinished"},A=e.getAttribute("ondownloadsfinished");new Function("event",A).call(e,t)}),!0),e.appendChild(t);var r,a,d=e.getAttribute("id");if(null!==d)t.id="x3dom-"+d+"-canvas";else{var h=(new Date).getTime();t.id="x3dom-"+h+"-canvas"}return e.style=e.style||{},null!==(r=e.getAttribute("width"))&&(r.indexOf("%")>=0&&x3dom.debug.logWarning("The width attribute is to be specified in pixels not in percent."),t.style.width=r,e.style.width=r,t.setAttribute("width",r)),null!==(a=e.getAttribute("height"))&&(a.indexOf("%")>=0&&x3dom.debug.logWarning("The height attribute is to be specified in pixels not in percent."),t.style.height=a,e.style.height=a,t.setAttribute("height",a)),t.setAttribute("tabindex","0"),t},x3dom.X3DCanvas.prototype._watchForResize=function(){if(!this.xrSession){var e=[parseInt(x3dom.getStyle(this.canvas,"width"))||0,parseInt(x3dom.getStyle(this.canvas,"height"))||0];this._current_dim[0]==e[0]&&this._current_dim[1]==e[1]||(this._current_dim=e,this.x3dElem.setAttribute("width",e[0]+"px"),this.x3dElem.setAttribute("height",e[1]+"px"))}},x3dom.X3DCanvas.prototype._createProgressDiv=function(){var e=document.createElement("div");e.setAttribute("class","x3dom-progress");var t=document.createElement("div");t.setAttribute("class","x3dom-progress-spinner"),e.appendChild(t);var A=document.createElement("div");return A.setAttribute("id","x3domProgessCount"),A.appendChild(document.createTextNode("Loading...")),e.appendChild(A),e.oncontextmenu=e.onmousedown=function(e){return e.preventDefault(),e.stopPropagation(),!1},e},x3dom.X3DCanvas.prototype._createVRDiv=function(){var e=document.createElement("div");return e.setAttribute("class","x3dom-vr"),e.onclick=e=>{this.x3dElem.runtime.toggleVR()},e.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),!1},e.title="Toggle VR",e},x3dom.X3DCanvas.prototype.mousePosition=function(e){var t=e.target.getBoundingClientRect(),A=Math.round(e.clientX-t.left)*this.devicePixelRatio,i=Math.round(e.clientY-t.top)*this.devicePixelRatio;return new x3dom.fields.SFVec2f(A,i)},x3dom.X3DCanvas.prototype.tick=function(e,t){this._elapsedTime=this._totalTime?e-this._totalTime:0,this._totalTime=e;var A=this.x3dElem.runtime,i=(new Date).getTime(),o=i-this.lastTimeFPSWasTaken;this.fps_t0;this.fps_t0=i,this.doc.advanceTime(i/1e3);var s,n=(new Date).getTime()-i;if(this.doc.hasAnimationStateChanged()&&(this.doc.isAnimating()?A.onAnimationStarted():A.onAnimationFinished()),(this.doc.needRender||t)&&(o>=1e3&&(A.fps=this.framesSinceLastTime/(o/1e3),A.addMeasurement("FPS",A.fps),this.framesSinceLastTime=0,this.lastTimeFPSWasTaken=i),this.framesSinceLastTime++,A.addMeasurement("ANIM",n),0==A.isReady&&(A.ready(),A.isReady=!0),A.enterFrame({total:this._totalTime,elapsed:this._elapsedTime}),t||(this.doc.needRender=!1),this.doc.render(this.gl,this.getVRFrameData(t)),this.doc._scene._vf.doPickPass||A.removeMeasurement("PICKING"),A.exitFrame({total:this._totalTime,elapsed:this._elapsedTime})),this.progressDiv)if(this.doc.downloadCount>0?A.addInfo("#LOADS:",this.doc.downloadCount):A.removeInfo("#LOADS:"),"false"!==this.doc.properties.getProperty("showProgress")){if(this.progressDiv){var r=Math.max(+this.doc.downloadCount,0);this.progressDiv.childNodes[1].textContent=""+r,this.doc.downloadCount>0?this.progressDiv.style.opacity="1":this.progressDiv.style.opacity="0"}}else this.progressDiv.style.opacity="0";this.doc.downloadCount<=0&&this.doc.previousDownloadCount>0&&(document.createEvent?((s=document.createEvent("Events")).initEvent("downloadsfinished",!0,!0),this.x3dElem.dispatchEvent(s)):document.createEventObject&&(s=document.createEventObject(),this.x3dElem.fireEvent("ondownloadsfinished",s)));this.doc.previousDownloadCount=this.doc.downloadCount},x3dom.X3DCanvas.prototype.mainloop=function(e,t){this.doc&&this.x3dElem.runtime&&(this._watchForResize(),this.tick(e,t),this.xrSession?this.xrSession.requestAnimationFrame(this.mainloop):window.requestAnimFrame(this.mainloop))},x3dom.X3DCanvas.prototype.load=function(e,t,A){this.doc=new x3dom.X3DDocument(this.canvas,this.gl,A),this.doc.onload=()=>{this.mainloop=this.mainloop.bind(this),this.checkForVRSupport(),this.hasRuntime?this.mainloop():this.tick()},this.x3dElem.render=()=>{this.hasRuntime?this.doc.needRender=!0:this.doc.render(x3dCanvas.gl)},this.x3dElem.context=this.gl.ctx3d,this.doc.onerror=function(){alert("Failed to load X3D document")},this.doc.load(e,t)},x3dom.X3DCanvas.prototype.checkForVRSupport=function(){navigator.xr&&navigator.xr.isSessionSupported("immersive-vr").then(e=>{e&&(this.vrDiv.style.display="block")})},x3dom.X3DCanvas.prototype.enterVR=function(){this.xrSession||this.gl.ctx3d.makeXRCompatible().then(()=>{navigator.xr.requestSession("immersive-vr").then(e=>{e.requestReferenceSpace("local").then(t=>{const A=new XRWebGLLayer(e,this.gl.ctx3d);e.updateRenderState({baseLayer:A}),this._oldCanvasWidth=this.canvas.width,this._oldCanvasHeight=this.canvas.height,this.canvas.width=A.framebufferWidth,this.canvas.height=A.framebufferHeight,this.gl.VRMode=2,this.xrReferenceSpace=t,this.xrSession=e,this.doc.needRender=!0;var i=this.doc._viewarea.getViewMatrix(),o=new x3dom.fields.Quaternion(0,0,1,0);o.normalize(),o.setValue(i);var s=i.e3();const n=new XRRigidTransform({x:s.x,y:s.y,z:s.z},{x:o.x,y:o.y,z:o.z,w:o.w});this.xrReferenceSpace=this.xrReferenceSpace.getOffsetReferenceSpace(n),this.xrSession.addEventListener("end",()=>{this.exitVR()}),e.requestAnimationFrame(this.mainloop)})})})},x3dom.X3DCanvas.prototype.exitVR=function(){this.xrSession&&(this.xrSession.end(),this.xrSession=void 0,this.xrReferenceSpace=void 0,this.canvas.width=this._oldCanvasWidth,this.canvas.height=this._oldCanvasHeight,this.gl.VRMode=1,this.doc.needRender=!0,window.requestAnimationFrame(this.mainloop))},x3dom.X3DCanvas.prototype.getVRFrameData=function(e){if(!e)return;const t=e.getViewerPose(this.xrReferenceSpace);if(!t)return;const A={framebuffer:e.session.renderState.baseLayer.framebuffer,controllers:{}};for(const e of t.views)"left"===e.eye?(A.leftViewMatrix=e.transform.inverse.matrix,A.leftProjectionMatrix=e.projectionMatrix):"right"===e.eye&&(A.rightViewMatrix=e.transform.inverse.matrix,A.rightProjectionMatrix=e.projectionMatrix);for(const t of e.session.inputSources)if(t.gripSpace){const i=e.getPose(t.gripSpace,this.xrReferenceSpace);null!==i&&null!==i.transform&&(A.controllers[t.handedness]={gamepad:t.gamepad,type:t.profiles[0],pose:{position:[i.transform.position.x,i.transform.position.y,i.transform.position.z],orientation:[i.transform.orientation.x,i.transform.orientation.y,i.transform.orientation.z,i.transform.orientation.w]}})}return A},x3dom.InputTypes={NAVIGATION:1,INTERACTION:2},x3dom.Viewarea=function(e,t){this._doc=e,this._scene=t,e._nodeBag.viewarea.push(this),this._pickingInfo={pickPos:new x3dom.fields.SFVec3f(0,0,0),pickNorm:new x3dom.fields.SFVec3f(0,0,1),pickObj:null,firstObj:null,lastObj:null,lastClickObj:null,shadowObjectId:-1},this._currentInputType=x3dom.InputTypes.NAVIGATION,this._rotMat=x3dom.fields.SFMatrix4f.identity(),this._transMat=x3dom.fields.SFMatrix4f.identity(),this._movement=new x3dom.fields.SFVec3f(0,0,0),this._needNavigationMatrixUpdate=!0,this._deltaT=0,this._flyMat=null,this._pitch=0,this._yaw=0,this._eyePos=new x3dom.fields.SFVec3f(0,0,0),this._width=400,this._height=300,this._dx=0,this._dy=0,this._lastX=-1,this._lastY=-1,this._pressX=-1,this._pressY=-1,this._lastButton=0,this._points=0,this._numRenderedNodes=0,this._pick=new x3dom.fields.SFVec3f(0,0,0),this._pickNorm=new x3dom.fields.SFVec3f(0,0,1),this._isAnimating=!1,this._isMoving=!1,this._lastTS=0,this._mixer=new x3dom.MatrixMixer,this._interpolator=new x3dom.FieldInterpolator,this._animationStateChanged=!1,this.vrFrameData=null,this.gamepads=null,this.vrLeftViewMatrix=new x3dom.fields.SFMatrix4f,this.vrRightViewMatrix=new x3dom.fields.SFMatrix4f,this.vrLeftProjMatrix=new x3dom.fields.SFMatrix4f,this.vrRightProjMatrix=new x3dom.fields.SFMatrix4f,this.vrControllerManager=new x3dom.VRControllerManager(this._doc),this._inverseDevicePixelRatio=1/window.devicePixelRatio,this.arc=null},x3dom.Viewarea.prototype.setVRFrameData=function(e,t){this.vrFrameData=t,this.vrFrameData&&(this.vrLeftViewMatrix.setFromArray(this.vrFrameData.leftViewMatrix),this.vrRightViewMatrix.setFromArray(this.vrFrameData.rightViewMatrix),this.vrLeftProjMatrix.setFromArray(this.vrFrameData.leftProjectionMatrix),this.vrRightProjMatrix.setFromArray(this.vrFrameData.rightProjectionMatrix))},x3dom.Viewarea.prototype.updateGamepads=function(e){this.vrControllerManager.update(this,e)},x3dom.Viewarea.prototype.tick=function(e){if(this._scene.getEnvironment()._vf.enableARC&&null==this.arc&&(this.arc=new x3dom.arc.AdaptiveRenderControl(this._scene)),this._mixer.isActive()){if(this._mixer._isVPtarget){var t=this._scene.getViewpoint();t.resetView();var A=t.getViewMatrix().mult(t.getCurrentTransform().inverse());this._mixer.setEndMatrix(A)}var i=this._mixer.mix(e);this._scene.getViewpoint().setView(i)}if(this._interpolator.isActive()){var o=this._interpolator.interpolate(e);this._scene.getViewpoint().setZoom(o)}var s=this.navigateTo(e),n=this._isAnimating;return this._lastTS=e,this._isAnimating=this._mixer.isMixing||this._interpolator.isInterpolating||s,this._isAnimating!=n?this._animationStateChanged=!0:this._animationStateChanged=!1,null!=this.arc&&this.arc.update(this.isMovingOrAnimating()?1:0,this._doc._x3dElem.runtime.getFPS()),this._isAnimating||n},x3dom.Viewarea.prototype.isMoving=function(){return this._isMoving},x3dom.Viewarea.prototype.isAnimating=function(){return this._isAnimating},x3dom.Viewarea.prototype.hasAnimationStateChanged=function(){return this._animationStateChanged},x3dom.Viewarea.prototype.isMovingOrAnimating=function(){return this._isMoving||this._isAnimating},x3dom.Viewarea.prototype.navigateTo=function(e){return this._scene.getNavigationInfo()._impl.navigateTo(this,e)},x3dom.Viewarea.prototype.moveFwd=function(){this._scene.getNavigationInfo()._impl.moveForward(this)},x3dom.Viewarea.prototype.moveBwd=function(){this._scene.getNavigationInfo()._impl.moveBackwards(this)},x3dom.Viewarea.prototype.strafeRight=function(){this._scene.getNavigationInfo()._impl.strafeRight(this)},x3dom.Viewarea.prototype.strafeLeft=function(){this._scene.getNavigationInfo()._impl.strafeLeft(this)},x3dom.Viewarea.prototype.animateTo=function(e,t,A){this._scene.getNavigationInfo()._impl.animateTo(this,e,t,A)},x3dom.Viewarea.prototype.orthoAnimateTo=function(e,t,A){this._scene.getNavigationInfo()._impl.orthoAnimateTo(this,e,t,A)},x3dom.Viewarea.prototype.zoom=function(e){this._scene.getNavigationInfo()._impl.zoom(this,e)},x3dom.Viewarea.prototype.getLights=function(){for(var e=[],t=0;t<this._doc._nodeBag.lights.length;t++)1==this._doc._nodeBag.lights[t]._vf.on&&e.push(this._doc._nodeBag.lights[t]);return e},x3dom.Viewarea.prototype.getLightsShadow=function(){for(var e=this._doc._nodeBag.lights,t=0;t<e.length;t++)if(e[t]._vf.shadowIntensity>0&&e[t]._vf.on)return!0;return!1},x3dom.Viewarea.prototype.hasPhysicalEnvironmentLight=function(){for(var e=0;e<this._doc._nodeBag.lights.length;e++){var t=this._doc._nodeBag.lights[e];if(x3dom.isa(t,x3dom.nodeTypes.PhysicalEnvironmentLight)&&t._vf.on)return!0}return!1},x3dom.Viewarea.prototype.updateSpecialNavigation=function(e,t){var A=this._scene.getNavigationInfo();if("helicopter"==A.getType()&&!A._heliUpdated){var i=A.getTypeParams(),o=i[0],s=e.getViewMatrix().mult(t.inverse()).inverse();this._from=s.e3(),this._at=this._from.subtract(s.e2()),this._up=new x3dom.fields.SFVec3f(0,1,0),this._from.y=i[1],this._at.y=this._from.y;var n=s.e0(),r=x3dom.fields.Quaternion.axisAngle(n,o).toMatrix(),a=x3dom.fields.SFMatrix4f.translation(this._from);a=a.mult(r),r=x3dom.fields.SFMatrix4f.translation(this._from.negate()),a=a.mult(r),this._at=a.multMatrixPnt(this._at),this._flyMat=x3dom.fields.SFMatrix4f.lookAt(this._from,this._at,this._up),this._scene.getViewpoint().setView(this._flyMat.inverse()),A._heliUpdated=!0}},x3dom.Viewarea.prototype.getViewpointMatrix=function(){var e=this._scene.getViewpoint(),t=e.getCurrentTransform();return this.updateSpecialNavigation(e,t),e.getViewMatrix().mult(t.inverse())},x3dom.Viewarea.prototype.getViewMatrix=function(){return this.vrFrameData?this.vrLeftViewMatrix:this.getViewpointMatrix().mult(this._transMat).mult(this._rotMat)},x3dom.Viewarea.prototype.getViewMatrices=function(){if(this.vrFrameData)return[this.vrLeftViewMatrix,this.vrRightViewMatrix];var e=this.getViewpointMatrix().mult(this._transMat).mult(this._rotMat);return[e,e]},x3dom.Viewarea.prototype.getLightMatrix=function(e){var t,A=(e=e||this._doc._nodeBag.lights).length;if(A>0){var i=this._scene.getVolume();if(i.isValid()){var o=x3dom.fields.SFVec3f.MAX(),s=x3dom.fields.SFVec3f.MIN();i.getBounds(o,s);var n=[],r=this._scene.getViewpoint().getFieldOfView(),a=s.subtract(o),d=a.y/2/Math.tan(r/2)+a.z/2,h=a.x/2/Math.tan(r/2)+a.z/2;for(a=o.add(a.multiply(.5)),t=0;t<A;t++){var g=e[t];if(x3dom.isa(g,x3dom.nodeTypes.PointLight)){var l=g.getCurrentTransform().multMatrixPnt(g._vf.location);a=a.subtract(l).normalize()}else{var I=g.getCurrentTransform().multMatrixVec(g._vf.direction);I=I.normalize().negate(),a=a.add(I.multiply(1.2*(d>h?d:h)))}n.push(g.getViewMatrix(a))}return n}}return Array(A||1).fill(this.getViewMatrix())},x3dom.Viewarea.prototype.getWCtoLCMatrix=function(e){var t,A=this.getProjectionMatrix();return t=0===arguments.length?this.getLightMatrix()[0]:e,A.mult(t)},x3dom.Viewarea.prototype.getWCtoLCMatricesPointLight=function(e,t,A){var i=t._vf.zNear,o=t._vf.zFar,s=this.getLightProjectionMatrix(e,i,o,!1,A);s._00=1,s._11=1;var n,r=[];r[0]=s.mult(e);for(var a=1;a<=3;a++)n=x3dom.fields.SFMatrix4f.rotationY(a*Math.PI/2),r[a]=s.mult(n.mult(e));return n=x3dom.fields.SFMatrix4f.rotationX(Math.PI/2),r[4]=s.mult(n.mult(e)),n=x3dom.fields.SFMatrix4f.rotationX(3*Math.PI/2),r[5]=s.mult(n.mult(e)),r},x3dom.Viewarea.prototype.getWCtoLCMatricesCascaded=function(e,t,A){var i=Math.max(1,Math.min(t._vf.shadowCascades,6)),o=Math.max(0,Math.min(t._vf.shadowSplitFactor,1)),s=Math.max(0,Math.min(t._vf.shadowSplitOffset,1)),n=x3dom.isa(t,x3dom.nodeTypes.SpotLight),r=t._vf.zNear,a=t._vf.zFar,d=this.getLightProjectionMatrix(e,r,a,!0,A);n&&(d._00=1,d._11=1);var h=d.mult(e),g=[];if(1==i)return g[0]=h,g;for(var l=this.getShadowSplitDepths(i,o,s,!0,A),I=0;I<i;I++){var c=this.getLightFittingMatrix(h,l[I],l[I+1],A);g[I]=c.mult(h)}return g},x3dom.Viewarea.prototype.getLightProjectionMatrix=function(e,t,A,i,o){var s=x3dom.fields.SFMatrix4f.copy(o);if(!i||t>0||A>0){var n,r,a=e.inverse().e3(),d=x3dom.fields.SFVec3f.copy(this._scene._lastMin),h=x3dom.fields.SFVec3f.copy(this._scene._lastMax).subtract(d),g=h.length()/2,l=d.add(h.multiply(.5)),I=a.subtract(l).length();return g&&(n=I>g?.8*(I-g):1,r=1.2*(I+g)),t>0&&(n=t),A>0&&(r=A),s._22=-(r+n)/(r-n),s._23=-2*r*n/(r-n),s}return this.getLightCropMatrix(s.mult(e)).mult(s)},x3dom.Viewarea.prototype.getProjectionMatrix=function(){return this.vrFrameData?this.vrLeftProjMatrix:this._scene.getViewpoint().getProjectionMatrix(this._width/this._height)},x3dom.Viewarea.prototype.getProjectionMatrices=function(){if(this.vrFrameData)return[this.vrLeftProjMatrix,this.vrRightProjMatrix];var e=this._scene.getViewpoint().getProjectionMatrix(this._width/this._height);return[e,e]},x3dom.Viewarea.prototype.getViewfrustum=function(e){var t=this._scene.getEnvironment();if(1==t._vf.frustumCulling){if(0==arguments.length){var A=this.getProjectionMatrix(),i=this.getViewMatrix();return new x3dom.fields.FrustumVolume(A.mult(i))}return new x3dom.fields.FrustumVolume(e)}return null},x3dom.Viewarea.prototype.getWCtoCCMatrix=function(){var e=this.getViewMatrix();return this.getProjectionMatrix().mult(e)},x3dom.Viewarea.prototype.getCCtoWCMatrix=function(){return this.getWCtoCCMatrix().inverse()},x3dom.Viewarea.prototype.calcViewRay=function(e,t,A){var i=A||this.getCCtoWCMatrix(),o=e/(this._width-1)*2-1,s=(this._height-1-t)/(this._height-1)*2-1,n=i.multFullMatrixPnt(new x3dom.fields.SFVec3f(o,s,-1)),r=i.multFullMatrixPnt(new x3dom.fields.SFVec3f(o,s,1)).subtract(n);return new x3dom.fields.Ray(n,r)},x3dom.Viewarea.prototype.showAll=function(e,t){void 0===e&&(e="negZ"),void 0===t&&(t=!1);var A=this._scene;A.updateVolume();var i,o=x3dom.fields.SFVec3f.copy(A._lastMin),s=x3dom.fields.SFVec3f.copy(A._lastMax),n="x",r="y",a="z",d=1,h=new x3dom.fields.SFVec3f(0,0,-1);switch(e){case"posX":d=-1;case"negX":a="x",n="y",r="z",i=new x3dom.fields.SFVec3f(d,0,0);break;case"posY":d=-1;case"negY":a="y",n="z",r="x",i=new x3dom.fields.SFVec3f(0,d,0);break;case"posZ":d=-1;case"negZ":default:i=new x3dom.fields.SFVec3f(0,0,-d)}var g=A.getViewpoint(),l=g.getFieldOfView(),I=x3dom.isa(g,x3dom.nodeTypes.OrthoViewpoint),c=s.subtract(o),f=c.multiply(.5),u=o.add(f);t&&g.setCenterOfRotation(u);var C=Math.min(this._width/this._height,1),_=c[a]/2,m=Math.tan(l/2),p=c[r]/2/m+_,E=c[n]/2/m+_;(c=o.add(c.multiply(.5)))[a]+=I?d*(p>E?p:E)*3.01:d*(p>E?p:E)*1.01,c[a]/=C;var B=x3dom.fields.Quaternion.rotateFromTo(h,i).toMatrix();B=B.mult(x3dom.fields.SFMatrix4f.translation(c.negate())),I?(this.orthoAnimateTo(p,Math.abs(g._fieldOfView[0])),this.animateTo(B,g)):this.animateTo(B,g)},x3dom.Viewarea.prototype.fit=function(e,t,A){var i=this._scene.getViewpoint(),o=this.getFitViewMatrix(e,t,i,A);x3dom.isa(i,x3dom.nodeTypes.OrthoViewpoint)?(this.orthoAnimateTo(dist/2.01,Math.abs(i._fieldOfView[0])),this.animateTo(o,i)):this.animateTo(o,i)},x3dom.Viewarea.prototype.getFitViewMatrix=function(e,t,A,i){void 0===i&&(i=!0);var o=t.subtract(e).multiply(.5),s=e.add(o),n=o.length(),r=A.getFieldOfView(),a=x3dom.fields.SFMatrix4f.copy(this.getViewMatrix()),d=new x3dom.fields.SFVec3f(a._00,a._01,a._02),h=new x3dom.fields.SFVec3f(a._10,a._11,a._12),g=new x3dom.fields.SFVec3f(a._20,a._21,a._22),l=Math.min(this._width/this._height,1),I=n/Math.tan(r/2)/l,c=s.add(g.multiply(I));return a._03=-d.dot(c),a._13=-h.dot(c),a._23=-g.dot(c),i&&A.setCenterOfRotation(s),a},x3dom.Viewarea.prototype.resetView=function(){this._scene.getNavigationInfo()._impl.resetView(this)},x3dom.Viewarea.prototype.resetNavHelpers=function(){this._rotMat=x3dom.fields.SFMatrix4f.identity(),this._transMat=x3dom.fields.SFMatrix4f.identity(),this._movement=new x3dom.fields.SFVec3f(0,0,0),this._needNavigationMatrixUpdate=!0},x3dom.Viewarea.prototype.uprightView=function(){var e=this.getViewMatrix().inverse(),t=e.e3(),A=t.subtract(e.e2()),i=new x3dom.fields.SFVec3f(0,1,0),o=e.e2().cross(i).normalize().cross(i).normalize();A=t.add(o),e=(e=x3dom.fields.SFMatrix4f.lookAt(t,A,i)).inverse(),this.animateTo(e,this._scene.getViewpoint())},x3dom.Viewarea.prototype.callEvtHandler=function(e,t,A){if(!e||!e._xmlNode)return null;try{var i=e._xmlNode,o=i[t];if("function"==typeof o)o.call(i,A);else if(i.hasAttribute(t)){var s=i.getAttribute(t);new Function("event",s).call(i,A)}var n=e._listeners[A.type];if(n)for(var r=0;r<n.length;r++)n[r].call(i,A)}catch(e){x3dom.debug.logException(e)}return A.cancelBubble},x3dom.Viewarea.prototype.checkEvents=function(e,t,A,i,o){var s,n,r,a=this,d=!0,h=e&&e._xmlNode?e._xmlNode:{},g=this._doc._nodeBag.affectedPointingSensors,l={viewarea:a,target:h,type:o.substr(2,o.length-2),button:i,layerX:t*this._inverseDevicePixelRatio,layerY:A*this._inverseDevicePixelRatio,worldX:a._pick.x,worldY:a._pick.y,worldZ:a._pick.z,normalX:a._pickNorm.x,normalY:a._pickNorm.y,normalZ:a._pickNorm.z,hitPnt:a._pick.toGL(),hitObject:h,shadowObjectId:a._pickingInfo.shadowObjectId,cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.cancelBubble=!0}};try{var I=e;I&&I._xmlNode&&I._cf.geometry&&!I._xmlNode[o]&&!I._xmlNode.hasAttribute(o)&&!I._listeners[l.type]&&(I=I._cf.geometry.node),I&&!0===a.callEvtHandler(I,o,l)&&(d=!1)}catch(e){x3dom.debug.logException(e)}var c=function(e){e._parentNodes.forEach((function(e){if(e._xmlNode&&(e._xmlNode[o]||e._xmlNode.hasAttribute(o)||e._listeners[l.type])&&!0===a.callEvtHandler(e,o,l)&&(d=!1),0==i&&0==g.length&&("onmousemove"==o||"onmouseover"==o||"onmouseout"==o))for(r=e._childNodes.length,n=0;n<r;++n)s=e._childNodes[n],x3dom.isa(s,x3dom.nodeTypes.X3DPointingDeviceSensorNode)&&s._vf.enabled&&-1==g.indexOf(s)&&g.push(s);x3dom.isa(e,x3dom.nodeTypes.Anchor)&&"onclick"===o?(e.handleTouch(),d=!1):d&&c(e)}))};return d&&e&&c(e),d},x3dom.Viewarea.prototype._notifyAffectedPointingSensors=function(e){var t,A={mousedown:"pointerPressedOverSibling",mousemove:"pointerMoved",mouseover:"pointerMovedOver",mouseout:"pointerMovedOut"}[e.type],i=this._doc._nodeBag.affectedPointingSensors,o=i.length;if(o>0&&void 0!==A)for(t=0;t<o;t++)i[t][A](e)},x3dom.Viewarea.prototype.initMouseState=function(){this._deltaT=0,this._dx=0,this._dy=0,this._lastX=-1,this._lastY=-1,this._pressX=-1,this._pressY=-1,this._lastButton=0,this._isMoving=!1,this._needNavigationMatrixUpdate=!0},x3dom.Viewarea.prototype.onMousePress=function(e,t,A){(this._needNavigationMatrixUpdate=!0,this.prepareEvents(e,t,0,"onmouseover"),this.prepareEvents(e,t,A,"onmousedown"),this._pickingInfo.lastClickObj=this._pickingInfo.pickObj,this._pickingInfo.firstObj=this._pickingInfo.pickObj,this._dx=0,this._dy=0,this._lastX=e,this._lastY=t,this._pressX=e,this._pressY=t,this._lastButton=A,this._isMoving=!1,this._currentInputType==x3dom.InputTypes.NAVIGATION)&&this._scene.getNavigationInfo()._impl.onMousePress(this,e,t,A)},x3dom.Viewarea.prototype.onMouseRelease=function(e,t,A,i){var o,s,n=this._doc._nodeBag.affectedPointingSensors;for(o=0;o<n.length;++o)n[o].pointerReleased();this._doc._nodeBag.affectedPointingSensors=[];var r=this._scene.getNavigationInfo(),a=r.getType(),d=this._scene._vf.pickMode.toLowerCase();if("box"!==d){if(this.prepareEvents(e,t,i,"onmouseup"),this._pickingInfo.pickObj&&this._pickingInfo.pickObj===this._pickingInfo.lastClickObj)this.prepareEvents(e,t,i,"onclick");else if(!this._pickingInfo.pickObj&&!this._pickingInfo.lastClickObj&&!this._pickingInfo.firstObj){var h="backgroundClicked";try{if(this._scene._xmlNode&&(this._scene._xmlNode["on"+h]||this._scene._xmlNode.hasAttribute("on"+h)||this._scene._listeners[h])){var g={target:this._scene._xmlNode,type:h,button:i,layerX:e*this._inverseDevicePixelRatio,layerY:t*this._inverseDevicePixelRatio,cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.cancelBubble=!0}};this._scene.callEvtHandler("on"+h,g)}}catch(e){x3dom.debug.logException("backgroundClicked: "+e)}}}else{var l=(new Date).getTime(),I=this.calcViewRay(e,t),c=this._scene.doIntersect(I),f=I.hitObject;c&&f&&(this._pick.setValues(I.hitPoint),this.checkEvents(f,e,t,A,"onclick"),x3dom.debug.logInfo("Hit '"+f._xmlNode.localName+"/ "+f._DEF+"' at dist="+I.dist.toFixed(4)),"color"===d?x3dom.debug.logInfo("Ray hit color "+this._pick):"idbufid"===d||"texcoord"===d?x3dom.debug.logInfo("Ray hit data "+this._pick):x3dom.debug.logInfo("Ray hit at position "+this._pick.x.toFixed(4)+" "+this._pick.y.toFixed(4)+" "+this._pick.z.toFixed(4)));var u=(new Date).getTime()-l;if(x3dom.debug.logInfo("Picking time (box): "+u+"ms"),!c){var C=(s=this.getViewMatrix().e2().negate()).dot(I.pos.negate())/s.dot(I.dir);this._pick=I.pos.add(I.dir.multiply(C))}}if(this._pickingInfo.firstObj=null,this._currentInputType==x3dom.InputTypes.NAVIGATION&&(this._pickingInfo.pickObj||this._pickingInfo.shadowObjectId>=0)&&"lookat"===a&&this._pressX===e&&this._pressY===t){var _=2&this._lastButton?-1:1,m=this._pickingInfo.pickPos.subtract(this._from).length()/3,p=new x3dom.fields.SFMatrix4f;p.setValues(this.getViewMatrix());var E=(p=p.inverse()).e3(),B=(E.subtract(p.e2()),p.e1()),Q=(s=this._pickingInfo.pickPos.subtract(E)).length();s=s.normalize();var x=E.addScaled(s,Q),v=s.cross(B).normalize();s=v.cross(B).normalize(),_<0&&(m=2*(.5+Q+m));var y=x.addScaled(s,m);p=(p=x3dom.fields.SFMatrix4f.lookAt(y,x,B)).inverse(),m=y.subtract(E).length();var F=Math.max(.5,Math.log((1+m)/r._vf.speed));this.animateTo(p,this._scene.getViewpoint(),F)}this._dx=0,this._dy=0,this._lastX=e,this._lastY=t,this._lastButton=A,this._isMoving=!1},x3dom.Viewarea.prototype.onMouseOver=function(e,t,A){this._dx=0,this._dy=0,this._lastButton=0,this._isMoving=!1,this._lastX=e,this._lastY=t,this._deltaT=0},x3dom.Viewarea.prototype.onMouseOut=function(e,t,A){var i;this._dx=0,this._dy=0,this._lastButton=0,this._isMoving=!1,this._lastX=e,this._lastY=t,this._deltaT=0;var o=this._doc._nodeBag.affectedPointingSensors;for(i=0;i<o.length;++i)o[i].pointerReleased();this._doc._nodeBag.affectedPointingSensors=[]},x3dom.Viewarea.prototype.onDoubleClick=function(e,t){this._doc._x3dElem.hasAttribute("disableDoubleClick")&&"true"===this._doc._x3dElem.getAttribute("disableDoubleClick")||this._scene.getNavigationInfo()._impl.onDoubleClick(this,e,t)},x3dom.Viewarea.prototype.handleMoveEvt=function(e,t,A){if(0==A&&(this._doc._nodeBag.affectedPointingSensors=[]),this.prepareEvents(e,t,A,"onmousemove"),this._pickingInfo.pickObj!==this._pickingInfo.lastObj){if(this._pickingInfo.lastObj){var i=this._pickingInfo.pickObj;this._pickingInfo.pickObj=this._pickingInfo.lastObj;var o=this._doc._nodeBag.affectedPointingSensors;this._doc._nodeBag.affectedPointingSensors=[],this.prepareEvents(e,t,A,"onmouseout"),this._doc._nodeBag.affectedPointingSensors=o,this._pickingInfo.pickObj=i}this._pickingInfo.pickObj&&this.prepareEvents(e,t,A,"onmouseover"),this._pickingInfo.lastObj=this._pickingInfo.pickObj}},x3dom.Viewarea.prototype.onMove=function(e,t,A){this.handleMoveEvt(e,t,A),(this._lastX<0||this._lastY<0)&&(this._lastX=e,this._lastY=t),this._dx=e-this._lastX,this._dy=t-this._lastY,this._lastX=e,this._lastY=t},x3dom.Viewarea.prototype.onMoveView=function(e,t){if(this._currentInputType==x3dom.InputTypes.NAVIGATION){var A=this._scene.getNavigationInfo(),i=this._scene.getViewpoint();if("examine"===A.getType()){if(e){var o=this._scene._lastMax.subtract(this._scene._lastMin).length();o=(o<x3dom.fields.Eps?1:o)*A._vf.speed,e=e.multiply(o),this._movement=this._movement.add(e),this._transMat=i.getViewMatrix().inverse().mult(x3dom.fields.SFMatrix4f.translation(this._movement)).mult(i.getViewMatrix())}if(t){var s=i.getCenterOfRotation(),n=this.getViewMatrix();n.setTranslate(new x3dom.fields.SFVec3f(0,0,0)),this._rotMat=this._rotMat.mult(x3dom.fields.SFMatrix4f.translation(s)).mult(n.inverse()).mult(t).mult(n).mult(x3dom.fields.SFMatrix4f.translation(s.negate()))}this._isMoving=!0}}},x3dom.Viewarea.prototype.onDrag=function(e,t,A){this.handleMoveEvt(e,t,A),this._currentInputType==x3dom.InputTypes.NAVIGATION&&this._scene.getNavigationInfo()._impl.onDrag(this,e,t,A)},x3dom.Viewarea.prototype.prepareEvents=function(e,t,A,i){var o=this._doc._nodeBag.affectedPointingSensors,s=this._scene._vf.pickMode.toLowerCase(),n=null;(0==s.indexOf("idbuf")||"color"==s||"texcoord"==s)&&(n=this._pickingInfo.pickObj)&&(this._pick.setValues(this._pickingInfo.pickPos),this._pickNorm.setValues(this._pickingInfo.pickNorm),this.checkEvents(n,e,t,A,i),"onclick"===i&&(n._xmlNode&&x3dom.debug.logInfo('Hit "'+n._xmlNode.localName+"/ "+n._DEF+'"'),"color"===s?x3dom.debug.logInfo("Ray hit color "+this._pick):"idbufid"===s||"texcoord"===s?x3dom.debug.logInfo("Ray hit data "+this._pick):x3dom.debug.logInfo("Ray hit at position "+this._pick.x.toFixed(4)+" "+this._pick.y.toFixed(4)+" "+this._pick.z.toFixed(4))));var r={viewarea:this,target:{},type:i.substr(2,i.length-2),button:A,layerX:e,layerY:t,worldX:this._pick.x,worldY:this._pick.y,worldZ:this._pick.z,normalX:this._pickNorm.x,normalY:this._pickNorm.y,normalZ:this._pickNorm.z,hitPnt:this._pick.toGL(),hitObject:n&&n._xmlNode?n._xmlNode:null,shadowObjectId:this._pickingInfo.shadowObjectId,cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.cancelBubble=!0}};this._notifyAffectedPointingSensors(r),o.length>0?this._currentInputType=x3dom.InputTypes.INTERACTION:this._currentInputType=x3dom.InputTypes.NAVIGATION},x3dom.Viewarea.prototype.getRenderMode=function(){return this._points},x3dom.Viewarea.prototype.getShadowedLights=function(){for(var e=[],t=0,A=this.getLights(),i=0;i<A.length;i++)A[i]._vf.shadowIntensity>0&&(e[t]=A[i],t++);return e},x3dom.Viewarea.prototype.getShadowSplitDepths=function(e,t,A,i,o){var s,n=[],r=this._scene.getViewpoint(),a=r.getNear(),d=r.getFar();n[0]=a,a+=A*(d-a)/10;for(var h=1;h<e;h++)s=a*Math.pow(d/a,h/e),n[h]=t*s+(1-t)*(a+h/(e*(a-d)));if(n[e]=d,!i)return n;for(var g=[],l=0;l<=e;l++)g[l]=o.multFullMatrixPnt(new x3dom.fields.SFVec3f(0,0,-n[l])).z;return g},x3dom.Viewarea.prototype.getLightCropMatrix=function(e){var t,A=x3dom.fields.SFVec3f.copy(this._scene._lastMin),i=x3dom.fields.SFVec3f.copy(this._scene._lastMax),o=[];for(o[0]=new x3dom.fields.SFVec3f(A.x,A.y,A.z),o[1]=new x3dom.fields.SFVec3f(A.x,A.y,i.z),o[2]=new x3dom.fields.SFVec3f(A.x,i.y,A.z),o[3]=new x3dom.fields.SFVec3f(A.x,i.y,i.z),o[4]=new x3dom.fields.SFVec3f(i.x,A.y,A.z),o[5]=new x3dom.fields.SFVec3f(i.x,A.y,i.z),o[6]=new x3dom.fields.SFVec3f(i.x,i.y,A.z),o[7]=new x3dom.fields.SFVec3f(i.x,i.y,i.z),t=0;t<8;t++)o[t]=e.multFullMatrixPnt(o[t]);var s=x3dom.fields.SFVec3f.copy(o[0]),n=x3dom.fields.SFVec3f.copy(o[0]);for(t=1;t<8;t++)s.z=Math.min(o[t].z,s.z),n.z=Math.max(o[t].z,n.z);var r=2/(n.z-s.z),a=-r*(n.z+s.z)/2,d=x3dom.fields.SFMatrix4f.identity();return d._22=r,d._23=a,d},x3dom.Viewarea.prototype.getLightFittingMatrix=function(e,t,A,i){var o,s=this.getViewMatrix(),n=i.mult(s).inverse(),r=[];for(r[0]=new x3dom.fields.SFVec3f(-1,-1,A),r[1]=new x3dom.fields.SFVec3f(-1,-1,t),r[2]=new x3dom.fields.SFVec3f(-1,1,A),r[3]=new x3dom.fields.SFVec3f(-1,1,t),r[4]=new x3dom.fields.SFVec3f(1,-1,A),r[5]=new x3dom.fields.SFVec3f(1,-1,t),r[6]=new x3dom.fields.SFVec3f(1,1,A),r[7]=new x3dom.fields.SFVec3f(1,1,t),o=0;o<8;o++)r[o]=n.multFullMatrixPnt(r[o]),r[o]=e.multFullMatrixPnt(r[o]);var a=x3dom.fields.SFVec3f.copy(r[0]),d=x3dom.fields.SFVec3f.copy(r[0]);for(o=1;o<8;o++)a.x=Math.min(r[o].x,a.x),a.y=Math.min(r[o].y,a.y),a.z=Math.min(r[o].z,a.z),d.x=Math.max(r[o].x,d.x),d.y=Math.max(r[o].y,d.y),d.z=Math.max(r[o].z,d.z);var h=function(e,t){var A=e.x,i=e.y,o=e.z,s=t.x,n=t.y,r=t.z;A>1||s<-1?(A=-1,s=1):(A=Math.max(A,-1),s=Math.min(s,1)),i>1||n<-1?(i=-1,n=1):(i=Math.max(i,-1),n=Math.min(n,1)),o>1||r<-1?(o=-1,r=1):(o=Math.max(o,-1),r=Math.min(r,1));var a=new x3dom.fields.SFVec3f(A,i,o),d=new x3dom.fields.SFVec3f(s,n,r);return new x3dom.fields.BoxVolume(a,d)}(a,d),g=2/(h.max.x-h.min.x),l=2/(h.max.y-h.min.y),I=-g*(h.max.x+h.min.x)/2,c=-l*(h.max.y+h.min.y)/2,f=x3dom.fields.SFMatrix4f.identity();return f._00=g,f._11=l,f._03=I,f._13=c,f},x3dom.fields={};var VecMath=x3dom.fields;function _colorParse(e){var t=0,A=0,i=0,o=1,s={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",feldspar:"#d19275",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslateblue:"#8470ff",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",violetred:"#d02090",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},n=/^rgb\((\d{1,3}),\s{0,1}(\d{1,3}),\s{0,1}(\d{1,3})\)$/.exec(e);null!==n&&(t=n[1]/255,A=n[2]/255,i=n[3]/255);var r=/^rgba\((\d{1,3}),\s{0,1}(\d{1,3}),\s{0,1}(\d{1,3}),(0+\.?\d*|1\.?0*)\)$/.exec(e);if(null!==r&&(t=r[1]/255,A=r[2]/255,i=r[3]/255,o=+r[4]),s[e]&&(e=s[e]),e.substr&&"#"===e.substr(0,1)){var a=e.substr(1),d=a.length;8===d?(t=parseInt("0x"+a.substr(0,2),16)/255,A=parseInt("0x"+a.substr(2,2),16)/255,i=parseInt("0x"+a.substr(4,2),16)/255,o=parseInt("0x"+a.substr(6,2),16)/255):6===d?(t=parseInt("0x"+a.substr(0,2),16)/255,A=parseInt("0x"+a.substr(2,2),16)/255,i=parseInt("0x"+a.substr(4,2),16)/255):4===d?(t=parseInt("0x"+a.substr(0,1),16)/15,A=parseInt("0x"+a.substr(1,1),16)/15,i=parseInt("0x"+a.substr(2,1),16)/15,o=parseInt("0x"+a.substr(3,1),16)/15):3===d&&(t=parseInt("0x"+a.substr(0,1),16)/15,A=parseInt("0x"+a.substr(1,1),16)/15,i=parseInt("0x"+a.substr(2,1),16)/15)}return{r:t,g:A,b:i,a:o}}function startDashVideo(e,t){var A,i,o,s=function(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,A,i){e[A]=i}));return e},n=e;s&&s.hasOwnProperty("url")&&(n=s.url),A=document.querySelector(t),i=new Dash.di.DashContext,(o=new MediaPlayer(i)).startup(),o.attachView(A),o.setAutoPlay(!1),o.attachSource(n)}function setNamespace(e,t,A){t instanceof Element&&void 0!==t.__setAttribute&&(t.hasAttribute("id")?t.__setAttribute("id",e.toString().replace(" ","")+"__"+t.getAttribute("id")):t.hasAttribute("DEF")&&A&&(t.__setAttribute("id",e.toString().replace(" ","")+"__"+t.getAttribute("DEF")),t.id||(t.id=t.__getAttribute("id")))),t.hasChildNodes()&&t.childNodes.forEach((function(t){setNamespace(e,t,A)}))}x3dom.fields.Eps=1e-6,x3dom.fields.SFMatrix4f=function(e,t,A,i,o,s,n,r,a,d,h,g,l,I,c,f){0===arguments.length?(this._00=1,this._01=0,this._02=0,this._03=0,this._10=0,this._11=1,this._12=0,this._13=0,this._20=0,this._21=0,this._22=1,this._23=0,this._30=0,this._31=0,this._32=0,this._33=1):(this._00=e,this._01=t,this._02=A,this._03=i,this._10=o,this._11=s,this._12=n,this._13=r,this._20=a,this._21=d,this._22=h,this._23=g,this._30=l,this._31=I,this._32=c,this._33=f)},x3dom.fields.SFMatrix4f.prototype.e0=function(){return new x3dom.fields.SFVec3f(this._00,this._10,this._20).normalize()},x3dom.fields.SFMatrix4f.prototype.e1=function(){return new x3dom.fields.SFVec3f(this._01,this._11,this._21).normalize()},x3dom.fields.SFMatrix4f.prototype.e2=function(){return new x3dom.fields.SFVec3f(this._02,this._12,this._22).normalize()},x3dom.fields.SFMatrix4f.prototype.e3=function(){return new x3dom.fields.SFVec3f(this._03,this._13,this._23)},x3dom.fields.SFMatrix4f.copy=function(e){return new x3dom.fields.SFMatrix4f(e._00,e._01,e._02,e._03,e._10,e._11,e._12,e._13,e._20,e._21,e._22,e._23,e._30,e._31,e._32,e._33)},x3dom.fields.SFMatrix4f.prototype.copy=function(){return x3dom.fields.SFMatrix4f.copy(this)},x3dom.fields.SFMatrix4f.identity=function(){return new x3dom.fields.SFMatrix4f(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},x3dom.fields.SFMatrix4f.zeroMatrix=function(){return new x3dom.fields.SFMatrix4f(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},x3dom.fields.SFMatrix4f.translation=function(e){return new x3dom.fields.SFMatrix4f(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1)},x3dom.fields.SFMatrix4f.rotationX=function(e){var t=Math.cos(e),A=Math.sin(e);return new x3dom.fields.SFMatrix4f(1,0,0,0,0,t,-A,0,0,A,t,0,0,0,0,1)},x3dom.fields.SFMatrix4f.rotationY=function(e){var t=Math.cos(e),A=Math.sin(e);return new x3dom.fields.SFMatrix4f(t,0,A,0,0,1,0,0,-A,0,t,0,0,0,0,1)},x3dom.fields.SFMatrix4f.rotationZ=function(e){var t=Math.cos(e),A=Math.sin(e);return new x3dom.fields.SFMatrix4f(t,-A,0,0,A,t,0,0,0,0,1,0,0,0,0,1)},x3dom.fields.SFMatrix4f.scale=function(e){return new x3dom.fields.SFMatrix4f(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},x3dom.fields.SFMatrix4f.lookAt=function(e,t,A){var i=e.subtract(t).normalize(),o=A.normalize().cross(i).normalize();if(o.dot(o)<x3dom.fields.Eps)return x3dom.debug.logWarning("View matrix is linearly dependent."),x3dom.fields.SFMatrix4f.translation(e);var s=i.cross(o).normalize(),n=x3dom.fields.SFMatrix4f.identity();return n.setValue(o,s,i,e),n},x3dom.fields.SFMatrix4f.perspectiveFrustum=function(e,t,A,i,o,s){return new x3dom.fields.SFMatrix4f(2*o/(t-e),0,(t+e)/(t-e),0,0,2*o/(i-A),(i+A)/(i-A),0,0,0,-(s+o)/(s-o),-2*s*o/(s-o),0,0,-1,0)},x3dom.fields.SFMatrix4f.perspective=function(e,t,A,i){var o=1/Math.tan(e/2);return new x3dom.fields.SFMatrix4f(o/t,0,0,0,0,o,0,0,0,0,(A+i)/(A-i),2*A*i/(A-i),0,0,-1,0)},x3dom.fields.SFMatrix4f.ortho=function(e,t,A,i,o,s,n){var r=(t-e)/2,a=(i-A)/2,d=s-o;return void 0===n&&(n=1),n<r/a?a=r/n:r=a*n,e=-r,t=r,A=-a,i=a,r*=2,a*=2,new x3dom.fields.SFMatrix4f(2/r,0,0,-(t+e)/r,0,2/a,0,-(i+A)/a,0,0,-2/d,-(s+o)/d,0,0,0,1)},x3dom.fields.SFMatrix4f.prototype.setTranslate=function(e){this._03=e.x,this._13=e.y,this._23=e.z},x3dom.fields.SFMatrix4f.prototype.setScale=function(e){this._00=e.x,this._11=e.y,this._22=e.z},x3dom.fields.SFMatrix4f.prototype.setRotate=function(e){var t=e.x*e.x,A=e.x*e.y,i=e.x*e.z,o=e.y*e.y,s=e.y*e.z,n=e.z*e.z,r=e.w*e.x,a=e.w*e.y,d=e.w*e.z;this._00=1-2*(o+n),this._01=2*(A-d),this._02=2*(i+a),this._10=2*(A+d),this._11=1-2*(t+n),this._12=2*(s-r),this._20=2*(i-a),this._21=2*(s+r),this._22=1-2*(t+o)},x3dom.fields.SFMatrix4f.parseRotation=function(e){var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e),A=+t[1],i=+t[2],o=+t[3],s=+t[4],n=Math.sqrt(A*A+i*i+o*o);0===n?(A=1,i=o=0):(A/=n,i/=n,o/=n);var r=Math.cos(s),a=Math.sin(s),d=1-r;return new x3dom.fields.SFMatrix4f(d*A*A+r,d*A*i+a*o,d*A*o-a*i,0,d*A*i-a*o,d*i*i+r,d*i*o+a*A,0,d*A*o+a*i,d*i*o-a*A,d*o*o+r,0,0,0,0,1).transpose()},x3dom.fields.SFMatrix4f.parse=function(e){var t=!1;/matrix.*\((.+)\)/.exec(e)&&(e=RegExp.$1,t=!0);var A=e.split(/[,\s]+/).map((function(e){return+e}));return A.length>=16?t?new x3dom.fields.SFMatrix4f(A[0],A[4],A[8],A[12],A[1],A[5],A[9],A[13],A[2],A[6],A[10],A[14],A[3],A[7],A[11],A[15]):new x3dom.fields.SFMatrix4f(A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],A[8],A[9],A[10],A[11],A[12],A[13],A[14],A[15]):6===A.length?new x3dom.fields.SFMatrix4f(A[0],A[1],0,A[4],A[2],A[3],0,A[5],0,0,1,0,0,0,0,1):(x3dom.debug.logWarning("SFMatrix4f - can't parse string: "+e),x3dom.fields.SFMatrix4f.identity())},x3dom.fields.SFMatrix4f.prototype.mult=function(e){return new x3dom.fields.SFMatrix4f(this._00*e._00+this._01*e._10+this._02*e._20+this._03*e._30,this._00*e._01+this._01*e._11+this._02*e._21+this._03*e._31,this._00*e._02+this._01*e._12+this._02*e._22+this._03*e._32,this._00*e._03+this._01*e._13+this._02*e._23+this._03*e._33,this._10*e._00+this._11*e._10+this._12*e._20+this._13*e._30,this._10*e._01+this._11*e._11+this._12*e._21+this._13*e._31,this._10*e._02+this._11*e._12+this._12*e._22+this._13*e._32,this._10*e._03+this._11*e._13+this._12*e._23+this._13*e._33,this._20*e._00+this._21*e._10+this._22*e._20+this._23*e._30,this._20*e._01+this._21*e._11+this._22*e._21+this._23*e._31,this._20*e._02+this._21*e._12+this._22*e._22+this._23*e._32,this._20*e._03+this._21*e._13+this._22*e._23+this._23*e._33,this._30*e._00+this._31*e._10+this._32*e._20+this._33*e._30,this._30*e._01+this._31*e._11+this._32*e._21+this._33*e._31,this._30*e._02+this._31*e._12+this._32*e._22+this._33*e._32,this._30*e._03+this._31*e._13+this._32*e._23+this._33*e._33)},x3dom.fields.SFMatrix4f.prototype.multMatrixPnt=function(e){return new x3dom.fields.SFVec3f(this._00*e.x+this._01*e.y+this._02*e.z+this._03,this._10*e.x+this._11*e.y+this._12*e.z+this._13,this._20*e.x+this._21*e.y+this._22*e.z+this._23)},x3dom.fields.SFMatrix4f.prototype.multMatrixVec=function(e){return new x3dom.fields.SFVec3f(this._00*e.x+this._01*e.y+this._02*e.z,this._10*e.x+this._11*e.y+this._12*e.z,this._20*e.x+this._21*e.y+this._22*e.z)},x3dom.fields.SFMatrix4f.prototype.multFullMatrixPnt=function(e){var t=this._30*e.x+this._31*e.y+this._32*e.z+this._33;return t&&(t=1/t),new x3dom.fields.SFVec3f((this._00*e.x+this._01*e.y+this._02*e.z+this._03)*t,(this._10*e.x+this._11*e.y+this._12*e.z+this._13)*t,(this._20*e.x+this._21*e.y+this._22*e.z+this._23)*t)},x3dom.fields.SFMatrix4f.prototype.multMatrixPlane=function(e){var t=new x3dom.fields.SFVec3f(e.x,e.y,e.z),A=t.multiply(-e.w);A=this.multMatrixPnt(A);var i=-(t=this.inverse().transpose().multMatrixVec(t)).dot(A);return new x3dom.fields.SFVec4f(t.x,t.y,t.z,i)},x3dom.fields.SFMatrix4f.prototype.transpose=function(){return new x3dom.fields.SFMatrix4f(this._00,this._10,this._20,this._30,this._01,this._11,this._21,this._31,this._02,this._12,this._22,this._32,this._03,this._13,this._23,this._33)},x3dom.fields.SFMatrix4f.prototype.negate=function(){return new x3dom.fields.SFMatrix4f(-this._00,-this._01,-this._02,-this._03,-this._10,-this._11,-this._12,-this._13,-this._20,-this._21,-this._22,-this._23,-this._30,-this._31,-this._32,-this._33)},x3dom.fields.SFMatrix4f.prototype.multiply=function(e){return new x3dom.fields.SFMatrix4f(e*this._00,e*this._01,e*this._02,e*this._03,e*this._10,e*this._11,e*this._12,e*this._13,e*this._20,e*this._21,e*this._22,e*this._23,e*this._30,e*this._31,e*this._32,e*this._33)},x3dom.fields.SFMatrix4f.prototype.add=function(e){return new x3dom.fields.SFMatrix4f(this._00+e._00,this._01+e._01,this._02+e._02,this._03+e._03,this._10+e._10,this._11+e._11,this._12+e._12,this._13+e._13,this._20+e._20,this._21+e._21,this._22+e._22,this._23+e._23,this._30+e._30,this._31+e._31,this._32+e._32,this._33+e._33)},x3dom.fields.SFMatrix4f.prototype.addScaled=function(e,t){return new x3dom.fields.SFMatrix4f(this._00+t*e._00,this._01+t*e._01,this._02+t*e._02,this._03+t*e._03,this._10+t*e._10,this._11+t*e._11,this._12+t*e._12,this._13+t*e._13,this._20+t*e._20,this._21+t*e._21,this._22+t*e._22,this._23+t*e._23,this._30+t*e._30,this._31+t*e._31,this._32+t*e._32,this._33+t*e._33)},x3dom.fields.SFMatrix4f.prototype.setValues=function(e){this._00=e._00,this._01=e._01,this._02=e._02,this._03=e._03,this._10=e._10,this._11=e._11,this._12=e._12,this._13=e._13,this._20=e._20,this._21=e._21,this._22=e._22,this._23=e._23,this._30=e._30,this._31=e._31,this._32=e._32,this._33=e._33},x3dom.fields.SFMatrix4f.prototype.setValue=function(e,t,A,i){this._00=e.x,this._01=t.x,this._02=A.x,this._10=e.y,this._11=t.y,this._12=A.y,this._20=e.z,this._21=t.z,this._22=A.z,this._30=0,this._31=0,this._32=0,arguments.length>3&&(this._03=i.x,this._13=i.y,this._23=i.z,this._33=1)},x3dom.fields.SFMatrix4f.prototype.setFromArray=function(e){return this._00=e[0],this._01=e[4],this._02=e[8],this._03=e[12],this._10=e[1],this._11=e[5],this._12=e[9],this._13=e[13],this._20=e[2],this._21=e[6],this._22=e[10],this._23=e[14],this._30=e[3],this._31=e[7],this._32=e[11],this._33=e[15],this},x3dom.fields.SFMatrix4f.fromArray=function(e){var t=new x3dom.fields.SFMatrix4f;return t._00=e[0],t._01=e[4],t._02=e[8],t._03=e[12],t._10=e[1],t._11=e[5],t._12=e[9],t._13=e[13],t._20=e[2],t._21=e[6],t._22=e[10],t._23=e[14],t._30=e[3],t._31=e[7],t._32=e[11],t._33=e[15],t},x3dom.fields.SFMatrix4f.prototype.fromRotationTranslationScale=function(e,t,A){t=t||new x3dom.fields.SFVec3f,e=e||new x3dom.fields.Quaternion,A=A||new x3dom.fields.SFVec3f(1,1,1);var i=e.x,o=e.y,s=e.z,n=e.w,r=i+i,a=o+o,d=s+s,h=i*r,g=i*a,l=i*d,I=o*a,c=o*d,f=s*d,u=n*r,C=n*a,_=n*d;return this._00=(1-(I+f))*A.x,this._10=(g+_)*A.x,this._20=(l-C)*A.x,this._30=0,this._01=(g-_)*A.y,this._11=(1-(h+f))*A.y,this._21=(c+u)*A.y,this._31=0,this._02=(l+C)*A.z,this._12=(c-u)*A.z,this._22=(1-(h+I))*A.z,this._32=0,this._03=t.x,this._13=t.y,this._23=t.z,this._33=1,this},x3dom.fields.SFMatrix4f.fromRotationTranslationScale=function(e,t,A){t=t||new x3dom.fields.SFVec3f,e=e||new x3dom.fields.Quaternion,A=A||new x3dom.fields.SFVec3f(1,1,1);var i=new x3dom.fields.SFMatrix4f,o=e.x,s=e.y,n=e.z,r=e.w,a=o+o,d=s+s,h=n+n,g=o*a,l=o*d,I=o*h,c=s*d,f=s*h,u=n*h,C=r*a,_=r*d,m=r*h;return i._00=(1-(c+u))*A.x,i._10=(l+m)*A.x,i._20=(I-_)*A.x,i._30=0,i._01=(l-m)*A.y,i._11=(1-(g+u))*A.y,i._21=(f+C)*A.y,i._31=0,i._02=(I+_)*A.z,i._12=(f-C)*A.z,i._22=(1-(g+c))*A.z,i._32=0,i._03=t.x,i._13=t.y,i._23=t.z,i._33=1,i},x3dom.fields.SFMatrix4f.prototype.toGL=function(){return[this._00,this._10,this._20,this._30,this._01,this._11,this._21,this._31,this._02,this._12,this._22,this._32,this._03,this._13,this._23,this._33]},x3dom.fields.SFMatrix4f.fromGL=function(e){var t=new x3dom.fields.SFMatrix4f;return t._00=e[0],t._01=e[4],t._02=e[8],t._03=e[12],t._10=e[1],t._11=e[5],t._12=e[9],t._13=e[13],t._20=e[2],t._21=e[6],t._22=e[10],t._23=e[14],t._30=e[3],t._31=e[7],t._32=e[11],t._33=e[15],t},x3dom.fields.SFMatrix4f.prototype.at=function(e,t){return this["_"+e+t]},x3dom.fields.SFMatrix4f.prototype.setAt=function(e,t,A){return this["_"+e+t]=A,this},x3dom.fields.SFMatrix4f.prototype.sqrt=function(){for(var e=x3dom.fields.SFMatrix4f.identity(),t=x3dom.fields.SFMatrix4f.copy(this),A=0;A<6;A++){var i=t.inverse(),o=0==A?x3dom.fields.SFMatrix4f.identity():e.inverse(),s=t.det(),n=e.det(),r=Math.abs(Math.pow(s*n,-.125)),a=1/r;t=(t=(t=t.multiply(r)).addScaled(o,a)).multiply(.5),e=(e=(e=e.multiply(r)).addScaled(i,a)).multiply(.5)}return t},x3dom.fields.SFMatrix4f.prototype.normInfinity=function(){var e=0,t=0;return(e=Math.abs(this._00))>t&&(t=e),(e=Math.abs(this._01))>t&&(t=e),(e=Math.abs(this._02))>t&&(t=e),(e=Math.abs(this._03))>t&&(t=e),(e=Math.abs(this._10))>t&&(t=e),(e=Math.abs(this._11))>t&&(t=e),(e=Math.abs(this._12))>t&&(t=e),(e=Math.abs(this._13))>t&&(t=e),(e=Math.abs(this._20))>t&&(t=e),(e=Math.abs(this._21))>t&&(t=e),(e=Math.abs(this._22))>t&&(t=e),(e=Math.abs(this._23))>t&&(t=e),(e=Math.abs(this._30))>t&&(t=e),(e=Math.abs(this._31))>t&&(t=e),(e=Math.abs(this._32))>t&&(t=e),(e=Math.abs(this._33))>t&&(t=e),t},x3dom.fields.SFMatrix4f.prototype.norm1_3x3=function(){var e=Math.abs(this._00)+Math.abs(this._10)+Math.abs(this._20),t=0;return(t=Math.abs(this._01)+Math.abs(this._11)+Math.abs(this._21))>e&&(e=t),(t=Math.abs(this._02)+Math.abs(this._12)+Math.abs(this._22))>e&&(e=t),e},x3dom.fields.SFMatrix4f.prototype.normInf_3x3=function(){var e=Math.abs(this._00)+Math.abs(this._01)+Math.abs(this._02),t=0;return(t=Math.abs(this._10)+Math.abs(this._11)+Math.abs(this._12))>e&&(e=t),(t=Math.abs(this._20)+Math.abs(this._21)+Math.abs(this._22))>e&&(e=t),e},x3dom.fields.SFMatrix4f.prototype.adjointT_3x3=function(){var e=x3dom.fields.SFMatrix4f.identity();return e._00=this._11*this._22-this._12*this._21,e._01=this._12*this._20-this._10*this._22,e._02=this._10*this._21-this._11*this._20,e._10=this._21*this._02-this._22*this._01,e._11=this._22*this._00-this._20*this._02,e._12=this._20*this._01-this._21*this._00,e._20=this._01*this._12-this._02*this._11,e._21=this._02*this._10-this._00*this._12,e._22=this._00*this._11-this._01*this._10,e},x3dom.fields.SFMatrix4f.prototype.equals=function(e){var t=1e-12;return Math.abs(this._00-e._00)<t&&Math.abs(this._01-e._01)<t&&Math.abs(this._02-e._02)<t&&Math.abs(this._03-e._03)<t&&Math.abs(this._10-e._10)<t&&Math.abs(this._11-e._11)<t&&Math.abs(this._12-e._12)<t&&Math.abs(this._13-e._13)<t&&Math.abs(this._20-e._20)<t&&Math.abs(this._21-e._21)<t&&Math.abs(this._22-e._22)<t&&Math.abs(this._23-e._23)<t&&Math.abs(this._30-e._30)<t&&Math.abs(this._31-e._31)<t&&Math.abs(this._32-e._32)<t&&Math.abs(this._33-e._33)<t},x3dom.fields.SFMatrix4f.prototype.getTransform=function(e,t,A,i,o){var s=null;if(arguments.length>4){s=(s=x3dom.fields.SFMatrix4f.translation(o.negate())).mult(this);var n=x3dom.fields.SFMatrix4f.translation(o);s=s.mult(n)}else s=x3dom.fields.SFMatrix4f.copy(this);var r=s.decompose(e,t,A,i);A.setValues(A.multiply(r))},x3dom.fields.SFMatrix4f.prototype.decompose=function(e,t,A,i){var o=x3dom.fields.SFMatrix4f.copy(this),s=x3dom.fields.SFMatrix4f.identity(),n=x3dom.fields.SFMatrix4f.identity(),r=x3dom.fields.SFMatrix4f.identity();e.x=o._03,e.y=o._13,e.z=o._23,o._03=0,o._13=0,o._23=0,o._30=0,o._31=0,o._32=0;var a=1;return o.polarDecompose(s,n)<0&&(s=s.negate(),a=-1),t.setValue(s),n.spectralDecompose(r,A),i.setValue(r),a},x3dom.fields.SFMatrix4f.prototype.polarDecompose=function(e,t){var A,i,o,s,n,r=this.transpose(),a=x3dom.fields.SFMatrix4f.identity(),d=r.norm1_3x3(),h=r.normInf_3x3();do{if(A=r.adjointT_3x3(),0==(n=r._00*A._00+r._01*A._01+r._02*A._02)){x3dom.debug.logWarning("polarDecompose: Mk_det == 0.0");break}i=A.norm1_3x3(),o=A.normInf_3x3();var g=Math.sqrt(Math.sqrt(i*o/(d*h))/Math.abs(n)),l=.5*g,I=.5/(g*n);a.setValues(r),r=(r=r.multiply(l)).addScaled(A,I),s=(a=a.addScaled(r,-1)).norm1_3x3(),d=r.norm1_3x3(),h=r.normInf_3x3()}while(s>1e-12*d);e.setValues(r.transpose()),t.setValues(r.mult(this));for(var c=0;c<3;++c)for(var f=c;f<3;++f)t.setAt(f,c,.5*(t.at(f,c)+t.at(c,f))),t.setAt(c,f,.5*(t.at(f,c)+t.at(c,f)));return n},x3dom.fields.SFMatrix4f.prototype.spectralDecompose=function(e,t){for(var A=[1,2,0],i=[this._00,this._11,this._22],o=[this._12,this._20,this._01],s=0;s<20;++s){if(0==Math.abs(o[0])+Math.abs(o[1])+Math.abs(o[2]))break;for(var n=2;n>=0;--n){var r=A[n],a=A[r],d=Math.abs(o[n]),h=100*d;if(d>0){var g=0,l=i[a]-i[r],I=Math.abs(l);if(I+h==I)g=o[n]/l;else{var c=.5*l/o[n];g=1/(Math.abs(c)+Math.sqrt(c*c+1)),g=c<0?-g:g}var f=1/Math.sqrt(g*g+1),u=g*f,C=u/(f+1),_=g*o[n];o[n]=0,i[r]-=_,i[a]+=_;var m=o[a];o[a]-=u*(o[r]+C*m),o[r]+=u*(m-C*o[r]);for(var p=2;p>=0;--p){var E=e.at(p,r),B=e.at(p,a);e.setAt(p,r,e.at(p,r)-u*(B+C*E)),e.setAt(p,a,e.at(p,a)+u*(E-C*B))}}}}t.x=i[0],t.y=i[1],t.z=i[2]},x3dom.fields.SFMatrix4f.prototype.log=function(){var e=x3dom.fields.SFMatrix4f.copy(this),t=x3dom.fields.SFMatrix4f.copy(this);t._00-=1,t._11-=1,t._22-=1,t._33-=1;for(var A=0;t.normInfinity()>.5;)e=e.sqrt(),t.setValues(e),t._00-=1,t._11-=1,t._22-=1,t._33-=1,A++;e._00-=1,e._11-=1,e._22-=1,e._33-=1,e=e.negate(),t.setValues(e);for(var i=x3dom.fields.SFMatrix4f.copy(e),o=1;t.normInfinity()>1e-12&&o<12;)t=t.mult(e),o++,i=i.addScaled(t,1/o);return i.multiply(-(1<<A))},x3dom.fields.SFMatrix4f.prototype.exp=function(){var e=x3dom.fields.SFMatrix4f.copy(this),t=x3dom.fields.SFMatrix4f.identity(),A=x3dom.fields.SFMatrix4f.identity(),i=x3dom.fields.SFMatrix4f.identity(),o=0,s=1,n=1+parseInt(Math.log(e.normInfinity()/.693));for(n<0&&(n=0),e=e.multiply(1/(1<<n)),o=1;o<=6;o++)s*=(6-o+1)/(o*(12-o+1)),i=e.mult(i),A=A.addScaled(i,s),t=o%2?t.addScaled(i,-s):t.addScaled(i,s);for(i=t.inverse().mult(A),o=0;o<n;o++)i=i.mult(i);return i},x3dom.fields.SFMatrix4f.prototype.det3=function(e,t,A,i,o,s,n,r,a){return e*o*a+t*s*n+A*i*r-e*s*r-t*i*a-A*o*n},x3dom.fields.SFMatrix4f.prototype.det=function(){var e=this._00,t=this._10,A=this._20,i=this._30,o=this._01,s=this._11,n=this._21,r=this._31,a=this._02,d=this._12,h=this._22,g=this._32,l=this._03,I=this._13,c=this._23,f=this._33;return e*this.det3(s,d,I,n,h,c,r,g,f)-t*this.det3(o,a,l,n,h,c,r,g,f)+A*this.det3(o,a,l,s,d,I,r,g,f)-i*this.det3(o,a,l,s,d,I,n,h,c)},x3dom.fields.SFMatrix4f.prototype.inverse=function(){var e=this._00,t=this._10,A=this._20,i=this._30,o=this._01,s=this._11,n=this._21,r=this._31,a=this._02,d=this._12,h=this._22,g=this._32,l=this._03,I=this._13,c=this._23,f=this._33,u=this.det();return 0==u?(x3dom.debug.logWarning("Invert matrix: singular matrix, no inverse!"),x3dom.fields.SFMatrix4f.identity()):(u=1/u,new x3dom.fields.SFMatrix4f(+this.det3(s,d,I,n,h,c,r,g,f)*u,-this.det3(o,a,l,n,h,c,r,g,f)*u,+this.det3(o,a,l,s,d,I,r,g,f)*u,-this.det3(o,a,l,s,d,I,n,h,c)*u,-this.det3(t,d,I,A,h,c,i,g,f)*u,+this.det3(e,a,l,A,h,c,i,g,f)*u,-this.det3(e,a,l,t,d,I,i,g,f)*u,+this.det3(e,a,l,t,d,I,A,h,c)*u,+this.det3(t,s,I,A,n,c,i,r,f)*u,-this.det3(e,o,l,A,n,c,i,r,f)*u,+this.det3(e,o,l,t,s,I,i,r,f)*u,-this.det3(e,o,l,t,s,I,A,n,c)*u,-this.det3(t,s,d,A,n,h,i,r,g)*u,+this.det3(e,o,a,A,n,h,i,r,g)*u,-this.det3(e,o,a,t,s,d,i,r,g)*u,+this.det3(e,o,a,t,s,d,A,n,h)*u))},x3dom.fields.SFMatrix4f.prototype.getEulerAngles=function(){var e,t,A,i,o,s,n,r;return Math.abs(Math.abs(this._20)-1)>1e-4?(e=-Math.asin(this._20),t=Math.PI-e,n=Math.cos(e),r=Math.cos(t),i=Math.atan2(this._21/n,this._22/n),o=Math.atan2(this._21/r,this._22/r),[i,e,Math.atan2(this._10/n,this._00/n),o,t,Math.atan2(this._10/r,this._00/r)]):(0,-1==this._20?(A=Math.PI/2,s=0+Math.atan2(this._01,this._02)):(A=-Math.PI/2,s=-0+Math.atan2(-this._01,-this._02)),[s,A,0,s,A,0])},x3dom.fields.SFMatrix4f.prototype.toString=function(){return this._00.toFixed(6)+" "+this._10.toFixed(6)+" "+this._20.toFixed(6)+" "+this._30.toFixed(6)+" "+this._01.toFixed(6)+" "+this._11.toFixed(6)+" "+this._21.toFixed(6)+" "+this._31.toFixed(6)+" "+this._02.toFixed(6)+" "+this._12.toFixed(6)+" "+this._22.toFixed(6)+" "+this._32.toFixed(6)+" "+this._03.toFixed(6)+" "+this._13.toFixed(6)+" "+this._23.toFixed(6)+" "+this._33.toFixed(6)},x3dom.fields.SFMatrix4f.prototype.setValueByStr=function(e){var t=!1;/matrix.*\((.+)\)/.exec(e)&&(e=RegExp.$1,t=!0);var A=e.split(/[,\s]+/).map((function(e){return+e}));return A.length>=16?t?(this._00=A[0],this._01=A[4],this._02=A[8],this._03=A[12],this._10=A[1],this._11=A[5],this._12=A[9],this._13=A[13],this._20=A[2],this._21=A[6],this._22=A[10],this._23=A[14],this._30=A[3],this._31=A[7],this._32=A[11],this._33=A[15]):(this._00=A[0],this._01=A[1],this._02=A[2],this._03=A[3],this._10=A[4],this._11=A[5],this._12=A[6],this._13=A[7],this._20=A[8],this._21=A[9],this._22=A[10],this._23=A[11],this._30=A[12],this._31=A[13],this._32=A[14],this._33=A[15]):6===A.length?(this._00=A[0],this._01=A[1],this._02=0,this._03=A[4],this._10=A[2],this._11=A[3],this._12=0,this._13=A[5],this._20=0,this._21=0,this._22=1,this._23=0,this._30=0,this._31=0,this._32=0,this._33=1):x3dom.debug.logWarning("SFMatrix4f - can't parse string: "+e),this},x3dom.fields.SFVec2f=function(e,t){0===arguments.length?(this.x=0,this.y=0):(this.x=e,this.y=t)},x3dom.fields.SFVec2f.copy=function(e){return new x3dom.fields.SFVec2f(e.x,e.y)},x3dom.fields.SFVec2f.parse=function(e){var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);return null===t?new x3dom.fields.SFVec2f:new x3dom.fields.SFVec2f(+t[1],+t[2])},x3dom.fields.SFVec2f.prototype.copy=function(){return x3dom.fields.SFVec2f.copy(this)},x3dom.fields.SFVec2f.prototype.setValues=function(e){return this.x=e.x,this.y=e.y,this},x3dom.fields.SFVec2f.prototype.at=function(e){switch(e){case 0:return this.x;case 1:return this.y;default:return this.x}},x3dom.fields.SFVec2f.prototype.add=function(e){return new x3dom.fields.SFVec2f(this.x+e.x,this.y+e.y)},x3dom.fields.SFVec2f.prototype.subtract=function(e){return new x3dom.fields.SFVec2f(this.x-e.x,this.y-e.y)},x3dom.fields.SFVec2f.prototype.negate=function(){return new x3dom.fields.SFVec2f(-this.x,-this.y)},x3dom.fields.SFVec2f.prototype.dot=function(e){return this.x*e.x+this.y*e.y},x3dom.fields.SFVec2f.prototype.reflect=function(e){var t=2*this.dot(e);return new x3dom.fields.SFVec2f(this.x-t*e.x,this.y-t*e.y)},x3dom.fields.SFVec2f.prototype.normalize=function(){var e=this.length();return e&&(e=1/e),new x3dom.fields.SFVec2f(this.x*e,this.y*e)},x3dom.fields.SFVec2f.prototype.multComponents=function(e){return new x3dom.fields.SFVec2f(this.x*e.x,this.y*e.y)},x3dom.fields.SFVec2f.prototype.multiply=function(e){return new x3dom.fields.SFVec2f(this.x*e,this.y*e)},x3dom.fields.SFVec2f.prototype.divideComponents=function(e){return new x3dom.fields.SFVec2f(this.x/e.x,this.y/e.y)},x3dom.fields.SFVec2f.prototype.divide=function(e){var t=e?1/e:1;return new x3dom.fields.SFVec2f(this.x*t,this.y*t)},x3dom.fields.SFVec2f.prototype.equals=function(e,t){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t},x3dom.fields.SFVec2f.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},x3dom.fields.SFVec2f.prototype.toGL=function(){return[this.x,this.y]},x3dom.fields.SFVec2f.prototype.toString=function(){return this.x+" "+this.y},x3dom.fields.SFVec2f.prototype.setValueByStr=function(e){var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);return t=t||[0,0,0],this.x=+t[1],this.y=+t[2],this},x3dom.fields.SFVec3f=function(e,t,A){0===arguments.length?(this.x=0,this.y=0,this.z=0):(this.x=e,this.y=t,this.z=A)},x3dom.fields.SFVec3f.NullVector=new x3dom.fields.SFVec3f(0,0,0),x3dom.fields.SFVec3f.OneVector=new x3dom.fields.SFVec3f(1,1,1),x3dom.fields.SFVec3f.copy=function(e){return new x3dom.fields.SFVec3f(e.x,e.y,e.z)},x3dom.fields.SFVec3f.MIN=function(){return new x3dom.fields.SFVec3f(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)},x3dom.fields.SFVec3f.MAX=function(){return new x3dom.fields.SFVec3f(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},x3dom.fields.SFVec3f.parse=function(e){try{var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);return new x3dom.fields.SFVec3f(+t[1],+t[2],+t[3])}catch(t){var A=x3dom.fields.SFColor.colorParse(e);return new x3dom.fields.SFVec3f(A.r,A.g,A.b)}},x3dom.fields.SFVec3f.prototype.copy=function(){return x3dom.fields.SFVec3f.copy(this)},x3dom.fields.SFVec3f.prototype.fromArray=function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this},x3dom.fields.SFVec3f.fromArray=function(e){return new x3dom.fields.SFVec3f(e[0],e[1],e[2])},x3dom.fields.SFVec3f.prototype.setValues=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},x3dom.fields.SFVec3f.prototype.set=function(e,t,A){return this.x=e,this.y=t,this.z=A,this},x3dom.fields.SFVec3f.prototype.at=function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:return this.x}},x3dom.fields.SFVec3f.prototype.add=function(e){return new x3dom.fields.SFVec3f(this.x+e.x,this.y+e.y,this.z+e.z)},x3dom.fields.SFVec3f.prototype.addScaled=function(e,t){return new x3dom.fields.SFVec3f(this.x+t*e.x,this.y+t*e.y,this.z+t*e.z)},x3dom.fields.SFVec3f.prototype.subtract=function(e){return new x3dom.fields.SFVec3f(this.x-e.x,this.y-e.y,this.z-e.z)},x3dom.fields.SFVec3f.prototype.subtractVectors=function(e,t){return new x3dom.fields.SFVec3f(e.x-t.x,e.y-t.y,e.z-t.z)},x3dom.fields.SFVec3f.prototype.negate=function(){return new x3dom.fields.SFVec3f(-this.x,-this.y,-this.z)},x3dom.fields.SFVec3f.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},x3dom.fields.SFVec3f.prototype.cross=function(e){return new x3dom.fields.SFVec3f(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},x3dom.fields.SFVec3f.prototype.reflect=function(e){var t=2*this.dot(e);return new x3dom.fields.SFVec3f(this.x-t*e.x,this.y-t*e.y,this.z-t*e.z)},x3dom.fields.SFVec3f.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},x3dom.fields.SFVec3f.prototype.normalize=function(){var e=this.length();return e&&(e=1/e),new x3dom.fields.SFVec3f(this.x*e,this.y*e,this.z*e)},x3dom.fields.SFVec3f.prototype.multComponents=function(e){return new x3dom.fields.SFVec3f(this.x*e.x,this.y*e.y,this.z*e.z)},x3dom.fields.SFVec3f.prototype.multiply=function(e){return new x3dom.fields.SFVec3f(this.x*e,this.y*e,this.z*e)},x3dom.fields.SFVec3f.prototype.divide=function(e){var t=e?1/e:1;return new x3dom.fields.SFVec3f(this.x*t,this.y*t,this.z*t)},x3dom.fields.SFVec3f.prototype.equals=function(e,t){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t&&Math.abs(this.z-e.z)<t},x3dom.fields.SFVec3f.prototype.toGL=function(){return[this.x,this.y,this.z]},x3dom.fields.SFVec3f.prototype.toString=function(){return this.x+" "+this.y+" "+this.z},x3dom.fields.SFVec3f.prototype.setValueByStr=function(e){try{var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);this.x=+t[1],this.y=+t[2],this.z=+t[3]}catch(t){var A=x3dom.fields.SFColor.colorParse(e);this.x=A.r,this.y=A.g,this.z=A.b}return this},x3dom.fields.SFVec4f=function(e,t,A,i){0===arguments.length?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x=e,this.y=t,this.z=A,this.w=i)},x3dom.fields.SFVec4f.copy=function(e){return new x3dom.fields.SFVec4f(e.x,e.y,e.z,e.w)},x3dom.fields.SFVec4f.prototype.copy=function(){return x3dom.fields.SFVec4f(this)},x3dom.fields.SFVec4f.parse=function(e){var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);return null===t?new x3dom.fields.SFVec4f:new x3dom.fields.SFVec4f(+t[1],+t[2],+t[3],+t[4])},x3dom.fields.SFVec4f.prototype.setValueByStr=function(e){var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);return t=t||[0,0,0,0,0],this.x=+t[1],this.y=+t[2],this.z=+t[3],this.w=+t[4],this},x3dom.fields.SFVec4f.prototype.toGL=function(){return[this.x,this.y,this.z,this.w]},x3dom.fields.SFVec4f.prototype.toString=function(){return this.x+" "+this.y+" "+this.z+" "+this.w},x3dom.fields.Quaternion=function(e,t,A,i){0===arguments.length?(this.x=0,this.y=0,this.z=0,this.w=1):(this.x=e,this.y=t,this.z=A,this.w=i)},x3dom.fields.SFRotation=new Proxy(x3dom.fields.Quaternion,{construct:function(e,t){var A;t[0]=t[0]||0,t[1]=null==t[1]?1:t[1],t[2]=t[2]||0,t[3]=t[3]||0;var i={get:function(e,t){switch(t){case"0":return e.SFRotation.x;case"1":return e.SFRotation.y;case"2":return e.SFRotation.z;case"3":case"angle":return e.SFRotation.angle;default:return Reflect.get(e,t)}},set:function(e,t,A){var i=e.SFRotation,o={0:"x",1:"y",2:"z",x:"x",y:"y",z:"z",angle:"angle"};return t in o?(i[o[t]]=A,e.setValues(new x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(i.x,i.y,i.z),i.angle)),!0):(x3dom.debug.logWarning(" SFRotation: property not available - "+t),!1)}};if(t[0].constructor==x3dom.fields.SFVec3f){var o=(A=t[1].constructor==x3dom.fields.SFVec3f?new x3dom.fields.Quaternion.rotateFromTo(t[0].normalize(),t[1].normalize()):new x3dom.fields.Quaternion.axisAngle(t[0],t[1])).toAxisAngle();A.SFRotation={x:o[0].x,y:o[0].y,z:o[0].z,angle:o[1]}}else(A=new x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(t[0],t[1],t[2]),t[3])).SFRotation={x:t[0],y:t[1],z:t[2],angle:t[3]};return new Proxy(A,i)}}),x3dom.fields.Quaternion.prototype.getAxis=function(){if("SFRotation"in this){var e=this.SFRotation;return new x3dom.fields.SFVec3f(e.x,e.y,e.z)}return this.toAxisAngle()[0]},x3dom.fields.Quaternion.prototype.setAxis=function(e){var t;"SFRotation"in this?(t=this.SFRotation.angle,this.SFRotation.x=e.x,this.SFRotation.y=e.y,this.SFRotation.z=e.z):t=this.angle();var A=new x3dom.fields.Quaternion.axisAngle(e,t);this.setValues(A)},x3dom.fields.Quaternion.prototype.multiVec=function(e){var t=x3dom.fields.SFMatrix4f.identity();return t.setRotate(this),t.multMatrixVec(e)},x3dom.fields.Quaternion.prototype.setValues=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},x3dom.fields.Quaternion.copy=function(e){return new x3dom.fields.Quaternion(e.x,e.y,e.z,e.w)},x3dom.fields.Quaternion.prototype.multiply=function(e){var t=new x3dom.fields.Quaternion(this.w*e.x+this.x*e.w+this.y*e.z-this.z*e.y,this.w*e.y+this.y*e.w+this.z*e.x-this.x*e.z,this.w*e.z+this.z*e.w+this.x*e.y-this.y*e.x,this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z);if("SFRotation"in this){var A=t.toAxisAngle();return new x3dom.fields.SFRotation(A[0].x,A[0].y,A[0].z,A[1])}return t},x3dom.fields.Quaternion.prototype.fromArray=function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this},x3dom.fields.Quaternion.fromArray=function(e){return new x3dom.fields.Quaternion(e[0],e[1],e[2],e[3])},x3dom.fields.Quaternion.parseAxisAngle=function(e){var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);return null===t?new x3dom.fields.Quaternion:x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(+t[1],+t[2],+t[3]),+t[4])},x3dom.fields.Quaternion.axisAngle=function(e,t){var A=e.length();if(A>x3dom.fields.Eps){var i=Math.sin(t/2)/A,o=Math.cos(t/2);return new x3dom.fields.Quaternion(e.x*i,e.y*i,e.z*i,o)}return new x3dom.fields.Quaternion(0,0,0,1)},x3dom.fields.Quaternion.prototype.copy=function(){return x3dom.fields.Quaternion.copy(this)},x3dom.fields.Quaternion.prototype.toMatrix=function(){var e=this.x*this.x,t=this.x*this.y,A=this.x*this.z,i=this.y*this.y,o=this.y*this.z,s=this.z*this.z,n=this.w*this.x,r=this.w*this.y,a=this.w*this.z;return new x3dom.fields.SFMatrix4f(1-2*(i+s),2*(t-a),2*(A+r),0,2*(t+a),1-2*(e+s),2*(o-n),0,2*(A-r),2*(o+n),1-2*(e+i),0,0,0,0,1)},x3dom.fields.Quaternion.prototype.toAxisAngle=function(){var e,t,A=0,i=0,o=0;return this.w>1&&this.normalize(),t=2*Math.acos(this.w),0==(e=Math.sqrt(1-this.w*this.w))?(A=this.x,i=this.y,o=this.z):(A=this.x/e,i=this.y/e,o=this.z/e),[new x3dom.fields.SFVec3f(A,i,o),t]},x3dom.fields.Quaternion.prototype.angle=function(){return 2*Math.acos(this.w)},x3dom.fields.Quaternion.prototype.setValue=function(e){var t,A=1,i=[0,0,0],o=0,s=0,n=0,r=[1,2,0];if((t=e._00+e._11+e._22)>0?(A=Math.sqrt(t+1),this.w=.5*A,A=.5/A,this.x=(e._21-e._12)*A,this.y=(e._02-e._20)*A,this.z=(e._10-e._01)*A):(o=e._11>e._00?1:0,e._22>e.at(o,o)&&(o=2),n=r[s=r[o]],A=Math.sqrt(e.at(o,o)-(e.at(s,s)+e.at(n,n))+1),i[o]=.5*A,A=.5/A,this.w=(e.at(n,s)-e.at(s,n))*A,i[s]=(e.at(s,o)+e.at(o,s))*A,i[n]=(e.at(n,o)+e.at(o,n))*A,this.x=i[0],this.y=i[1],this.z=i[2]),this.w>1||this.w<-1){var a=1+100*x3dom.fields.Eps;(this.w>a||this.w<-a)&&x3dom.debug.logInfo("MatToQuat: BUG: |quat[4]| ("+this.w+") >> 1.0 !"),this.w>1?this.w=1:this.w=-1}},x3dom.fields.Quaternion.prototype.setFromEuler=function(e,t,A){var i=Math.sin(.5*e),o=Math.cos(.5*e),s=Math.sin(.5*t),n=Math.cos(.5*t),r=Math.sin(.5*A),a=Math.cos(.5*A);return this.x=i*n*a-o*s*r,this.y=o*s*a+i*n*r,this.z=o*n*r-i*s*a,this.w=o*n*a+i*s*r,this},x3dom.fields.Quaternion.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},x3dom.fields.Quaternion.prototype.add=function(e){return new x3dom.fields.Quaternion(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},x3dom.fields.Quaternion.prototype.subtract=function(e){return new x3dom.fields.Quaternion(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},x3dom.fields.Quaternion.prototype.setValues=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},x3dom.fields.Quaternion.prototype.equals=function(e,t){return this.dot(e)>=1-t},x3dom.fields.Quaternion.prototype.multScalar=function(e){return new x3dom.fields.Quaternion(this.x*e,this.y*e,this.z*e,this.w*e)},x3dom.fields.Quaternion.prototype.normalize=function(){var e=this.dot(this),t=1;return e&&(t=1/Math.sqrt(e)),this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},x3dom.fields.Quaternion.normalize=function(e){var t=e.dot(e),A=1;return t&&(A=1/Math.sqrt(t)),e.x*=A,e.y*=A,e.z*=A,e.w*=A,e},x3dom.fields.Quaternion.prototype.negate=function(){return new x3dom.fields.Quaternion(-this.x,-this.y,-this.z,-this.w)},x3dom.fields.Quaternion.prototype.inverse=function(){var e=new x3dom.fields.Quaternion(-this.x,-this.y,-this.z,this.w);if("SFRotation"in this){var t=e.toAxisAngle();return new x3dom.fields.SFRotation(t[0].x,t[0].y,t[0].z,t[1])}return e},x3dom.fields.Quaternion.prototype.slerp=function(e,t){var A,i,o,s=this.dot(e);if(s<0?(s=-s,A=e.negate()):A=new x3dom.fields.Quaternion(e.x,e.y,e.z,e.w),1-s>1e-5){var n=Math.acos(s),r=Math.sin(n);i=Math.sin((1-t)*n)/r,o=Math.sin(t*n)/r}else i=1-t,o=t;var a=this.multScalar(i).add(A.multScalar(o));if("SFRotation"in this){var d=a.toAxisAngle();return new x3dom.fields.SFRotation(d[0].x,d[0].y,d[0].z,d[1])}return a},x3dom.fields.Quaternion.rotateFromTo=function(e,t){var A=e.normalize(),i=t.normalize(),o=A.dot(i);if(o>.99999)return new x3dom.fields.Quaternion(0,0,0,1);if(o<-.99999){var s=new x3dom.fields.SFVec3f(1,0,0),n=A.cross(s);return n.length()<1e-5&&(s.x=0,s.y=1,s.z=0,n=A.cross(s)),n=n.normalize(),x3dom.fields.Quaternion.axisAngle(n,Math.PI)}var r=e.cross(t);r=r.normalize();var a=Math.sqrt(.5*(1-o));return r=r.multiply(a),a=Math.sqrt(.5*(1+o)),new x3dom.fields.Quaternion(r.x,r.y,r.z,a)},x3dom.fields.Quaternion.prototype.toGL=function(){var e=this.toAxisAngle();return[e[0].x,e[0].y,e[0].z,e[1]]},x3dom.fields.Quaternion.prototype.toString=function(){return"SFRotation"in this?this.SFRotation.x+" "+this.SFRotation.y+" "+this.SFRotation.z+" "+this.SFRotation.angle:this.x+" "+this.y+" "+this.z+", "+this.w},x3dom.fields.Quaternion.prototype.setValueByStr=function(e){var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);t=t||[0,1,0,0,0];var A=x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(+t[1],+t[2],+t[3]),+t[4]);return this.x=A.x,this.y=A.y,this.z=A.z,this.w=A.w,this},x3dom.fields.SFColor=function(e,t,A){0===arguments.length?(this.r=0,this.g=0,this.b=0):(this.r=e,this.g=t,this.b=A)},x3dom.fields.SFColor.parse=function(e){try{var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);return new x3dom.fields.SFColor(+t[1],+t[2],+t[3])}catch(t){return x3dom.fields.SFColor.colorParse(e)}},x3dom.fields.SFColor.copy=function(e){return new x3dom.fields.SFColor(e.r,e.g,e.b)},x3dom.fields.SFColor.prototype.copy=function(){return x3dom.fields.SFColor.copy(this)},x3dom.fields.SFColor.prototype.setHSV=function(e,t,A){var i,o,s,n,r,a=0,d=0,h=0;switch(s=A*(1-t),n=A*(1-t*(o=e/60-(i=Math.floor(e/60)))),r=A*(1-t*(1-o)),i){case 0:case 6:a=A,d=r,h=s;break;case 1:a=n,d=A,h=s;break;case 2:a=s,d=A,h=r;break;case 3:a=s,d=n,h=A;break;case 4:a=r,d=s,h=A;break;case 5:a=A,d=s,h=n;break;default:x3dom.debug.logWarning("Using black for invalid case in setHSV: "+i)}return this.r=a,this.g=d,this.b=h,this},x3dom.fields.SFColor.prototype.getHSV=function(){var e,t=0,A={},i=this.r;if(A.name="red",A.value=this.r,this.g<i&&(i=this.g),this.b<i&&(i=this.b),this.g>A.value&&(A.name="green",A.value=this.g),this.b>A.value&&(A.name="blue",A.value=this.b),0==(e=A.value-i))t=0;else if("red"==A.name)t=(this.g-this.b)/e%6*60;else if("green"==A.name)t=60*((this.b-this.r)/e+2);else{if("blue"!=A.name)throw"Unknown maximum component: "+A.name;t=60*((this.r-this.g)/e+4)}return t<0&&(t+=360),[t,0==A.value?0:e/A.value,A.value]},x3dom.fields.SFColor.prototype.setValues=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},x3dom.fields.SFColor.prototype.equals=function(e,t){return Math.abs(this.r-e.r)<t&&Math.abs(this.g-e.g)<t&&Math.abs(this.b-e.b)<t},x3dom.fields.SFColor.prototype.add=function(e){return new x3dom.fields.SFColor(this.r+e.r,this.g+e.g,this.b+e.b)},x3dom.fields.SFColor.prototype.subtract=function(e){return new x3dom.fields.SFColor(this.r-e.r,this.g-e.g,this.b-e.b)},x3dom.fields.SFColor.prototype.multiply=function(e){return new x3dom.fields.SFColor(this.r*e,this.g*e,this.b*e)},x3dom.fields.SFColor.prototype.toUint=function(){return(Math.round(255*this.r)<<16|Math.round(255*this.g)<<8|Math.round(255*this.b))>>>0},x3dom.fields.SFColor.prototype.setFromUint=function(e){return this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e>>0&255)/255,this},x3dom.fields.SFColor.prototype.toGL=function(){return[this.r,this.g,this.b]},x3dom.fields.SFColor.prototype.toString=function(){return this.r+" "+this.g+" "+this.b},x3dom.fields.SFColor.prototype.setValueByStr=function(e){try{var t=/^\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*$/.exec(e);this.r=+t[1],this.g=+t[2],this.b=+t[3]}catch(t){var A=x3dom.fields.SFColor.colorParse(e);this.r=A.r,this.g=A.g,this.b=A.b}return this},x3dom.fields.SFColor.colorParse=function(e){var t=_colorParse(e);return new x3dom.fields.SFColor(t.r,t.g,t.b)},x3dom.fields.SFColorRGBA=function(e,t,A,i){0===arguments.length?(this.r=0,this.g=0,this.b=0,this.a=1):(this.r=e,this.g=t,this.b=A,this.a=i)},x3dom.fields.SFColorRGBA.parse=function(e){try{var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);return new x3dom.fields.SFColorRGBA(+t[1],+t[2],+t[3],+t[4])}catch(t){return x3dom.fields.SFColorRGBA.colorParse(e)}},x3dom.fields.SFColorRGBA.copy=function(e){return new x3dom.fields.SFColorRGBA(e.r,e.g,e.b,e.a)},x3dom.fields.SFColorRGBA.prototype.copy=function(){return x3dom.fields.SFColorRGBA.copy(this)},x3dom.fields.SFColorRGBA.prototype.setHSV=x3dom.fields.SFColor.prototype.setHSV,x3dom.fields.SFColorRGBA.prototype.getHSV=x3dom.fields.SFColor.prototype.getHSV,x3dom.fields.SFColorRGBA.prototype.setValues=function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this},x3dom.fields.SFColorRGBA.prototype.equals=function(e,t){return Math.abs(this.r-e.r)<t&&Math.abs(this.g-e.g)<t&&Math.abs(this.b-e.b)<t&&Math.abs(this.a-e.a)<t},x3dom.fields.SFColorRGBA.prototype.toGL=function(){return[this.r,this.g,this.b,this.a]},x3dom.fields.SFColorRGBA.prototype.toString=function(){return this.r+" "+this.g+" "+this.b+" "+this.a},x3dom.fields.SFColorRGBA.prototype.setValueByStr=function(e){try{var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);this.r=+t[1],this.g=+t[2],this.b=+t[3],this.a=+t[4]}catch(t){var A=x3dom.fields.SFColorRGBA.colorParse(e);this.r=A.r,this.g=A.g,this.b=A.b,this.a=A.a}return this},x3dom.fields.SFColorRGBA.prototype.toUint=function(){return(Math.round(255*this.r)<<24|Math.round(255*this.g)<<16|Math.round(255*this.b)<<8|Math.round(255*this.a))>>>0},x3dom.fields.SFColorRGBA.prototype.setFromUint=function(e){return this.r=(e>>24&255)/255,this.g=(e>>16&255)/255,this.b=(e>>8&255)/255,this.a=(e>>0&255)/255,this},x3dom.fields.SFColorRGBA.colorParse=function(e){var t=_colorParse(e);return new x3dom.fields.SFColorRGBA(t.r,t.g,t.b,t.a)},x3dom.fields.SFImage=function(e,t,A,i){if(0!==arguments.length&&i&&i.map){this.width=e,this.height=t,this.comp=A;var o=this.array;i.map((function(e){o.push(e)}),this.array)}else this.width=0,this.height=0,this.comp=0,this.array=[]},x3dom.fields.SFImage.parse=function(e){var t=new x3dom.fields.SFImage;return t.setValueByStr(e),t},x3dom.fields.SFImage.copy=function(e){var t=new x3dom.fields.SFImage;return t.width=e.width,t.height=e.height,t.comp=e.comp,t.setPixels(e.getPixels()),t},x3dom.fields.SFImage.prototype.copy=function(){return x3dom.fields.SFImage.copy(this)},x3dom.fields.SFImage.prototype.setValueByStr=function(e){var t,A,i,o,s,n=e.match(/(\w+)/g),r=n.length;if(this.array=[],!(r>2))return this.width=0,this.height=0,void(this.comp=0);this.width=+n[0],this.height=+n[1],this.comp=+n[2];var a=10;for(t=3;t<r;t++)if(n[t].substr){"x"===n[t].substr(1,1).toLowerCase()&&(a=16);var d=parseInt(n[t],a);1===this.comp?(A=255&d,this.array.push(A)):2===this.comp?(A=d>>8&255,i=255&d,this.array.push(A,i)):3===this.comp?(A=d>>16&255,i=d>>8&255,o=255&d,this.array.push(A,i,o)):4===this.comp&&(A=d>>24&255,i=d>>16&255,o=d>>8&255,s=255&d,this.array.push(A,i,o,s))}},x3dom.fields.SFImage.prototype.setPixel=function(e,t,A){var i=(t*this.width+e)*this.comp;return 1===this.comp&&i<this.array.length?this.array[i]=255*A.r:2===this.comp&&i+1<this.array.length?(this.array[i]=255*A.r,this.array[i+1]=255*A.g):3===this.comp&&i+2<this.array.length?(this.array[i]=255*A.r,this.array[i+1]=255*A.g,this.array[i+2]=255*A.b):4===this.comp&&i+3<this.array.length&&(this.array[i]=255*A.r,this.array[i+1]=255*A.g,this.array[i+2]=255*A.b,this.array[i+3]=255*A.a),this},x3dom.fields.SFImage.prototype.getPixel=function(e,t){var A=(t*this.width+e)*this.comp;if(1===this.comp&&A<this.array.length){var i=this.array[A]/255;return new x3dom.fields.SFColorRGBA(i,i,i,1)}if(2===this.comp&&A+1<this.array.length){i=this.array[A]/255;var o=this.array[A+1]/255;return new x3dom.fields.SFColorRGBA(i,i,i,o)}return 3===this.comp&&A+2<this.array.length?new x3dom.fields.SFColorRGBA(this.array[A]/255,this.array[A+1]/255,this.array[A+2]/255,1):4===this.comp&&A+3<this.array.length?new x3dom.fields.SFColorRGBA(this.array[A]/255,this.array[A+1]/255,this.array[A+2]/255,this.array[A+3]/255):void 0},x3dom.fields.SFImage.prototype.setPixels=function(e){var t,A=0;if(1===this.comp)for(t=0;t<e.length;t++)this.array[A++]=255*e[t].r;else if(2===this.comp)for(t=0;t<e.length;t++)this.array[A++]=255*e[t].r,this.array[A++]=255*e[t].g;else if(3===this.comp)for(t=0;t<e.length;t++)this.array[A++]=255*e[t].r,this.array[A++]=255*e[t].g,this.array[A++]=255*e[t].b;else if(4===this.comp)for(t=0;t<e.length;t++)this.array[A++]=255*e[t].r,this.array[A++]=255*e[t].g,this.array[A++]=255*e[t].b,this.array[A++]=255*e[t].a},x3dom.fields.SFImage.prototype.getPixels=function(){var e,t=[];if(1===this.comp)for(e=0;e<this.array.length;e+=this.comp){var A=this.array[e]/255;t.push(new x3dom.fields.SFColorRGBA(A,A,A,1))}else if(2===this.comp)for(e=0;e<this.array.length;e+=this.comp){A=this.array[e]/255;var i=this.array[e+1]/255;t.push(new x3dom.fields.SFColorRGBA(A,A,A,i))}else if(3===this.comp)for(e=0;e<this.array.length;e+=this.comp)t.push(new x3dom.fields.SFColorRGBA(this.array[e]/255,this.array[e+1]/255,this.array[e+2]/255,1));else if(4===this.comp)for(e=0;e<this.array.length;e+=this.comp)t.push(new x3dom.fields.SFColorRGBA(this.array[e]/255,this.array[e+1]/255,this.array[e+2]/255,this.array[e+3]/255));return t},x3dom.fields.SFImage.prototype.toGL=function(){var e=[];return this.array.map((function(t){e.push(t)})),e},x3dom.fields.MFColor=function(e){if(e){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFColor.copy=function(e){var t=new x3dom.fields.MFColor;return e.map((function(e){t.push(e.copy())}),this),t},x3dom.fields.MFColor.prototype=x3dom.extend([]),x3dom.fields.MFColor.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),A=[],i=0,o=t?t.length:0;i<o;i+=3)A.push(new x3dom.fields.SFColor(+t[i+0],+t[i+1],+t[i+2]));return new x3dom.fields.MFColor(A)},x3dom.fields.MFColor.prototype.copy=function(){return x3dom.fields.MFColor.copy(this)},x3dom.fields.MFColor.prototype.setValueByStr=function(e){this.length=0;for(var t=e.match(/([+\-0-9eE\.]+)/g),A=0,i=t?t.length:0;A<i;A+=3)this.push(new x3dom.fields.SFColor(+t[A+0],+t[A+1],+t[A+2]))},x3dom.fields.MFColor.prototype.toGL=function(){var e=[];return this.map((function(t){e.push(t.r),e.push(t.g),e.push(t.b)})),e},x3dom.fields.MFColorRGBA=function(e){if(e){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFColorRGBA.copy=function(e){var t=new x3dom.fields.MFColorRGBA;return e.map((function(e){t.push(e.copy())}),this),t},x3dom.fields.MFColorRGBA.prototype=x3dom.extend([]),x3dom.fields.MFColorRGBA.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),A=[],i=0,o=t?t.length:0;i<o;i+=4)A.push(new x3dom.fields.SFColorRGBA(+t[i+0],+t[i+1],+t[i+2],+t[i+3]));return new x3dom.fields.MFColorRGBA(A)},x3dom.fields.MFColorRGBA.prototype.copy=function(){return x3dom.fields.MFColorRGBA.copy(this)},x3dom.fields.MFColorRGBA.prototype.setValueByStr=function(e){this.length=0;for(var t=e.match(/([+\-0-9eE\.]+)/g),A=0,i=t?t.length:0;A<i;A+=4)this.push(new x3dom.fields.SFColorRGBA(+t[A+0],+t[A+1],+t[A+2],+t[A+3]))},x3dom.fields.MFColorRGBA.prototype.toGL=function(){var e=[];return this.map((function(t){e.push(t.r),e.push(t.g),e.push(t.b),e.push(t.a)})),e},x3dom.fields.MFRotation=function(e){if(e){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFRotation.prototype=x3dom.extend([]),x3dom.fields.MFRotation.copy=function(e){var t=new x3dom.fields.MFRotation;return e.map((function(e){t.push(e.copy())}),this),t},x3dom.fields.MFRotation.prototype.copy=function(){return x3dom.fields.MFRotation.copy(this)},x3dom.fields.MFRotation.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),A=[],i=0,o=t?t.length:0;i<o;i+=4)A.push(x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(+t[i+0],+t[i+1],+t[i+2]),+t[i+3]));return new x3dom.fields.MFRotation(A)},x3dom.fields.MFRotation.prototype.setValueByStr=function(e){this.length=0;for(var t=e.match(/([+\-0-9eE\.]+)/g),A=0,i=t?t.length:0;A<i;A+=4)this.push(x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(+t[A+0],+t[A+1],+t[A+2]),+t[A+3]))},x3dom.fields.MFRotation.prototype.toGL=function(){var e=[];return this.map((function(t){var A=t.toAxisAngle();e.push(A[0].x),e.push(A[0].y),e.push(A[0].z),e.push(A[1])})),e},x3dom.fields.MFVec3f=function(e){if(e){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFVec3f.prototype=x3dom.extend(Array),x3dom.fields.MFVec3f.copy=function(e){var t=new x3dom.fields.MFVec3f;return e.map((function(e){t.push(e.copy())}),this),t},x3dom.fields.MFVec3f.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),A=[],i=0,o=t?t.length:0;i<o;i+=3)A.push(new x3dom.fields.SFVec3f(+t[i+0],+t[i+1],+t[i+2]));return new x3dom.fields.MFVec3f(A)},x3dom.fields.MFVec3f.prototype.copy=function(){return x3dom.fields.MFVec3f.copy(this)},x3dom.fields.MFVec3f.prototype.setValueByStr=function(e){this.length=0;for(var t=e.match(/([+\-0-9eE\.]+)/g),A=0,i=t?t.length:0;A<i;A+=3)this.push(new x3dom.fields.SFVec3f(+t[A+0],+t[A+1],+t[A+2]));return this},x3dom.fields.MFVec3f.prototype.setValues=function(e){var t,A=Math.min(e.length,this.length);for(t=0;t<A;t++)this[t].setValues(e[t])},x3dom.fields.MFVec3f.prototype.toGL=function(){var e=[];return this.map((function(t){e.push(t.x),e.push(t.y),e.push(t.z)})),e},x3dom.fields.MFVec3f.prototype.toString=function(){var e="";return this.forEach((function(t){e=e+t.toString()+" "})),e.trim()},x3dom.fields.MFVec2f=function(e){if(e){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFVec2f.prototype=x3dom.extend([]),x3dom.fields.MFVec2f.copy=function(e){var t=new x3dom.fields.MFVec2f;return e.map((function(e){t.push(e.copy())}),this),t},x3dom.fields.MFVec2f.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),A=[],i=0,o=t?t.length:0;i<o;i+=2)A.push(new x3dom.fields.SFVec2f(+t[i+0],+t[i+1]));return new x3dom.fields.MFVec2f(A)},x3dom.fields.MFVec2f.prototype.copy=function(){return x3dom.fields.MFVec2f.copy(this)},x3dom.fields.MFVec2f.prototype.setValueByStr=function(e){this.length=0;for(var t=e.match(/([+\-0-9eE\.]+)/g),A=0,i=t?t.length:0;A<i;A+=2)this.push(new x3dom.fields.SFVec2f(+t[A+0],+t[A+1]))},x3dom.fields.MFVec2f.prototype.toGL=function(){var e=[];return this.map((function(t){e.push(t.x),e.push(t.y)})),e},x3dom.fields.MFInt32=function(e){if(e){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFInt32.prototype=x3dom.extend([]),x3dom.fields.MFInt32.copy=function(e){var t=new x3dom.fields.MFInt32;return e.map((function(e){t.push(e)}),this),t},x3dom.fields.MFInt32.parse=function(e){for(var t=e.match(/([+\-]?\d+\s*){1},?\s*/g),A=[],i=0,o=t?t.length:0;i<o;++i)A.push(parseInt(t[i],10));return new x3dom.fields.MFInt32(A)},x3dom.fields.MFInt32.prototype.copy=function(){return x3dom.fields.MFInt32.copy(this)},x3dom.fields.MFInt32.prototype.setValueByStr=function(e){this.length=0;for(var t=e.match(/([+\-]?\d+\s*){1},?\s*/g),A=0,i=t?t.length:0;A<i;++A)this.push(parseInt(t[A],10))},x3dom.fields.MFInt32.prototype.toGL=function(){var e=[];return this.map((function(t){e.push(t)})),e},x3dom.fields.MFFloat=function(e){if(e){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFFloat.prototype=x3dom.extend([]),x3dom.fields.MFFloat.copy=function(e){var t=new x3dom.fields.MFFloat;return e.map((function(e){t.push(e)}),this),t},x3dom.fields.MFFloat.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),A=[],i=0,o=t?t.length:0;i<o;i++)A.push(+t[i]);return new x3dom.fields.MFFloat(A)},x3dom.fields.MFFloat.prototype.copy=function(){return x3dom.fields.MFFloat.copy(this)},x3dom.fields.MFFloat.prototype.setValueByStr=function(e){this.length=0;for(var t=e.match(/([+\-0-9eE\.]+)/g),A=0,i=t?t.length:0;A<i;A++)this.push(+t[A])},x3dom.fields.MFFloat.prototype.toGL=function(){var e=[];return this.map((function(t){e.push(t)})),e},x3dom.fields.MFBoolean=function(e){if(e){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFBoolean.prototype=x3dom.extend([]),x3dom.fields.MFBoolean.copy=function(e){var t=new x3dom.fields.MFBoolean;return e.map((function(e){t.push(e)}),this),t},x3dom.fields.MFBoolean.parse=function(e){for(var t=e.match(/(true|false|1|0)/gi),A=[],i=0,o=t?t.length:0;i<o;i++)A.push("1"==t[i]||"true"==t[i].toLowerCase());return new x3dom.fields.MFBoolean(A)},x3dom.fields.MFBoolean.prototype.copy=function(){return x3dom.fields.MFBoolean.copy(this)},x3dom.fields.MFBoolean.prototype.setValueByStr=function(e){this.length=0;for(var t=e.match(/(true|false|1|0)/gi),A=0,i=t?t.length:0;A<i;A++)this.push("1"==t[A]||"true"==t[A].toLowerCase())},x3dom.fields.MFBoolean.prototype.toGL=function(){var e=[];return this.map((function(t){e.push(t?1:0)})),e},x3dom.fields.MFString=function(e){if(e&&e.map){var t=this;e.map((function(e){t.push(e)}),this)}},x3dom.fields.MFString.prototype=x3dom.extend([]),x3dom.fields.MFString.copy=function(e){var t=new x3dom.fields.MFString;return e.map((function(e){t.push(e)}),this),t},x3dom.fields.MFString.parse=function(e){var t=[];if((e=e.trim()).length&&'"'==e[0])for(var A,i=/"((?:[^\\"]|\\\\|\\")*)"/g;A=i.exec(e);){var o=A[1].replace(/\\([\\"])/g,"$1");void 0!==o&&t.push(o)}else t.push(e);return new x3dom.fields.MFString(t)},x3dom.fields.MFString.prototype.copy=function(){return x3dom.fields.MFString.copy(this)},x3dom.fields.MFString.prototype.setValueByStr=function(e){if(this.length=0,e.length&&'"'==e[0])for(var t,A=/"((?:[^\\"]|\\\\|\\")*)"/g;t=A.exec(e);){var i=t[1].replace(/\\([\\"])/,"$1");void 0!==i&&this.push(i)}else this.push(e);return this},x3dom.fields.MFString.prototype.toString=function(){for(var e="",t=0,A=this.length;t<A;t++)e=e+this[t]+" ";return e},x3dom.fields.SFNode=function(e){this.type=e,this.node=null},x3dom.fields.SFNode.prototype.hasLink=function(e){return e?this.node===e:this.node},x3dom.fields.SFNode.prototype.addLink=function(e){return this.node=e,!0},x3dom.fields.SFNode.prototype.rmLink=function(e){return this.node===e&&(this.node=null,!0)},x3dom.fields.MFNode=function(e){this.type=e,this.nodes=[]},x3dom.fields.MFNode.prototype.hasLink=function(e){if(!e)return this.length>0;for(var t=0,A=this.nodes.length;t<A;t++)if(this.nodes[t]===e)return!0;return!1},x3dom.fields.MFNode.prototype.addLink=function(e){return this.nodes.push(e),!0},x3dom.fields.MFNode.prototype.rmLink=function(e){for(var t=0,A=this.nodes.length;t<A;t++)if(this.nodes[t]===e)return this.nodes.splice(t,1),!0;return!1},x3dom.fields.MFNode.prototype.length=function(){return this.nodes.length},x3dom.fields.Line=function(e,t){0===arguments.length&&(this.pos=new x3dom.fields.SFVec3f(0,0,0),this.dir=new x3dom.fields.SFVec3f(0,0,1)),this.pos=x3dom.fields.SFVec3f.copy(e),this.dir=x3dom.fields.SFVec3f.copy(t)},x3dom.fields.Line.prototype.closestPoint=function(e){var t=e.subtract(this.pos).dot(this.dir);return this.pos.add(this.dir.multiply(t))},x3dom.fields.Line.prototype.shortestDistance=function(e){var t=e.subtract(this.pos),A=t.dot(this.dir);return t.subtract(this.dir.multiply(A)).length()},x3dom.fields.Ray=function(e,t){if(0===arguments.length)this.pos=new x3dom.fields.SFVec3f(0,0,0),this.dir=new x3dom.fields.SFVec3f(0,0,1);else{this.pos=new x3dom.fields.SFVec3f(e.x,e.y,e.z);var A=t.length();A&&(A=1/A),this.dir=new x3dom.fields.SFVec3f(t.x*A,t.y*A,t.z*A)}this.enter=0,this.exit=0,this.hitObject=null,this.hitPoint={},this.dist=Number.MAX_VALUE},x3dom.fields.Ray.prototype.toString=function(){return"Ray: ["+this.pos.toString()+"; "+this.dir.toString()+"]"},x3dom.fields.Ray.prototype.intersectPlane=function(e,t){var A,i=null,o=t.dot(this.dir);return o<0&&(A=(e.dot(t)-this.pos.dot(t))/o,i=this.pos.addScaled(this.dir,A)),i},x3dom.fields.Ray.prototype.intersect=function(e,t){var A,i,o,s=0,n=Number.MAX_VALUE;if(this.dir.x>x3dom.fields.Eps)A=1/this.dir.x,i=(e.x-this.pos.x)*A,(o=(t.x-this.pos.x)*A)<n&&(n=o),i>s&&(s=i);else if(this.dir.x<-x3dom.fields.Eps)A=1/this.dir.x,i=(t.x-this.pos.x)*A,(o=(e.x-this.pos.x)*A)<n&&(n=o),i>s&&(s=i);else if(this.pos.x<e.x||this.pos.x>t.x)return!1;if(this.dir.y>x3dom.fields.Eps){if(A=1/this.dir.y,i=(e.y-this.pos.y)*A,(o=(t.y-this.pos.y)*A)<n&&(n=o),i>s&&(s=i),s-n>=x3dom.fields.Eps)return!1}else if(this.dir.y<-x3dom.fields.Eps){if(A=1/this.dir.y,i=(t.y-this.pos.y)*A,(o=(e.y-this.pos.y)*A)<n&&(n=o),i>s&&(s=i),s-n>=x3dom.fields.Eps)return!1}else if(this.pos.y<e.y||this.pos.y>t.y)return!1;if(this.dir.z>x3dom.fields.Eps)A=1/this.dir.z,i=(e.z-this.pos.z)*A,(o=(t.z-this.pos.z)*A)<n&&(n=o),i>s&&(s=i);else if(this.dir.z<-x3dom.fields.Eps)A=1/this.dir.z,i=(t.z-this.pos.z)*A,(o=(e.z-this.pos.z)*A)<n&&(n=o),i>s&&(s=i);else if(this.pos.z<e.z||this.pos.z>t.z)return!1;return this.enter=s,this.exit=n,s-n<x3dom.fields.Eps},x3dom.fields.BoxVolume=function(e,t){arguments.length<2?(this.min=new x3dom.fields.SFVec3f(0,0,0),this.max=new x3dom.fields.SFVec3f(0,0,0),this.valid=!1):(this.min=x3dom.fields.SFVec3f.copy(e),this.max=x3dom.fields.SFVec3f.copy(t),this.valid=!0),this.updateInternals()},x3dom.fields.BoxVolume.prototype.getScalarValue=function(){var e=this.max.subtract(this.min);return e.x*e.y*e.z},x3dom.fields.BoxVolume.copy=function(e){var t=new x3dom.fields.BoxVolume(e.min,e.max);return t.valid=e.valid,t},x3dom.fields.BoxVolume.prototype.equals=function(e){return this.min.equals(e.min,1e-12)&&this.max.equals(e.max,1e-12)},x3dom.fields.BoxVolume.prototype.updateInternals=function(){this.radialVec=this.max.subtract(this.min).multiply(.5),this.center=this.min.add(this.radialVec),this.diameter=2*this.radialVec.length()},x3dom.fields.BoxVolume.prototype.setBounds=function(e,t){this.min.setValues(e),this.max.setValues(t),this.updateInternals(),this.valid=!0},x3dom.fields.BoxVolume.prototype.setBoundsByCenterSize=function(e,t){var A=t.multiply(.5);this.min=e.subtract(A),this.max=e.add(A),this.updateInternals(),this.valid=!0},x3dom.fields.BoxVolume.prototype.extendBounds=function(e,t){this.valid?(this.min.x>e.x&&(this.min.x=e.x),this.min.y>e.y&&(this.min.y=e.y),this.min.z>e.z&&(this.min.z=e.z),this.max.x<t.x&&(this.max.x=t.x),this.max.y<t.y&&(this.max.y=t.y),this.max.z<t.z&&(this.max.z=t.z),this.updateInternals()):this.setBounds(e,t)},x3dom.fields.BoxVolume.prototype.getBounds=function(e,t){e.setValues(this.min),t.setValues(this.max)},x3dom.fields.BoxVolume.prototype.getRadialVec=function(){return this.radialVec},x3dom.fields.BoxVolume.prototype.invalidate=function(){this.valid=!1,this.min=new x3dom.fields.SFVec3f(0,0,0),this.max=new x3dom.fields.SFVec3f(0,0,0),this.updateInternals()},x3dom.fields.BoxVolume.prototype.isValid=function(){return this.valid},x3dom.fields.BoxVolume.prototype.getCenter=function(){return this.center},x3dom.fields.BoxVolume.prototype.getDiameter=function(){return this.diameter},x3dom.fields.BoxVolume.prototype.transform=function(e){var t,A,i,o,s,n;t=o=e._03,A=s=e._13,i=n=e._23;var r=this.max.x*e._00,a=this.min.x*e._00;r>=a?(o+=r,t+=a):(o+=a,t+=r),(r=this.max.y*e._01)>=(a=this.min.y*e._01)?(o+=r,t+=a):(o+=a,t+=r),(r=this.max.z*e._02)>=(a=this.min.z*e._02)?(o+=r,t+=a):(o+=a,t+=r),(r=this.max.x*e._10)>=(a=this.min.x*e._10)?(s+=r,A+=a):(s+=a,A+=r),(r=this.max.y*e._11)>=(a=this.min.y*e._11)?(s+=r,A+=a):(s+=a,A+=r),(r=this.max.z*e._12)>=(a=this.min.z*e._12)?(s+=r,A+=a):(s+=a,A+=r),(r=this.max.x*e._20)>=(a=this.min.x*e._20)?(n+=r,i+=a):(n+=a,i+=r),(r=this.max.y*e._21)>=(a=this.min.y*e._21)?(n+=r,i+=a):(n+=a,i+=r),(r=this.max.z*e._22)>=(a=this.min.z*e._22)?(n+=r,i+=a):(n+=a,i+=r),this.min.x=t,this.min.y=A,this.min.z=i,this.max.x=o,this.max.y=s,this.max.z=n,this.updateInternals()},x3dom.fields.BoxVolume.prototype.transformFrom=function(e,t){var A,i,o,s,n,r;A=s=e._03,i=n=e._13,o=r=e._23;var a=t.max.x*e._00,d=t.min.x*e._00;a>=d?(s+=a,A+=d):(s+=d,A+=a),(a=t.max.y*e._01)>=(d=t.min.y*e._01)?(s+=a,A+=d):(s+=d,A+=a),(a=t.max.z*e._02)>=(d=t.min.z*e._02)?(s+=a,A+=d):(s+=d,A+=a),(a=t.max.x*e._10)>=(d=t.min.x*e._10)?(n+=a,i+=d):(n+=d,i+=a),(a=t.max.y*e._11)>=(d=t.min.y*e._11)?(n+=a,i+=d):(n+=d,i+=a),(a=t.max.z*e._12)>=(d=t.min.z*e._12)?(n+=a,i+=d):(n+=d,i+=a),(a=t.max.x*e._20)>=(d=t.min.x*e._20)?(r+=a,o+=d):(r+=d,o+=a),(a=t.max.y*e._21)>=(d=t.min.y*e._21)?(r+=a,o+=d):(r+=d,o+=a),(a=t.max.z*e._22)>=(d=t.min.z*e._22)?(r+=a,o+=d):(r+=d,o+=a),this.min.x=A,this.min.y=i,this.min.z=o,this.max.x=s,this.max.y=n,this.max.z=r,this.updateInternals(),this.valid=!0},x3dom.fields.FrustumVolume=function(e){if(this.planeNormals=[],this.planeDistances=[],this.directionIndex=[],0!==arguments.length){for(var t=[],A=0;A<6;A++)this.planeNormals[A]=new x3dom.fields.SFVec3f(0,0,0),this.planeDistances[A]=0,this.directionIndex[A]=0,t[A]=new x3dom.fields.SFVec4f(0,0,0,0);for(t[0].x=e._30-e._00,t[0].y=e._31-e._01,t[0].z=e._32-e._02,t[0].w=e._33-e._03,t[1].x=e._30+e._00,t[1].y=e._31+e._01,t[1].z=e._32+e._02,t[1].w=e._33+e._03,t[2].x=e._30+e._10,t[2].y=e._31+e._11,t[2].z=e._32+e._12,t[2].w=e._33+e._13,t[3].x=e._30-e._10,t[3].y=e._31-e._11,t[3].z=e._32-e._12,t[3].w=e._33-e._13,t[4].x=e._30+e._20,t[4].y=e._31+e._21,t[4].z=e._32+e._22,t[4].w=e._33+e._23,t[5].x=e._30-e._20,t[5].y=e._31-e._21,t[5].z=e._32-e._22,t[5].w=e._33-e._23,A=0;A<6;A++){var i=Math.sqrt(t[A].x*t[A].x+t[A].y*t[A].y+t[A].z*t[A].z);t[A].x/=i,t[A].y/=i,t[A].z/=i,t[A].w/=-i}var o=function(e){var t=0;return e.x>0&&(t|=1),e.y>0&&(t|=2),e.z>0&&(t|=4),t};this.planeNormals[3].setValues(t[0]),this.planeDistances[3]=t[0].w,this.directionIndex[3]=o(this.planeNormals[3]),this.planeNormals[2].setValues(t[1]),this.planeDistances[2]=t[1].w,this.directionIndex[2]=o(this.planeNormals[2]),this.planeNormals[5].setValues(t[2]),this.planeDistances[5]=t[2].w,this.directionIndex[5]=o(this.planeNormals[5]),this.planeNormals[4].setValues(t[3]),this.planeDistances[4]=t[3].w,this.directionIndex[4]=o(this.planeNormals[4]),this.planeNormals[0].setValues(t[4]),this.planeDistances[0]=t[4].w,this.directionIndex[0]=o(this.planeNormals[0]),this.planeNormals[1].setValues(t[5]),this.planeDistances[1]=t[5].w,this.directionIndex[1]=o(this.planeNormals[1])}},x3dom.fields.FrustumVolume.prototype.intersect=function(e,t){if(this.planeNormals.length<6)return x3dom.debug.logWarning("FrustumVolume not initialized!"),!1;var A=this,i=e.min,o=e.max,s=function(e){var t=new x3dom.fields.SFVec3f(0,0,0);return t.x=1&e?i.x:o.x,t.y=2&e?i.y:o.y,t.z=4&e?i.z:o.z,t},n=function(e,t){return A.planeNormals[e].dot(t)-A.planeDistances[e]>=0},r=function(e){var t=s(A.directionIndex[e]);return n(e,t)},a=function(e){var t=s(7^A.directionIndex[e]);return!n(e,t)},d=1;t<0&&(t=0);for(var h=0;h<6;h++,d<<=1)if(0==(t&d)){if(a(h))return-1;r(h)&&(t|=d)}return t},x3dom.BindableStack=function(e,t,A,i){this._doc=e,this._type=t,this._defaultType=A,this._defaultRoot=null,this._getter=i,this._bindBag=[],this._bindStack=[]},x3dom.BindableStack.prototype.top=function(){return this._bindStack.length>0?this._bindStack[this._bindStack.length-1]:null},x3dom.BindableStack.prototype.push=function(e){var t=this.top();t!==e&&(t&&t.deactivate(),this._bindStack.push(e),e.activate(t))},x3dom.BindableStack.prototype.replaceTop=function(e){var t=this.top();t!==e&&t&&(t.deactivate(),this._bindStack[this._bindStack.length-1]=e,e.activate(t))},x3dom.BindableStack.prototype.pop=function(e){var t;return e&&e!==(t=this.top())?null:((t=this._bindStack.pop())&&t.deactivate(),t)},x3dom.BindableStack.prototype.switchTo=function(e){var t=this.getActive(),A=this._bindBag.length,i=0,o=0,s=-1;if(!(A<=1)){switch(e){case"first":i=this._bindBag[0];break;case"last":i=this._bindBag[A-1];break;default:for(o=0;o<A;o++)if(this._bindBag[o]==t){s=o;break}if(s>=0)for(o=s;!i&&(o="next"==e?o<A-1?o+1:0:o>0?o-1:A-1)!=s;)this._bindBag[o]._vf.description.length>=0&&(i=this._bindBag[o])}i?this.replaceTop(i):x3dom.debug.logWarning("Cannot switch bindable; no other bindable with description found.")}},x3dom.BindableStack.prototype.getActive=function(){if(0===this._bindStack.length){if(0===this._bindBag.length)if(this._defaultRoot){x3dom.debug.logInfo("create new "+this._defaultType._typeName+" for "+this._type._typeName+"-stack");var e=new this._defaultType({doc:this._doc,nameSpace:this._defaultRoot._nameSpace,autoGen:!0});this._defaultRoot.addChild(e),e.nodeChanged()}else x3dom.debug.logError("stack without defaultRoot");else x3dom.debug.logInfo("activate first "+this._type._typeName+" for "+this._type._typeName+"-stack");this._bindStack.push(this._bindBag[0]),this._bindBag[0].activate()}var t=this._bindStack[this._bindStack.length-1];return null==t._nameSpace&&(this.pop(),t=this.getActive()),t},x3dom.BindableBag=function(e){this._stacks=[],this.addType("X3DViewpointNode","Viewpoint","getViewpoint",e),this.addType("X3DNavigationInfoNode","NavigationInfo","getNavigationInfo",e),this.addType("X3DBackgroundNode","Background","getBackground",e),this.addType("X3DFogNode","Fog","getFog",e),this.addType("X3DEnvironmentNode","Environment","getEnvironment",e)},x3dom.BindableBag.prototype.addType=function(e,t,A,i){var o=x3dom.nodeTypes[e],s=x3dom.nodeTypes[t];if(o&&s){var n=new x3dom.BindableStack(i,o,s,A);this._stacks.push(n)}else x3dom.debug.logWarning("Invalid Bindable type/defaultType: "+e+"/"+s)},x3dom.BindableBag.prototype.setRefNode=function(e){this._stacks.forEach((function(t){t._defaultRoot=e,e[t._getter]=function(){return t.getActive()}}))},x3dom.BindableBag.prototype.addBindable=function(e){for(var t=0,A=this._stacks.length;t<A;t++){var i=this._stacks[t];if(x3dom.isa(e,i._type)){x3dom.debug.logInfo("register "+e.typeName()+"Bindable "+e._DEF+"/"+e._vf.description),i._bindBag.push(e);var o=i.top();if(o&&o._autoGen){i.replaceTop(e);for(var s=0,n=i._bindBag.length;s<n;s++)if(i._bindBag[s]===o){i._bindBag.splice(s,1);break}i._defaultRoot.removeChild(o)}return i}}return x3dom.debug.logError(e.typeName()+" is not a valid bindable"),null},x3dom.NodeNameSpace=function(e,t){this.name=e,this.doc=t,this.baseURL="",this.setBaseURL(t.properties.properties.baseURL),this.defMap={},this.parent=null,this.childSpaces=[],this.protos=[],this.lateRoutes=[],this.imports=new Map,this.exports=new Map,this.superInlineNode=null},x3dom.NodeNameSpace.prototype.addNode=function(e,t){this.defMap[t]=e,e._nameSpace||(e._nameSpace=this)},x3dom.NodeNameSpace.prototype.removeNode=function(e){var t=e?this.defMap[e]:null;t&&(delete this.defMap[e],t._nameSpace==this&&(t._nameSpace=null))},x3dom.NodeNameSpace.prototype.getNamedNode=function(e){return this.defMap[e]},x3dom.NodeNameSpace.prototype.getNamedElement=function(e){var t=this.defMap[e];return t?t._xmlNode:null},x3dom.NodeNameSpace.prototype.addSpace=function(e){this.childSpaces.push(e),e.parent=this},x3dom.NodeNameSpace.prototype.removeSpace=function(e){e.parent=null;for(var t=0;t<this.childSpaces.length;t++)this.childSpaces[t]==e&&this.childSpaces.splice(t,1)},x3dom.NodeNameSpace.prototype.setBaseURL=function(e){var t=e.lastIndexOf("/");this.baseURL=t>=0?e.substr(0,t+1):"",x3dom.debug.logInfo("setBaseURL: "+this.baseURL)},x3dom.NodeNameSpace.prototype.getURL=function(e){return void 0!==e&&e.length?"/"===e[0]||e.indexOf(":")>=0?e:this.baseURL+e:""},x3dom.hasElementAttribute=function(e){var t=this.__hasAttribute(e);return!t&&e&&(t=this.__hasAttribute(e.toLowerCase())),t},x3dom.getElementAttribute=function(e){var t=this.__getAttribute(e);return!t&&""!=t&&e&&(t=this.__getAttribute(e.toLowerCase())),null==t&&this._x3domNode?this._x3domNode._vf[e]:t},x3dom.setElementAttribute=function(e,t){this.__setAttribute(e,t);var A=this._x3domNode;A&&(x3dom.userAgentFeature.supportsMutationObserver||A.updateField(e,t),A._nameSpace.doc.needRender=!0)},x3dom.getFieldValue=function(e){var t=this._x3domNode;if(t&&void 0!==t._vf[e]){var A=t._vf[e];return A instanceof Object&&"copy"in A?t._vf[e].copy():t._vf[e]}return null},x3dom.setFieldValue=function(e,t){var A=this._x3domNode;A&&void 0!==A._vf[e]&&A._nameSpace&&(t instanceof Object&&"copy"in t?A._vf[e]=t.copy():A._vf[e]=t,A.fieldChanged(e),A._nameSpace.doc.needRender=!0)},x3dom.requestFieldRef=function(e){var t=this._x3domNode;return t&&t._vf[e]?t._vf[e]:null},x3dom.releaseFieldRef=function(e){var t=this._x3domNode;t&&t._vf[e]&&t._nameSpace&&(t.fieldChanged(e),t._nameSpace.doc.needRender=!0)},x3dom.attachFieldAccess=function(e){e.requestFieldRef=x3dom.requestFieldRef,e.releaseFieldRef=x3dom.releaseFieldRef,e.getFieldValue=x3dom.getFieldValue,e.setFieldValue=x3dom.setFieldValue},x3dom.NodeNameSpace.prototype.setupTree=function(e,t){var A=null;if(t=t||null,x3dom.isX3DElement(e)){if(e._x3domNode)return x3dom.debug.logWarning("Tree is already initialized"),null;if(void 0===e.tagName||e.__addEventListener||e.__removeEventListener||(e.__addEventListener=e.addEventListener,e.addEventListener=function(e,t,A){this._x3domNode._listeners[e]||(this._x3domNode._listeners[e]=[]),this._x3domNode._listeners[e].push(t),this.__addEventListener(e,t,A)},e.__removeEventListener=e.removeEventListener,e.removeEventListener=function(e,t,A){var i=this._x3domNode._listeners[e];if(i)for(var o=0;o<i.length;o++)i[o]==t&&(i.splice(o,1),o--);this.__removeEventListener(e,t,A)}),e.hasAttribute("USE")||e.hasAttribute("use")){if(e.hasAttribute("USE")||e.setAttribute("USE",e.getAttribute("use")),!(A=this.defMap[e.getAttribute("USE")])){var i=e.getAttribute("USE").split("__");if(i.length>=2){for(var o=this;o;)o.name==i[0]&&(A=o.defMap[i[1]]),o=A?null:o.parent;A||(A=null,x3dom.debug.logWarning("Could not USE: "+e.getAttribute("USE")))}}return A&&(e._x3domNode=A,x3dom.attachFieldAccess(e)),A}if("route"===e.localName.toLowerCase()){var s=e,n=s.getAttribute("fromNode")||s.getAttribute("fromnode"),r=s.getAttribute("toNode")||s.getAttribute("tonode"),a=this.defMap[n],d=this.defMap[r],h=s.getAttribute("fromField")||s.getAttribute("fromfield"),g=s.getAttribute("toField")||s.getAttribute("tofield");return a&&d?(a.setupRoute(h,d,g),s._nodeNameSpace=this):(x3dom.debug.logWarning("not yet available route - can't find all DEFs for "+h+" -> "+g),this.lateRoutes.push({route:s,fnDEF:n,tnDEF:r,fnAtt:h,tnAtt:g})),null}if("import"===e.localName.toLowerCase()){var l=e.getAttribute("inlineDEF")||e.getAttribute("inlinedef"),I=e.getAttribute("importedDEF")||e.getAttribute("importeddef"),c=e.getAttribute("AS")||e.getAttribute("as");if(!l||!I)return null;if(c||(c=I),this.imports.get(l)||this.imports.set(l,new Map),this.imports.get(l).set(c,I),e._nodeNameSpace=this,this.defMap[l]&&this.defMap[l]._childNodes[0]&&this.defMap[l]._childNodes[0]._nameSpace){var f=this.defMap[l]._childNodes[0]._nameSpace;if(C=f.exports.get(I)){var u=f.defMap[C];u&&(this.defMap[c]=u,this.routeLateRoutes())}}return null}if("export"===e.localName.toLowerCase()){var C=e.getAttribute("localDEF")||e.getAttribute("localdef");c=e.getAttribute("AS")||e.getAttribute("as");return C?(c||(c=C),this.exports.set(c,C),e._nodeNameSpace=this,this.superInlineNode&&this.superInlineNode._nameSpace&&this.superInlineNode._nameSpace.importNodes(this),null):null}x3dom.attachFieldAccess(e);var _=x3dom.nodeTypesLC[e.localName.toLowerCase()];if(void 0!==_){!1===x3dom.userAgentFeature.supportsDOMAttrModified&&e instanceof Element&&(e.setAttribute&&!e.__setAttribute&&(e.__setAttribute=e.setAttribute,e.setAttribute=x3dom.setElementAttribute),e.getAttribute&&!e.__getAttribute&&(e.__getAttribute=e.getAttribute,e.getAttribute=x3dom.getElementAttribute),e.hasAttribute&&!e.__hasAttribute&&(e.__hasAttribute=e.hasAttribute,e.hasAttribute=x3dom.hasElementAttribute));var m={doc:this.doc,runtime:this.doc._x3dElem.runtime,xmlNode:e,nameSpace:this};return A=new _(m),e.hasAttribute("DEF")?(A._DEF=e.getAttribute("DEF"),this.defMap[A._DEF]=A):e.hasAttribute("id")&&(A._DEF=e.getAttribute("id"),A._DEF in this.defMap||(this.defMap[A._DEF]=A)),void 0===e.highlight&&(e.highlight=function(e,t){var A=x3dom.fields.SFColor.parse(t);this._x3domNode.highlight(e,A),this._x3domNode._nameSpace.doc.needRender=!0}),A._xmlNode=e,e._x3domNode=A,e.querySelectorAll(":scope > *").forEach((function(t){var A=t.localName.toLowerCase();"protodeclare"==A?this.protoDeclare(t):"externprotodeclare"==A?this.externProtoDeclare(t):"protoinstance"==A&&this.protoInstance(t,e)}),this),e.childNodes.forEach((function(e){var t=this.setupTree(e,A);t&&A.addChild(t,e.getAttribute("containerField"))}),this),A.nodeChanged(),A}x3dom.debug.logWarning("Unrecognised X3D element &lt;"+e.localName+"&gt;.")}else if(e.localName){var p=e.localName.toLowerCase(),E=this.protos.find((function(e){return p==e.name.toLowerCase()&&e.isExternProto}));t&&"x3dommetagroup"==p?e.childNodes.forEach(function(e){var A=this.setupTree(e,t);A&&t.addChild(A,e.getAttribute("containerField"))}.bind(this)):"protodeclare"==p||"externprotodeclare"==p||"protoinstance"==p?A=null:"is"==e.localName.toLowerCase()?0==e.querySelectorAll("connect").length&&x3dom.debug.logWarning("IS statement without connect link: "+e.parentElement.localName):E?this.loadExternProtoAsync(E,e,e,e.parentElement):(x3dom.debug.logWarning("Unrecognised X3D element &lt;"+e.localName+"&gt;."),A=null)}return A},x3dom.NodeNameSpace.prototype.importNodes=function(e){if(e&&e.superInlineNode&&e.superInlineNode._nameSpace==this){var t=this,A=e.superInlineNode._DEF,i=t.imports,o=e.exports,s=0;A&&i.get(A)&&(i.get(A).forEach((function(A,i){var n=o.get(A);if(n){var r=e.defMap[n];r&&(t.defMap[i]=r,s++)}})),s>0&&t.routeLateRoutes())}},x3dom.NodeNameSpace.prototype.routeLateRoutes=function(){var e=this;e.lateRoutes.forEach((function(t){var A=e.defMap[t.fnDEF],i=e.defMap[t.tnDEF];A&&i&&(x3dom.debug.logInfo("fixed ROUTE: from="+A._DEF+", to="+i._DEF),A.setupRoute(t.fnAtt,i,t.tnAtt),t.route._nodeNameSpace=e)}))},x3dom.NodeNameSpace.prototype.protoInstance=function(e,t){if(e.localName&&!e._x3dom){var A=e.getAttribute("name");if(e.hasAttribute("USE")){var i=e.getAttribute("USE"),o=this.defMap[i];A=o?o.constructor._typeName:t.getRootNode().querySelector("[DEF="+i+"]").getAttribute("name")}var s=this.protos.find((function(e){return e.name==A}));if(null!=s){var n=document.createElement(A);if(e.hasAttribute("DEF")?n.setAttribute("DEF",e.getAttribute("DEF")):e.hasAttribute("USE")&&n.setAttribute("USE",e.getAttribute("USE")),e.hasAttribute("containerField")&&n.setAttribute("containerField",e.getAttribute("containerField")),e.querySelectorAll(":scope > fieldValue , :scope > fieldvalue").forEach((function(e){var t=e.getAttribute("name"),A=e.querySelectorAll(":scope > *");if(A.length>0)A.forEach((function(e){e.setAttribute("containerField",t),n.appendChild(e)}));else{var i=e.getAttribute("value");i&&n.setAttribute(t,i)}})),s.isExternProto&&s.needsLoading)this.loadExternProtoAsync(s,n,e,t);else{this.doc.mutationObserver.disconnect(),e.insertAdjacentElement("afterend",n);var r=this.doc._x3dElem;this.doc._scene&&(r=this.doc._scene._xmlNode),this.doc.mutationObserver.observe(r,{attributes:!0,attributeOldValue:!0,childList:!0,subtree:!0}),e._x3dom=n}}else x3dom.debug.logWarning("ProtoInstance without a ProtoDeclaration "+A)}},x3dom.NodeNameSpace.prototype.loadExternProtoAsync=function(e,t,A,i){e.instanceQueue.push({protoInstanceDom:t,domNode:A,parentDom:i,targetChildIndex:i._x3domNode._childNodes.length+e.instanceQueue.length}),A._x3dom=t;var o=this,s=0;!function t(){var A=o.getURL(e.url[s]);o.doc.incrementDownloads(),fetch(A).then((function(e){if(!e.ok)throw new Error("Network response was not OK: "+e.status);return e.text()})).then((function(t){var i=new DOMParser,s=i.parseFromString(t,"application/xml"),n=s.querySelector("X3D");null==n&&(n=(s=i.parseFromString(t,"text/html")).querySelector("X3D"));var r=A.includes("#")?A.split("#").slice(-1)[0]:"",a=""==r?"ProtoDeclare":"ProtoDeclare[name='"+r+"']",d=n.querySelector(a);d.setAttribute("name",e.name),o.confNameSpace=new x3dom.NodeNameSpace(e.name,o.doc),o.confNameSpace.setBaseURL(o.baseURL+e.name),o.confNameSpace.setupTree(n.querySelector("Scene"),n),o.confNameSpace.protos.forEach((function(e){o.protos.push(e)}));var h,g=o.protos.findIndex((function(t){return t==e}));for(o.protos.splice(g,1),o.protoDeclare(d);h=e.instanceQueue.shift();){var l=h.parentDom,I=l._x3domNode,c=h.protoInstanceDom,f=h.targetChildIndex;o.doc.mutationObserver.disconnect(),h.domNode!==c&&h.domNode.insertAdjacentElement("afterend",c),o.doc.mutationObserver.observe(o.doc._scene._xmlNode,{attributes:!0,attributeOldValue:!0,childList:!0,subtree:!0}),o.doc.onNodeAdded(c,l);var u=I._childNodes,C=u.length-1;if(f!==C){var _=u[f],m=u[C];u[f]=m,u[C]=_;var p=(E=l.getAttribute("containerField"))in I._cf&&I._cf[E];if(!p)for(var E in I._cf){var B=I._cf[E];if(x3dom.isa(m,B.type)){p=B;break}}p[f]=m,p[C]=_}o.lateRoutes.forEach((function(e){var t=o.defMap[e.fnDEF],A=o.defMap[e.tnDEF];t&&A&&(x3dom.debug.logInfo("fixed ROUTE: from="+t._DEF+", to="+A._DEF),t.setupRoute(e.fnAtt,A,e.tnAtt),e.route._nodeNameSpace=o)})),o.superInlineNode&&o.superInlineNode._nameSpace&&o.superInlineNode._nameSpace.importNodes(o)}e.needsLoading=!1,o.doc.decrementDownloads()})).catch((function(i){if(x3dom.debug.logWarning(A+": ExternProto fetch failed: "+i),o.doc.decrementDownloads(),!(++s<e.url.length))return x3dom.debug.logError("ExternProto fetch failed for all urls."),e.needsLoading=!1,null;t()}))}()},x3dom.NodeNameSpace.prototype.externProtoDeclare=function(e){var t=e.getAttribute("name"),A=x3dom.fields.MFString.parse(e.getAttribute("url")),i=new x3dom.ProtoDeclaration(this,t,null,null,!0,A);this.protos.push(i)},x3dom.NodeNameSpace.prototype.protoDeclare=function(e){var t=e.getAttribute("name"),A=e.querySelector("ProtoInterface"),i=[];A&&A.querySelectorAll("field").forEach((function(e){i.push({name:e.getAttribute("name"),accessType:e.getAttribute("accessType"),dataType:e.getAttribute("type"),value:e.getAttribute("value"),cfValue:e.querySelectorAll(":scope > *")})}));var o=e.querySelector("ProtoBody");if(o){o._ISRoutes={},o.querySelectorAll("IS").forEach((function(e){for(var t=e.parentElement;"protobody"!==t.localName.toLowerCase();)t=t.parentElement;t===o&&e.querySelectorAll("connect").forEach((function(t){var A=e.parentElement;if(0==A.hasAttribute("DEF")){var i="_proto_"+A.tagName+"_"+x3dom.protoISDEFuid++;A.setAttribute("DEF",i),"protoinstance"==A.localName.toLowerCase()&&A._x3domNode&&(A._x3domNode._DEF=i,A._x3domNode.typeNode._nameSpace.defMap[i]=A._x3domNode)}var s=t.getAttribute("protoField"),n=A.getAttribute("DEF"),r=t.getAttribute("nodeField");o._ISRoutes[s]||(o._ISRoutes[s]=[]),o._ISRoutes[s].push({nodeDEF:n,nodeField:r})}))}));var s=new x3dom.ProtoDeclaration(this,t,o,i);s.registerNode(),this.protos.push(s)}else x3dom.debug.logWarning("ProtoDeclare without a ProtoBody definition: "+e.name);return"ProtoDeclare"},x3dom.protoISDEFuid=0,x3dom.gfx_webgl=function(){"use strict";function e(e,t,A,i){this.ctx3d=e,this.canvas=t,this.name=A,this.x3dElem=i,this.IG_PositionBuffer=null,this.cache=new x3dom.Cache,this.stateManager=new x3dom.StateManager(e),this.VRMode=1,this.BUFFER_IDX={INDEX:0,POSITION:1,NORMAL:2,TEXCOORD:3,TEXCOORD_0:3,COLOR:4,TANGENT:6,BITANGENT:7,TEXCOORD_1:8,ID:9}}return e.prototype.getName=function(){return this.name},e.prototype.setupShape=function(e,t,A){var i,o,s,n,r,a,d,h,g,l,I,c,f=0,u=t.shape,C=u._cf.geometry.node;if(void 0!==u._webgl){var _=!1;if(!0===u._dirty.colors&&void 0===u._webgl.shader.color&&C._mesh._colors[0].length&&(_=!0),_&&u._cleanupGLObjects&&u._cleanupGLObjects(!0,!1),!0===u._dirty.texture){if(u._webgl.texture.length!=u.getTextures().length){for(s=0;s<u._webgl.texture.length;++s)u._webgl.texture.pop();for(o=u.getTextures(),s=0;s<o.length;++s)u._webgl.texture.push(new x3dom.Texture(e,u._nameSpace.doc,this.cache,o[s]));u._dirty.shader=!0,void 0===u._webgl.shader.texcoord&&(u._dirty.texcoords=!0)}else for(o=u.getTextures(),s=0;s<o.length;++s)o[s]===u._webgl.texture[s].node?u._webgl.texture[s].update():(u._webgl.texture[s].texture=null,u._webgl.texture[s].node=o[s],u._webgl.texture[s].update());u._dirty.texture=!1}if(u._webgl.shader=this.cache.getShaderByProperties(e,u,u.getShaderProperties(A)),!_&&0==u._webgl.binaryGeometry&&0==u._webgl.bufferGeometry)for(f=0;f<u._webgl.positions.length;f++)if(i=6*f,1!=u._dirty.positions&&1!=u._dirty.indexes||(void 0!==u._webgl.shader.position&&(u._webgl.indexes[f]=C._mesh._indices[f],e.deleteBuffer(u._webgl.buffers[i+x3dom.BUFFER_IDX.INDEX]),g=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.INDEX]=g,x3dom.caps.INDEX_UINT&&C._mesh._positions[0].length/3>65535?(l=new Uint32Array(u._webgl.indexes[f]),u._webgl.indexType=e.UNSIGNED_INT):(l=new Uint16Array(u._webgl.indexes[f]),u._webgl.indexType=e.UNSIGNED_SHORT),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,g),e.bufferData(e.ELEMENT_ARRAY_BUFFER,l,e.STATIC_DRAW),l=null,u._webgl.positions[f]=C._mesh._positions[f],e.deleteBuffer(u._webgl.buffers[i+x3dom.BUFFER_IDX.POSITION]),r=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.POSITION]=r,e.bindBuffer(e.ARRAY_BUFFER,r),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u._webgl.buffers[i+x3dom.BUFFER_IDX.INDEX]),n=new Float32Array(u._webgl.positions[f]),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(u._webgl.shader.position,C._mesh._numPosComponents,u._webgl.coordType,!1,u._coordStrideOffset[0],u._coordStrideOffset[1]),n=null),u._dirty.positions=!1,u._dirty.indexes=!1),1==u._dirty.colors&&(void 0!==u._webgl.shader.color&&(u._webgl.colors[f]=C._mesh._colors[f],e.deleteBuffer(u._webgl.buffers[i+x3dom.BUFFER_IDX.COLOR]),c=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.COLOR]=c,y=new Float32Array(u._webgl.colors[f]),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,y,e.STATIC_DRAW),e.vertexAttribPointer(u._webgl.shader.color,C._mesh._numColComponents,u._webgl.colorType,!1,u._colorStrideOffset[0],u._colorStrideOffset[1]),y=null),u._dirty.colors=!1),1==u._dirty.normals&&(void 0!==u._webgl.shader.normal&&(u._webgl.normals[f]=C._mesh._normals[f],e.deleteBuffer(u._webgl.buffers[i+x3dom.BUFFER_IDX.NORMAL]),I=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.NORMAL]=I,Q=new Float32Array(u._webgl.normals[f]),e.bindBuffer(e.ARRAY_BUFFER,I),e.bufferData(e.ARRAY_BUFFER,Q,e.STATIC_DRAW),e.vertexAttribPointer(u._webgl.shader.normal,C._mesh._numNormComponents,u._webgl.normalType,!1,u._normalStrideOffset[0],u._normalStrideOffset[1]),Q=null),u._dirty.normals=!1),1==u._dirty.texcoords&&(void 0!==u._webgl.shader.texcoord&&(u._webgl.texcoords[f]=C._mesh._texCoords[f],e.deleteBuffer(u._webgl.buffers[i+x3dom.BUFFER_IDX.TEXCOORD]),a=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.TEXCOORD]=a,v=new Float32Array(u._webgl.texcoords[f]),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,v,e.STATIC_DRAW),e.vertexAttribPointer(u._webgl.shader.texCoord,C._mesh._numTexComponents,u._webgl.texCoordType,!1,u._texCoordStrideOffset[0],u._texCoordStrideOffset[1]),v=null),u._dirty.texcoords=!1),1==u._dirty.specialAttribs&&void 0!==u._webgl.shader.particleSize){var m=C._vf.size.toGL();m.length&&(e.deleteBuffer(u._webgl.buffers[i+x3dom.BUFFER_IDX.ID]),u._webgl.buffers[i+x3dom.BUFFER_IDX.ID]=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,u._webgl.buffers[i+x3dom.BUFFER_IDX.ID]),e.bufferData(e.ARRAY_BUFFER,new Float32Array(m),e.STATIC_DRAW)),u._dirty.specialAttribs=!1}if(!_)return}else if(!(x3dom.isa(C,x3dom.nodeTypes.Text)||x3dom.isa(C,x3dom.nodeTypes.BinaryGeometry)||x3dom.isa(C,x3dom.nodeTypes.PopGeometry)||x3dom.isa(C,x3dom.nodeTypes.BufferGeometry))&&(!C||C._mesh._positions[0].length<1))return void x3dom.debug.logError("NO VALID MESH OR NO VERTEX POSITIONS SET!");for(u.unsetDirty(),u._cleanupGLObjects||(u._cleanupGLObjects=function(t,A){if(this._webgl&&(arguments.length>0&&t||0==this._parentNodes.length)){for(var i=this._webgl.shader,o=0;o<this._webgl.positions.length;o++){var s=6*o;void 0!==i.position&&(e.deleteBuffer(this._webgl.buffers[s+x3dom.BUFFER_IDX.INDEX]),e.deleteBuffer(this._webgl.buffers[s+x3dom.BUFFER_IDX.POSITION])),void 0!==i.normal&&e.deleteBuffer(this._webgl.buffers[s+x3dom.BUFFER_IDX.NORMAL]),void 0!==i.texcoord&&e.deleteBuffer(this._webgl.buffers[s+x3dom.BUFFER_IDX.TEXCOORD]),void 0!==i.color&&e.deleteBuffer(this._webgl.buffers[s+x3dom.BUFFER_IDX.COLOR]),void 0!==i.id&&e.deleteBuffer(this._webgl.buffers[s+x3dom.BUFFER_IDX.ID]),void 0!==i.tangent&&e.deleteBuffer(this._webgl.buffers[s+x3dom.BUFFER_IDX.TANGENT]),void 0!==i.binormal&&e.deleteBuffer(this._webgl.buffers[s+x3dom.BUFFER_IDX.BITANGENT])}for(var n=0;n<this._webgl.dynamicFields.length;n++){var r=this._webgl.dynamicFields[n];void 0!==i[r.name]&&e.deleteBuffer(r.buf)}void 0===A&&(A=!0),A&&(delete this._webgl,x3dom.BinaryContainerLoader.outOfMemory=!1)}}),u._webgl={positions:C._mesh._positions,normals:C._mesh._normals,texcoords:C._mesh._texCoords,colors:C._mesh._colors,tangents:C._mesh._tangents,binormals:C._mesh._binormals,indexes:C._mesh._indices,indexType:e.UNSIGNED_SHORT,coordType:e.FLOAT,normalType:e.FLOAT,texCoordType:e.FLOAT,texCoord2Type:e.FLOAT,colorType:e.FLOAT,tangentType:e.FLOAT,binormalType:e.FLOAT,coordNormalized:!1,normalNormalized:!1,texCoordNormalized:!1,texCoord2Normalized:!1,colorNormalized:!1,tangentNormalized:!1,binormalNormalized:!1,texture:[],dirtyLighting:x3dom.Utils.checkDirtyLighting(A),binaryGeometry:0,popGeometry:0,bufferGeometry:0},o=u.getTextures(),s=0;s<o.length;++s)u._webgl.texture.push(new x3dom.Texture(e,u._nameSpace.doc,this.cache,o[s]));u._webgl.shader=this.cache.getShaderByProperties(e,u,u.getShaderProperties(A));var p=u._webgl.shader,E=0;if(u._webgl.buffers=[],u._webgl.dynamicFields=[],x3dom.isa(C,x3dom.nodeTypes.X3DBinaryContainerGeometryNode)){u._webgl.primType=[];for(var B=0;B<C._vf.primType.length;++B)u._webgl.primType.push(x3dom.Utils.primTypeDic(e,C._vf.primType[B]))}else u._webgl.primType=x3dom.Utils.primTypeDic(e,C._mesh._primType);if(x3dom.isa(C,x3dom.nodeTypes.BinaryGeometry))x3dom.BinaryContainerLoader.setupBinGeo(u,p,e,A,this);else if(x3dom.isa(C,x3dom.nodeTypes.BufferGeometry))x3dom.BinaryContainerLoader.setupBufferGeo(u,p,e,A,this);else if(x3dom.isa(C,x3dom.nodeTypes.PopGeometry))x3dom.BinaryContainerLoader.setupPopGeo(u,p,e,A,this);else{for(f=0;f<u._webgl.positions.length;f++){if(i=6*f,u._webgl.positions[f]&&(g=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.INDEX]=g,x3dom.caps.INDEX_UINT&&u._webgl.positions[0].length/3>65535?(l=new Uint32Array(u._webgl.indexes[f]),u._webgl.indexType=e.UNSIGNED_INT):(l=new Uint16Array(u._webgl.indexes[f]),u._webgl.indexType=e.UNSIGNED_SHORT),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,g),e.bufferData(e.ELEMENT_ARRAY_BUFFER,l,e.STATIC_DRAW),l=null,r=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.POSITION]=r,e.bindBuffer(e.ARRAY_BUFFER,r),n=new Float32Array(u._webgl.positions[f]),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,r),e.vertexAttribPointer(p.position,C._mesh._numPosComponents,u._webgl.coordType,!1,u._coordStrideOffset[0],u._coordStrideOffset[1]),e.enableVertexAttribArray(p.position),n=null),u._webgl.normals[f]){I=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.NORMAL]=I;var Q=new Float32Array(u._webgl.normals[f]);e.bindBuffer(e.ARRAY_BUFFER,I),e.bufferData(e.ARRAY_BUFFER,Q,e.STATIC_DRAW),e.vertexAttribPointer(p.normal,C._mesh._numNormComponents,u._webgl.normalType,!1,u._normalStrideOffset[0],u._normalStrideOffset[1]),e.enableVertexAttribArray(p.normal),Q=null}if(u._webgl.texcoords[f]){var x=e.createBuffer();u._webgl.buffers[i+x3dom.BUFFER_IDX.TEXCOORD]=x;var v=new Float32Array(u._webgl.texcoords[f]);e.bindBuffer(e.ARRAY_BUFFER,x),e.bufferData(e.ARRAY_BUFFER,v,e.STATIC_DRAW),e.vertexAttribPointer(p.texcoord,C._mesh._numTexComponents,u._webgl.texCoordType,!1,u._texCoordStrideOffset[0],u._texCoordStrideOffset[1]),e.enableVertexAttribArray(p.texcoord),v=null}if(u._webgl.colors[f]){c=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.COLOR]=c;var y=new Float32Array(u._webgl.colors[f]);e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,y,e.STATIC_DRAW),e.vertexAttribPointer(p.color,C._mesh._numColComponents,u._webgl.colorType,!1,u._colorStrideOffset[0],u._colorStrideOffset[1]),e.enableVertexAttribArray(p.color),y=null}if(void 0!==p.particleSize){var F=C._vf.size.toGL();if(F.length){var D=e.createBuffer();u._webgl.buffers[i+x3dom.BUFFER_IDX.ID]=D,e.bindBuffer(e.ARRAY_BUFFER,D),e.bufferData(e.ARRAY_BUFFER,new Float32Array(F),e.STATIC_DRAW)}}if(u._webgl.tangents[f]){d=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.TANGENT]=d;var S=new Float32Array(u._webgl.tangents[f]);e.bindBuffer(e.ARRAY_BUFFER,d),e.bufferData(e.ARRAY_BUFFER,S,e.STATIC_DRAW),e.vertexAttribPointer(p.tangent,C._mesh._numTangentComponents,u._webgl.tangentType,!1,u._tangentStrideOffset[0],u._tangentStrideOffset[1]),e.enableVertexAttribArray(p.tangent),S=null}if(u._webgl.binormals[f]){h=e.createBuffer(),u._webgl.buffers[i+x3dom.BUFFER_IDX.BITANGENT]=h;var w=new Float32Array(u._webgl.binormals[f]);e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,w,e.STATIC_DRAW),e.vertexAttribPointer(p.binormal,C._mesh._numBinormalComponents,u._webgl.binormalType,!1,u._binormalStrideOffset[0],u._binormalStrideOffset[1]),e.enableVertexAttribArray(p.tangent),w=null}}for(var N in C._mesh._dynamicFields)if(C._mesh._dynamicFields.hasOwnProperty(N)){var T=C._mesh._dynamicFields[N];if(u._webgl.dynamicFields[E]={buf:{},name:N,numComponents:T.numComponents},void 0!==p[N]){var b=e.createBuffer();u._webgl.dynamicFields[E++].buf=b;var M=new Float32Array(T.value);e.bindBuffer(e.ARRAY_BUFFER,b),e.bufferData(e.ARRAY_BUFFER,M,e.STATIC_DRAW),e.vertexAttribPointer(p[N],T.numComponents,e.FLOAT,!1,0,0),M=null}}}},e.prototype.setupScene=function(e,t){var A=null,i=null,o=this;if(void 0!==t._webgl){if(!t._dirty)return;void 0!==t._webgl.texture&&t._webgl.texture&&e.deleteTexture(t._webgl.texture),t._cleanupGLObjects&&t._cleanupGLObjects(),t._webgl={}}t._dirty=!1;var s=t.getTexUrl(),n=0;if(s.length>0&&s[0].length>0)s.length>=6&&s[1].length>0&&s[2].length>0&&s[3].length>0&&s[4].length>0&&s[5].length>0||-1!=s[0].indexOf(".dds")?(A=new x3dom.nodeTypes.Sphere,t._webgl={positions:A._mesh._positions[0],indexes:A._mesh._indices[0],buffers:[{},{}]},t._webgl.primType=e.TRIANGLES,-1!=s[0].indexOf(".dds")?(t._webgl.shader=this.cache.getShader(e,x3dom.shader.BACKGROUND_CUBETEXTURE_DDS),t._webgl.texture=x3dom.Utils.createTextureCube(e,t._nameSpace.doc,[s[0]],!1,t._vf.crossOrigin,!0,!1,!1)):(t._webgl.shader=this.cache.getShader(e,x3dom.shader.BACKGROUND_CUBETEXTURE_DDS),t._webgl.texture=x3dom.Utils.createTextureCube(e,t._nameSpace.doc,s,!1,t._vf.crossOrigin,!0,!1))):(t._webgl={positions:[-1,-1,0,-1,1,0,1,-1,0,1,1,0],indexes:[0,1,2,3],buffers:[{},{}]},s=t._nameSpace.getURL(s[0]),t._webgl.texture=x3dom.Utils.createTexture2D(e,t._nameSpace.doc,s,!0,t._vf.crossOrigin,!1,!1),t._webgl.primType=e.TRIANGLE_STRIP,t._webgl.shader=o.cache.getShader(e,x3dom.shader.BACKGROUND_TEXTURE));else if(t.getSkyColor().length>1||t.getGroundColor().length){A=new x3dom.nodeTypes.Sphere,i=e.createTexture(),t._webgl={positions:A._mesh._positions[0],texcoords:A._mesh._texCoords[0],indexes:A._mesh._indices[0],buffers:[{},{},{}],texture:i,primType:e.TRIANGLES};var r=x3dom.Utils.nextHighestPowerOfTwo(t.getSkyColor().length+t.getGroundColor().length+2);r=r<512?512:r;var a=t._vf.groundAngle.length,d=[],h=[],g=[],l=[0];for(n=0;n<t._vf.skyColor.length;n++)g[n]=t._vf.skyColor[n];for(n=0;n<t._vf.skyAngle.length;n++)l[n+1]=t._vf.skyAngle[n];if(a>0||1==t._vf.groundColor.length){for(l[l.length-1]<Math.PI/2&&(l[l.length]=Math.PI/2-x3dom.fields.Eps,g[g.length]=g[g.length-1]),n=a-1;n>=0;n--)n==a-1&&Math.PI-t._vf.groundAngle[n]<=Math.PI/2&&(l[l.length]=Math.PI/2,g[g.length]=t._vf.groundColor[t._vf.groundColor.length-1]),l[l.length]=Math.PI-t._vf.groundAngle[n],g[g.length]=t._vf.groundColor[n+1];0==a&&1==t._vf.groundColor.length&&(l[l.length]=Math.PI/2,g[g.length]=t._vf.groundColor[0]),l[l.length]=Math.PI,g[g.length]=t._vf.groundColor[0]}else l[l.length-1]<Math.PI&&(l[l.length]=Math.PI,g[g.length]=g[g.length-1]);for(n=0;n<l.length;n++)l[n]/=Math.PI;if(l.length!=g.length){x3dom.debug.logError("Number of background colors and corresponding angles do not match.\nYou have to define one angle less than the count of RGB colors because the angle 0° is added automatically.");var I=l.length<g.length?l.length:g.length;l.length=I,g.length=I}var c=new x3dom.nodeTypes.ColorInterpolator;for(c._vf.key=new x3dom.fields.MFFloat(l),c._vf.keyValue=new x3dom.fields.MFColor(g),c._vf.RGB=!0,c.fieldChanged("keyValue"),n=0;n<r;n++)c._vf.set_fraction=n/(r-1),c.fieldChanged("set_fraction"),d[n]=c._vf.value_changed;d.reverse();var f=Math.floor(255*(1-t.getTransparency()));for(n=0;n<d.length;n++)h.push(Math.floor(255*d[n].r),Math.floor(255*d[n].g),Math.floor(255*d[n].b),f);var u=new Uint8Array(h),C=e.RGBA;r=u.length/4,e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,C,1,r,0,C,e.UNSIGNED_BYTE,u),e.bindTexture(e.TEXTURE_2D,null),t._webgl.shader=o.cache.getShader(e,x3dom.shader.BACKGROUND_SKYTEXTURE)}else t._webgl={};if(t._webgl.shader){var _=t._webgl.shader,m=e.createBuffer();t._webgl.buffers[x3dom.BUFFER_IDX.POSITION]=m,e.bindBuffer(e.ARRAY_BUFFER,m);var p=new Float32Array(t._webgl.positions);e.bufferData(e.ARRAY_BUFFER,p,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,m),e.vertexAttribPointer(_.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(_.position);var E=e.createBuffer();t._webgl.buffers[x3dom.BUFFER_IDX.INDEX]=E;var B=new Uint16Array(t._webgl.indexes);if(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,E),e.bufferData(e.ELEMENT_ARRAY_BUFFER,B,e.STATIC_DRAW),p=null,B=null,void 0!==_.texcoord){var Q=e.createBuffer();t._webgl.buffers[x3dom.BUFFER_IDX.TEXCOORD]=Q;var x=new Float32Array(t._webgl.texcoords);e.bindBuffer(e.ARRAY_BUFFER,Q),e.bufferData(e.ARRAY_BUFFER,x,e.STATIC_DRAW),e.vertexAttribPointer(_.texcoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(_.texcoord),x=null}t._cleanupGLObjects=function(){var t=this._webgl.shader;void 0!==t.position&&(e.deleteBuffer(this._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),e.deleteBuffer(this._webgl.buffers[x3dom.BUFFER_IDX.POSITION])),void 0!==t.texcoord&&e.deleteBuffer(this._webgl.buffers[x3dom.BUFFER_IDX.TEXCOORD])}}t._webgl.render=function(e,A,i,s){var n=t._webgl.shader,r=1-t.getTransparency(),a=null,d=i._22,h=i._23,g=A.e3();if(null!=n&&void 0!==n.texcoord&&null!==n.texcoord&&void 0!==t._webgl.texture&&null!==t._webgl.texture)e.clearColor(0,0,0,r),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),o.stateManager.frontFace(e.CCW),o.stateManager.disable(e.CULL_FACE),o.stateManager.disable(e.DEPTH_TEST),o.stateManager.disable(e.BLEND),o.stateManager.useProgram(n),n.tex||(n.tex=0),i._22=100001/99999,i._23=2e5/99999,A._03=0,A._13=0,A._23=0,a=i.mult(A),n.modelViewProjectionMatrix=a.toGL(),A._03=g.x,A._13=g.y,A._23=g.z,i._22=d,i._23=h,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t._webgl.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[x3dom.BUFFER_IDX.POSITION]),e.vertexAttribPointer(n.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n.position),e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[x3dom.BUFFER_IDX.TEXCOORD]),e.vertexAttribPointer(n.texcoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n.texcoord),o.setVertexAttribEyeIdx(e,n),o.drawElements(e,t._webgl.primType,t._webgl.indexes.length,e.UNSIGNED_SHORT,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.disableVertexAttribArray(n.position),e.disableVertexAttribArray(n.texcoord),o.disableVertexAttribEyeIdx(e,n),e.clear(e.DEPTH_BUFFER_BIT);else if(!n||!t._webgl.texture||void 0!==t._webgl.texture.textureCubeReady&&!0!==t._webgl.texture.textureCubeReady){var l=t.getSkyColor().toGL();e.clearColor(l[0],l[1],l[2],r),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT)}else{if(e.clearColor(0,0,0,r),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),o.stateManager.frontFace(e.CCW),o.stateManager.disable(e.CULL_FACE),o.stateManager.disable(e.DEPTH_TEST),o.stateManager.disable(e.BLEND),o.stateManager.useProgram(n),n.tex||(n.tex=0),t._webgl.texture.textureCubeReady)i._22=100001/99999,i._23=2e5/99999,A._03=0,A._13=0,A._23=0,a=i.mult(A),n.modelViewProjectionMatrix=a.toGL(),A._03=g.x,A._13=g.y,A._23=g.z,i._22=d,i._23=h,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,t._webgl.texture),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);else{if(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t._webgl.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t._vf.scaling&&t._webgl.texture.ready){var I=1,c=new x3dom.fields.SFVec2f(o.canvas.width,o.canvas.height),f=new x3dom.fields.SFVec2f(t._webgl.texture.width,t._webgl.texture.height);c.x>c.y?(I=c.x/f.x,f.x=c.x,f.y=f.y*I):(I=c.y/f.y,f.y=c.y,f.x=f.x*I);var u=c.divideComponents(f),C=f.subtract(c).multiply(.5).divideComponents(f)}else u=new x3dom.fields.SFVec2f(1,1),C=new x3dom.fields.SFVec2f(0,0);n.scale=u.toGL(),n.translation=C.toGL()}if(n.isVR=-1,n.screenWidth=o.canvas.width,o.setTonemappingOperator(s,n),2==o.VRMode){var _=s.getViewMatrices()[1],m=_.e3();_._03=0,_._13=0,_._23=0;var p=s.getProjectionMatrices()[1].mult(_);n.modelViewProjectionMatrix2=p.toGL(),_._03=m.x,_._13=m.y,_._23=m.z,n.isVR=1}o.setVertexAttribEyeIdx(e,n),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[x3dom.BUFFER_IDX.POSITION]),e.vertexAttribPointer(n.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n.position),o.drawElements(e,t._webgl.primType,t._webgl.indexes.length,e.UNSIGNED_SHORT,0),e.disableVertexAttribArray(n.position),o.disableVertexAttribEyeIdx(e,n),e.activeTexture(e.TEXTURE0),t._webgl.texture.textureCubeReady?e.bindTexture(e.TEXTURE_CUBE_MAP,null):e.bindTexture(e.TEXTURE_2D,null),e.clear(e.DEPTH_BUFFER_BIT)}}},e.prototype.setupFgnds=function(e,t){if(void 0===t._fgnd){var A=this;t._fgnd={},t._fgnd._webgl={positions:[-1,-1,0,-1,1,0,1,-1,0,1,1,0],indexes:[0,1,2,3],buffers:[{},{}]},t._fgnd._webgl.primType=e.TRIANGLE_STRIP,t._fgnd._webgl.shader=this.cache.getShader(e,x3dom.shader.FRONTGROUND_TEXTURE);var i=t._fgnd._webgl.shader,o=e.createBuffer();t._fgnd._webgl.buffers[x3dom.BUFFER_IDX.POSITION]=o,e.bindBuffer(e.ARRAY_BUFFER,o);var s=new Float32Array(t._fgnd._webgl.positions);e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(i.position,3,e.FLOAT,!1,0,0);var n=e.createBuffer();t._fgnd._webgl.buffers[x3dom.BUFFER_IDX.INDEX]=n;var r=new Uint16Array(t._fgnd._webgl.indexes);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r,e.STATIC_DRAW),s=null,r=null,t._fgnd._webgl.render=function(e,o){t._fgnd._webgl.texture=o,A.stateManager.frontFace(e.CCW),A.stateManager.disable(e.CULL_FACE),A.stateManager.disable(e.DEPTH_TEST),A.stateManager.useProgram(i),i.tex||(i.tex=0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t._fgnd._webgl.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._fgnd._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),e.bindBuffer(e.ARRAY_BUFFER,t._fgnd._webgl.buffers[x3dom.BUFFER_IDX.POSITION]),e.vertexAttribPointer(i.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(i.position),A.drawElements(e,t._fgnd._webgl.primType,t._fgnd._webgl.indexes.length,e.UNSIGNED_SHORT,0,1),e.disableVertexAttribArray(i.position),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null)}}},e.prototype.renderShadowPass=function(e,t,A,i,o,s,n){var r=t._scene,a=!1;this.stateManager.bindFramebuffer(e.FRAMEBUFFER,o.fbo),this.stateManager.viewport(0,0,o.width,o.height),e.clearColor(1,1,1,0),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),this.stateManager.depthFunc(e.LEQUAL),this.stateManager.enable(e.DEPTH_TEST),this.stateManager.enable(e.CULL_FACE),this.stateManager.disable(e.BLEND);x3dom.fields.SFVec3f.NullVector.toGL(),x3dom.fields.SFVec3f.OneVector.toGL();var d,h=r.getEnvironment()._vf.shadowExcludeTransparentObjects,g=r.drawableCollection.length;for(d=0;d<g;d++){var l=r.drawableCollection.get(d),I=l.transform,c=l.shape,f="transparent"==l.sortType,u=c._webgl;if(!(!u||h&&f)){var C=c._cf.geometry.node,_=c._cf.appearance.node,m=(C._mesh,c.getShaderProperties(t)),p=this.cache.getShaderByProperties(e,c,m,null,!0);if(!p)return;if(this.stateManager.useProgram(p),p.cameraView=n,p.offset=s,p.modelViewProjectionMatrix=A.mult(I).toGL(),u.coordType!=e.FLOAT&&(!u.popGeometry&&x3dom.Utils.isUnsignedType(C._vf.coordType)?p.bgCenter=C.getMin().toGL():p.bgCenter=C._vf.position.toGL(),p.bgSize=C._vf.size.toGL(),p.bgPrecisionMax=C.getPrecisionMax("coordType")),c._clipPlanes){p.modelViewMatrix=i.mult(I).toGL(),p.viewMatrixInverse=i.inverse().toGL();for(var E=0;E<c._clipPlanes.length;E++){var B=c._clipPlanes[E].plane,Q=c._clipPlanes[E].trafo;p["clipPlane"+E+"_Plane"]=Q.multMatrixPlane(B._vf.plane).toGL(),p["clipPlane"+E+"_CappingStrength"]=B._vf.cappingStrength,p["clipPlane"+E+"_CappingColor"]=B._vf.cappingColor.toGL()}}c.isSolid()?(this.stateManager.enable(e.CULL_FACE),c.isCCW()?this.stateManager.frontFace(e.CCW):this.stateManager.frontFace(e.CW)):this.stateManager.disable(e.CULL_FACE);var x,v=_?_._cf.depthMode.node:null,y=!!_&&null!=_._cf.texture.node,F=!f||y;if(v?v._vf.enableDepthTest?(this.stateManager.enable(e.DEPTH_TEST),this.stateManager.depthMask(!v._vf.readOnly),this.stateManager.depthFunc(x3dom.Utils.depthFunc(e,v._vf.depthFunc)),this.stateManager.depthRange(v._vf.zNearRange,v._vf.zFarRange)):this.stateManager.disable(e.DEPTH_TEST):(this.stateManager.enable(e.DEPTH_TEST),this.stateManager.depthMask(F),this.stateManager.depthFunc(e.LEQUAL)),u.popGeometry){var D=i.mult(I);this.updatePopState(l,C,p,u,r,D,t,this.x3dElem.runtime.fps)}x=u.positions.length;for(var S=0;S<x;S++){var w,N,T,b=6*S;if(void 0!==p.position&&u.buffers[b+x3dom.BUFFER_IDX.POSITION]&&u.indexes[S]){if(a=!1,u.buffers[b+x3dom.BUFFER_IDX.INDEX]&&(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,u.buffers[b+x3dom.BUFFER_IDX.INDEX]),a=!0),this.setVertexAttribPointerPosition(e,c,b,S),void 0!==p.id&&u.buffers[b+x3dom.BUFFER_IDX.ID]&&(e.bindBuffer(e.ARRAY_BUFFER,u.buffers[b+x3dom.BUFFER_IDX.ID]),0!=u.binaryGeometry&&1==C._vf.idsPerVertex&&(e.vertexAttribPointer(p.id,1,e.FLOAT,!1,4,0),e.enableVertexAttribArray(p.id))),a&&(u.binaryGeometry>0||u.popGeometry>0))for(w=0,T=0,N=C._vf.vertexCount.length;w<N;w++)this.drawElements(e,u.primType[w],C._vf.vertexCount[w],u.indexType,x3dom.Utils.getByteAwareOffset(T,u.indexType,e)),T+=C._vf.vertexCount[w];else if(u.binaryGeometry<0||u.popGeometry<0)for(w=0,T=0,N=C._vf.vertexCount.length;w<N;w++)this.drawArrays(e,u.primType[w],T,C._vf.vertexCount[w]),T+=C._vf.vertexCount[w];else if(C.hasIndexOffset()){var M=c.tessellationProperties();for(w=0,N=M.length;w<N;w++)this.drawElements(e,u.primType,M[w].count,u.indexType,M[w].offset*x3dom.Utils.getOffsetMultiplier(u.indexType,e))}else 0==u.indexes[S].length?this.drawArrays(e,u.primType,0,u.positions[S].length/3):this.drawElements(e,u.primType,u.indexes[S].length,u.indexType,0);e.disableVertexAttribArray(p.position),void 0!==p.texcoord&&u.buffers[b+x3dom.BUFFER_IDX.TEXCOORD]&&e.disableVertexAttribArray(p.texcoord),void 0!==p.color&&u.buffers[b+x3dom.BUFFER_IDX.COLOR]&&e.disableVertexAttribArray(p.color),void 0!==p.id&&u.buffers[b+x3dom.BUFFER_IDX.ID]&&e.disableVertexAttribArray(p.id)}}}}x3dom.Utils.needLineWidth&&this.stateManager.lineWidth(1),this.stateManager.depthMask(!0),v&&(this.stateManager.enable(e.DEPTH_TEST),this.stateManager.depthFunc(e.LEQUAL),this.stateManager.depthRange(0,1)),e.flush(),this.stateManager.bindFramebuffer(e.FRAMEBUFFER,null)},e.prototype.renderPickingPass=function(e,t,A,i,o,s,n,r,a,d,h){var g=t._webgl.pickScale,l=t._webgl.fboPick.height,I=r*g,c=l-1-a*g,f=!1;this.stateManager.bindFramebuffer(e.FRAMEBUFFER,t._webgl.fboPick.fbo),this.stateManager.viewport(0,0,t._webgl.fboPick.width,l),e.clearColor(0,0,0,0),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var u=t.drawableCollection.viewarea,C=t.getEnvironment(),_=t.drawableCollection.length;C._vf.smallFeatureCulling&&C._lowPriorityThreshold<1&&u.isMovingOrAnimating()&&!(_=Math.floor(_*C._lowPriorityThreshold))&&t.drawableCollection.length&&(_=1);x3dom.fields.SFVec3f.NullVector.toGL(),x3dom.fields.SFVec3f.OneVector.toGL();this.stateManager.depthFunc(e.LEQUAL),this.stateManager.enable(e.DEPTH_TEST),this.stateManager.enable(e.CULL_FACE),this.stateManager.disable(e.BLEND),x3dom.Utils.needLineWidth&&this.stateManager.lineWidth(2);for(var m=0;m<_;m++){var p=t.drawableCollection.get(m),E=p.transform,B=p.shape,Q="transparent"==p.sortType,x=B._webgl;if(x&&!(B._objectID<1)&&B._vf.isPickable){var v=B._cf.geometry.node,y=B._cf.appearance.node,F=(v._mesh,B.getShaderProperties(u)),D=this.cache.getShaderByProperties(e,B,F,n);if(!D)return;if(x.shader=D,this.stateManager.useProgram(D),D.screenWidth=this.canvas.width*t._webgl.pickScale,D.modelMatrix=E.toGL(),D.modelViewProjectionMatrix=i.mult(E).toGL(),D.isVR=-1,2==this.VRMode){var S=u.getViewMatrices()[1],w=u.getProjectionMatrices()[1].mult(S);D.modelViewProjectionMatrix2=w.mult(E).toGL(),D.isVR=1}if(D.lowBit=(255&B._objectID)/255,D.highBit=(B._objectID>>>8)/255,D.from=o.toGL(),D.sceneSize=s,0!=x.binaryGeometry&&1==v._vf.idsPerVertex&&(D.shadowIDs=B._vf.idOffset+x3dom.nodeTypes.Shape.objectID+2),x.coordType!=e.FLOAT&&(!x.popGeometry&&x3dom.Utils.isUnsignedType(v._vf.coordType)?D.bgCenter=v.getMin().toGL():D.bgCenter=v._vf.position.toGL(),D.bgSize=v._vf.size.toGL(),D.bgPrecisionMax=v.getPrecisionMax("coordType")),1==n&&x.colorType!=e.FLOAT&&(D.bgPrecisionColMax=v.getPrecisionMax("colorType")),2==n&&x.texCoordType!=e.FLOAT&&(D.bgPrecisionTexMax=v.getPrecisionMax("texCoordType")),B._clipPlanes){D.modelViewMatrix=A.mult(E).toGL(),D.viewMatrixInverse=A.inverse().toGL(),2==this.VRMode&&(D.modelViewMatrix2=S.mult(E).toGL(),D.viewMatrixInverse2=S.inverse().toGL());for(var N=0;N<B._clipPlanes.length;N++){var T=B._clipPlanes[N].plane,b=B._clipPlanes[N].trafo;D["clipPlane"+N+"_Plane"]=b.multMatrixPlane(T._vf.plane).toGL(),D["clipPlane"+N+"_CappingStrength"]=T._vf.cappingStrength,D["clipPlane"+N+"_CappingColor"]=T._vf.cappingColor.toGL()}}B.isSolid()?(this.stateManager.enable(e.CULL_FACE),B.isCCW()?this.stateManager.frontFace(e.CCW):this.stateManager.frontFace(e.CW)):this.stateManager.disable(e.CULL_FACE);var M=y?y._cf.depthMode.node:null,R=!!y&&null!=y._cf.texture.node,G=!Q||R;if(M?M._vf.enableDepthTest?(this.stateManager.enable(e.DEPTH_TEST),this.stateManager.depthMask(!M._vf.readOnly),this.stateManager.depthFunc(x3dom.Utils.depthFunc(e,M._vf.depthFunc)),this.stateManager.depthRange(M._vf.zNearRange,M._vf.zFarRange)):this.stateManager.disable(e.DEPTH_TEST):(this.stateManager.enable(e.DEPTH_TEST),this.stateManager.depthMask(G),this.stateManager.depthFunc(e.LEQUAL)),x.popGeometry){var U=A.mult(E);this.updatePopState(p,v,D,x,t,U,u,this.x3dElem.runtime.fps)}var L=y?y._cf.pointProperties.node:null;if(L=L&&(x3dom.isa(v,x3dom.nodeTypes.PointSet)||x3dom.isa(v,x3dom.nodeTypes.BinaryGeometry))){var k=y._cf.pointProperties.node._vf;D.pointSizeAttenuation=k.attenuation.toGL(),D.pointSizeFactor=g*k.pointSizeScaleFactor,D.minPointSize=k.pointSizeMinValue,D.maxPointSize=k.pointSizeMaxValue}for(var V=x.positions.length,P=0;P<V;P++){var O,Y,J,K=6*P;if(void 0!==D.position&&x.buffers[K+x3dom.BUFFER_IDX.POSITION]&&x.indexes[P]){if(f=!1,x.buffers[K+x3dom.BUFFER_IDX.INDEX]&&(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,x.buffers[K+x3dom.BUFFER_IDX.INDEX]),f=!0),this.setVertexAttribEyeIdx(e,D),this.setVertexAttribPointerPosition(e,B,K,P),1==n&&this.setVertexAttribPointerColor(e,B,K,P),2==n&&void 0!==D.texcoord&&x.buffers[K+x3dom.BUFFER_IDX.TEXCOORD]&&this.setVertexAttribPointerTexCoord(e,B,K,P),void 0!==D.id&&x.buffers[K+x3dom.BUFFER_IDX.ID]&&(e.bindBuffer(e.ARRAY_BUFFER,x.buffers[K+x3dom.BUFFER_IDX.ID]),0!=x.binaryGeometry&&1==v._vf.idsPerVertex&&(e.vertexAttribPointer(D.id,1,e.FLOAT,!1,4,0),e.enableVertexAttribArray(D.id))),f&&(x.binaryGeometry>0||x.popGeometry>0))for(O=0,J=0,Y=v._vf.vertexCount.length;O<Y;O++)this.drawElements(e,x.primType[O],v._vf.vertexCount[O],x.indexType,x3dom.Utils.getByteAwareOffset(J,x.indexType,e)),J+=v._vf.vertexCount[O];else if(x.binaryGeometry<0||x.popGeometry<0)for(O=0,J=0,Y=v._vf.vertexCount.length;O<Y;O++)this.drawArrays(e,x.primType[O],J,v._vf.vertexCount[O]),J+=v._vf.vertexCount[O];else if(f&&x.bufferGeometry>0)this.drawElements(e,x.primType[0],v._vf.vertexCount[0],x.indexType,B._indexOffset);else if(x.bufferGeometry<0)this.drawArrays(e,x.primType[0],0,v._vf.vertexCount[0]);else if(v.hasIndexOffset()){var X=B.tessellationProperties();for(O=0,Y=X.length;O<Y;O++)this.drawElements(e,x.primType,X[O].count,x.indexType,X[O].offset*x3dom.Utils.getOffsetMultiplier(x.indexType,e))}else 0==x.indexes[P].length?this.drawArrays(e,x.primType,0,x.positions[P].length/3):this.drawElements(e,x.primType,x.indexes[P].length,x.indexType,0);e.disableVertexAttribArray(D.position),void 0!==D.texcoord&&x.buffers[K+x3dom.BUFFER_IDX.TEXCOORD]&&e.disableVertexAttribArray(D.texcoord),void 0!==D.color&&x.buffers[K+x3dom.BUFFER_IDX.COLOR]&&e.disableVertexAttribArray(D.color),void 0!==D.id&&x.buffers[K+x3dom.BUFFER_IDX.ID]&&e.disableVertexAttribArray(D.id),this.disableVertexAttribEyeIdx(e,D)}}}}x3dom.Utils.needLineWidth&&this.stateManager.lineWidth(1),this.stateManager.depthMask(!0),M&&(this.stateManager.enable(e.DEPTH_TEST),this.stateManager.depthFunc(e.LEQUAL),this.stateManager.depthRange(0,1)),e.flush();try{var H=new Uint8Array(4*d*h);e.readPixels(I,c,d,h,e.RGBA,e.UNSIGNED_BYTE,H),t._webgl.fboPick.pixelData=H}catch(e){t._webgl.fboPick.pixelData=[],x3dom.debug.logException(e+" (cannot pick)")}this.stateManager.bindFramebuffer(e.FRAMEBUFFER,null)},e.prototype.renderShape=function(e,t,A,i,o,s,n,r,a){var d=!1,h=e.shape,g=e.transform,l="transparent"==e.sortType;if(h&&h._webgl&&g){var I=h._webgl,c=I.shader;if(c){var f=this.stateManager.useProgram(c),u=h._cf.appearance.node,C=h._cf.geometry.node,_=C._mesh,m=t._scene,p=null;I.coordType!=a.FLOAT?(!I.popGeometry&&x3dom.Utils.isUnsignedType(C._vf.coordType)?c.bgCenter=C.getMin().toGL():c.bgCenter=C._vf.position.toGL(),c.bgSize=C._vf.size.toGL(),c.bgPrecisionMax=C.getPrecisionMax("coordType")):(c.bgCenter=[0,0,0],c.bgSize=[1,1,1],c.bgPrecisionMax=1),I.colorType!=a.FLOAT?c.bgPrecisionColMax=C.getPrecisionMax("colorType"):c.bgPrecisionColMax=1,I.texCoordType!=a.FLOAT?c.bgPrecisionTexMax=C.getPrecisionMax("texCoordType"):c.bgPrecisionTexMax=1,I.normalType!=a.FLOAT?c.bgPrecisionNorMax=C.getPrecisionMax("normalType"):c.bgPrecisionNorMax=1,I.tangentType!=a.FLOAT?c.bgPrecisionTangentMax=C.getPrecisionMax("tangentType"):c.bgPrecisionTangentMax=1,I.binormalType!=a.FLOAT?c.bgPrecisionBinormalMax=C.getPrecisionMax("binormalType"):c.bgPrecisionBinormalMax=1;var E=m.getFog();E&&f&&(c.fogColor=E._vf.color.toGL(),c.fogRange=E._vf.visibilityRange,c.fogType="LINEAR"==E._vf.fogType?0:1);var B,Q=u?u._cf.material.node:null,x=u?u._shader:null,v=!1,y=x&&x3dom.isa(x,x3dom.nodeTypes.ComposedShader);if(I.csshader?(c.diffuseColor=x._vf.diffuseFactor.toGL(),c.specularColor=x._vf.specularFactor.toGL(),c.emissiveColor=x._vf.emissiveFactor.toGL(),c.shininess=x._vf.shininessFactor,c.ambientIntensity=(x._vf.ambientFactor.x+x._vf.ambientFactor.y+x._vf.ambientFactor.z)/3,c.transparency=1-x._vf.alphaFactor,c.environmentFactor=x._vf.environmentFactor.x,c.normalBias=x._vf.normalBias.toGL(),x.getDisplacementMap()?(p=x3dom.Utils.findTextureByName(I.texture,"displacementMap"),c.displacementWidth=p.texture.width,c.displacementHeight=p.texture.height,c.displacementFactor=x._vf.displacementFactor,c.displacementAxis="x"==x._vf.displacementAxis?0:"y"==x._vf.displacementAxis?1:2):x.getDiffuseDisplacementMap()&&(p=x3dom.Utils.findTextureByName(I.texture,"diffuseDisplacementMap"),c.displacementWidth=p.texture.width,c.displacementHeight=p.texture.height,c.displacementFactor=x._vf.displacementFactor,c.displacementAxis="x"==x._vf.displacementAxis?0:"y"==x._vf.displacementAxis?1:2)):Q&&x3dom.isa(Q,x3dom.nodeTypes.PhysicalMaterial)?("roughnessMetallic"==Q._vf.model?(c.diffuseColor=[Q._vf.baseColorFactor.r,Q._vf.baseColorFactor.g,Q._vf.baseColorFactor.b],c.specularColor=[x3dom.Utils.lerp(.04,Q._vf.baseColorFactor.r,Q._vf.metallicFactor),x3dom.Utils.lerp(.04,Q._vf.baseColorFactor.g,Q._vf.metallicFactor),x3dom.Utils.lerp(.04,Q._vf.baseColorFactor.b,Q._vf.metallicFactor)],c.shininess=1-Q._vf.roughnessFactor,c.metallicFactor=Q._vf.metallicFactor,c.transparency=1-Q._vf.baseColorFactor.a):(c.diffuseColor=[Q._vf.diffuseFactor.r,Q._vf.diffuseFactor.g,Q._vf.diffuseFactor.b],c.specularColor=[Q._vf.specularFactor.r,Q._vf.specularFactor.g,Q._vf.specularFactor.b],c.shininess=Q._vf.glossinessFactor,c.transparency=1-Q._vf.diffuseFactor.a),c.emissiveColor=Q._vf.emissiveFactor.toGL(),c.normalBias=Q._vf.normalBias.toGL(),c.ambientIntensity=1,c.alphaCutoff=Q._vf.alphaCutoff):Q?(c.diffuseColor=Q._vf.diffuseColor.toGL(),c.specularColor=Q._vf.specularColor.toGL(),c.emissiveColor=Q._vf.emissiveColor.toGL(),c.shininess=Q._vf.shininess,c.ambientIntensity=Q._vf.ambientIntensity,c.transparency=Q._vf.transparency,c.environmentFactor=0,c.alphaCutoff=u._vf.alphaClipThreshold.toFixed(2),x3dom.isa(Q,x3dom.nodeTypes.TwoSidedMaterial)&&(v=!0,c.backDiffuseColor=Q._vf.backDiffuseColor.toGL(),c.backSpecularColor=Q._vf.backSpecularColor.toGL(),c.backEmissiveColor=Q._vf.backEmissiveColor.toGL(),c.backShininess=Q._vf.backShininess,c.backAmbientIntensity=Q._vf.backAmbientIntensity,c.backTransparency=Q._vf.backTransparency)):(c.diffuseColor=[1,1,1],c.specularColor=[0,0,0],c.emissiveColor=[0,0,0],c.shininess=0,c.ambientIntensity=1,c.transparency=0,c.alphaCutoff=.1),x)if(y){for(var F in x._vf)if(x._vf.hasOwnProperty(F)&&"language"!==F){var D=x._vf[F];null!=D&&(D.toGL?c[F]=D.toGL():c[F]=D)}}else x3dom.isa(x,x3dom.nodeTypes.CommonSurfaceShader)&&(I.csshader=x);for(var S=0;S<i&&f;S++){var w=o.mult(A[S].getCurrentTransform());x3dom.isa(A[S],x3dom.nodeTypes.DirectionalLight)?(c["light"+S+"_Type"]=0,c["light"+S+"_On"]=A[S]._vf.on?1:0,c["light"+S+"_Color"]=A[S]._vf.color.toGL(),c["light"+S+"_Intensity"]=A[S]._vf.intensity,c["light"+S+"_AmbientIntensity"]=A[S]._vf.ambientIntensity,c["light"+S+"_Direction"]=w.multMatrixVec(A[S]._vf.direction).toGL(),c["light"+S+"_Attenuation"]=[1,1,1],c["light"+S+"_Location"]=[1,1,1],c["light"+S+"_Radius"]=0,c["light"+S+"_BeamWidth"]=0,c["light"+S+"_CutOffAngle"]=0,c["light"+S+"_ShadowIntensity"]=A[S]._vf.shadowIntensity):x3dom.isa(A[S],x3dom.nodeTypes.PointLight)?(c["light"+S+"_Type"]=1,c["light"+S+"_On"]=A[S]._vf.on?1:0,c["light"+S+"_Color"]=A[S]._vf.color.toGL(),c["light"+S+"_Intensity"]=A[S]._vf.intensity,c["light"+S+"_AmbientIntensity"]=A[S]._vf.ambientIntensity,c["light"+S+"_Direction"]=[1,1,1],c["light"+S+"_Attenuation"]=A[S]._vf.attenuation.toGL(),c["light"+S+"_Location"]=w.multMatrixPnt(A[S]._vf.location).toGL(),c["light"+S+"_Radius"]=A[S]._vf.radius,c["light"+S+"_BeamWidth"]=0,c["light"+S+"_CutOffAngle"]=0,c["light"+S+"_ShadowIntensity"]=A[S]._vf.shadowIntensity):x3dom.isa(A[S],x3dom.nodeTypes.SpotLight)?(c["light"+S+"_Type"]=2,c["light"+S+"_On"]=A[S]._vf.on?1:0,c["light"+S+"_Color"]=A[S]._vf.color.toGL(),c["light"+S+"_Intensity"]=A[S]._vf.intensity,c["light"+S+"_AmbientIntensity"]=A[S]._vf.ambientIntensity,c["light"+S+"_Direction"]=w.multMatrixVec(A[S]._vf.direction).toGL(),c["light"+S+"_Attenuation"]=A[S]._vf.attenuation.toGL(),c["light"+S+"_Location"]=w.multMatrixPnt(A[S]._vf.location).toGL(),c["light"+S+"_Radius"]=A[S]._vf.radius,c["light"+S+"_BeamWidth"]=A[S]._vf.beamWidth,c["light"+S+"_CutOffAngle"]=A[S]._vf.cutOffAngle,c["light"+S+"_ShadowIntensity"]=A[S]._vf.shadowIntensity):x3dom.isa(A[S],x3dom.nodeTypes.PhysicalEnvironmentLight)&&(B=A[S],i--)}if(m.getNavigationInfo()._vf.headlight&&f&&(c["light"+(i=i||0)+"_Type"]=0,c["light"+i+"_On"]=1,c["light"+i+"_Color"]=[1,1,1],c["light"+i+"_Intensity"]=1,c["light"+i+"_AmbientIntensity"]=0,c["light"+i+"_Direction"]=[0,0,-1],c["light"+i+"_Attenuation"]=[1,1,1],c["light"+i+"_Location"]=[1,1,1],c["light"+i+"_Radius"]=0,c["light"+i+"_BeamWidth"]=0,c["light"+i+"_CutOffAngle"]=0,c["light"+i+"_ShadowIntensity"]=0),h._clipPlanes)for(var N=0;N<h._clipPlanes.length;N++){var T=h._clipPlanes[N].plane,b=h._clipPlanes[N].trafo;c["clipPlane"+N+"_Plane"]=b.multMatrixPlane(T._vf.plane).toGL(),c["clipPlane"+N+"_CappingStrength"]=T._vf.cappingStrength,c["clipPlane"+N+"_CappingColor"]=T._vf.cappingColor.toGL()}var M=u?u._cf.depthMode.node:null,R=!!u&&null!=u._cf.texture.node,G=!l||R;M?M._vf.enableDepthTest?(this.stateManager.enable(a.DEPTH_TEST),this.stateManager.depthMask(!M._vf.readOnly),this.stateManager.depthFunc(x3dom.Utils.depthFunc(a,M._vf.depthFunc)),this.stateManager.depthRange(M._vf.zNearRange,M._vf.zFarRange)):this.stateManager.disable(a.DEPTH_TEST):(this.stateManager.enable(a.DEPTH_TEST),this.stateManager.depthMask(G),this.stateManager.depthFunc(a.LEQUAL));var U=u?u._cf.blendMode.node:null;if(U){var L=x3dom.Utils.blendFunc(a,U._vf.srcFactor),k=x3dom.Utils.blendFunc(a,U._vf.destFactor);!1!==L&&!1!==k?(this.stateManager.enable(a.BLEND),this.stateManager.blendFuncSeparate(L,k,a.ONE,a.ONE),this.stateManager.blendColor(U._vf.color.r,U._vf.color.g,U._vf.color.b,1-U._vf.colorTransparency),this.stateManager.blendEquation(x3dom.Utils.blendEquation(a,U._vf.equation))):this.stateManager.disable(a.BLEND)}else Q&&x3dom.isa(Q,x3dom.nodeTypes.PhysicalMaterial)?"BLEND"==Q._vf.alphaMode?(this.stateManager.enable(a.BLEND),this.stateManager.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE)):this.stateManager.disable(a.BLEND):(this.stateManager.enable(a.BLEND),this.stateManager.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE));var V=u?u._cf.colorMaskMode.node:null;V?this.stateManager.colorMask(V._vf.maskR,V._vf.maskG,V._vf.maskB,V._vf.maskA):this.stateManager.colorMask(!0,!0,!0,!0);var P=u?u._cf.lineProperties.node:null;P?this.stateManager.lineWidth(P._vf.linewidthScaleFactor):x3dom.Utils.needLineWidth&&this.stateManager.lineWidth(1),h.isSolid()&&!v?(this.stateManager.enable(a.CULL_FACE),h.isCCW()?this.stateManager.frontFace(a.CCW):this.stateManager.frontFace(a.CW)):this.stateManager.disable(a.CULL_FACE);var O=o.mult(g),Y=O.inverse();if(c.screenWidth=this.canvas.width,c.isOrthoView=1==r._33?1:0,c.modelMatrix=g.toGL(),c.modelViewMatrix=O.toGL(),c.viewMatrix=o.toGL(),c.normalMatrix=Y.transpose().toGL(),c.modelViewMatrixInverse=Y.toGL(),c.modelViewProjectionMatrix=s.mult(g).toGL(),c.modelViewProjectionInverseMatrix=s.mult(g).inverse().toGL(),c.viewMatrixInverse=o.inverse().toGL(),c.cameraPosWS=o.inverse().e3().toGL(),this.setTonemappingOperator(t,c),y&&(c.model=g.toGL(),c.projectionMatrix=r.toGL(),c.worldMatrix=g.toGL(),c.worldInverseTranspose=g.inverse().transpose().toGL()),2==this.VRMode){var J=t.getViewMatrices()[1],K=t.getProjectionMatrices()[1].mult(J),X=J.mult(g),H=X.inverse();c.viewMatrix2=J.toGL(),c.modelViewMatrix2=X.toGL(),c.normalMatrix2=H.transpose().toGL(),c.modelViewMatrixInverse2=H.toGL(),c.modelViewProjectionMatrix2=K.mult(g).toGL(),c.isVR=1}else c.isVR=0;I.popGeometry&&this.updatePopState(e,C,c,I,m,O,t,this.x3dElem.runtime.fps);for(var z=0,q=I.texture.length;z<q;z++)p=I.texture[z],a.activeTexture(a.TEXTURE0+z),a.bindTexture(p.type,p.texture),a.texParameteri(p.type,a.TEXTURE_WRAP_S,p.wrapS),a.texParameteri(p.type,a.TEXTURE_WRAP_T,p.wrapT),a.texParameteri(p.type,a.TEXTURE_MAG_FILTER,p.magFilter),a.texParameteri(p.type,a.TEXTURE_MIN_FILTER,p.minFilter),x3dom.caps.ANISOTROPIC&&a.texParameterf(p.type,x3dom.caps.ANISOTROPIC.TEXTURE_MAX_ANISOTROPY_EXT,p.anisotropicDegree),x&&y||c[p.samplerName]||(c[p.samplerName]=z);if(x3dom.isa(Q,x3dom.nodeTypes.PhysicalMaterial)&&null!=B&&""!=B._vf.diffuse&&""!=B._vf.specular){var W=B._nameSpace.getURL(B._vf.diffuse),j=B._nameSpace.getURL(B._vf.specular),Z=x3dom.BRDF_LUT,$=this.cache.getTexture2D(a,h._nameSpace.doc,Z,!1,"anonymous",!1,!1,!0),ee=this.cache.getTextureCube(a,h._nameSpace.doc,[W],!1,"anonymous",!1,!1,!0),te=this.cache.getTextureCube(a,h._nameSpace.doc,[j],!1,"anonymous",!1,!1,!0);a.activeTexture(a.TEXTURE0+q),a.bindTexture(a.TEXTURE_2D,$),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),c.brdfMap=q++,ee.ready&&(a.activeTexture(a.TEXTURE0+q),a.bindTexture(a.TEXTURE_CUBE_MAP,ee),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),c.diffuseEnvironmentMap=q++),te.ready&&(a.activeTexture(a.TEXTURE0+q),a.bindTexture(a.TEXTURE_CUBE_MAP,te),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),c.specularEnvironmentMap=q++)}if(u&&u._cf.textureTransform.node){var Ae=u.texTransformMatrix();c.texTrafoMatrix=Ae.toGL()}var ie,oe,se,ne,re,ae=null,de=I.dynamicFields.length;for(ie=0;ie<de;ie++)void 0!==c[(ae=I.dynamicFields[ie]).name]&&(a.bindBuffer(a.ARRAY_BUFFER,ae.buf),a.vertexAttribPointer(c[ae.name],ae.numComponents,a.FLOAT,!1,0,0),a.enableVertexAttribArray(c[ae.name]));var he=!1;x3dom.isa(C,x3dom.nodeTypes.ParticleSet)&&(he=!0);var ge=u?u._cf.pointProperties.node:null;if(ge=ge&&(x3dom.isa(C,x3dom.nodeTypes.PointSet)||x3dom.isa(C,x3dom.nodeTypes.BinaryGeometry))){var le=u._cf.pointProperties.node._vf;c.pointSizeAttenuation=le.attenuation.toGL(),c.pointSizeFactor=le.pointSizeScaleFactor,c.minPointSize=le.pointSizeMinValue,c.maxPointSize=le.pointSizeMaxValue}re=I.positions.length;for(var Ie=0;Ie<re;Ie++){var ce=6*Ie;if(d=!1,void 0!==c.position&&I.buffers[ce+x3dom.BUFFER_IDX.POSITION]&&I.indexes[Ie]){if(I.buffers[ce+x3dom.BUFFER_IDX.INDEX]){if(he&&"any"!=C.drawOrder()){for(var fe,ue=[],Ce=C._cf.coord.node.getPoints(),_e=Ce.length==I.indexes[Ie].length?I.indexes[Ie].length:0,me=0;me<_e;me++){var pe=O.multMatrixPnt(Ce[me]);ue.push([me,pe.z])}for("backtofront"==C.drawOrder()?ue.sort((function(e,t){return e[1]-t[1]})):ue.sort((function(e,t){return t[1]-e[1]})),me=0;me<_e;me++)h._webgl.indexes[Ie][me]=ue[me][0];x3dom.caps.INDEX_UINT&&_e>65535?(fe=new Uint32Array(h._webgl.indexes[Ie]),h._webgl.indexType=a.UNSIGNED_INT):(fe=new Uint16Array(h._webgl.indexes[Ie]),h._webgl.indexType=a.UNSIGNED_SHORT),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,I.buffers[ce+x3dom.BUFFER_IDX.INDEX]),a.bufferData(a.ELEMENT_ARRAY_BUFFER,fe,a.DYNAMIC_DRAW),fe=null}a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,I.buffers[ce+x3dom.BUFFER_IDX.INDEX]),d=!0}this.setVertexAttribEyeIdx(a,c),this.setVertexAttribPointerPosition(a,h,ce,Ie),this.setVertexAttribPointerNormal(a,h,ce,Ie),this.setVertexAttribPointerTexCoord(a,h,ce,Ie),this.setVertexAttribPointerTexCoord2(a,h,ce,Ie),this.setVertexAttribPointerColor(a,h,ce,Ie),this.setVertexAttribPointerTangent(a,h,ce,Ie),this.setVertexAttribPointerBinormal(a,h,ce,Ie),void 0===c.id&&void 0===c.particleSize||!h._webgl.buffers[ce+x3dom.BUFFER_IDX.ID]||(a.bindBuffer(a.ARRAY_BUFFER,h._webgl.buffers[ce+x3dom.BUFFER_IDX.ID]),0!=I.binaryGeometry&&1==C._vf.idsPerVertex?(a.vertexAttribPointer(c.id,1,a.FLOAT,!1,4,0),a.enableVertexAttribArray(c.id)):he&&(a.vertexAttribPointer(c.particleSize,3,a.FLOAT,!1,0,0),a.enableVertexAttribArray(c.particleSize))),0!=I.popGeometry&&I.buffers[ce+x3dom.BUFFER_IDX.ID]&&(a.bindBuffer(a.ARRAY_BUFFER,I.buffers[ce+x3dom.BUFFER_IDX.ID]),a.vertexAttribPointer(c.PG_vertexID,1,a.FLOAT,!1,4,0),a.enableVertexAttribArray(c.PG_vertexID));var Ee,Be=t.getRenderMode(),Qe=!!Q&&(Q._vf.transparency>0&&!h.isSolid()),xe=function(e,t){e.frontFace(h.isCCW()?a.CCW:a.CW),e.enable(a.CULL_FACE),e.cullFace(a.FRONT),t(),e.cullFace(a.BACK),t(),e.disable(a.CULL_FACE)};if(Be>0){var ve=1==Be?a.POINTS:a.LINES;if(d&&(I.binaryGeometry>0||I.popGeometry>0))for(oe=0,ne=0,se=C._vf.vertexCount.length;oe<se;oe++)this.drawElements(a,ve,C._vf.vertexCount[oe],I.indexType,x3dom.Utils.getByteAwareOffset(ne,I.indexType,a)),ne+=C._vf.vertexCount[oe];else if(I.binaryGeometry<0||I.popGeometry<0)for(oe=0,ne=0,se=C._vf.vertexCount.length;oe<se;oe++)this.drawArrays(a,ve,ne,C._vf.vertexCount[oe]),ne+=C._vf.vertexCount[oe];else if(d&&I.bufferGeometry>0)this.drawElements(a,I.primType[0],C._vf.vertexCount[0],I.indexType,h._indexOffset);else if(I.bufferGeometry<0)this.drawArrays(a,I.primType[0],0,C._vf.vertexCount[0]);else if(C.hasIndexOffset())for(oe=0,se=(Ee=h.tessellationProperties()).length;oe<se;oe++)this.drawElements(a,ve,Ee[oe].count,I.indexType,Ee[oe].offset*x3dom.Utils.getOffsetMultiplier(I.indexType,a));else 0==I.indexes[Ie].length?this.drawArrays(a,ve,0,I.positions[Ie].length/3):this.drawElements(a,ve,I.indexes[Ie].length,I.indexType,0)}else if(d&&(I.binaryGeometry>0||I.popGeometry>0))for(oe=0,ne=0,se=C._vf.vertexCount.length;oe<se;oe++)this.drawElements(a,I.primType[oe],C._vf.vertexCount[oe],I.indexType,x3dom.Utils.getByteAwareOffset(ne,I.indexType,a)),ne+=C._vf.vertexCount[oe];else if(I.binaryGeometry<0||I.popGeometry<0)for(oe=0,ne=0,se=C._vf.vertexCount.length;oe<se;oe++)this.drawArrays(a,I.primType[oe],ne,C._vf.vertexCount[oe]),ne+=C._vf.vertexCount[oe];else if(d&&I.bufferGeometry>0)this.drawElements(a,I.primType[0],C._vf.vertexCount[0],I.indexType,h._indexOffset);else if(I.bufferGeometry<0)this.drawArrays(a,I.primType[0],0,C._vf.vertexCount[0]);else if(C.hasIndexOffset())for(oe=0,se=(Ee=h.tessellationProperties()).length;oe<se;oe++)this.drawElements(a,I.primType,Ee[oe].count,I.indexType,Ee[oe].offset*x3dom.Utils.getOffsetMultiplier(I.indexType,a));else 0==I.indexes[Ie].length?Qe?xe(this.stateManager,this.drawArrays.bind(this,a,I.primType,0,I.positions[Ie].length/3)):this.drawArrays(a,I.primType,0,I.positions[Ie].length/3):Qe?xe(this.stateManager,this.drawElements.bind(this,a,I.primType,I.indexes[Ie].length,I.indexType,0)):this.drawElements(a,I.primType,I.indexes[Ie].length,I.indexType,0);a.disableVertexAttribArray(c.position),void 0!==c.normal&&a.disableVertexAttribArray(c.normal),this.disableVertexAttribEyeIdx(a,c),void 0!==c.texcoord&&a.disableVertexAttribArray(c.texcoord),void 0!==c.texcoord2&&a.disableVertexAttribArray(c.texcoord2),void 0!==c.color&&a.disableVertexAttribArray(c.color),void 0!==c.tangent&&a.disableVertexAttribArray(c.tangent),void 0!==c.binormal&&a.disableVertexAttribArray(c.binormal),I.buffers[ce+x3dom.BUFFER_IDX.ID]&&(void 0!==c.id?a.disableVertexAttribArray(c.id):void 0!==c.particleSize&&a.disableVertexAttribArray(c.particleSize)),0!=I.popGeometry&&void 0!==c.PG_vertexID&&a.disableVertexAttribArray(c.PG_vertexID)}}for(ie=0;ie<de;ie++)void 0!==c[(ae=I.dynamicFields[ie]).name]&&a.disableVertexAttribArray(c[ae.name]);this.numCoords+=_._numCoords,this.numFaces+=_._numFaces,I.binaryGeometry||I.popGeometry||I.bufferGeometry?this.numDrawCalls+=C._vf.vertexCount.length:C.hasIndexOffset()?this.numDrawCalls+=h.tessellationProperties().length:this.numDrawCalls+=re,this.stateManager.depthMask(!0),M&&(this.stateManager.enable(a.DEPTH_TEST),this.stateManager.depthFunc(a.LEQUAL),this.stateManager.depthRange(0,1)),U&&(this.stateManager.enable(a.BLEND),this.stateManager.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE),this.stateManager.blendColor(1,1,1,1),this.stateManager.blendEquation(a.FUNC_ADD)),V&&this.stateManager.colorMask(!0,!0,!0,!0),P&&this.stateManager.lineWidth(1);var ye=I.texture;for(q=ye?ye.length:0,z=0;z<q;z++)ye[z]&&u&&u._cf.texture.node&&(p=u._cf.texture.node.getTexture(z),a.activeTexture(a.TEXTURE0+z),x3dom.isa(p,x3dom.nodeTypes.X3DEnvironmentTextureNode)?a.bindTexture(a.TEXTURE_CUBE_MAP,null):a.bindTexture(a.TEXTURE_2D,null))}else x3dom.debug.logError("[Context|RenderShape] No Shader is set!")}else x3dom.debug.logError("[Context|RenderShape] No valid Shape!")},e.prototype.updatePopState=function(e,t,A,i,o,s,n,r){var a=x3dom.nodeTypes.PopGeometry.ErrorToleranceFactor*t._vf.precisionFactor;(r<=1||n.isMovingOrAnimating())&&(a*=x3dom.nodeTypes.PopGeometry.PrecisionFactorOnMove);var d=16;if(a>0){var h=o.getViewpoint(),g=h.getImgPlaneHeightAtDistOne(),l=h.getNear(),I=s.multMatrixPnt(t._vf.position),c=.5*s.multMatrixVec(t._vf.size).length(),f=2*(.5*s.multMatrixVec(t._vf.maxBBSize).length())/(a*(Math.max(-I.z-c,l)*(g/n._height)));d=(d=Math.ceil(Math.log(f)/.693147180559945))<1?1:d>16?16:d}var u=t._vf.minPrecisionLevel,C=t._vf.maxPrecisionLevel;d=-1!=u&&d<u?u:d,d=-1!=C&&d>C?C:d;var _=i.levelsAvailable<d?i.levelsAvailable:d;d=_,a<=1&&(d=d==t.getNumLevels()?16:d);var m=t._vf.indexedRendering,p=t._mesh;p._numCoords=0,p._numFaces=0;for(var E=0;E<_;++E){var B=i.numVerticesAtLevel[E];p._numCoords+=B,p._numFaces+=(m?t.getNumIndicesByLevel(E):B)/3}x3dom.nodeTypes.PopGeometry.numRenderedVerts+=p._numCoords,x3dom.nodeTypes.PopGeometry.numRenderedTris+=p._numFaces,p.currentLOD=d,t.adaptVertexCount(m?3*p._numFaces:p._numCoords),A.PG_maxBBSize=t._vf.maxBBSize.toGL(),A.PG_bbMin=t._bbMinBySize,A.PG_numAnchorVertices=t._vf.numAnchorVertices,A.PG_bbMaxModF=t._vf.bbMaxModF.toGL(),A.PG_bboxShiftVec=t._vf.bbShiftVec.toGL(),A.PG_precisionLevel=d,A.PG_powPrecision=x3dom.nodeTypes.PopGeometry.powLUT[d-1]},e.prototype.pickValue=function(e,t,A,i,o,s){x3dom.Utils.startMeasure("picking");var n=e._scene,r=this.ctx3d;if(!(r&&n&&n._webgl&&n.drawableCollection))return!1;var a,d,h=n._vf.pickMode.toLowerCase(),g=0;switch(h){case"box":return!1;case"idbuf":g=0;break;case"idbuf24":g=3;break;case"idbufid":g=4;break;case"color":g=1;break;case"texcoord":g=2}arguments.length>4?(a=o,d=s):(a=e._last_mat_view,d=e._last_mat_scene);var l=x3dom.fields.SFVec3f.copy(n._lastMin),I=x3dom.fields.SFVec3f.copy(n._lastMax),c=a.inverse().e3(),f=x3dom.fields.SFVec3f.copy(c),u=x3dom.fields.SFVec3f.copy(c);f.x>l.x&&(f.x=l.x),f.y>l.y&&(f.y=l.y),f.z>l.z&&(f.z=l.z),u.x<I.x&&(u.x=I.x),u.y<I.y&&(u.y=I.y),u.z<I.z&&(u.z=I.z),n._lastMin.setValues(f),n._lastMax.setValues(u);var C=n._lastMax.subtract(n._lastMin).length();n.getViewpoint().getFar()&&(C=Math.min(C,n.getViewpoint().getFar()));var _=e.getCCtoWCMatrix();n._lastMin.setValues(l),n._lastMax.setValues(I);var m=x3dom.nodeTypes.Shape.objectID+2;this.renderPickingPass(r,n,a,d,c,C,g,t,A,2,2);var p=n._webgl.fboPick.pixelData;if(p&&p.length){var E,B,Q,x,v,y,F=new x3dom.fields.SFVec3f(0,0,0),D=new x3dom.fields.SFVec3f(0,0,1),S=0,w=p[S+3],N=1/n._webgl.pickScale,T=1/256;0==g?(w+=256*p[S+2],B=p[S]/255*T+p[S+1]/255,Q=e.calcViewRay(t,A,_),F=c.add(Q.dir.multiply(B*C)),B=p[S=4]/255*T+p[S+1]/255,x=e.calcViewRay(t+N,A,_),v=(v=c.add(x.dir.multiply(B*C))).subtract(F).normalize(),B=p[S=8]/255*T+p[S+1]/255,x=e.calcViewRay(t,A-N,_),y=(y=c.add(x.dir.multiply(B*C))).subtract(F).normalize(),D=v.cross(y).normalize()):3==g?(w+=256*p[S+2]+65536*p[S+1],B=p[S]/255,Q=e.calcViewRay(t,A,_),F=c.add(Q.dir.multiply(B*C)),B=p[S=4]/255,x=e.calcViewRay(t+N,A,_),v=(v=c.add(x.dir.multiply(B*C))).subtract(F).normalize(),B=p[S=8]/255,x=e.calcViewRay(t,A-N,_),y=(y=c.add(x.dir.multiply(B*C))).subtract(F).normalize(),D=v.cross(y).normalize()):4==g?(w+=256*p[S+2],E=p[S+1],E+=256*p[S],0==w&&E>0&&E<m&&(w=E)):(F.x=p[S],F.y=p[S+1],F.z=p[S+2]);var b,M,R="shadowObjectIdChanged",G=Math.max(i>>>8,255&i);if(w>=m){var U;w-=m;var L=t*e._inverseDevicePixelRatio,k=A*e._inverseDevicePixelRatio;if(4!=g?(e._pickingInfo.pickPos=F,e._pick.setValues(F),e._pickingInfo.pickNorm=D,e._pickNorm.setValues(D),e._pickingInfo.pickObj=null,e._pickingInfo.lastClickObj=null,U=n._xmlNode):(e._pickingInfo.pickObj=x3dom.nodeTypes.Shape.idMap.nodeID[E],U=e._pickingInfo.pickObj._xmlNode),b=e._pickingInfo.shadowObjectId!=w,e._pickingInfo.lastShadowObjectId=e._pickingInfo.shadowObjectId,e._pickingInfo.shadowObjectId=w,(b||G)&&n._xmlNode&&(n._xmlNode["on"+R]||n._xmlNode.hasAttribute("on"+R)||n._listeners[R])&&(M={target:n._xmlNode,type:R,button:G,mouseup:i>>>8>0,layerX:L,layerY:k,shadowObjectId:w,worldX:F.x,worldY:F.y,worldZ:F.z,normalX:D.x,normalY:D.y,normalZ:D.z,hitPnt:F.toGL(),hitObject:U,cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.cancelBubble=!0}},n.callEvtHandler("on"+R,M)),n._shadowIdMap&&n._shadowIdMap.mapping&&w<n._shadowIdMap.mapping.length){var V,P,O,Y=n._shadowIdMap.mapping[w].usage;for(Q||(Q=e.calcViewRay(t,A,_)),P=0;P<Y.length;P++)if((O=n._nameSpace.defMap[Y[P]])&&O.doIntersect(Q)){e._pickingInfo.pickObj=O;break}for(V=0;V<n._nameSpace.childSpaces.length;V++)for(P=0;P<Y.length;P++)if((O=n._nameSpace.childSpaces[V].defMap[Y[P]])&&O.doIntersect(Q)){e._pickingInfo.pickObj=O;break}}}else b=-1!=e._pickingInfo.shadowObjectId,e._pickingInfo.shadowObjectId=-1,b&&n._xmlNode&&(n._xmlNode["on"+R]||n._xmlNode.hasAttribute("on"+R)||n._listeners[R])&&(M={target:n._xmlNode,type:R,button:G,mouseup:i>>>8>0,layerX:L,layerY:k,shadowObjectId:e._pickingInfo.shadowObjectId,cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.cancelBubble=!0}},n.callEvtHandler("on"+R,M)),w>0?(e._pickingInfo.pickPos=F,e._pickingInfo.pickNorm=D,e._pickingInfo.pickObj=x3dom.nodeTypes.Shape.idMap.nodeID[w]):(e._pickingInfo.pickObj=null,e._pickingInfo.lastClickObj=null)}var J=x3dom.Utils.stopMeasure("picking");return this.x3dElem.runtime.addMeasurement("PICKING",J),!0},e.prototype.pickRect=function(e,t,A,i,o){var s=this.ctx3d,n=e?e._scene:null;if(!(s&&n&&n._webgl&&n.drawableCollection))return!1;var r,a=e._last_mat_view.inverse().e3(),d=n._lastMax.subtract(n._lastMin).length(),h=t<=i?t:i,g=A>=o?A:o,l=(1+Math.abs(i-t))*n._webgl.pickScale,I=(1+Math.abs(o-A))*n._webgl.pickScale;this.renderPickingPass(s,n,e._last_mat_view,e._last_mat_scene,a,d,0,h,g,l<1?1:l,I<1?1:I);var c=[];for(r=0;n._webgl.fboPick.pixelData&&r<n._webgl.fboPick.pixelData.length;r+=4){var f=n._webgl.fboPick.pixelData[r+3]+256*n._webgl.fboPick.pixelData[r+2];f>0&&c.push(f)}c.sort(),c=function(e){for(var t=[],A=e.length,i=0;i<A;i++){for(var o=i+1;o<A;o++)e[i]===e[o]&&(o=++i);t.push(e[i])}return t}(c);var u,C=[],_=x3dom.nodeTypes.Shape.objectID+2;for(r=0;r<c.length;r++)(f=c[r])>=_?f-=_:(u=(u=x3dom.nodeTypes.Shape.idMap.nodeID[f])&&u._xmlNode?u._xmlNode:null)&&C.push(u);return C},e.prototype.renderScene=function(e,t){var A=this.ctx3d,i=e._scene;if(null!==A&&null!==i){var o,s,n,r,a,d,h,g,l,I,c,f=e._doc._nodeBag.renderTextures,u=f.length,C=null,_=A.UNSIGNED_BYTE,m=A.UNSIGNED_BYTE;x3dom.caps.FP_TEXTURES&&(_=A.FLOAT,m=A.FLOAT,x3dom.caps.FPL_TEXTURES||!0);var p=[-1,-1,1,-1,-1,1,-1,1,1,-1,1,1];if(i.updateVolume(),i._webgl){var E=Math.round(this.canvas.width*i._webgl.pickScale),B=Math.round(this.canvas.height*i._webgl.pickScale);for(i._webgl._currFboWidth===E&&i._webgl._currFboHeight===B||(i._webgl._currFboWidth=E,i._webgl._currFboHeight=B,i._webgl.fboPick=x3dom.Utils.initFBO(A,E,B,i._webgl.fboPick.type,!1,!0),i._webgl.fboPick.pixelData=null,x3dom.debug.logInfo("Refreshed picking FBO to size ("+E+", "+B+")")),s=0;s<u;s++)(o=f[s])._webgl&&o._webgl.fbo&&o._webgl.fbo.width==o._vf.dimensions[0]&&o._webgl.fbo.height==o._vf.dimensions[1]||(o.invalidateGLObject(),o._cleanupGLObjects?o._cleanupGLObjects():o._cleanupGLObjects=function(e){e||A.deleteTexture(this._webgl.fbo.tex),this._webgl.fbo.dtex&&A.deleteTexture(this._webgl.fbo.dtex),this._webgl.fbo.rbo&&A.deleteRenderbuffer(this._webgl.fbo.rbo),A.bindFramebuffer(A.FRAMEBUFFER,null),A.deleteFramebuffer(this._webgl.fbo.fbo),this._webgl.fbo.rbo=null,this._webgl.fbo.fbo=null},C=o._cf.textureProperties.node,I=o.requirePingPong()?A.UNSIGNED_BYTE:_,o._webgl={},o._webgl.fbo=x3dom.Utils.initFBO(A,o._vf.dimensions[0],o._vf.dimensions[1],I,C&&C._vf.generateMipMaps,o._vf.depthMap||!o.requirePingPong()),o.requirePingPong()&&(c=o._vf.dimensions[0]+"x"+o._vf.dimensions[1],void 0===i._webgl.refinement[c]&&(i._webgl.refinement[c]=x3dom.Utils.initFBO(A,o._vf.dimensions[0],o._vf.dimensions[1],I,!1,!1)),o._webgl.texture=null),x3dom.debug.logInfo("Init/resize RenderedTexture_"+s+" to size "+o._vf.dimensions[0]+" x "+o._vf.dimensions[1]));for(h=(n=e.getShadowedLights()).length,a=0;a<h;a++)if(g=n[a]._vf.shadowMapSize,r=x3dom.isa(n[a],x3dom.nodeTypes.PointLight)?6:Math.max(1,Math.min(n[a]._vf.shadowCascades,6)),void 0===i._webgl.fboShadow[a]||i._webgl.fboShadow[a].length!=r||i._webgl.fboShadow[a][0].height!=g)for(i._webgl.fboShadow[a]=[],d=0;d<r;d++)i._webgl.fboShadow[a][d]=x3dom.Utils.initFBO(A,g,g,m,!1,!0);for(a=0;a<h;a++){for(g=i._webgl.fboShadow[a][0].height,l=!1,d=0;d<i._webgl.fboBlur.length;d++)g==i._webgl.fboBlur[d].height&&(l=!0);l||(i._webgl.fboBlur[i._webgl.fboBlur.length]=x3dom.Utils.initFBO(A,g,g,m,!1,!0))}((x3dom.SSAO.isEnabled(i)||i._webgl.fboShadow.length>0)&&void 0===i._webgl.fboScene||i._webgl.fboScene&&(this.canvas.width!=i._webgl.fboScene.width||this.canvas.height!=i._webgl.fboScene.height))&&(i._webgl.fboScene=x3dom.Utils.initFBO(A,this.canvas.width,this.canvas.height,m,!1,!0))}else{for(i._webgl={},this.setupFgnds(A,i),i._webgl.pickScale=.5,i._webgl._currFboWidth=Math.round(this.canvas.width*i._webgl.pickScale),i._webgl._currFboHeight=Math.round(this.canvas.height*i._webgl.pickScale),i._webgl.fboPick=x3dom.Utils.initFBO(A,i._webgl._currFboWidth,i._webgl._currFboHeight,A.UNSIGNED_BYTE,!1,!0),i._webgl.fboPick.pixelData=null,i._webgl.normalShader=this.cache.getShader(A,x3dom.shader.NORMAL),i._webgl.fboShadow=[],h=(n=e.getShadowedLights()).length,a=0;a<h;a++)for(g=n[a]._vf.shadowMapSize,r=x3dom.isa(n[a],x3dom.nodeTypes.PointLight)?6:Math.max(1,Math.min(n[a]._vf.shadowCascades,6)),i._webgl.fboShadow[a]=[],d=0;d<r;d++)i._webgl.fboShadow[a][d]=x3dom.Utils.initFBO(A,g,g,m,!1,!0);for((i._webgl.fboShadow.length>0||x3dom.SSAO.isEnabled(i))&&(i._webgl.fboScene=x3dom.Utils.initFBO(A,this.canvas.width,this.canvas.height,m,!1,!0)),i._webgl.fboBlur=[],a=0;a<h;a++){for(g=i._webgl.fboShadow[a][0].height,l=!1,d=0;d<i._webgl.fboBlur.length;d++)g==i._webgl.fboBlur[d].height&&(l=!0);l||(i._webgl.fboBlur[i._webgl.fboBlur.length]=x3dom.Utils.initFBO(A,g,g,m,!1,!0))}for(i._webgl.ppBuffer=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,i._webgl.ppBuffer),A.bufferData(A.ARRAY_BUFFER,new Float32Array(p),A.STATIC_DRAW),i._webgl.refinement={stamps:new Array(2),positionBuffer:A.createBuffer()},A.bindBuffer(A.ARRAY_BUFFER,i._webgl.refinement.positionBuffer),A.bufferData(A.ARRAY_BUFFER,new Float32Array(p),A.STATIC_DRAW),s=0;s<u;s++)C=(o=f[s])._cf.textureProperties.node,I=o.requirePingPong()?A.UNSIGNED_BYTE:_,o._webgl={},o._webgl.fbo=x3dom.Utils.initFBO(A,o._vf.dimensions[0],o._vf.dimensions[1],I,C&&C._vf.generateMipMaps,o._vf.depthMap||!o.requirePingPong()),o._cleanupGLObjects=function(e){e||A.deleteTexture(this._webgl.fbo.tex),this._webgl.fbo.dtex&&A.deleteTexture(this._webgl.fbo.dtex),this._webgl.fbo.rbo&&A.deleteFramebuffer(this._webgl.fbo.rbo),A.bindFramebuffer(A.FRAMEBUFFER,null),A.deleteFramebuffer(this._webgl.fbo.fbo),this._webgl.fbo.rbo=null,this._webgl.fbo.fbo=null},o.requirePingPong()&&(c=o._vf.dimensions[0]+"x"+o._vf.dimensions[1],void 0===i._webgl.refinement[c]&&(i._webgl.refinement[c]=x3dom.Utils.initFBO(A,o._vf.dimensions[0],o._vf.dimensions[1],I,!1,!1)),o._webgl.texture=null);e._last_mat_view=x3dom.fields.SFMatrix4f.identity(),e._last_mat_proj=x3dom.fields.SFMatrix4f.identity(),e._last_mat_scene=x3dom.fields.SFMatrix4f.identity(),this._calledViewpointChangedHandler=!1}var Q=i.getEnvironment();Q.checkSanity();var x=i.getBackground();this.setupScene(A,x),this.numFaces=0,this.numCoords=0,this.numDrawCalls=0;var v=e.getProjectionMatrix(),y=e.getViewMatrix();if(!this._calledViewpointChangedHandler||!e._last_mat_view.equals(y)){var F=i.getViewpoint(),D="viewpointChanged";try{if(F.hasEventListener(D)||i.hasEventListener(D)){var S=F.getCurrentTransform(),w=(S=S.inverse().mult(y)).inverse(),N=new x3dom.fields.Quaternion(0,0,1,0);N.setValue(w);var T=w.e3(),b={target:F._xmlNode,type:D,matrix:S,position:T,orientation:N.toAxisAngle(),cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0},preventDefault:function(){this.cancelBubble=!0}};F.hasEventListener(D)&&F.callEvtHandler("on"+D,b),i.hasEventListener(D)&&i.callEvtHandler("on"+D,b),F.callEvtHandler("on"+D,b),this._calledViewpointChangedHandler=!0}}catch(e){x3dom.debug.logException(e)}}e._last_mat_view=y,e._last_mat_proj=v;var M=v.mult(y);if(e._last_mat_scene=M,i.drawableCollection=null,!i.drawableCollection){var R={viewArea:e,sortTrans:Q._vf.sortTrans,viewMatrix:y,projMatrix:v,sceneMatrix:M,frustumCulling:!0,smallFeatureThreshold:Q._smallFeatureThreshold,context:this,gl:A};i.drawableCollection=new x3dom.DrawableCollection(R),x3dom.Utils.startMeasure("traverse"),i.collectDrawableObjects(x3dom.fields.SFMatrix4f.identity(),i.drawableCollection,!0,!1,0,[]);var G=x3dom.Utils.stopMeasure("traverse");this.x3dElem.runtime.addMeasurement("TRAVERSE",G)}x3dom.Utils.startMeasure("sorting"),i.drawableCollection.sort();var U=x3dom.Utils.stopMeasure("sorting");this.x3dElem.runtime.addMeasurement("SORT",U);var L,k=e.getLights(),V=k.length,P=[],O=[],Y=0;x3dom.Utils.startMeasure("shadow");for(var J=e.getLightMatrix(k),K=0;K<V;K++)if(k[K]._vf.shadowIntensity>0){var X=J[K],H=i._webgl.fboShadow[Y],z=Math.max(0,Math.min(1,k[K]._vf.shadowOffset));if(x3dom.isa(k[K],x3dom.nodeTypes.PointLight))for(L=e.getWCtoLCMatricesPointLight(X,k[K],v),a=0;a<6;a++)this.renderShadowPass(A,e,L[a],y,H[a],z,!1);else{var q=Math.max(1,Math.min(k[K]._vf.shadowCascades,6));for(L=e.getWCtoLCMatricesCascaded(X,k[K],v),a=0;a<q;a++)this.renderShadowPass(A,e,L[a],y,H[a],z,!1)}Y++,P[P.length]=L,O[O.length]=X}if(Y>0||x3dom.SSAO.isEnabled(i)){this.renderShadowPass(A,e,M,y,i._webgl.fboScene,0,!0);var W=x3dom.Utils.stopMeasure("shadow");this.x3dElem.runtime.addMeasurement("SHADOW",W)}else this.x3dElem.runtime.removeMeasurement("SHADOW");for(L=e.getWCtoLCMatrix(e.getLightMatrix()[0]),s=0;s<u;s++)this.renderRTPass(A,e,f[s]);for(x3dom.Utils.startMeasure("render"),this.stateManager.bindFramebuffer(A.FRAMEBUFFER,t?t.framebuffer:null),this.stateManager.viewport(0,0,this.canvas.width,this.canvas.height),x._webgl.render(A,y,v,e),x3dom.nodeTypes.PopGeometry.numRenderedVerts=0,x3dom.nodeTypes.PopGeometry.numRenderedTris=0,h=i.drawableCollection.length,Q._vf.smallFeatureCulling&&Q._lowPriorityThreshold<1&&e.isMovingOrAnimating()&&!(h=Math.floor(h*Q._lowPriorityThreshold))&&i.drawableCollection.length&&(h=1),this.stateManager.unsetProgram(),a=0;a<h;a++){var j=i.drawableCollection.get(a);this.renderShape(j,e,k,V,y,M,L,v,A)}if(Y>0&&this.renderShadows(A,e,n,P,O,y,v,M),this.stateManager.disable(A.BLEND),this.stateManager.disable(A.DEPTH_TEST),e._numRenderedNodes=h,x3dom.SSAO.isEnabled(i)&&x3dom.SSAO.renderSSAO(this.stateManager,A,i,this.canvas),void 0!==e._visDbgBuf&&e._visDbgBuf){var Z=i._vf.pickMode.toLowerCase();0!=Z.indexOf("idbuf")&&"color"!=Z&&"texcoord"!=Z||(this.stateManager.viewport(0,3*this.canvas.height/4,this.canvas.width/4,this.canvas.height/4),i._fgnd._webgl.render(A,i._webgl.fboPick.tex)),(Y>0||x3dom.SSAO.isEnabled(i))&&(this.stateManager.viewport(this.canvas.width/4,3*this.canvas.height/4,this.canvas.width/4,this.canvas.height/4),i._fgnd._webgl.render(A,i._webgl.fboScene.tex));var $=3,ee=2;for(a=0;a<Y;a++){H=i._webgl.fboShadow[a];for(d=0;d<H.length;d++)this.stateManager.viewport(ee*this.canvas.width/4,$*this.canvas.height/4,this.canvas.width/4,this.canvas.height/4),i._fgnd._webgl.render(A,H[d].tex),ee<2?ee++:(ee=0,$--)}for(s=0;s<u;s++)(o=f[s])._webgl.fbo.fbo&&(this.stateManager.viewport(s*this.canvas.width/8,5*this.canvas.height/8,this.canvas.width/8,this.canvas.height/8),i._fgnd._webgl.render(A,o._webgl.fbo.tex))}A.finish();var te=x3dom.Utils.stopMeasure("render");this.x3dElem.runtime.addMeasurement("RENDER",te),this.x3dElem.runtime.addMeasurement("DRAW",h?te/h:0),this.x3dElem.runtime.addInfo("#NODES:",i.drawableCollection.numberOfNodes),this.x3dElem.runtime.addInfo("#SHAPES:",e._numRenderedNodes),this.x3dElem.runtime.addInfo("#DRAWS:",this.numDrawCalls),this.x3dElem.runtime.addInfo("#POINTS:",this.numCoords),this.x3dElem.runtime.addInfo("#TRIS:",this.numFaces)}},e.prototype.renderPingPongPass=function(e,t,A){var i=t._scene,o=A._vf.dimensions[0]+"x"+A._vf.dimensions[1],s=i._webgl.refinement[o];if(0!=A._currLoadLevel||i._webgl.refinement.stamps[0]&&i._webgl.refinement.stamps[1]||(i._webgl.refinement.stamps[0]=this.cache.getTexture2D(e,A._nameSpace.doc,A._nameSpace.getURL(A._vf.stamp0),!1,"anonymous",!1,!1),i._webgl.refinement.stamps[1]=this.cache.getTexture2D(e,A._nameSpace.doc,A._nameSpace.getURL(A._vf.stamp1),!1,"anonymous",!1,!1)),A._currLoadLevel<A._loadLevel){A._currLoadLevel++,A._webgl.texture&&e.deleteTexture(A._webgl.texture);var n=A._vf.url[0]+"/"+A._currLoadLevel+"."+A._vf.format;A._webgl.texture=x3dom.Utils.createTexture2D(e,A._nameSpace.doc,A._nameSpace.getURL(n),!1,"anonymous",!1,!1),A._vf.iterations%2==0?A._currLoadLevel%2!=0?A._repeat.x*=2:A._repeat.y*=2:A._currLoadLevel%2==0?A._repeat.x*=2:A._repeat.y*=2}if(A._webgl.texture.ready&&i._webgl.refinement.stamps[0].ready&&i._webgl.refinement.stamps[1].ready){this.stateManager.bindFramebuffer(e.FRAMEBUFFER,s.fbo),this.stateManager.viewport(0,0,s.width,s.height),this.stateManager.disable(e.BLEND),this.stateManager.disable(e.CULL_FACE),this.stateManager.disable(e.DEPTH_TEST),e.clearColor(0,0,0,1),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var r=this.cache.getShader(e,x3dom.shader.TEXTURE_REFINEMENT);this.stateManager.useProgram(r),e.bindBuffer(e.ARRAY_BUFFER,i._webgl.refinement.positionBuffer),e.vertexAttribPointer(r.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r.position),r.stamp=0,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,i._webgl.refinement.stamps[(A._currLoadLevel+1)%2]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),A._currLoadLevel>1&&(r.lastTex=1,e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,A._webgl.fbo.tex),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),r.curTex=2,e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,A._webgl.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r.mode=A._currLoadLevel-1,r.repeat=A._repeat.toGL(),e.drawArrays(e.TRIANGLES,0,6),this.stateManager.bindFramebuffer(e.FRAMEBUFFER,A._webgl.fbo.fbo),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),r.mode=0,r.curTex=2,e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,s.tex),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.drawArrays(e.TRIANGLES,0,6),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.disableVertexAttribArray(r.position),this.stateManager.bindFramebuffer(e.FRAMEBUFFER,null),this.stateManager.viewport(0,0,this.canvas.width,this.canvas.height),A._vf.autoRefinement&&A.nextLevel(),A._currLoadLevel==A._vf.maxLevel&&A._currLoadLevel++,A._webgl.fbo.mipMap&&(e.bindTexture(e.TEXTURE_2D,A._webgl.fbo.tex),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null)),A.requirePingPong()||(e.deleteTexture(A._webgl.texture),delete A._webgl.texture,A._cleanupGLObjects(!0)),A._renderedImage++}},e.prototype.renderRTPass=function(e,t,A){if(x3dom.isa(A,x3dom.nodeTypes.RefinementTexture))A.requirePingPong()&&this.renderPingPongPass(e,t,A);else{switch(A._vf.update.toUpperCase()){case"NONE":return;case"NEXT_FRAME_ONLY":if(!A._needRenderUpdate)return;A._needRenderUpdate=!1}var i,o,s=t._scene,n=null,r=A.getViewMatrix(),a=A.getProjectionMatrix(),d=a.mult(r),h=t.getLightMatrix()[0],g=t.getWCtoLCMatrix(h),l=A._cf.excludeNodes.nodes,I=l.length,c=new Array(I);for(i=0;i<I;i++){var f=l[i].renderFlag&&l[i].renderFlag();c[i]=void 0===f?-1:!0===f?1:0,A._cf.excludeNodes.nodes[i]._vf.visible=!1}this.stateManager.bindFramebuffer(e.FRAMEBUFFER,A._webgl.fbo.fbo),this.stateManager.viewport(0,0,A._webgl.fbo.width,A._webgl.fbo.height),null===A._cf.background.node?(e.clearColor(0,0,0,1),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT)):A._cf.background.node===s.getBackground()?(n=s.getBackground())._webgl.render(e,r,a,t):(n=A._cf.background.node,this.setupScene(e,n),n._webgl.render(e,r,a,t)),this.stateManager.depthFunc(e.LEQUAL),this.stateManager.enable(e.DEPTH_TEST),this.stateManager.enable(e.CULL_FACE),this.stateManager.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE),this.stateManager.enable(e.BLEND);var u,C=t.getLights(),_=C.length,m=A._cf.scene.node;if(m&&m!==s){var p={viewArea:t,sortTrans:s.getEnvironment()._vf.sortTrans,viewMatrix:r,projMatrix:a,sceneMatrix:d,frustumCulling:!1,smallFeatureThreshold:1,context:this,gl:e};if(m.numberOfNodes=0,m.drawableCollection=new x3dom.DrawableCollection(p),m.collectDrawableObjects(x3dom.fields.SFMatrix4f.identity(),m.drawableCollection,!0,!1,0,[]),m.drawableCollection.sort(),o=m.drawableCollection.length,A._vf.showNormals)this.renderNormals(e,m,s._webgl.normalShader,r,d);else for(this.stateManager.unsetProgram(),i=0;i<o;i++)(u=m.drawableCollection.get(i)).shape.renderFlag()&&this.renderShape(u,t,C,_,r,d,g,a,e)}else if(o=s.drawableCollection.length,A._vf.showNormals)this.renderNormals(e,s,s._webgl.normalShader,r,d);else for(this.stateManager.unsetProgram(),i=0;i<o;i++)u=s.drawableCollection.get(i),this.renderShape(u,t,C,_,r,d,g,a,e);for(this.stateManager.disable(e.BLEND),this.stateManager.disable(e.DEPTH_TEST),e.flush(),this.stateManager.bindFramebuffer(e.FRAMEBUFFER,null),A._webgl.fbo.mipMap&&(e.bindTexture(e.TEXTURE_2D,A._webgl.fbo.tex),e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null)),i=0;i<I;i++)0!==c[i]&&(A._cf.excludeNodes.nodes[i]._vf.visible=!0)}},e.prototype.renderNormals=function(e,t,A,i,o){if(A&&t){this.stateManager.depthFunc(e.LEQUAL),this.stateManager.enable(e.DEPTH_TEST),this.stateManager.enable(e.CULL_FACE),this.stateManager.disable(e.BLEND),this.stateManager.useProgram(A);for(var s=x3dom.fields.SFVec3f.NullVector.toGL(),n=x3dom.fields.SFVec3f.OneVector.toGL(),r=0,a=t.drawableCollection.length;r<a;r++){var d=t.drawableCollection.get(r),h=d.transform,g=d.shape,l=g._webgl;if(l&&g&&g.renderFlag()){var I=g._cf.geometry.node,c=I._mesh,f=i.mult(h).inverse();A.normalMatrix=f.transpose().toGL(),A.modelViewProjectionMatrix=o.mult(h).toGL(),l.coordType!=e.FLOAT?(0!=l.popGeometry||4==c._numPosComponents&&x3dom.Utils.isUnsignedType(I._vf.coordType)?A.bgCenter=I.getMin().toGL():A.bgCenter=I._vf.position.toGL(),A.bgSize=I._vf.size.toGL(),A.bgPrecisionMax=I.getPrecisionMax("coordType")):(A.bgCenter=s,A.bgSize=n,A.bgPrecisionMax=1),l.normalType!=e.FLOAT?A.bgPrecisionNorMax=I.getPrecisionMax("normalType"):A.bgPrecisionNorMax=1,g.isSolid()?(this.stateManager.enable(e.CULL_FACE),g.isCCW()?this.stateManager.frontFace(e.CCW):this.stateManager.frontFace(e.CW)):this.stateManager.disable(e.CULL_FACE);for(var u=0,C=l.positions.length;u<C;u++){var _,m,p,E=6*u;if(void 0!==A.position&&l.buffers[E+x3dom.BUFFER_IDX.POSITION]&&l.indexes[u]){if(l.buffers[E+x3dom.BUFFER_IDX.INDEX]&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,l.buffers[E+x3dom.BUFFER_IDX.INDEX]),this.setVertexAttribPointerPosition(e,g,E,u),this.setVertexAttribPointerNormal(e,g,E,u),l.binaryGeometry>0||l.popGeometry>0)for(_=0,p=0,m=I._vf.vertexCount.length;_<m;_++)this.drawElements(e,l.primType[_],I._vf.vertexCount[_],l.indexType,x3dom.Utils.getByteAwareOffset(p,l.indexType,e)),p+=I._vf.vertexCount[_];else if(l.binaryGeometry<0||l.popGeometry<0)for(_=0,p=0,m=I._vf.vertexCount.length;_<m;_++)this.drawArrays(e,l.primType[_],p,I._vf.vertexCount[_]),p+=I._vf.vertexCount[_];else if(indicesReady&&l.bufferGeometry>0)this.drawElements(e,l.primType[0],I._vf.vertexCount[0],l.indexType,g._indexOffset);else if(l.bufferGeometry<0)this.drawArrays(e,l.primType[0],0,I._vf.vertexCount[0]);else if(I.hasIndexOffset()){var B=g.tessellationProperties();for(_=0,m=B.length;_<m;_++)this.drawElements(e,l.primType,B[_].count,l.indexType,B[_].offset*x3dom.Utils.getOffsetMultiplier(l.indexType,e))}else 0==l.indexes[u].length?this.drawArrays(e,l.primType,0,l.positions[u].length/3):this.drawElements(e,l.primType,l.indexes[u].length,l.indexType,0);e.disableVertexAttribArray(A.position),void 0!==A.normal&&e.disableVertexAttribArray(A.normal)}}}}}},e.prototype.shutdown=function(e){var t=this.ctx3d,A=e._scene;if(null!=t&&A){var i=A.getBackground();i._webgl&&void 0!==i._webgl.position&&(t.deleteBuffer(i._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),t.deleteBuffer(i._webgl.buffers[x3dom.BUFFER_IDX.POSITION]));var o=A._fgnd;void 0!==o._webgl.position&&(t.deleteBuffer(o._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),t.deleteBuffer(o._webgl.buffers[x3dom.BUFFER_IDX.POSITION]));for(var s=A.drawableCollection?A.drawableCollection.length:0,n=0;n<s;n++){var r=A.drawableCollection.get(n).shape;r._cleanupGLObjects&&r._cleanupGLObjects(!0)}this.cache.Release(t)}},e.prototype.renderShadows=function(e,t,A,i,o,s,n,r){var a=t._scene,d=x3dom.caps.MAX_TEXTURE_IMAGE_UNITS;if(!(d<7)){var h,g,l,I,c,f=1,u=[0];for(l=0;l<A.length;l++){var C=A[l]._vf.shadowFilterSize;for(g=(h=a._webgl.fboShadow[l]).length,I=0;I<g;I++)this.blurTex(e,a,h[I],C);(f+=6)>d&&(u[u.length]=l,f=7)}u[u.length]=A.length;var _=u.length-1,m=n.inverse(),p=r.inverse();this.stateManager.enable(e.BLEND),this.stateManager.blendFunc(e.DST_COLOR,e.ZERO);for(var E=0;E<_;E++){var B=u[E],Q=u[E+1],x=[];for(c=B;c<Q;c++)x[x.length]=A[c];var v={};v.FOG=a.getFog()._vf.visibilityRange>0?1:0;var y,F,D=this.cache.getShadowRenderingShader(e,x,v);this.stateManager.useProgram(D),e.bindBuffer(e.ARRAY_BUFFER,a._webgl.ppBuffer),e.vertexAttribPointer(D.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(D.position),D.sceneMap=0,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,a._webgl.fboScene.tex),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),D.inverseProj=m.toGL(),D.inverseViewProj=p.toGL();for(var S=0,w=0,N=x.length;w<N;w++){for(F=o[w+B],y=i[w+B],h=a._webgl.fboShadow[w+B],g=y.length,l=0;l<g;l++)e.activeTexture(e.TEXTURE1+S),e.bindTexture(e.TEXTURE_2D,h[l].tex),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),D["light"+w+"_"+l+"_ShadowMap"]=S+1,D["light"+w+"_"+l+"_Matrix"]=y[l].toGL(),S++;if(D["light"+w+"_ViewMatrix"]=F.toGL(),!x3dom.isa(x[w],x3dom.nodeTypes.PointLight))for(I=0;I<g;I++){var T=Math.max(1,Math.min(x[w]._vf.shadowCascades,6)),b=Math.max(0,Math.min(x[w]._vf.shadowSplitFactor,1)),M=Math.max(0,Math.min(x[w]._vf.shadowSplitOffset,1)),R=t.getShadowSplitDepths(T,b,M,!1,n);D["light"+w+"_"+I+"_Split"]=R[I+1]}var G=s.mult(x[w].getCurrentTransform());x3dom.isa(x[w],x3dom.nodeTypes.DirectionalLight)?(D["light"+w+"_Type"]=0,D["light"+w+"_On"]=x[w]._vf.on?1:0,D["light"+w+"_Direction"]=G.multMatrixVec(x[w]._vf.direction).toGL(),D["light"+w+"_Attenuation"]=[1,1,1],D["light"+w+"_Location"]=[1,1,1],D["light"+w+"_Radius"]=0,D["light"+w+"_BeamWidth"]=0,D["light"+w+"_CutOffAngle"]=0,D["light"+w+"_ShadowIntensity"]=x[w]._vf.shadowIntensity,D["light"+w+"_ShadowCascades"]=x[w]._vf.shadowCascades,D["light"+w+"_ShadowOffset"]=Math.max(0,Math.min(1,x[w]._vf.shadowOffset))):x3dom.isa(x[w],x3dom.nodeTypes.PointLight)?(D["light"+w+"_Type"]=1,D["light"+w+"_On"]=x[w]._vf.on?1:0,D["light"+w+"_Direction"]=[1,1,1],D["light"+w+"_Attenuation"]=x[w]._vf.attenuation.toGL(),D["light"+w+"_Location"]=G.multMatrixPnt(x[w]._vf.location).toGL(),D["light"+w+"_Radius"]=x[w]._vf.radius,D["light"+w+"_BeamWidth"]=0,D["light"+w+"_CutOffAngle"]=0,D["light"+w+"_ShadowIntensity"]=x[w]._vf.shadowIntensity,D["light"+w+"_ShadowOffset"]=Math.max(0,Math.min(1,x[w]._vf.shadowOffset))):x3dom.isa(x[w],x3dom.nodeTypes.SpotLight)&&(D["light"+w+"_Type"]=2,D["light"+w+"_On"]=x[w]._vf.on?1:0,D["light"+w+"_Direction"]=G.multMatrixVec(x[w]._vf.direction).toGL(),D["light"+w+"_Attenuation"]=x[w]._vf.attenuation.toGL(),D["light"+w+"_Location"]=G.multMatrixPnt(x[w]._vf.location).toGL(),D["light"+w+"_Radius"]=x[w]._vf.radius,D["light"+w+"_BeamWidth"]=x[w]._vf.beamWidth,D["light"+w+"_CutOffAngle"]=x[w]._vf.cutOffAngle,D["light"+w+"_ShadowIntensity"]=x[w]._vf.shadowIntensity,D["light"+w+"_ShadowCascades"]=x[w]._vf.shadowCascades,D["light"+w+"_ShadowOffset"]=Math.max(0,Math.min(1,x[w]._vf.shadowOffset)))}if(v.FOG&&(D.fogType=999),e.drawArrays(e.TRIANGLES,0,6),v.FOG){var U=a.getFog();this.stateManager.blendColor(U._vf.color.r,U._vf.color.g,U._vf.color.b,1),this.stateManager.blendFunc(e.CONSTANT_COLOR,e.ONE_MINUS_SRC_COLOR),D.fogColor=U._vf.color.toGL(),D.fogRange=U._vf.visibilityRange,D.fogType="LINEAR"==U._vf.fogType?0:1,e.drawArrays(e.TRIANGLES,0,6)}var L=S+1;for(c=0;c<L;c++)e.activeTexture(e.TEXTURE0+c),e.bindTexture(e.TEXTURE_2D,null);e.disableVertexAttribArray(D.position)}this.stateManager.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)}},e.prototype.blurTex=function(e,t,A,i){if(!(i<=0)){i=i<5?3:i<7?5:7;for(var o=A.width,s=A.height,n=null,r=0,a=t._webgl.fboBlur.length;r<a;r++)if(s==t._webgl.fboBlur[r].height){n=t._webgl.fboBlur[r];break}this.stateManager.bindFramebuffer(e.FRAMEBUFFER,n.fbo),this.stateManager.viewport(0,0,o,s),this.stateManager.enable(e.BLEND),this.stateManager.blendFunc(e.ONE,e.ZERO),this.stateManager.disable(e.CULL_FACE),this.stateManager.disable(e.DEPTH_TEST),e.clearColor(1,1,1,0),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var d=this.cache.getShader(e,x3dom.shader.BLUR);this.stateManager.useProgram(d),e.bindBuffer(e.ARRAY_BUFFER,t._webgl.ppBuffer),e.vertexAttribPointer(d.position,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(d.position),d.pixelSizeHor=1/o,d.pixelSizeVert=1/s,d.filterSize=i,d.horizontal=!0,d.texture=0,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,A.tex),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.drawArrays(e.TRIANGLES,0,6),this.stateManager.bindFramebuffer(e.FRAMEBUFFER,A.fbo),e.clearColor(1,1,1,0),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),d.horizontal=!1,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n.tex),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.drawArrays(e.TRIANGLES,0,6),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.disableVertexAttribArray(d.position),e.flush(),this.stateManager.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.stateManager.bindFramebuffer(e.FRAMEBUFFER,null),this.stateManager.viewport(0,0,this.canvas.width,this.canvas.height)}},e.prototype.drawElements=function(e,t,A,i,o,s){if(s=null==s?1:s,s*=this.VRMode,2==x3dom.caps.WEBGL_VERSION)e.drawElementsInstanced(t,A,i,o,s);else if(x3dom.caps.INSTANCED_ARRAYS){this.ctx3d.getExtension("ANGLE_instanced_arrays").drawElementsInstancedANGLE(t,A,i,o,s)}else e.drawElements(t,A,i,o)},e.prototype.drawArrays=function(e,t,A,i,o){if(o=null==o?1:o,o*=this.VRMode,2==x3dom.caps.WEBGL_VERSION)e.drawArraysInstanced(t,A,i,o);else if(x3dom.caps.INSTANCED_ARRAYS){this.ctx3d.getExtension("ANGLE_instanced_arrays").drawArraysInstancedANGLE(t,A,i,o)}else e.drawArrays(t,A,i)},e.prototype.setVertexAttribEyeIdx=function(e,t){if(2==x3dom.caps.WEBGL_VERSION&&null!=t.eyeIdx)this.eyeIdxBuffer?(e.bindBuffer(e.ARRAY_BUFFER,this.eyeIdxBuffer),e.vertexAttribPointer(t.eyeIdx,1,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.eyeIdx),e.vertexAttribDivisor(t.eyeIdx,1)):(this.eyeIdxBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.eyeIdxBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1]),e.STATIC_DRAW),e.vertexAttribPointer(t.eyeIdx,1,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.eyeIdx),e.vertexAttribDivisor(t.eyeIdx,1));else if(x3dom.caps.INSTANCED_ARRAYS&&null!=t.eyeIdx){var A=this.ctx3d.getExtension("ANGLE_instanced_arrays");this.eyeIdxBuffer?(e.bindBuffer(e.ARRAY_BUFFER,this.eyeIdxBuffer),e.vertexAttribPointer(t.eyeIdx,1,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.eyeIdx),A.vertexAttribDivisorANGLE(t.eyeIdx,1)):(this.eyeIdxBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.eyeIdxBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1]),e.STATIC_DRAW),e.vertexAttribPointer(t.eyeIdx,1,e.FLOAT,!1,0,0),e.enableVertexAttribArray(t.eyeIdx),A.vertexAttribDivisorANGLE(t.eyeIdx,1))}},e.prototype.disableVertexAttribEyeIdx=function(e,t){if(2==x3dom.caps.WEBGL_VERSION&&null!=t.eyeIdx)e.disableVertexAttribArray(t.eyeIdx),e.vertexAttribDivisor(t.eyeIdx,0);else if(x3dom.caps.INSTANCED_ARRAYS&&null!=t.eyeIdx){var A=this.ctx3d.getExtension("ANGLE_instanced_arrays");e.disableVertexAttribArray(t.eyeIdx),A.vertexAttribDivisorANGLE(t.eyeIdx,0)}},e.prototype.setVertexAttribPointerPosition=function(e,t,A,i){var o=t._webgl.shader;if(void 0!==o.position&&t._webgl.buffers[A+x3dom.BUFFER_IDX.POSITION]){var s=t._cf.geometry.node;e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[A+x3dom.BUFFER_IDX.POSITION]),e.vertexAttribPointer(o.position,s._mesh._numPosComponents,t._webgl.coordType,t._webgl.coordNormalized,t._coordStrideOffset[0],t._coordStrideOffset[1]),e.enableVertexAttribArray(o.position)}},e.prototype.setVertexAttribPointerNormal=function(e,t,A,i){var o=t._webgl.shader;if(void 0!==o.normal&&t._webgl.buffers[A+x3dom.BUFFER_IDX.NORMAL]){var s=t._cf.geometry.node;e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[A+x3dom.BUFFER_IDX.NORMAL]),e.vertexAttribPointer(o.normal,s._mesh._numNormComponents,t._webgl.normalType,t._webgl.normalNormalized,t._normalStrideOffset[0],t._normalStrideOffset[1]),e.enableVertexAttribArray(o.normal)}},e.prototype.setVertexAttribPointerTexCoord=function(e,t,A,i){var o=t._webgl.shader;if(void 0!==o.texcoord&&t._webgl.buffers[A+x3dom.BUFFER_IDX.TEXCOORD]){var s=t._cf.geometry.node;e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[A+x3dom.BUFFER_IDX.TEXCOORD]),e.vertexAttribPointer(o.texcoord,s._mesh._numTexComponents,t._webgl.texCoordType,t._webgl.texCoordNormalized,t._texCoordStrideOffset[0],t._texCoordStrideOffset[1]),e.enableVertexAttribArray(o.texcoord)}},e.prototype.setVertexAttribPointerTexCoord2=function(e,t,A,i){var o=t._webgl.shader;if(void 0!==o.texcoord2&&t._webgl.buffers[A+x3dom.BUFFER_IDX.TEXCOORD_1]){var s=t._cf.geometry.node;e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[A+x3dom.BUFFER_IDX.TEXCOORD_1]),e.vertexAttribPointer(o.texcoord2,s._mesh._numTex2Components,t._webgl.texCoord2Type,t._webgl.texCoord2Normalized,t._texCoord2StrideOffset[0],t._texCoord2StrideOffset[1]),e.enableVertexAttribArray(o.texcoord2)}},e.prototype.setVertexAttribPointerColor=function(e,t,A,i){var o=t._webgl.shader;if(void 0!==o.color&&t._webgl.buffers[A+x3dom.BUFFER_IDX.COLOR]){var s=t._cf.geometry.node;e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[A+x3dom.BUFFER_IDX.COLOR]),e.vertexAttribPointer(o.color,s._mesh._numColComponents,t._webgl.colorType,t._webgl.colorNormalized,t._colorStrideOffset[0],t._colorStrideOffset[1]),e.enableVertexAttribArray(o.color)}},e.prototype.setVertexAttribPointerTangent=function(e,t,A,i){var o=t._webgl.shader;if(void 0!==o.tangent&&t._webgl.buffers[A+x3dom.BUFFER_IDX.TANGENT]){var s=t._cf.geometry.node;e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[A+x3dom.BUFFER_IDX.TANGENT]),e.vertexAttribPointer(o.tangent,s._mesh._numTangentComponents,t._webgl.tangentType,t._webgl.tangentNormalized,t._tangentStrideOffset[0],t._tangentStrideOffset[1]),e.enableVertexAttribArray(o.tangent)}},e.prototype.setVertexAttribPointerBinormal=function(e,t,A,i){var o=t._webgl.shader;if(void 0!==o.binormal&&t._webgl.buffers[A+x3dom.BUFFER_IDX.BITANGENT]){var s=t._cf.geometry.node;e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[A+x3dom.BUFFER_IDX.BITANGENT]),e.vertexAttribPointer(o.binormal,s._mesh._numBinormalComponents,t._webgl.binormalType,t._webgl.binormalNormalized,t._binormalStrideOffset[0],t._binormalStrideOffset[1]),e.enableVertexAttribArray(o.binormal)}},e.prototype.setTonemappingOperator=function(e,t){switch(e._scene.getEnvironment()._vf.tonemapping){case"none":t.tonemappingOperator=0;break;case"reinhard":t.tonemappingOperator=1;break;case"uncharted":t.tonemappingOperator=2;break;case"filmic":t.tonemappingOperator=3;break;default:t.tonemappingOperator=0}},function(t,A){var i=["webgl2","webgl","experimental-webgl","moz-webgl","webkit-3d"],o=/mac|ip(hone|od|ad)/i.test(navigator.platform),s=/safari/i.test(navigator.userAgent),n=/trident\//i.test(navigator.userAgent);o&&i.splice(0,1);for(var r=null,a=A.getElementsByTagName("Environment"),d={alpha:!0,depth:!0,stencil:!0,antialias:!!!(a&&a[0]&&a[0].hasAttribute("SSAO")&&"true"===a[0].getAttribute("SSAO").toLowerCase()),premultipliedAlpha:!1,preserveDrawingBuffer:!0,failIfMajorPerformanceCaveat:!0},h=0;h<i.length;h++)try{if(x3dom.caps.RENDERMODE="HARDWARE ("+i[h]+")",(r=t.getContext(i[h],d))||(x3dom.caps.RENDERMODE="SOFTWARE",d.failIfMajorPerformanceCaveat=!1,r=t.getContext(i[h],d),d.failIfMajorPerformanceCaveat=!0),r){var g=new e(r,t,"webgl",A);try{x3dom.caps.VENDOR=r.getParameter(r.VENDOR),x3dom.caps.VERSION=r.getParameter(r.VERSION),x3dom.caps.WEBGL_VERSION=-1===x3dom.caps.VERSION.indexOf("WebGL 2.0")?1:2,x3dom.caps.RENDERER=r.getParameter(r.RENDERER),x3dom.caps.SHADING_LANGUAGE_VERSION=r.getParameter(r.SHADING_LANGUAGE_VERSION),x3dom.caps.RED_BITS=r.getParameter(r.RED_BITS),x3dom.caps.GREEN_BITS=r.getParameter(r.GREEN_BITS),x3dom.caps.BLUE_BITS=r.getParameter(r.BLUE_BITS),x3dom.caps.ALPHA_BITS=r.getParameter(r.ALPHA_BITS),x3dom.caps.DEPTH_BITS=r.getParameter(r.DEPTH_BITS),x3dom.caps.MAX_VERTEX_ATTRIBS=r.getParameter(r.MAX_VERTEX_ATTRIBS),x3dom.caps.MAX_VERTEX_TEXTURE_IMAGE_UNITS=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x3dom.caps.MAX_VARYING_VECTORS=r.getParameter(r.MAX_VARYING_VECTORS),x3dom.caps.MAX_VERTEX_UNIFORM_VECTORS=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),x3dom.caps.MAX_COMBINED_TEXTURE_IMAGE_UNITS=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS),x3dom.caps.MAX_TEXTURE_SIZE=r.getParameter(r.MAX_TEXTURE_SIZE),x3dom.caps.MAX_TEXTURE_IMAGE_UNITS=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),x3dom.caps.MAX_CUBE_MAP_TEXTURE_SIZE=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),x3dom.caps.COMPRESSED_TEXTURE_FORMATS=r.getParameter(r.COMPRESSED_TEXTURE_FORMATS),x3dom.caps.MAX_RENDERBUFFER_SIZE=r.getParameter(r.MAX_RENDERBUFFER_SIZE),x3dom.caps.MAX_VIEWPORT_DIMS=r.getParameter(r.MAX_VIEWPORT_DIMS),x3dom.caps.ALIASED_LINE_WIDTH_RANGE=r.getParameter(r.ALIASED_LINE_WIDTH_RANGE),x3dom.caps.ALIASED_POINT_SIZE_RANGE=r.getParameter(r.ALIASED_POINT_SIZE_RANGE),x3dom.caps.SAMPLES=r.getParameter(r.SAMPLES),x3dom.caps.COMPRESSED_TEXTURE=r.getExtension("WEBGL_compressed_texture_s3tc"),x3dom.caps.INDEX_UINT=r.getExtension("OES_element_index_uint"),x3dom.caps.FP_TEXTURES=r.getExtension("OES_texture_float"),x3dom.caps.FPL_TEXTURES=r.getExtension("OES_texture_float_linear"),x3dom.caps.HFP_TEXTURES=r.getExtension("OES_texture_half_float"),x3dom.caps.COLOR_BUFFER_FLOAT=r.getExtension("WEBGL_color_buffer_float"),x3dom.caps.HFPL_TEXTURES=r.getExtension("OES_texture_half_float_linear"),x3dom.caps.STD_DERIVATIVES=r.getExtension("OES_standard_derivatives"),x3dom.caps.DRAW_BUFFERS=r.getExtension("WEBGL_draw_buffers"),x3dom.caps.DEPTH_TEXTURE=r.getExtension("WEBGL_depth_texture"),x3dom.caps.DEBUGRENDERINFO=r.getExtension("WEBGL_debug_renderer_info"),x3dom.caps.ANISOTROPIC=r.getExtension("EXT_texture_filter_anisotropic"),x3dom.caps.TEXTURE_LOD=r.getExtension("EXT_shader_texture_lod"),x3dom.caps.INSTANCED_ARRAYS=r.getExtension("ANGLE_instanced_arrays"),x3dom.caps.ANISOTROPIC&&(x3dom.caps.MAX_ANISOTROPY=r.getParameter(x3dom.caps.ANISOTROPIC.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),x3dom.caps.EXTENSIONS=r.getSupportedExtensions(),x3dom.Utils.isWebGL2Enabled()&&(x3dom.caps.DEPTH_TEXTURE=null,x3dom.caps.INDEX_UINT=!0),x3dom.caps.DEBUGRENDERINFO?(x3dom.caps.UNMASKED_RENDERER_WEBGL=r.getParameter(x3dom.caps.DEBUGRENDERINFO.UNMASKED_RENDERER_WEBGL),x3dom.caps.UNMASKED_VENDOR_WEBGL=r.getParameter(x3dom.caps.DEBUGRENDERINFO.UNMASKED_VENDOR_WEBGL)):(x3dom.caps.UNMASKED_RENDERER_WEBGL="",x3dom.caps.UNMASKED_VENDOR_WEBGL="");var l=x3dom.caps.EXTENSIONS.toString().replace(/,/g,", ");x3dom.debug.logInfo(i[h]+" context found\nVendor: "+x3dom.caps.VENDOR+" "+x3dom.caps.UNMASKED_VENDOR_WEBGL+", Renderer: "+x3dom.caps.RENDERER+" "+x3dom.caps.UNMASKED_RENDERER_WEBGL+", Version: "+x3dom.caps.VERSION+", ShadingLangV.: "+x3dom.caps.SHADING_LANGUAGE_VERSION+", MSAA samples: "+x3dom.caps.SAMPLES+"\nExtensions: "+l),x3dom.caps.INDEX_UINT&&(x3dom.Utils.maxIndexableCoords=4294967295),o&&(x3dom.caps.HFP_TEXTURES=!1,x3dom.caps.FP_TEXTURES=!1),s&&(x3dom.caps.TEXTURE_LOD=!1),n&&(x3dom.caps.INSTANCED_ARRAYS=!1)}catch(e){x3dom.debug.logWarning("Your browser probably supports an older WebGL version."),g=null}return g}}catch(e){x3dom.debug.logWarning(e)}return null}}(),x3dom.SSAO={},x3dom.SSAO.isEnabled=function(e){return e.getEnvironment()._vf.SSAO},x3dom.SSAO.reinitializeShadersIfNecessary=function(e){void 0===x3dom.SSAO.shaderProgram&&(x3dom.SSAO.shaderProgram=x3dom.Utils.wrapProgram(e,new x3dom.shader.SSAOShader(e),"ssao")),void 0===x3dom.SSAO.blurShaderProgram&&(x3dom.SSAO.blurShaderProgram=x3dom.Utils.wrapProgram(e,new x3dom.shader.SSAOBlurShader(e),"ssao-blur"))},x3dom.SSAO.reinitializeRandomTextureIfNecessary=function(e,t){var A=t.getEnvironment()._vf.SSAOrandomTextureSize!=x3dom.SSAO.currentRandomTextureSize;if(void 0===x3dom.SSAO.randomTexture&&(x3dom.SSAO.randomTexture=e.createTexture()),void 0===x3dom.SSAO.randomTexture||A){e.bindTexture(e.TEXTURE_2D,x3dom.SSAO.randomTexture);for(var i=x3dom.SSAO.currentRandomTextureSize=t.getEnvironment()._vf.SSAOrandomTextureSize,o=new ArrayBuffer(i*i*4),s=new Uint8Array(o),n=0;n<i*i;++n){var r=2*Math.random()-1,a=2*Math.random()-1,d=Math.sqrt(r*r+a*a+0);r/=d,a/=d,s[4*n]=.5*(r+1)*255,s[4*n+1]=.5*(a+1)*255,s[4*n+2]=127.5,s[4*n+3]=255}e.texImage2D(e.TEXTURE_2D,0,e.RGBA,i,i,0,e.RGBA,e.UNSIGNED_BYTE,s),e.bindTexture(e.TEXTURE_2D,null)}},x3dom.SSAO.reinitializeFBOIfNecessary=function(e,t){var A=x3dom.SSAO.currentFBOWidth!=t.width||x3dom.SSAO.currentFBOHeight!=t.height;if(void 0===x3dom.SSAO.fbo||A){x3dom.SSAO.currentFBOWidth=t.width,x3dom.SSAO.currentFBOHeight=t.height;var i=e.getParameter(e.FRAMEBUFFER_BINDING);void 0===x3dom.SSAO.fbo&&(x3dom.SSAO.fbo=e.createFramebuffer()),e.bindFramebuffer(e.FRAMEBUFFER,x3dom.SSAO.fbo),void 0===x3dom.SSAO.fbotex&&(x3dom.SSAO.fbotex=e.createTexture()),e.bindTexture(e.TEXTURE_2D,x3dom.SSAO.fbotex),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,x3dom.SSAO.currentFBOWidth,x3dom.SSAO.currentFBOHeight,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindTexture(e.TEXTURE_2D,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,x3dom.SSAO.fbotex,0),e.bindFramebuffer(e.FRAMEBUFFER,i)}},x3dom.SSAO.render=function(e,t,A,i,o,s){var n=t.getParameter(t.FRAMEBUFFER_BINDING);null!=s&&t.bindFramebuffer(t.FRAMEBUFFER,s),e.frontFace(t.CCW),e.disable(t.CULL_FACE),e.disable(t.DEPTH_TEST);var r=x3dom.SSAO.shaderProgram;e.useProgram(r),r.depthTexture=0,r.randomTexture=1,r.radius=A.getEnvironment()._vf.SSAOradius,r.randomTextureTilingFactor=[o.width/x3dom.SSAO.currentRandomTextureSize,o.height/x3dom.SSAO.currentRandomTextureSize];var a=A.getViewpoint(),d=a.getNear(),h=a.getFar();r.nearPlane=d,r.farPlane=h,r.depthReconstructionConstantA=(h+d)/(d-h),r.depthReconstructionConstantB=2*h*d/(d-h),r.depthBufferEpsilon=1e-4*(h-d),r.samples=[.03800223814729654,.10441029119843426,-.04479934806797181,-.03800223814729654,-.10441029119843426,.04479934806797181,-.17023209847088397,.1428416910414532,.6154407640895228,.17023209847088397,-.1428416910414532,-.6154407640895228,-.288675134594813,-.16666666666666646,-.3774214123135722,.288675134594813,.16666666666666646,.3774214123135722,.07717696785196887,-.43769233467209245,-.5201284112706428,-.07717696785196887,.43769233467209245,.5201284112706428,.5471154183401156,-.09647120981496134,-.15886420745887797,-.5471154183401156,.09647120981496134,.15886420745887797,.3333333333333342,.5773502691896253,-.8012446019636266,-.3333333333333342,-.5773502691896253,.8012446019636266,-.49994591864508653,.5958123446480936,-.15385106176844343,.49994591864508653,-.5958123446480936,.15385106176844343,-.8352823295874743,-.3040179051783715,.7825440557226517,.8352823295874743,.3040179051783715,-.7825440557226517],r.tex||(r.tex=0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,x3dom.SSAO.randomTexture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,A._fgnd._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),t.bindBuffer(t.ARRAY_BUFFER,A._fgnd._webgl.buffers[x3dom.BUFFER_IDX.POSITION]),t.vertexAttribPointer(r.position,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r.position),t.drawElements(A._fgnd._webgl.primType,A._fgnd._webgl.indexes.length,t.UNSIGNED_SHORT,0),t.disableVertexAttribArray(r.position),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,null),null!=s&&t.bindFramebuffer(t.FRAMEBUFFER,n)},x3dom.SSAO.blur=function(e,t,A,i,o,s,n){var r=t.getParameter(t.FRAMEBUFFER_BINDING);null!=n&&t.bindFramebuffer(t.FRAMEBUFFER,n),e.frontFace(t.CCW),e.disable(t.CULL_FACE),e.disable(t.DEPTH_TEST);var a=x3dom.SSAO.blurShaderProgram;e.useProgram(a),a.SSAOTexture=0,a.depthTexture=1,a.depthThreshold=A.getEnvironment()._vf.SSAOblurDepthTreshold;var d=A.getViewpoint(),h=d.getNear(),g=d.getFar();a.nearPlane=h,a.farPlane=g,a.depthReconstructionConstantA=(g+h)/(h-g),a.depthReconstructionConstantB=2*g*h/(h-g),a.pixelSize=[1/s.width,1/s.height],a.amount=A.getEnvironment()._vf.SSAOamount,t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,o),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,A._fgnd._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),t.bindBuffer(t.ARRAY_BUFFER,A._fgnd._webgl.buffers[x3dom.BUFFER_IDX.POSITION]),t.vertexAttribPointer(a.position,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(a.position),t.drawElements(A._fgnd._webgl.primType,A._fgnd._webgl.indexes.length,t.UNSIGNED_SHORT,0),t.disableVertexAttribArray(a.position),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,null),null!=n&&t.bindFramebuffer(t.FRAMEBUFFER,r)},x3dom.SSAO.renderSSAO=function(e,t,A,i){this.reinitializeShadersIfNecessary(t),this.reinitializeRandomTextureIfNecessary(t,A),this.reinitializeFBOIfNecessary(t,i),e.viewport(0,0,i.width,i.height),this.render(e,t,A,A._webgl.fboScene.tex,i,x3dom.SSAO.fbo),t.enable(t.BLEND),t.blendFunc(t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA),this.blur(e,t,A,x3dom.SSAO.fbotex,A._webgl.fboScene.tex,i,null),t.disable(t.BLEND)},x3dom.runtime={},x3dom.Runtime=function(e,t){this.doc=e,this.canvas=t,this.config={},this.isReady=!1,this.fps=0,this.VRMode=!1,this.states={measurements:[],infos:[]}},x3dom.Runtime.prototype.addMeasurement=function(e,t){this.states.measurements[e]=t},x3dom.Runtime.prototype.removeMeasurement=function(e){this.states.measurements[e]&&delete this.states.measurements[e]},x3dom.Runtime.prototype.addInfo=function(e,t){this.states.infos[e]=t},x3dom.Runtime.prototype.removeInfo=function(e){delete this.states.infos[e]},x3dom.Runtime.prototype.initialize=function(e,t){this.doc=e,this.canvas=t,this.config={},this.isReady=!1,this.fps=0},x3dom.Runtime.prototype.noBackendFound=function(){x3dom.debug.logInfo("No backend found. Unable to render.")},x3dom.Runtime.prototype.ready=function(){x3dom.debug.logInfo("System ready.")},x3dom.Runtime.prototype.enterFrame=function(){},x3dom.Runtime.prototype.exitFrame=function(){},x3dom.Runtime.prototype.triggerRedraw=function(){this.canvas.doc.needRender=!0},x3dom.Runtime.prototype.getActiveBindable=function(e){var t,A,i,o,s;if(t=this.canvas.doc._bindableBag._stacks,o=[],!(s=x3dom.nodeTypesLC[e.toLowerCase()]))return x3dom.debug.logError('No node of type "'+e+'" found.'),null;for(A=0;A<t.length;A++)void 0!==(i=t[A].getActive())._xmlNode&&x3dom.isa(i,s)&&o.push(i);return o[0]?o[0]._xmlNode:null},x3dom.Runtime.prototype.nextView=function(){var e=this.canvas.doc._scene.getViewpoint()._stack;e?e.switchTo("next"):x3dom.debug.logError("No valid ViewBindable stack.")},x3dom.Runtime.prototype.prevView=function(){var e=this.canvas.doc._scene.getViewpoint()._stack;e?e.switchTo("prev"):x3dom.debug.logError("No valid ViewBindable stack.")},x3dom.Runtime.prototype.viewpoint=function(){return this.canvas.doc._scene.getViewpoint()},x3dom.Runtime.prototype.viewMatrix=function(){return this.canvas.doc._viewarea.getViewMatrix()},x3dom.Runtime.prototype.projectionMatrix=function(){return this.canvas.doc._viewarea.getProjectionMatrix()},x3dom.Runtime.prototype.getWorldToCameraCoordinatesMatrix=function(){return this.canvas.doc._viewarea.getWCtoCCMatrix()},x3dom.Runtime.prototype.getCameraToWorldCoordinatesMatrix=function(){return this.canvas.doc._viewarea.getCCtoWCMatrix()},x3dom.Runtime.prototype.getViewingRay=function(e,t){return this.canvas.doc._viewarea.calcViewRay(e,t)},x3dom.Runtime.prototype.shootRay=function(e,t){var A=this.canvas.doc,i=A._viewarea._pickingInfo;return A.onPick(this.canvas.gl,e,t),{pickPosition:i.pickObj?i.pickPos:null,pickNormal:i.pickObj?i.pickNorm:null,pickObject:i.pickObj?i.pickObj._xmlNode:null}},x3dom.Runtime.prototype.getWidth=function(){return this.canvas.doc._viewarea._width},x3dom.Runtime.prototype.getHeight=function(){return this.canvas.doc._viewarea._height},x3dom.Runtime.prototype.mousePosition=function(e){var t=this.canvas.mousePosition(e);return[t.x,t.y]},x3dom.Runtime.prototype.calcCanvasPos=function(e,t,A){var i=window.devicePixelRatio||1,o=new x3dom.fields.SFVec3f(e,t,A),s=this.canvas.doc._viewarea.getWCtoCCMatrix().multFullMatrixPnt(o),n=this.canvas.doc._viewarea._width/i,r=this.canvas.doc._viewarea._height/i;return[Math.round((s.x+1)*(n-1)/2),Math.round((r-1)*(1-s.y)/2)]},x3dom.Runtime.prototype.calcPagePos=x3dom.Runtime.prototype.calcCanvasPos,x3dom.Runtime.prototype.getBBoxPoints=function(){var e=this.canvas.doc._scene;return e.updateVolume(),[{x:e._lastMin.x,y:e._lastMin.y,z:e._lastMin.z},{x:e._lastMax.x,y:e._lastMin.y,z:e._lastMin.z},{x:e._lastMin.x,y:e._lastMax.y,z:e._lastMin.z},{x:e._lastMax.x,y:e._lastMax.y,z:e._lastMin.z},{x:e._lastMin.x,y:e._lastMin.y,z:e._lastMax.z},{x:e._lastMax.x,y:e._lastMin.y,z:e._lastMax.z},{x:e._lastMin.x,y:e._lastMax.y,z:e._lastMax.z},{x:e._lastMax.x,y:e._lastMax.y,z:e._lastMax.z}]},x3dom.Runtime.prototype.getSceneBRect=function(){for(var e={x:Number.MAX_VALUE,y:Number.MAX_VALUE},t={x:Number.MIN_VALUE,y:Number.MIN_VALUE},A=this.getBBoxPoints(),i=0;i<A.length;i++){var o=this.calcCanvasPos(A[i].x,A[i].y,A[i].z);e.x=o[0]<e.x?o[0]:e.x,e.y=o[1]<e.y?o[1]:e.y,t.x=o[0]>t.x?o[0]:t.x,t.y=o[1]>t.y?o[1]:t.y}return{x:e.x,y:e.y,width:t.x-e.x,height:t.y-e.y}},x3dom.Runtime.prototype.calcClientPos=function(e,t,A){var i=this.canvas.canvas.offsetParent;if(!i)return x3dom.debug.logError("Can't calc client pos without offsetParent."),[0,0];var o=i.getBoundingClientRect(),s=this.calcCanvasPos(e,t,A),n=document.defaultView.getComputedStyle(i,null),r=parseFloat(n.getPropertyValue("padding-left")),a=parseFloat(n.getPropertyValue("border-left-width")),d=parseFloat(n.getPropertyValue("padding-top")),h=parseFloat(n.getPropertyValue("border-top-width"));return[o.left+r+a+s[0],o.top+d+h+s[1]]},x3dom.Runtime.prototype.getScreenshot=function(){var e="",t=this.canvas.backend,A=this.canvas.canvas;if(A)if("flash"==t)e=A.getScreenshot();else{var i=document.createElement("canvas");i.width=A.width,i.height=A.height;var o=i.getContext("2d");o.drawImage(A,0,0,A.width,A.height),o.scale(1,-1),o.translate(0,-A.height),e=i.toDataURL()}return e},x3dom.Runtime.prototype.getCanvas=function(){return this.canvas.canvas},x3dom.Runtime.prototype.lightMatrix=function(){this.canvas.doc._viewarea.getLightMatrix()},x3dom.Runtime.prototype.resetView=function(){this.canvas.doc._viewarea.resetView()},x3dom.Runtime.prototype.lightView=function(){return this.canvas.doc._nodeBag.lights.length>0?(this.canvas.doc._viewarea.animateTo(this.canvas.doc._viewarea.getLightMatrix()[0],this.canvas.doc._scene.getViewpoint()),!0):(x3dom.debug.logInfo("No lights to navigate to."),!1)},x3dom.Runtime.prototype.uprightView=function(){this.canvas.doc._viewarea.uprightView()},x3dom.Runtime.prototype.fitAll=function(e){void 0===e&&(e=!0);var t=this.canvas.doc._scene;t.updateVolume(),this.canvas.doc._viewarea.fit(t._lastMin,t._lastMax,e)},x3dom.Runtime.prototype.fitObject=function(e,t){if(e&&e._x3domNode){void 0===t&&(t=!0);var A=x3dom.fields.SFVec3f.MAX(),i=x3dom.fields.SFVec3f.MIN();e._x3domNode.getVolume().getBounds(A,i);var o=e._x3domNode.getCurrentTransform();if(A=o.multMatrixPnt(A),i=o.multMatrixPnt(i),x3dom.isa(e._x3domNode,x3dom.nodeTypes.X3DTransformNode)){var s=e._x3domNode._trafo.inverse();A=s.multMatrixPnt(A),i=s.multMatrixPnt(i)}this.canvas.doc._viewarea.fit(A,i,t)}},x3dom.Runtime.prototype.showAll=function(e,t){this.canvas.doc._viewarea.showAll(e,t)},x3dom.Runtime.prototype.showObject=function(e,t){if(e&&e._x3domNode){void 0===t&&(t="negZ");var A=x3dom.fields.SFVec3f.MAX(),i=x3dom.fields.SFVec3f.MIN();e._x3domNode.getVolume().getBounds(A,i);var o=e._x3domNode.getCurrentTransform();A=o.multMatrixPnt(A),i=o.multMatrixPnt(i);var s,n=this.canvas.doc._viewarea,r=n._width<n._height?n._width:n._height;switch(t){case"posX":s=new x3dom.fields.SFVec3f(1,0,0);break;case"negX":s=new x3dom.fields.SFVec3f(-1,0,0);break;case"posY":s=new x3dom.fields.SFVec3f(0,1,0);break;case"negY":s=new x3dom.fields.SFVec3f(0,-1,0);break;case"posZ":s=new x3dom.fields.SFVec3f(0,0,1);break;case"negZ":s=new x3dom.fields.SFVec3f(0,0,-1)}var a=this.canvas.doc._scene.getViewpoint(),d=a.getFieldOfView()/2,h=Math.tan(d);Math.abs(h)>x3dom.fields.Eps&&(r/=h);var g=n._width-1,l=n._height-1,I=.25,c=new x3dom.fields.SFVec2f(I*g,I*l);I=.75;var f=new x3dom.fields.SFVec2f(I*g,I*l),u=i.subtract(A).multiply(.5),C=u.length(),_=A.add(u),m=f.subtract(c).multiply(.5),p=1.5*m.length();m=m.add(c);var E=1;p>x3dom.fields.Eps&&(E=C/p*Math.sqrt(m.x*m.x+m.y*m.y+r*r)),s=(s=o.multMatrixVec(s).normalize()).multiply(E);var B=_.add(s),Q=x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0,0,1),s).toMatrix(),x=x3dom.fields.SFMatrix4f.translation(B.negate()),v=x3dom.fields.SFMatrix4f.translation(B),y=(v=v.mult(Q).mult(x).mult(v)).inverse();n.animateTo(y,a)}},x3dom.Runtime.prototype.animateViewpointTo=function(e,t){var A=this.canvas.doc._viewarea,i=this.canvas.doc._scene.getViewpoint();null!=e._x3domNode&&(e=e._x3domNode),A.animateTo(e,i,t)},x3dom.Runtime.prototype.getCenter=function(e){return e&&e._x3domNode&&(this.isA(e,"X3DShapeNode")||this.isA(e,"X3DGeometryNode"))?e._x3domNode.getCenter():null},x3dom.Runtime.prototype.getCurrentTransform=function(e){return e&&e._x3domNode?e._x3domNode.getCurrentTransform():null},x3dom.Runtime.prototype.getBBox=function(e){if(e&&e._x3domNode&&this.isA(e,"X3DBoundedObject")){var t=e._x3domNode.getVolume();return{min:x3dom.fields.SFVec3f.copy(t.min),max:x3dom.fields.SFVec3f.copy(t.max)}}return null},x3dom.Runtime.prototype.getSceneBBox=function(){var e=this.canvas.doc._scene;return e.updateVolume(),{min:x3dom.fields.SFVec3f.copy(e._lastMin),max:x3dom.fields.SFVec3f.copy(e._lastMax)}},x3dom.Runtime.prototype.debug=function(e){var t=this.canvas.doc;return void 0===t._viewarea._visDbgBuf&&(t._viewarea._visDbgBuf="true"===t._x3dElem.getAttribute("showLog")),arguments.length>0?!0===e?(t._viewarea._visDbgBuf=!0,x3dom.debug.logContainer.style.display="block"):(t._viewarea._visDbgBuf=!1,x3dom.debug.logContainer.style.display="none"):(t._viewarea._visDbgBuf=!t._viewarea._visDbgBuf,x3dom.debug.logContainer.style.display=1==t._viewarea._visDbgBuf?"block":"none"),t.needRender=!0,t._viewarea._visDbgBuf},x3dom.Runtime.prototype.navigationType=function(){return this.canvas.doc._scene.getNavigationInfo().getType()},x3dom.Runtime.prototype.noNav=function(){this.canvas.doc._scene.getNavigationInfo().setType("none")},x3dom.Runtime.prototype.examine=function(){this.canvas.doc._scene.getNavigationInfo().setType("examine")},x3dom.Runtime.prototype.turnTable=function(){this.canvas.doc._scene.getNavigationInfo().setType("turntable")},x3dom.Runtime.prototype.fly=function(){this.canvas.doc._scene.getNavigationInfo().setType("fly")},x3dom.Runtime.prototype.freeFly=function(){this.canvas.doc._scene.getNavigationInfo().setType("freefly")},x3dom.Runtime.prototype.lookAt=function(){this.canvas.doc._scene.getNavigationInfo().setType("lookat")},x3dom.Runtime.prototype.lookAround=function(){this.canvas.doc._scene.getNavigationInfo().setType("lookaround")},x3dom.Runtime.prototype.walk=function(){this.canvas.doc._scene.getNavigationInfo().setType("walk")},x3dom.Runtime.prototype.game=function(){this.canvas.doc._scene.getNavigationInfo().setType("game")},x3dom.Runtime.prototype.helicopter=function(){this.canvas.doc._scene.getNavigationInfo().setType("helicopter")},x3dom.Runtime.prototype.resetExamin=function(){var e=this.canvas.doc._viewarea;e._rotMat=x3dom.fields.SFMatrix4f.identity(),e._transMat=x3dom.fields.SFMatrix4f.identity(),e._movement=new x3dom.fields.SFVec3f(0,0,0),e._needNavigationMatrixUpdate=!0,this.canvas.doc.needRender=!0},x3dom.Runtime.prototype.disableKeys=function(){this.canvas.disableKeys=!0},x3dom.Runtime.prototype.enableKeys=function(){this.canvas.disableKeys=!1},x3dom.Runtime.prototype.disableLeftDrag=function(){this.canvas.disableLeftDrag=!0},x3dom.Runtime.prototype.enableLeftDrag=function(){this.canvas.disableLeftDrag=!1},x3dom.Runtime.prototype.disableRightDrag=function(){this.canvas.disableRightDrag=!0},x3dom.Runtime.prototype.enableRightDrag=function(){this.canvas.disableRightDrag=!1},x3dom.Runtime.prototype.disableMiddleDrag=function(){this.canvas.disableMiddleDrag=!0},x3dom.Runtime.prototype.enableMiddleDrag=function(){this.canvas.disableMiddleDrag=!1},x3dom.Runtime.prototype.togglePoints=function(e){var t=this.canvas.doc,A=!0===e?3:2;return t._viewarea._points=++t._viewarea._points%A,t.needRender=!0,t._viewarea._points},x3dom.Runtime.prototype.pickRect=function(e,t,A,i){return this.canvas.doc.onPickRect(this.canvas.gl,e,t,A,i)},x3dom.Runtime.prototype.pickMode=function(e){return e&&!0===e.internal?this.canvas.doc._scene._vf.pickMode:this.canvas.doc._scene._vf.pickMode.toLowerCase()},x3dom.Runtime.prototype.changePickMode=function(e){switch(e=e.toLowerCase()){case"idbuf":e="idBuf";break;case"idbuf24":e="idBuf24";break;case"idbufid":e="idBufId";break;case"texcoord":e="texCoord";break;case"color":e="color";break;case"box":e="box";break;default:x3dom.debug.logWarning("Switch pickMode to "+e+" unknown intersect type"),e=void 0}return void 0!==e&&(this.canvas.doc._scene._vf.pickMode=e,x3dom.debug.logInfo("Switched pickMode to '"+e+"'."),!0)},x3dom.Runtime.prototype.speed=function(e){var t=this.canvas.doc._scene.getNavigationInfo();return e&&(t._vf.speed=e,x3dom.debug.logInfo("Changed navigation speed to "+t._vf.speed)),t._vf.speed},x3dom.Runtime.prototype.zoom=function(e){this.canvas.doc._viewarea.zoom(e),this.canvas.doc.needRender=!0},x3dom.Runtime.prototype.statistics=function(e){var t=this.canvas.stateViewer;return!!t&&(this.canvas.doc.needRender=!0,!0===e?(t.display(e),!0):!1===e?(t.display(e),!1):(t.display(!t.active),t.active))},x3dom.Runtime.prototype.processIndicator=function(e){var t=this.canvas.progressDiv;return!!t&&(!0===e?(t.style.display="flex",!0):!1===e?(t.style.display="none",!1):"none"!=t.style.display)},x3dom.Runtime.prototype.properties=function(){return this.canvas.doc.properties},x3dom.Runtime.prototype.backendName=function(){return this.canvas.backend},x3dom.Runtime.prototype.getFPS=function(){return this.fps},x3dom.Runtime.prototype.isA=function(e,t){var A=!1;return t&&e&&e._x3domNode&&(""===t&&(t="X3DNode"),A=x3dom.isa(e._x3domNode,x3dom.nodeTypesLC[t.toLowerCase()])),A},x3dom.Runtime.prototype.getPixelScale=function(){var e=this.viewpoint();if(!x3dom.isa(e,x3dom.nodeTypes.OrthoViewpoint))return x3dom.debug.logError("getPixelScale is only implemented for orthographic Viewpoints"),null;var t=e.getZoom(),A=t[0],i=t[1],o=t[2],s=t[3]-i,n=(o-A)/this.getWidth(),r=s/this.getHeight();return new x3dom.fields.SFVec3f(n,r,0)},x3dom.Runtime.prototype.onAnimationStarted=function(){},x3dom.Runtime.prototype.onAnimationFinished=function(){},x3dom.Runtime.prototype.enterVR=function(){this.canvas.enterVR()},x3dom.Runtime.prototype.exitVR=function(){this.canvas.exitVR()},x3dom.Runtime.prototype.toggleVR=function(){this.canvas.xrSession?this.canvas.xrSession&&this.exitVR():this.enterVR()},x3dom.Runtime.prototype.toggleProjection=function(e,t){var A,i=document.getElementById("x3d").runtime.canvas.doc._scene.getNavigationInfo(),o=i._vf.transitionTime,s=document.getElementById(e)._x3domNode,n=document.getElementById(t)._x3domNode;if(i._vf.transitionTime=0,n._bindAnimation=!1,s._bindAnimation=!1,s._vf.isActive)n._viewMatrix=s._viewMatrix,document.getElementById(t).setAttribute("set_bind","true"),A=s._viewMatrix.e3().length()/2.2,n.setZoom(A);else if(n._vf.isActive){s._viewMatrix=n._viewMatrix,document.getElementById(e).setAttribute("set_bind","true"),A=-2.2*n._fieldOfView[2];var r=n._viewMatrix.e2().normalize().multiply(A);s._viewMatrix.setTranslate(r)}return i._vf.transitionTime=o,n._bindAnimation=!0,s._bindAnimation=!0,s._vf.isActive?0:1},x3dom.Runtime.prototype.replaceWorld=function(e){var t,A,i;for(t="X3D"===e.localName.toUpperCase()?e.cloneNode(!1):this.doc.cloneNode(!1);A=e.firstChild;)"HEAD"==(i=1===A.nodeType?A.localName.toUpperCase():null)||"SCENE"==i?t.appendChild(A):A.remove();this.doc.parentNode.replaceChild(t,this.doc),this.doc=t,x3dom.reload()},x3dom.Runtime.prototype.createX3DFromJS=function(e,t){return t&&(e=x3dom.protoExpander.prototypeExpander(t,e)),(new x3dom.JSONParser).parseJavaScript(e)},x3dom.Runtime.prototype.createX3DFromString=function(e,t){try{var A=JSON.parse(e);return this.createX3DFromJS(A,t)}catch(t){var i=new DOMParser,o=i.parseFromString(e,"application/xml"),s=o.querySelector("X3D");return null==s&&(s=(o=i.parseFromString(e,"text/html")).querySelector("X3D")),s}},x3dom.Runtime.prototype.createX3DFromURLPromise=function(e,t){this.canvas.doc.incrementDownloads();var A=this;return fetch(e).then((function(e){return e.text()})).then((function(e){return A.canvas.doc.decrementDownloads(),A.createX3DFromString(e,t)})).catch((function(e){return A.canvas.doc.decrementDownloads(),x3dom.debug.logError("fetch failed: "+e),null}))},x3dom.Runtime.prototype.loadURL=function(e,t){var A=this;this.createX3DFromURLPromise(e,t).then((function(t){null!=t?A.replaceWorld(t):x3dom.debug.logError("loadURL: could not fetch or parse "+e)}))},x3dom.userAgentFeature={supportsDOMAttrModified:!1,supportsMutationObserver:!0},function(){"use strict";var e=function(){var e,t,A,i=document.getElementsByTagName("X3D"),o=[];for(e=0;e<i.length;e++)void 0===i[e].hasRuntime&&o.push(i[e]);var s,n,r,a,d,h,g,l=new x3dom.Properties,I=array_to_object(["showLog","showStat","showProgress","PrimitiveQuality","components","loadpath","disableDoubleClick","backend","altImg","runtimeEnabled","disableKeys","showTouchpoints","disableTouch","maxActiveDownloads","useGeoCache","baseURL"]),c=!1;for(e=0;e<o.length;e++){for(l.setProperty("showLog",o[e].getAttribute("showLog")||"false"),l.setProperty("showStat",o[e].getAttribute("showStat")||"false"),l.setProperty("showProgress",o[e].getAttribute("showProgress")||"true"),l.setProperty("PrimitiveQuality",o[e].getAttribute("PrimitiveQuality")||"High"),l.setProperty("useGeoCache",o[e].getAttribute("useGeoCache")||"true"),l.setProperty("baseURL",o[e].getAttribute("baseURL")||""),A=o[e].getElementsByTagName("PARAM"),t=0;t<A.length;t++)A[t].getAttribute("name")in I&&l.setProperty(A[t].getAttribute("name"),A[t].getAttribute("value"));"true"===l.getProperty("showLog")&&(c=!0)}for(1==c?x3dom.debug.activate(!0):x3dom.debug.activate(!1),o=o.map((function(e){return e.hasRuntime=!0,e})),void 0!==x3dom.about&&x3dom.debug.logInfo("X3DOM "+x3dom.about.version+", Build: "+x3dom.about.build+", Revison: <a href='https://github.com/x3dom/x3dom/tree/"+x3dom.about.revision+"'>"+x3dom.about.revision+"</a>, Date: "+x3dom.about.date),x3dom.debug.logInfo("Found "+o.length+" X3D and nodes..."),e=0;e<o.length;e++)s=o[e],n=new x3dom.X3DCanvas(s,x3dom.canvases.length),x3dom.canvases.push(n),null!==n.gl?(h=(new Date).getTime(),o[e].runtime=new x3dom.Runtime(o[e],n),o[e].runtime.initialize(o[e],n),x3dom.runtime.ready&&(o[e].runtime.ready=x3dom.runtime.ready),""==n.backend&&x3dom.runtime.noBackendFound(),n.load(o[e],e,l),"true"===l.getProperty("showStat")?o[e].runtime.statistics(!0):o[e].runtime.statistics(!1),"true"===l.getProperty("showProgress")?("bar"===l.getProperty("showProgress")&&n.progressDiv.setAttribute("class","x3dom-progress bar"),o[e].runtime.processIndicator(!0)):o[e].runtime.processIndicator(!1),g=(new Date).getTime()-h,x3dom.debug.logInfo("Time for setup and init of GL element no. "+e+": "+g+" ms.")):((r=document.createElement("div")).setAttribute("class","x3dom-nox3d"),r.setAttribute("id","x3dom-nox3d"),(a=document.createElement("p")).appendChild(document.createTextNode("WebGL is not yet supported in your browser. ")),(d=document.createElement("a")).setAttribute("href","http://www.x3dom.org/?page_id=9"),d.appendChild(document.createTextNode("Follow link for a list of supported browsers... ")),r.appendChild(a),r.appendChild(d),n.x3dElem.appendChild(r),n.stateViewer&&s.removeChild(n.stateViewer.viewer));var f;f=null,document.createEvent?((f=document.createEvent("Events")).initEvent("load",!0,!0),document.dispatchEvent(f)):document.createEventObject&&(f=document.createEventObject(),document.body.fireEvent("onload",f))},t=function(){if(x3dom.canvases&&x3dom.canvases.length>0&&x3dom.canvases[0].doc){for(var e=0;e<x3dom.canvases.length;e++)x3dom.canvases[e].doc.shutdown(x3dom.canvases[e].gl);x3dom.canvases=[]}};x3dom.reload=function(){e()},window.addEventListener?(window.addEventListener("load",e,!1),window.addEventListener("unload",t,!1),window.addEventListener("reload",t,!1)):window.attachEvent&&(window.attachEvent("onload",e),window.attachEvent("onunload",t),window.attachEvent("onreload",t)),"complete"===document.readyState&&window.setTimeout((function(){e()}),20)}(),x3dom.Cache=function(){this.textures=[],this.shaders=[]},x3dom.Cache.prototype.getTexture2D=function(e,t,A,i,o,s,n,r,a){var d=A;return void 0===this.textures[d]&&(this.textures[d]=x3dom.Utils.createTexture2D(e,t,A,i,o,s,n,r,a)),this.textures[d]},x3dom.Cache.prototype.getTexture2DByDEF=function(e,t,A){var i=t.name+"_"+A;return void 0===this.textures[i]&&(this.textures[i]=e.createTexture()),this.textures[i]},x3dom.Cache.prototype.getTextureCube=function(e,t,A,i,o,s,n,r){for(var a="",d=0;d<A.length;++d)a+=A[d]+"|";return void 0===this.textures[a]&&(this.textures[a]=x3dom.Utils.createTextureCube(e,t,A,i,o,s,n,r)),this.textures[a]},x3dom.Cache.prototype.getShader=function(e,t){var A=null;if(void 0===this.shaders[t]){switch(t){case x3dom.shader.PICKING:A=new x3dom.shader.PickingShader(e);break;case x3dom.shader.PICKING_24:A=new x3dom.shader.Picking24Shader(e);break;case x3dom.shader.PICKING_ID:A=new x3dom.shader.PickingIdShader(e);break;case x3dom.shader.PICKING_COLOR:A=new x3dom.shader.PickingColorShader(e);break;case x3dom.shader.PICKING_TEXCOORD:A=new x3dom.shader.PickingTexcoordShader(e);break;case x3dom.shader.FRONTGROUND_TEXTURE:A=new x3dom.shader.FrontgroundTextureShader(e);break;case x3dom.shader.BACKGROUND_TEXTURE:A=new x3dom.shader.BackgroundTextureShader(e);break;case x3dom.shader.BACKGROUND_SKYTEXTURE:A=new x3dom.shader.BackgroundSkyTextureShader(e);break;case x3dom.shader.BACKGROUND_CUBETEXTURE:A=new x3dom.shader.BackgroundCubeTextureShader(e);break;case x3dom.shader.BACKGROUND_CUBETEXTURE_DDS:A=new x3dom.shader.BackgroundCubeTextureDDSShader(e);break;case x3dom.shader.SHADOW:A=new x3dom.shader.ShadowShader(e);break;case x3dom.shader.BLUR:A=new x3dom.shader.BlurShader(e);break;case x3dom.shader.DEPTH:break;case x3dom.shader.NORMAL:A=new x3dom.shader.NormalShader(e);break;case x3dom.shader.TEXTURE_REFINEMENT:A=new x3dom.shader.TextureRefinementShader(e)}A?this.shaders[t]=x3dom.Utils.wrapProgram(e,A,t):x3dom.debug.logError("Couldn't create shader: "+t)}return this.shaders[t]},x3dom.Cache.prototype.getDynamicShader=function(e,t,A){var i=x3dom.Utils.generateProperties(t,A),o=i.id;if(void 0===this.shaders[o]){var s=null;s=-1!=i.CSHADER?new x3dom.shader.ComposedShader(e,A):new x3dom.shader.DynamicShader(e,i),this.shaders[o]=x3dom.Utils.wrapProgram(e,s,o)}return this.shaders[o]},x3dom.Cache.prototype.getShaderByProperties=function(e,t,A,i,o){var s=A.id;if(null!=i&&(s+=i),null!=o&&(s+="S"),void 0===this.shaders[s]){var n=null;if(null!=i)n=new x3dom.shader.DynamicShaderPicking(e,A,i);else if(null!=o)n=new x3dom.shader.DynamicShadowShader(e,A);else if(-1!=A.CSHADER)n=new x3dom.shader.ComposedShader(e,t);else if(null!=A.KHR_MATERIAL_COMMONS&&0!=A.KHR_MATERIAL_COMMONS)n=new x3dom.shader.KHRMaterialCommonsShader(e,A);else{if(null!=A.EMPTY_SHADER&&0!=A.EMPTY_SHADER)return{shaderID:s};n=new x3dom.shader.DynamicShader(e,A)}this.shaders[s]=x3dom.Utils.wrapProgram(e,n,s)}return this.shaders[s]},x3dom.Cache.prototype.getShadowRenderingShader=function(e,t,A){for(var i="shadow"+Object.values(A).join(""),o=0;o<t.length;o++)x3dom.isa(t[o],x3dom.nodeTypes.SpotLight)?i+="S":x3dom.isa(t[o],x3dom.nodeTypes.PointLight)?i+="P":i+="D";if(void 0===this.shaders[i]){var s=new x3dom.shader.ShadowRenderingShader(e,t,A);this.shaders[i]=x3dom.Utils.wrapProgram(e,s,i)}return this.shaders[i]},x3dom.Cache.prototype.Release=function(e){for(var t in this.textures)e.deleteTexture(this.textures[t]);for(var A in this.textures=[],this.shaders){for(var i=this.shaders[A],o=e.getAttachedShaders(i.program),s=0;s<o.length;++s)e.detachShader(i.program,o[s]),e.deleteShader(o[s]);e.deleteProgram(i.program)}this.shaders=[]},x3dom.Texture=function(e,t,A,i){this.gl=e,this.doc=t,this.cache=A,this.node=i,this.samplerName="diffuseMap",this.type=e.TEXTURE_2D,this.format=e.RGBA,this.magFilter=e.LINEAR,this.minFilter=e.LINEAR,this.wrapS=e.REPEAT,this.wrapT=e.REPEAT,this.genMipMaps=!1,this.texture=null,this.ready=!1,this.anisotropicDegree=1,this.dashtexture=!1;var o=this.node;if(this.node._x3domTexture=this,x3dom.isa(o,x3dom.nodeTypes.MovieTexture)&&-1!==o._vf.url[0].indexOf("mpd",o._vf.url[0].length-"mpd".length)){this.dashtexture=!0;var s=document.getElementById("AdditionalDashVideoScript");s||((s=document.createElement("script")).setAttribute("type","text/javascript"),s.setAttribute("src",x3dom.Texture.dashVideoScriptFile),s.setAttribute("id","AdditionalDashVideoScript"),s.onload=function(){for(var e;e=x3dom.Texture.loadDashVideos.pop();)x3dom.Texture.textNum++,e.update();s.ready=!0},document.getElementsByTagName("head")[0].appendChild(s)),!0===s.ready?(x3dom.Texture.textNum++,this.update()):x3dom.Texture.loadDashVideos.push(this)}this.dashtexture||this.update()},x3dom.Texture.dashVideoScriptFile="dash.all.js",x3dom.Texture.loadDashVideos=[],x3dom.Texture.textNum=0,x3dom.Texture.clampFontSize=!1,x3dom.Texture.minFontQuality=.5,x3dom.Texture.maxFontQuality=10,x3dom.Texture.prototype.update=function(){x3dom.isa(this.node,x3dom.nodeTypes.Text)?this.updateText():this.updateTexture(),this.node.validateGLObject()},x3dom.Texture.prototype.setPixel=function(e,t,A,i){var o=this.gl,s=new Uint8Array(A);o.bindTexture(this.type,this.texture),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.texSubImage2D(this.type,0,e,t,1,1,this.format,o.UNSIGNED_BYTE,s),o.bindTexture(this.type,null),i&&(this.doc.needRender=!0)},x3dom.Texture.prototype.updateTexture=function(){var e=this.gl,t=this.doc,A=this.node;if(this.samplerName=A._type,x3dom.isa(A,x3dom.nodeTypes.X3DEnvironmentTextureNode)?this.type=e.TEXTURE_CUBE_MAP:this.type=e.TEXTURE_2D,x3dom.isa(A,x3dom.nodeTypes.PixelTexture))switch(A._vf.image.comp){case 1:this.format=e.LUMINANCE;break;case 2:this.format=e.LUMINANCE_ALPHA;break;case 3:this.format=e.RGB;break;case 4:this.format=e.RGBA}else this.format=e.RGBA;if(null!==A._cf.textureProperties.node){var i=A._cf.textureProperties.node;this.wrapS=x3dom.Utils.boundaryModesDic(e,i._vf.boundaryModeS),this.wrapT=x3dom.Utils.boundaryModesDic(e,i._vf.boundaryModeT),this.minFilter=x3dom.Utils.minFilterDic(e,i._vf.minificationFilter),this.magFilter=x3dom.Utils.magFilterDic(e,i._vf.magnificationFilter),this.anisotropicDegree=Math.min(Math.max(i._vf.anisotropicDegree,1),x3dom.caps.MAX_ANISOTROPY),!0===i._vf.generateMipMaps?(this.genMipMaps=!0,this.minFilter==e.NEAREST?this.minFilter=e.NEAREST_MIPMAP_NEAREST:this.minFilter==e.LINEAR&&(this.minFilter=e.LINEAR_MIPMAP_LINEAR),this.texture&&(this.texture.ready||this.texture.textureCubeReady)&&(e.bindTexture(this.type,this.texture),e.generateMipmap(this.type),e.bindTexture(this.type,null))):(this.genMipMaps=!1,this.minFilter==e.LINEAR_MIPMAP_LINEAR||this.minFilter==e.LINEAR_MIPMAP_NEAREST?this.minFilter=e.LINEAR:this.minFilter!=e.NEAREST_MIPMAP_LINEAR&&this.minFilter!=e.NEAREST_MIPMAP_NEAREST||(this.minFilter=e.NEAREST))}else 0==A._vf.repeatS?this.wrapS=e.CLAMP_TO_EDGE:this.wrapS=e.REPEAT,0==A._vf.repeatT?this.wrapT=e.CLAMP_TO_EDGE:this.wrapT=e.REPEAT,"displacementMap"==this.samplerName&&(this.wrapS=e.CLAMP_TO_EDGE,this.wrapT=e.CLAMP_TO_EDGE,this.minFilter=e.NEAREST,this.magFilter=e.NEAREST);var o=A._video&&!0===A._needPerFrameUpdate;if(A._isCanvas&&A._canvas)null==this.texture&&(this.texture=e.createTexture()),this.texture.width=A._canvas.width,this.texture.height=A._canvas.height,this.texture.ready=!0,e.bindTexture(this.type,this.texture),e.texImage2D(this.type,0,this.format,this.format,e.UNSIGNED_BYTE,A._canvas),this.genMipMaps&&e.generateMipmap(this.type),e.bindTexture(this.type,null);else if(x3dom.isa(A,x3dom.nodeTypes.RenderedTexture))A._webgl&&A._webgl.fbo?A._webgl.fbo.dtex&&A._vf.depthMap?this.texture=A._webgl.fbo.dtex:this.texture=A._webgl.fbo.tex:(this.texture=null,x3dom.debug.logError("Try updating RenderedTexture without FBO initialized!")),this.texture&&(this.texture.ready=!0);else if(x3dom.isa(A,x3dom.nodeTypes.PixelTexture)){0==A._vf.origChannelCount&&A.setOrigChannelCount(A._vf.image.comp),null==this.texture&&(this.node._DEF?this.texture=this.cache.getTexture2DByDEF(e,this.node._nameSpace,this.node._DEF):this.texture=e.createTexture()),this.texture.width=A._vf.image.width,this.texture.height=A._vf.image.height,this.texture.ready=!0;var s=A._vf.image.array,n=A._vf.image.width*A._vf.image.height*A._vf.image.comp,r=new Uint8Array(n);r.set(s),e.bindTexture(this.type,this.texture),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(this.type,0,this.format,A._vf.image.width,A._vf.image.height,0,this.format,e.UNSIGNED_BYTE,r),this.genMipMaps&&e.generateMipmap(this.type),e.bindTexture(this.type,null)}else if(x3dom.isa(A,x3dom.nodeTypes.MovieTexture)||o){var a=this,d=document.getElementsByTagName("body")[0];if(null==this.texture&&(this.texture=e.createTexture()),this.dashtexture){var h=document.createElement("div");h.setAttribute("class","dash-video-player"+x3dom.Texture.textNum),A._video=document.createElement("video"),A._video.setAttribute("preload","auto"),A._video.setAttribute("muted","muted");var g=document.createElement("script");g.setAttribute("type","text/javascript"),g.innerHTML='startDashVideo("'+A._vf.url[0]+'",".dash-video-player'+x3dom.Texture.textNum+' video")',h.appendChild(g),h.appendChild(A._video),d.appendChild(h),A._video.style.visibility="hidden",A._video.style.display="none"}else{o||(A._video=document.createElement("video"),A._video.setAttribute("preload","auto"),A._video.setAttribute("muted","muted"),A._video.setAttribute("autoplay",""),A._video.setAttribute("playsinline",""),A._video.crossOrigin="anonymous",A._video.load());for(var l=0;l<A._vf.url.length;l++){var I=A._nameSpace.getURL(A._vf.url[l]);x3dom.debug.logInfo("Adding video file: "+I);var c=document.createElement("source");c.setAttribute("src",I),A._video.appendChild(c)}}var f=function(){e.bindTexture(a.type,a.texture),e.texImage2D(a.type,0,a.format,a.format,e.UNSIGNED_BYTE,A._video),a.genMipMaps&&e.generateMipmap(a.type),e.bindTexture(a.type,null),a.texture.ready=!0,t.needRender=!0},u=function(){window.removeEventListener("mousedown",u),window.removeEventListener("keydown",u),A._video instanceof HTMLMediaElement?A._video.play().then((function(){A._intervalID&&(x3dom.debug.logInfo("The video has already started, startVideo() is called repeatedly."),clearInterval(A._intervalID),A._intervalID=null),A._intervalID=setInterval(f,16)})).catch((function(e){x3dom.debug.logInfo("Waiting for interaction: "+e),window.addEventListener("mousedown",u),window.addEventListener("keydown",u)})):x3dom.debug.logInfo("No video exists.")};A._video.startVideo=u,A._video.pauseVideo=function(){window.removeEventListener("mousedown",u),window.removeEventListener("keydown",u),A._video.pause(),clearInterval(A._intervalID),A._intervalID=null},A._video.addEventListener("canplaythrough",u,!0),A._video.addEventListener("ended",(function(){clearInterval(A._intervalID),A._intervalID=null,!0===A._vf.loop&&(A._video.play(),A._intervalID=setInterval(f,16))}),!0)}else x3dom.isa(A,x3dom.nodeTypes.X3DEnvironmentTextureNode)?this.texture=this.cache.getTextureCube(e,t,A.getTexUrl(),!1,A._vf.crossOrigin,A._vf.scale,this.genMipMaps,A._vf.flipY):this.texture=this.cache.getTexture2D(e,t,A._nameSpace.getURL(A._vf.url[0]),!1,A._vf.crossOrigin,A._vf.scale,this.genMipMaps,A._vf.flipY,A)},x3dom.Texture.prototype.updateText=function(){var e=this.gl;this.wrapS=e.CLAMP_TO_EDGE,this.wrapT=e.CLAMP_TO_EDGE,this.type=e.TEXTURE_2D,this.format=e.RGBA,this.magFilter=e.LINEAR,this.minFilter=e.LINEAR_MIPMAP_LINEAR,this.genMipMaps=!0,x3dom.caps.MAX_ANISOTROPY&&(this.anisotropicDegree=x3dom.caps.MAX_ANISOTROPY);var t=this.node._cf.fontStyle.node,A="serif",i="normal",o="left",s=1,n=1,r=2,a="FIRST";if(null!==t){var d=t._vf.family.toString();switch(A=(d=(d=d.trim().replace(/\'/g,"").replace(/\,/," ")).split(" ")).map((function(e){return"SANS"==e?"Verdana, sans-serif":"SERIF"==e?"Georgia, serif":"TYPEWRITER"==e?"monospace":""+e})).join(","),(i=t._vf.style.toString().replace(/\'/g,"")).toUpperCase()){case"PLAIN":i="normal";break;case"BOLD":i="bold";break;case"ITALIC":i="italic";break;case"BOLDITALIC":i="italic bold";break;default:i="normal"}var h=t._vf.leftToRight?"ltr":"rtl",g=t._vf.topToBottom,l="ltr"==h?"left":"right",I="ltr"==h?"right":"left";switch((o=t._vf.justify[0].toString().replace(/\'/g,"")).toUpperCase()){case"BEGIN":o=l;break;case"END":o=I;break;case"FIRST":o=l;break;case"MIDDLE":o="center";break;default:o=l}if(void 0===t._vf.justify[1])a="FIRST";else switch((a=t._vf.justify[1].toString().replace(/\'/g,"")).toUpperCase()){case"BEGIN":a="BEGIN";break;case"FIRST":a="FIRST";break;case"MIDDLE":a="MIDDLE";break;case"END":a="END";break;default:a="FIRST"}s=t._vf.size,n=t._vf.spacing,t._vf.horizontal,t._vf.language,r=t._vf.quality,r=Math.max(x3dom.Texture.minFontQuality,r),r=Math.min(x3dom.Texture.maxFontQuality,r),s<.1&&(s=.1),x3dom.Texture.clampFontSize&&s>2.3&&(s=2.3)}var c,f,u=this.node._vf.string,C=this.node._vf.maxExtent,_=[],m=o,p=document.createElement("canvas");p.dir=h;var E=32*s;document.body.appendChild(p);var B=p.getContext("2d");B.font=i+" "+E+"px "+A;var Q,x,v,y=0;for(v=0;v<u.length;v++)(Q=B.measureText(u[v]).width)>y&&(y=Q),x=0|this.node._vf.length[v],C>0&&(x>C||0==x)&&(x=C),_[v]=x<=0?Q:32*x;var F=.25*E,D=y+F,S=E+E*n*(u.length-1)+F;c=0,f=0;var w=0,N=0,T="alphabetic";switch(o){case"center":w=-D/2,c=D/2;break;case"left":w=0,c=0;break;case"right":w=-D,c=D}switch(a){case"MIDDLE":N=S/2-F/2,T="middle",f=E/2;break;case"BEGIN":N=g?0:S-F,T=g?"top":"bottom",f=g?0:E;break;case"FIRST":N=g?E:S-F,T=g?"alphabetic":"bottom",f=E;break;case"END":N=g?S-F:0,T=g?"bottom":"top",f=g?E:0}var b=D*(1/32),M=S*(1/32),R=x3dom.caps.MAX_TEXTURE_SIZE>>2;w*=1/32,N*=1/32,p.width=Math.min(x3dom.Utils.nextHighestPowerOfTwo(D*r),R),p.height=Math.min(x3dom.Utils.nextHighestPowerOfTwo(S*r),R),p.dir=h,B.scale(p.width/D,p.height/S),B.fillStyle="rgba(0,0,0,0)",B.fillRect(0,0,B.canvas.width,B.canvas.height),B.fillStyle="white",B.textBaseline=T,B.font=i+" "+E+"px "+A,B.textAlign=m;var G={font_style:i,font_family:A,font_spacing:n,paragraph:u,topToBottom:g,leftToRight:h,textX:c,textY:f,textHeight:E,lengths:_};this.renderScaledText(B,1,G),null===this.texture&&(this.texture=e.createTexture()),e.bindTexture(this.type,this.texture),this.uploadTextMipmap(p,G),e.bindTexture(this.type,null),document.body.removeChild(p),this.node._mesh._positions[0]=[0+w,-M+N,0,b+w,-M+N,0,b+w,0+N,0,0+w,0+N,0],this.node.invalidateVolume(),this.node._parentNodes.forEach((function(e){e.setAllDirty()}))},x3dom.Texture.prototype.renderScaledText=function(e,t,A){e.font=A.font_style+" "+A.textHeight/t+"px "+A.font_family;for(var i=A.textY,o=0;o<A.paragraph.length;o++){var s=A.topToBottom?o:A.paragraph.length-1-o,n=A.paragraph[s];"rtl"==A.leftToRight&&(n="‮"+n),e.fillText(n,A.textX/t,i/t,A.lengths[s]/t),i+=A.textHeight*A.font_spacing}},x3dom.Texture.prototype.uploadTextMipmap=function(e,t){for(var A=this.gl,i=e.width,o=e.height,s=0,n=1,r=i,a=o,d=e.getContext("2d");A.texImage2D(this.type,s++,this.format,this.format,A.UNSIGNED_BYTE,d.getImageData(0,0,r,a)),1!=r||1!=a;)r=Math.max(1,r>>1),a=Math.max(1,a>>1),d.clearRect(0,0,i,o),n*=2,this.renderScaledText(d,n,t)},x3dom.X3DDocument=function(e,t,A){this.canvas=e,this.ctx=t,this.properties=A,this.needRender=!0,this._x3dElem=null,this._scene=null,this._viewarea=null,this.downloadCount=0,this.previousDownloadCount=0,this.mutationObserver=new MutationObserver(this.onMutation.bind(this)),this.X3DMutationObserver=new MutationObserver(this.onX3DMutation.bind(this)),this._nodeBag={timer:[],lights:[],clipPlanes:[],followers:[],trans:[],renderTextures:[],viewarea:[],affectedPointingSensors:[]},this.onload=function(){},this.onerror=function(){}},x3dom.X3DDocument.prototype.load=function(e,t){var A={},i=[e],o=this;!function s(){if(0===i.length)return o._setup(A[e],A,t),void o.onload();var n=i.shift();!x3dom.isX3DElement(n)||"x3d"!==n.localName.toLowerCase()&&"websg"!==n.localName.toLowerCase()||(A[n]=n,o._x3dElem=n,s())}()},x3dom.findScene=function(e){for(var t=[],A=0;A<e.childNodes.length;A++){var i=e.childNodes[A];i&&i.localName&&"scene"===i.localName.toLowerCase()&&t.push(i)}return t.length>1?(x3dom.debug.logError("X3D element has more than one Scene child (has "+e.childNodes.length+")."),null):t[0]},x3dom.X3DDocument.prototype._setup=function(e){var t=x3dom.findScene(e);this.X3DMutationObserver.observe(document,{attributes:!1,attributeOldValue:!1,childList:!0,subtree:!0}),this.mutationObserver.observe(e,{attributes:!1,attributeOldValue:!1,childList:!0,subtree:!1}),this.mutationObserver.observe(t,{attributes:!0,attributeOldValue:!0,childList:!0,subtree:!0}),this._bindableBag=new x3dom.BindableBag(this);var A=new x3dom.NodeNameSpace("scene",this).setupTree(t);this._scene=A,this._bindableBag.setRefNode(A),this._viewarea=new x3dom.Viewarea(this,A),this._viewarea._width=this.canvas.width,this._viewarea._height=this.canvas.height},x3dom.X3DDocument.prototype.advanceTime=function(e){var t=0;if(this._nodeBag.timer.length)for(t=0;t<this._nodeBag.timer.length;t++)this.needRender|=this._nodeBag.timer[t].tick(e);if(this._nodeBag.followers.length)for(t=0;t<this._nodeBag.followers.length;t++)this.needRender|=this._nodeBag.followers[t].tick(e);if(this._nodeBag.trans.length)for(t=0;t<this._nodeBag.trans.length;t++)this.needRender|=this._nodeBag.trans[t].tick(e);if(this._nodeBag.viewarea.length)for(t=0;t<this._nodeBag.viewarea.length;t++)this.needRender|=this._nodeBag.viewarea[t].tick(e)},x3dom.X3DDocument.prototype.render=function(e,t){e&&this._viewarea&&(this._viewarea.setVRFrameData(e,t),this._viewarea.updateGamepads(t),e.renderScene(this._viewarea,t))},x3dom.X3DDocument.prototype.onPick=function(e,t,A){e&&this._viewarea&&e.pickValue(this._viewarea,t,A,1)},x3dom.X3DDocument.prototype.onPickRect=function(e,t,A,i,o){return e&&this._viewarea?e.pickRect(this._viewarea,t,A,i,o):[]},x3dom.X3DDocument.prototype.onMove=function(e,t,A,i){e&&this._viewarea&&(this._viewarea._scene._vf.doPickPass&&e.pickValue(this._viewarea,t,A,i),this._viewarea.onMove(t,A,i))},x3dom.X3DDocument.prototype.onMoveView=function(e,t,A,i,o){e&&this._viewarea&&this._scene.getNavigationInfo()._impl.onTouchDrag(this._viewarea,t,A,i,o)},x3dom.X3DDocument.prototype.onDrag=function(e,t,A,i){e&&this._viewarea&&(this._viewarea._scene._vf.doPickPass&&!this._viewarea._isMoving&&e.pickValue(this._viewarea,t,A,i),this._viewarea.onDrag(t,A,i))},x3dom.X3DDocument.prototype.onWheel=function(e,t,A,i){e&&this._viewarea&&(this._viewarea._scene._vf.doPickPass&&e.pickValue(this._viewarea,t,i,0),this._viewarea.onDrag(t,A,2))},x3dom.X3DDocument.prototype.onMousePress=function(e,t,A,i){e&&this._viewarea&&(this._viewarea._scene.updateVolume(),e.pickValue(this._viewarea,t,A,i),this._viewarea.onMousePress(t,A,i))},x3dom.X3DDocument.prototype.onMouseRelease=function(e,t,A,i,o){if(e&&this._viewarea){var s=o<<8|i;e.pickValue(this._viewarea,t,A,s),this._viewarea.onMouseRelease(t,A,i,o)}},x3dom.X3DDocument.prototype.onMouseOver=function(e,t,A,i){e&&this._viewarea&&(e.pickValue(this._viewarea,t,A,i),this._viewarea.onMouseOver(t,A,i))},x3dom.X3DDocument.prototype.onMouseOut=function(e,t,A,i){e&&this._viewarea&&(e.pickValue(this._viewarea,t,A,i),this._viewarea.onMouseOut(t,A,i))},x3dom.X3DDocument.prototype.onDoubleClick=function(e,t,A){e&&this._viewarea&&this._viewarea.onDoubleClick(t,A)},x3dom.X3DDocument.prototype.onKeyDown=function(e){switch(e){case 37:this._viewarea.strafeLeft();break;case 38:this._viewarea.moveFwd();break;case 39:this._viewarea.strafeRight();break;case 40:this._viewarea.moveBwd()}},x3dom.X3DDocument.prototype.onKeyUp=function(e){var t=null;switch(e){case 13:x3dom.toggleFullScreen();break;case 33:(t=this._scene.getViewpoint()._stack)?t.switchTo("prev"):x3dom.debug.logError("No valid ViewBindable stack.");break;case 34:(t=this._scene.getViewpoint()._stack)?t.switchTo("next"):x3dom.debug.logError("No valid ViewBindable stack.");break;case 35:(t=this._scene.getViewpoint()._stack)?t.switchTo("last"):x3dom.debug.logError("No valid ViewBindable stack.");break;case 36:(t=this._scene.getViewpoint()._stack)?t.switchTo("first"):x3dom.debug.logError("No valid ViewBindable stack.")}},x3dom.X3DDocument.prototype.onKeyPress=function(e){var t=this._scene.getNavigationInfo(),A=this._scene.getEnvironment();switch(e){case 32:var i=this.canvas.parent.stateViewer;i&&i.display(),x3dom.debug.logInfo("a: show all | i: fit view | d: show helper buffers | s: small feature culling | t: light view | m: toggle render mode | c: frustum culling | p: intersect type | \ne: examine mode | f: fly mode | y: freefly mode | w: walk mode | h: helicopter mode | l: lookAt mode | o: lookaround | g: game mode | n: turntable | u: upright position | \nv: print viewpoint info | r: reset view | home: first view | end: last view | pageUp: next view | pageDown: prev. view | +: increase speed | -: decrease speed ");break;case 43:t._vf.speed=2*t._vf.speed,x3dom.debug.logInfo("Changed navigation speed to "+t._vf.speed);break;case 45:t._vf.speed=.5*t._vf.speed,x3dom.debug.logInfo("Changed navigation speed to "+t._vf.speed);break;case 51:x3dom.nodeTypes.PopGeometry.ErrorToleranceFactor+=.5,x3dom.debug.logInfo("Changed POP error tolerance to "+x3dom.nodeTypes.PopGeometry.ErrorToleranceFactor);break;case 52:x3dom.nodeTypes.PopGeometry.ErrorToleranceFactor-=.5,x3dom.debug.logInfo("Changed POP error tolerance to "+x3dom.nodeTypes.PopGeometry.ErrorToleranceFactor);break;case 54:t._vf.typeParams[1]+=1,t._heliUpdated=!1,x3dom.debug.logInfo("Changed helicopter height to "+t._vf.typeParams[1]);break;case 55:t._vf.typeParams[1]-=1,t._heliUpdated=!1,x3dom.debug.logInfo("Changed helicopter height to "+t._vf.typeParams[1]);break;case 56:t._vf.typeParams[0]-=.02,t._heliUpdated=!1,x3dom.debug.logInfo("Changed helicopter angle to "+t._vf.typeParams[0]);break;case 57:t._vf.typeParams[0]+=.02,t._heliUpdated=!1,x3dom.debug.logInfo("Changed helicopter angle to "+t._vf.typeParams[0]);break;case 97:this._viewarea.showAll();break;case 99:A._vf.frustumCulling=!A._vf.frustumCulling,x3dom.debug.logInfo("Viewfrustum culling "+(A._vf.frustumCulling?"on":"off"));break;case 100:void 0===this._viewarea._visDbgBuf&&(this._viewarea._visDbgBuf="true"===this._x3dElem.getAttribute("showLog")),this._viewarea._visDbgBuf=!this._viewarea._visDbgBuf,x3dom.debug.logContainer.style.display=1==this._viewarea._visDbgBuf?"block":"none";break;case 101:t.setType("examine",this._viewarea);break;case 102:t.setType("fly",this._viewarea);break;case 103:t.setType("game",this._viewarea);break;case 104:t.setType("helicopter",this._viewarea);break;case 105:this._viewarea.fit(this._scene._lastMin,this._scene._lastMax);break;case 108:t.setType("lookat",this._viewarea);break;case 109:this._viewarea._points=++this._viewarea._points%2;break;case 110:t.setType("turntable",this._viewarea);break;case 111:t.setType("lookaround",this._viewarea);break;case 112:switch(this._scene._vf.pickMode.toLowerCase()){case"idbuf":this._scene._vf.pickMode="color";break;case"color":this._scene._vf.pickMode="texCoord";break;case"texcoord":this._scene._vf.pickMode="box";break;default:this._scene._vf.pickMode="idBuf"}x3dom.debug.logInfo("Switch pickMode to '"+this._scene._vf.pickMode+"'.");break;case 114:this._viewarea.resetView();break;case 115:A._vf.smallFeatureCulling=!A._vf.smallFeatureCulling,x3dom.debug.logInfo("Small feature culling "+(A._vf.smallFeatureCulling?"on":"off"));break;case 116:this._nodeBag.lights.length>0&&this._viewarea.animateTo(this._viewarea.getLightMatrix()[0],this._scene.getViewpoint());break;case 117:this._viewarea.uprightView();break;case 118:var o=this;!function(){var e=o._viewarea._scene.getViewpoint(),t=o._viewarea.getViewMatrix().inverse(),A=new x3dom.fields.Quaternion(0,0,1,0);A.setValue(t);var i=A.toAxisAngle(),s=t.e3(),n=e.getCenterOfRotation();x3dom.debug.logInfo('\n&lt;Viewpoint position="'+s.x.toFixed(5)+" "+s.y.toFixed(5)+" "+s.z.toFixed(5)+'" orientation="'+i[0].x.toFixed(5)+" "+i[0].y.toFixed(5)+" "+i[0].z.toFixed(5)+" "+i[1].toFixed(5)+'" \n\tzNear="'+e.getNear().toFixed(5)+'" zFar="'+e.getFar().toFixed(5)+'" centerOfRotation="'+n.x.toFixed(5)+" "+n.y.toFixed(5)+" "+n.z.toFixed(5)+'" fieldOfView="'+e.getFieldOfView().toFixed(5)+'" description="'+e._vf.description+'"&gt;&lt;/Viewpoint&gt;')}();break;case 119:t.setType("walk",this._viewarea);break;case 121:t.setType("freefly",this._viewarea)}},x3dom.X3DDocument.prototype.shutdown=function(e){e&&e.shutdown(this._viewarea)},x3dom.X3DDocument.prototype.hasAnimationStateChanged=function(){return!!this._viewarea&&this._viewarea.hasAnimationStateChanged()},x3dom.X3DDocument.prototype.isAnimating=function(){return!!this._viewarea&&this._viewarea.isAnimating()},x3dom.X3DDocument.prototype.incrementDownloads=function(){this.downloadCount++},x3dom.X3DDocument.prototype.decrementDownloads=function(){this.downloadCount--},x3dom.X3DDocument.prototype.cleanNodeBag=function(e,t){for(var A=0,i=e.length;A<i;A++)if(e[A]===t){e.splice(A,1);break}},x3dom.X3DDocument.prototype.removeX3DOMBackendGraph=function(e){for(var t=e.childNodes,A=0,i=t.length;A<i;A++)this.removeX3DOMBackendGraph(t[A]);if(e._x3domNode){var o=e._x3domNode,s=o._nameSpace;if(x3dom.isa(o,x3dom.nodeTypes.X3DShapeNode))o._cleanupGLObjects&&o._cleanupGLObjects(!0),x3dom.nodeTypes.Shape.idMap.nodeID[o._objectID]&&delete x3dom.nodeTypes.Shape.idMap.nodeID[o._objectID];else if(x3dom.isa(o,x3dom.nodeTypes.TimeSensor))this.cleanNodeBag(this._nodeBag.timer,o);else if(x3dom.isa(o,x3dom.nodeTypes.X3DLightNode))this.cleanNodeBag(this._nodeBag.lights,o);else if(x3dom.isa(o,x3dom.nodeTypes.X3DFollowerNode))this.cleanNodeBag(this._nodeBag.followers,o);else if(x3dom.isa(o,x3dom.nodeTypes.X3DTransformNode))this.cleanNodeBag(this._nodeBag.trans,o);else if(x3dom.isa(o,x3dom.nodeTypes.RenderedTexture))this.cleanNodeBag(this._nodeBag.renderTextures,o),o._cleanupGLObjects&&o._cleanupGLObjects();else if(x3dom.isa(o,x3dom.nodeTypes.X3DPointingDeviceSensorNode))this.cleanNodeBag(this._nodeBag.affectedPointingSensors,o);else if(x3dom.isa(o,x3dom.nodeTypes.Texture))o.shutdown();else if(x3dom.isa(o,x3dom.nodeTypes.AudioClip))o.shutdown();else if(x3dom.isa(o,x3dom.nodeTypes.X3DBindableNode)){var n=o._stack;n&&(o.bind(!1),this.cleanNodeBag(n._bindBag,o)),o._cleanupGLObjects&&o._cleanupGLObjects()}else x3dom.isa(o,x3dom.nodeTypes.Scene)&&o._webgl&&(o._webgl=null);if(s&&!e.getAttribute("use")&&!e.getAttribute("USE")){s.removeNode(o._DEF);var r=s.superInlineNode;if(r&&r._nameSpace){var a=r._nameSpace.imports,d=s.exports,h=a.get(r._DEF);h&&d.forEach((function(e,t){o._DEF==e&&h.forEach((function(e,A){t==e&&delete r._nameSpace.defMap[A]}))}))}}o._xmlNode=null,delete e._x3domNode}},x3dom.X3DDocument.prototype.getParentNode=function(e){return e&&"x3dommetagroup"==e.localName.toLowerCase()&&(e=this.getParentNode(e.parentNode)),e},x3dom.X3DDocument.prototype.onAttributeChanged=function(e,t,A){"_x3domNode"in e&&(e._x3domNode.updateField(t,A),this.needRender=!0)},x3dom.X3DDocument.prototype.onNodeRemoved=function(e,t){var A=e;if(A){A.querySelectorAll&&A.querySelectorAll("*").forEach((function(e){e.highlight=null,e.addEventListener=null,e.removeEventListener=null}));var i=this.getParentNode(t);if(i&&"_x3domNode"in i&&"_x3domNode"in A){var o=i._x3domNode,s=A._x3domNode,n=s.findX3DDoc();if(n){var r=n._viewarea._pickingInfo;r.firstObj=null,r.lastObj=null,r.lastClickObj=null,r.pickObj=null}o&&s&&(o.removeChild(s),o.nodeChanged(),this.removeX3DOMBackendGraph(A),this._viewarea&&this._viewarea._scene&&(this._viewarea._scene.nodeChanged(),this._viewarea._scene.updateVolume(),this.needRender=!0))}else if(A.localName&&"ROUTE"==A.localName.toUpperCase()&&A._nodeNameSpace){var a=A._nodeNameSpace.defMap[A.getAttribute("fromNode")],d=A._nodeNameSpace.defMap[A.getAttribute("toNode")];a&&d&&a.removeRoute(A.getAttribute("fromField"),d,A.getAttribute("toField"))}else if(A.localName&&"IMPORT"==A.localName.toUpperCase()&&A._nodeNameSpace){var h=A.getAttribute("inlineDEF")||A.getAttribute("inlinedef"),g=A.getAttribute("importedDEF")||A.getAttribute("importeddef"),l=A.getAttribute("AS")||A.getAttribute("as");if(!h||!g)return;l||(l=g);var I=A._nodeNameSpace.imports,c=I.get(h);c&&c.get(l)==g&&(delete A._nodeNameSpace.defMap[l],c.delete(l),0==c.size&&I.delete(h))}else if(A.localName&&"EXPORT"==A.localName.toUpperCase()&&A._nodeNameSpace){var f=A.getAttribute("localDEF")||A.getAttribute("localdef");l=A.getAttribute("AS")||A.getAttribute("as");if(!f)return;l||(l=f);var u=A._nodeNameSpace.exports;u.get(l)==f&&u.delete(l)}}},x3dom.X3DDocument.prototype.onX3DNodeRemoved=function(e,t){var A=[];"querySelector"in e&&e.querySelector("X3D")&&(A=e.querySelectorAll("X3D")),e.localName&&"X3D"==e.localName.toUpperCase()&&(A=[e]),A.forEach((function(e){var t=e.runtime;if(t&&t.canvas&&t.canvas.doc&&t.canvas.doc._scene){var A=t.canvas.doc._scene._xmlNode;this.removeX3DOMBackendGraph(A);for(var i=0;i<x3dom.canvases.length;i++)if(x3dom.canvases[i]===t.canvas){x3dom.canvases[i].doc.shutdown(x3dom.canvases[i].gl),x3dom.canvases.splice(i,1);break}t.canvas.doc._scene=null,t.canvas.doc._viewarea=null,t.canvas.doc=null,t.canvas=null,t=null,e.context=null,e.runtime=null}}),this)},x3dom.X3DDocument.prototype.onNodeAdded=function(e,t){var A=e,i=this.getParentNode(t);if((!i.tagName||"inline"!=i.tagName.toLowerCase())&&"_x3domNode"in i){var o=i._x3domNode;if(o&&o._nameSpace&&A instanceof Element){if("_x3domNode"in A){if(A._x3domNode._parentNodes.includes(o))return;o.removeChild(A._x3domNode),this.removeX3DOMBackendGraph(A)}x3dom.caps.DOMNodeInsertedEvent_perSubtree&&this.removeX3DOMBackendGraph(A);var s=o._nameSpace.setupTree(A);o.addChild(s,A.getAttribute("containerField")),o.nodeChanged();var n=i.parentNode;n&&n._x3domNode&&n._x3domNode.nodeChanged(),this._viewarea&&this._viewarea._scene&&(this._viewarea._scene.nodeChanged(),this._viewarea._scene.updateVolume(),this.needRender=!0)}else x3dom.debug.logWarning("No _nameSpace in onNodeAdded")}},x3dom.X3DDocument.prototype.onX3DNodeAdded=function(e,t){var A=e;A.localName&&A.localName.toUpperCase()},x3dom.X3DDocument.prototype.onMutation=function(e){var t,A,i,o;for(t=0,A=e.length;t<A;t++)if("attributes"===(i=e[t]).type)(null!=i.oldValue||i.attributeName.startsWith("set_"))&&(o=i.target.getAttribute(i.attributeName),this.onAttributeChanged(i.target,i.attributeName,o));else if("childList"===i.type){if(i.removedNodes.length)for(var s=0,n=i.removedNodes.length;s<n;s++)this.onNodeRemoved(i.removedNodes[s],i.target);if(i.addedNodes.length)for(s=0,n=i.addedNodes.length;s<n;s++)this.onNodeAdded(i.addedNodes[s],i.target)}},x3dom.X3DDocument.prototype.onX3DMutation=function(e){for(var t=0,A=e.length;t<A;t++)if("childList"===e[t].type&&e[t].removedNodes.length)for(var i=0,o=e[t].removedNodes.length;i<o;i++)this.onX3DNodeRemoved(e[t].removedNodes[i],e[t].target)},x3dom.MatrixMixer=function(e,t){this.beginTime=e||0,this.endTime=t||1,this.isMixing=!1,this._beginMat=x3dom.fields.SFMatrix4f.identity(),this._beginInvMat=x3dom.fields.SFMatrix4f.identity(),this._beginLogMat=x3dom.fields.SFMatrix4f.identity(),this._endMat=x3dom.fields.SFMatrix4f.identity(),this._endLogMat=x3dom.fields.SFMatrix4f.identity(),this._beginRot=new x3dom.fields.Quaternion,this._endRot=new x3dom.fields.Quaternion,this._beginPos=new x3dom.fields.SFVec3f,this._endPos=new x3dom.fields.SFVec3f,this._result=x3dom.fields.SFMatrix4f.identity(),this._useQuaternion=!1,this._isVPtarget=!1},x3dom.MatrixMixer.prototype._calcFraction=function(e){var t=(e-this.beginTime)/(this.endTime-this.beginTime);return(Math.sin(t*Math.PI-Math.PI/2)+1)/2},x3dom.MatrixMixer.prototype._isValid=function(){var e=this._beginMat.inverse().mult(this._endMat).getEulerAngles();return Math.abs(e[0])!=Math.PI&&Math.abs(e[1])!=Math.PI&&Math.abs(e[2])!=Math.PI},x3dom.MatrixMixer.prototype._prepareQuaternionAnimation=function(){this._beginRot.setValue(this._beginMat),this._endRot.setValue(this._endMat),this._beginPos=this._beginMat.e3(),this._endPos=this._endMat.e3(),this._useQuaternion=!0},x3dom.MatrixMixer.prototype.reset=function(){this.beginTime=0,this.endTime=0,this._useQuaternion=!1,this.isMixing=!1},x3dom.MatrixMixer.prototype.isActive=function(){return this.beginTime>0},x3dom.MatrixMixer.prototype.setBeginMatrix=function(e){this._beginMat.setValues(e),this._beginInvMat=e.inverse(),this._beginLogMat=x3dom.fields.SFMatrix4f.zeroMatrix()},x3dom.MatrixMixer.prototype.getBeginMatrix=function(e){return this._beginMat},x3dom.MatrixMixer.prototype.setEndMatrix=function(e){this._endMat.setValues(e),this._isValid()||this._prepareQuaternionAnimation(),this._endLogMat=this._endMat.mult(this._beginInvMat).log(),this._logDiffMat=this._endLogMat.addScaled(this._beginLogMat,-1)},x3dom.MatrixMixer.prototype.getEndMatrix=function(e){return this._endMat},x3dom.MatrixMixer.prototype._mixQuaternion=function(e){var t=this._beginRot.slerp(this._endRot,e),A=this._beginPos.addScaled(this._endPos.subtract(this._beginPos),e);return this._result.setRotate(t),this._result.setTranslate(A),this._result.copy()},x3dom.MatrixMixer.prototype._mixMatrix=function(e){return this._logDiffMat.multiply(e).add(this._beginLogMat).exp().mult(this._beginMat)},x3dom.MatrixMixer.prototype.mix=function(e){if(e<=this.beginTime)return this._beginMat;if(e>=this.endTime)return this.reset(),this._endMat;this.isMixing=!0;var t=this._calcFraction(e);return this._useQuaternion?this._mixQuaternion(t):this._mixMatrix(t)},x3dom.Mesh=function(e){this._parent=e,this._vol=new x3dom.fields.BoxVolume,this._invalidate=!0,this._numFaces=0,this._numCoords=0,this._primType="TRIANGLES",this._positions=[],this._normals=[],this._texCoords=[],this._texCoords2=[],this._colors=[],this._indices=[],this._tangents=[],this._binormals=[],this._positions[0]=[],this._normals[0]=[],this._texCoords[0]=[],this._texCoords2[0]=[],this._colors[0]=[],this._indices[0]=[],this._tangents[0]=[],this._binormals[0]=[]},x3dom.Mesh.prototype._dynamicFields={},x3dom.Mesh.prototype._numPosComponents=3,x3dom.Mesh.prototype._numTexComponents=2,x3dom.Mesh.prototype._numTex2Components=2,x3dom.Mesh.prototype._numColComponents=3,x3dom.Mesh.prototype._numNormComponents=3,x3dom.Mesh.prototype._numTangentComponents=3,x3dom.Mesh.prototype._numBinormalComponents=3,x3dom.Mesh.prototype._lit=!0,x3dom.Mesh.prototype._vol=null,x3dom.Mesh.prototype._invalidate=!0,x3dom.Mesh.prototype._numFaces=0,x3dom.Mesh.prototype._numCoords=0,x3dom.Mesh.prototype.getVolume=function(){if(1==this._invalidate&&!this._vol.isValid()){var e=this._positions[0],t=e.length;if(t>=3){var A=new x3dom.fields.SFVec3f(e[0],e[1],e[2]);this._vol.setBounds(A,A);for(var i=3;i<t;i+=3)this._vol.min.x>e[i]&&(this._vol.min.x=e[i]),this._vol.min.y>e[i+1]&&(this._vol.min.y=e[i+1]),this._vol.min.z>e[i+2]&&(this._vol.min.z=e[i+2]),this._vol.max.x<e[i]&&(this._vol.max.x=e[i]),this._vol.max.y<e[i+1]&&(this._vol.max.y=e[i+1]),this._vol.max.z<e[i+2]&&(this._vol.max.z=e[i+2]);this._invalidate=!1}}return this._vol},x3dom.Mesh.prototype.invalidate=function(){this._invalidate=!0,this._vol.invalidate()},x3dom.Mesh.prototype.isValid=function(){return this._vol.isValid()},x3dom.Mesh.prototype.getCenter=function(){return this.getVolume().getCenter()},x3dom.Mesh.prototype.getDiameter=function(){return this.getVolume().getDiameter()},x3dom.Mesh.prototype.doIntersect=function(e){var t=this.getVolume(),A=e.intersect(t.min,t.max);return A&&e.enter<e.dist&&(e.dist=e.enter,e.hitObject=this._parent,e.hitPoint=e.pos.add(e.dir.multiply(e.enter))),A},x3dom.Mesh.prototype.calcNormals=function(e,t){void 0===t&&(t=!0);var A,i,o,s,n=this._multiIndIndices&&this._multiIndIndices.length,r=n?this._multiIndIndices:this._indices[0],a=this._positions[0],d=[],h=[],g=a.length,l=null,I=void 0!==this._posSize&&this._posSize>g?this._posSize/3:g/3;for(I=3*(I-Math.floor(I)>0?Math.floor(I+1):I),A=0;A<I;++A)h[A]=[];for(I=r.length,A=0;A<I;A+=3){var c,f,u,C;n?(c=3*A,f=3*(A+1),u=3*(A+2),C=new x3dom.fields.SFVec3f(a[f],a[f+1],a[f+2]),o=new x3dom.fields.SFVec3f(a[c],a[c+1],a[c+2]).subtract(C),s=C.subtract(new x3dom.fields.SFVec3f(a[u],a[u+1],a[u+2]))):(c=3*r[A],f=3*r[A+1],u=3*r[A+2],C=new x3dom.fields.SFVec3f(a[f],a[f+1],a[f+2]),o=new x3dom.fields.SFVec3f(a[c],a[c+1],a[c+2]).subtract(C),s=C.subtract(new x3dom.fields.SFVec3f(a[u],a[u+1],a[u+2])),c=3*A,f=3*(A+1),u=3*(A+2)),l=o.cross(s).normalize(),t||(l=l.negate()),e<=x3dom.fields.Eps?(d[c]=d[f]=d[u]=l.x,d[c+1]=d[f+1]=d[u+1]=l.y,d[c+2]=d[f+2]=d[u+2]=l.z):(h[r[A]].push(l),h[r[A+1]].push(l),h[r[A+2]].push(l))}if(e>x3dom.fields.Eps)for(A=0;A<g;A+=3){var _,m=A/3;for(I=(_=n?h[r[m]]:h[m]).length,l=new x3dom.fields.SFVec3f(0,0,0),i=0;i<I;++i)l=l.add(_[i]);l=l.normalize(),d[A]=l.x,d[A+1]=l.y,d[A+2]=l.z}this._normals[0]=d},x3dom.Mesh.prototype.splitMesh=function(e,t){var A,i;A=void 0===e?3:e,void 0===t&&(t=!1);var o=x3dom.Utils.maxIndexableCoords;if(o=Math.floor(o/A)*A,!(this._positions[0].length/3<=o)||t){i=!!t&&(this._multiIndIndices&&this._multiIndIndices.length);var s=this._positions[0],n=this._normals[0],r=this._texCoords[0],a=this._colors[0],d=i?this._multiIndIndices:this._indices[0],h=this._tangents[0],g=this._binormals[0],l=0;do{this._positions[l]=[],this._normals[l]=[],this._texCoords[l]=[],this._colors[l]=[],this._indices[l]=[],this._tangents[l]=[],this._binormals[l]=[];var I=d.length-(l+1)*o>=0;if(this._indices[l]=I?d.slice(l*o,(l+1)*o):d.slice(l*o),i)for(f=0,u=this._indices[l].length;f<u;f++)this._indices[l][f]=f;else if(l)for(var c=l*o,f=0,u=this._indices[l].length;f<u;f++)this._indices[l][f]-=c;this._positions[l]=I?s.slice(l*o*3,3*(l+1)*o):s.slice(l*o*3),n.length&&(this._normals[l]=I?n.slice(l*o*3,3*(l+1)*o):n.slice(l*o*3)),r.length&&(this._texCoords[l]=I?r.slice(l*o*this._numTexComponents,this._numTexComponents*(l+1)*o):r.slice(l*o*this._numTexComponents)),a.length&&(this._colors[l]=I?a.slice(l*o*this._numColComponents,this._numColComponents*(l+1)*o):a.slice(l*o*this._numColComponents)),h.length&&(this._tangents[l]=I?h.slice(l*o*3,3*(l+1)*o):h.slice(l*o*3)),g.length&&(this._binormals[l]=I?g.slice(l*o*3,3*(l+1)*o):g.slice(l*o*3))}while(s.length>++l*o*3)}},x3dom.Mesh.prototype.calcTexCoords=function(e){if(this._texCoords[0]=[],"sphere-local"===e.toLowerCase())for(var t=0,A=0,i=this._normals[0].length;t<i;t+=3)this._texCoords[0][A++]=.5+this._normals[0][t]/2,this._texCoords[0][A++]=.5+this._normals[0][t+1]/2;if("coord"===e.toLowerCase())for(var o=0,s=0,n=this._positions[0].length;o<n;o+=3)this._texCoords[0][s++]=this._positions[0][o],this._texCoords[0][s++]=this._positions[0][o+1];else{var r=new x3dom.fields.SFVec3f(0,0,0),a=new x3dom.fields.SFVec3f(0,0,0);this.getVolume().getBounds(r,a);var d=a.subtract(r),h=0,g=1;d.x>=d.y?d.x>=d.z?(h=0,g=d.y>=d.z?1:2):(h=2,g=0):d.y>=d.z?(h=1,g=d.x>=d.z?0:2):(h=2,g=1);var l=1,I=0,c=0;switch(h){case 0:l=d.x,I=r.x;break;case 1:l=d.y,I=r.y;break;case 2:l=d.z,I=r.z}switch(g){case 0:d.x,c=r.x;break;case 1:d.y,c=r.y;break;case 2:d.z,c=r.z}for(o=0,s=0,n=this._positions[0].length;o<n;o+=3)this._texCoords[0][s++]=(this._positions[0][o+h]-I)/l,this._texCoords[0][s++]=(this._positions[0][o+g]-c)/l}},x3dom.docs={},x3dom.docs.specURLMap={CADGeometry:"CADGeometry.html",Core:"core.html",DIS:"dis.html",CubeMapTexturing:"env_texture.html",EnvironmentalEffects:"enveffects.html",EnvironmentalSensor:"envsensor.html",Followers:"followers.html",Geospatial:"geodata.html",Geometry2D:"geometry2D.html",Geometry3D:"geometry3D.html",Grouping:"group.html","H-Anim":"hanim.html",Interpolation:"interp.html",KeyDeviceSensor:"keyboard.html",Layering:"layering.html",Layout:"layout.html",Lighting:"lighting.html",Navigation:"navigation.html",Networking:"networking.html",NURBS:"nurbs.html",ParticleSystems:"particle_systems.html",Picking:"picking.html",PointingDeviceSensor:"pointingsensor.html",Rendering:"rendering.html",RigidBodyPhysics:"rigid_physics.html",Scripting:"scripting.html",Shaders:"shaders.html",Shape:"shape.html",Sound:"sound.html",Text:"text.html",Texturing3D:"texture3D.html",Texturing:"texturing.html",Time:"time.html",EventUtilities:"utils.html",VolumeRendering:"volume.html"},x3dom.docs.specBaseURL="https://www.web3d.org/documents/specifications/19775-1/V3.3/Part01/components/",x3dom.docs.getNodeTreeInfo=function(){var e,t="",A=function(e,t){for(var A=0;A<e.length;A++)if(e[A]===t)return!0;return!1},i=function(e,A){for(var o=0;o<A;o++)t+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";for(var o in t+="<a href='"+x3dom.docs.specBaseURL+x3dom.docs.specURLMap[x3dom.nodeTypes[e]._compName]+"#"+e+"' style='color:black; text-decoration:none; font-weight:bold;'>"+e+"</a> &nbsp; <a href='"+x3dom.docs.specBaseURL+x3dom.docs.specURLMap[x3dom.nodeTypes[e]._compName]+"' style='color:black; text-decoration:none; font-style:italic;'>"+x3dom.nodeTypes[e]._compName+"</a><br/>",x3dom.nodeTypes[e].childTypes[e])i(x3dom.nodeTypes[e].childTypes[e][o],A+1)};for(e in x3dom.nodeTypes){var o;for(void 0===(o=x3dom.nodeTypes[e]).childTypes&&(o.childTypes={});o.superClass;)void 0===o.superClass.childTypes[o.superClass._typeName]&&(o.superClass.childTypes[o.superClass._typeName]=[]),A(o.superClass.childTypes[o.superClass._typeName],o._typeName)||o.superClass.childTypes[o.superClass._typeName].push(o._typeName),o=o.superClass}return i("X3DNode",0),"<div class='x3dom-doc-nodes-tree'>"+t+"</div>"},x3dom.docs.getComponentInfo=function(){var e,t,A,i=[],o="";for(t in x3dom.components)i.push(t);for(A in i.sort(),i){for(var s in t=i[A],e=x3dom.components[t],o+="<h2><a href='"+x3dom.docs.specBaseURL+x3dom.docs.specURLMap[t]+"' style='color:black; text-decoration:none; font-style:italic;'>"+t+"</a></h2>",o+="<ul style='list-style-type:circle;'>",e){if(o+="<li><a href='"+x3dom.docs.specBaseURL+x3dom.docs.specURLMap[t]+"#"+s+"' style='color:black; text-decoration:none; font-weight:bold;'>"+s+"</a> <ul>",!s.startsWith("X3D")){try{var n=new x3dom.nodeTypes[s];for(var r in o+="-- basic fields --",n._vf)o+="<li>"+r+": "+n._vf[r],o+="</li>"}catch(e){}try{for(var a in o+="-- node fields --",n._cf)o+="<li>"+a+": "+JSON.stringify(n._cf[a]),o+="</li>"}catch(e){}}o+="</ul> </li>"}o+="</ul>"}return o},x3dom.arc={},x3dom.arc.instance=null,x3dom.arc.Limits=function(e,t,A){this._min=e,this._max=t,this.getValue=function(e){return e=this._min+(this._max-this._min)*e,this._max>=e?this._min<=e?e:this._min:this._max}},x3dom.arc.ARF=function(e,t,A,i,o,s,n,r){this._name=e,this._stateValue=[.5,.5],this._limits=new x3dom.arc.Limits(t,A),this._factorGetterFunc=o,this._factorSetterFunc=s,this._setterFunc=r,this._getterFunc=n,this._dirFac=i,this.getFactor=function(){return this._factorGetterFunc()},this.update=function(e,t){var A=this._stateValue[e]+t*this._dirFac;this._stateValue[e]=0<=A?1>=A?A:1:0,this._setterFunc(this._limits.getValue(this._stateValue[e]))},this.reset=function(){this._stateValue[0]=.5,this._stateValue[1]=.5}},x3dom.arc.AdaptiveRenderControl=defineClass(null,(function(e){x3dom.arc.instance=this,this._scene=e,this._targetFrameRate=[],this._targetFrameRate[0]=this._scene._vf.minFrameRate,this._targetFrameRate[1]=this._scene._vf.maxFrameRate,this._currentState=0;var t=this._scene.getEnvironment();this._arfs=[],this._arfs.push(new x3dom.arc.ARF("smallFeatureCulling",0,10,-1,(function(){return t._vf.smallFeatureFactor}),(function(e){t._vf.smallFeatureFactor=e}),(function(){return t._vf.smallFeatureThreshold}),(function(e){t._vf.smallFeatureThreshold=e}))),this._arfs.push(new x3dom.arc.ARF("lowPriorityCulling",0,100,1,(function(){return t._vf.lowPriorityFactor}),(function(e){t._vf.lowPriorityFactor=e}),(function(){return 100*t._vf.lowPriorityThreshold}),(function(e){t._vf.lowPriorityThreshold=e/100}))),this._arfs.push(new x3dom.arc.ARF("tessellationDetailCulling",1,12,-1,(function(){return t._vf.tessellationErrorFactor}),(function(e){t._vf.tessellationErrorFactor=e}),(function(){return t.tessellationErrorThreshold}),(function(e){t.tessellationErrorThreshold=e}))),this._stepWidth=.1}),{update:function(e,t){this._currentState=e;var A=t-this._targetFrameRate[e];this._stepWidth=Math.abs(A)>10?.1:.01;var i,o=0,s=[],n=this._arfs.length;for(i=0;i<n;++i)s[i]=this._arfs[i].getFactor(),s[i]>0&&(o+=s[i]);var r=A<0?-1:1;for(i=0;i<n;++i)s[i]>0&&(s[i]/=o,this._arfs[i].update(e,this._stepWidth*s[i]*r))},reset:function(){for(var e=0,t=this._arfs.length;e<t;++e)this._arfs[e].reset()}}),x3dom.RequestManager={},x3dom.RequestManager.requests=[],x3dom.RequestManager.maxParallelRequests=50,x3dom.RequestManager.failedRequests=0,x3dom.RequestManager.loadedRequests=0,x3dom.RequestManager.totalRequests=0,x3dom.RequestManager.activeRequests=[],x3dom.RequestManager.requestHeaders=[],x3dom.RequestManager.withCredentials=!1,x3dom.RequestManager.onSendRequest=function(e){},x3dom.RequestManager.onAbortAllRequests=function(e){},x3dom.RequestManager.addRequestHeader=function(e,t){this.requestHeaders.push({header:e,value:t})},x3dom.RequestManager._sendRequest=function(){if(this.onSendRequest(this._getCounters()),!(this.activeRequests.length>this.maxParallelRequests)){var e=this.requests.pop();e&&(this.activeRequests.push(e),e.send(null),this._sendRequest())}},x3dom.RequestManager._getCounters=function(){return{loaded:this.loadedRequests,active:this.activeRequests.length,failed:this.failedRequests,total:this.totalRequests}},x3dom.RequestManager.addRequest=function(e){if(e instanceof XMLHttpRequest){this.totalRequests++,e.withCredentials=this.withCredentials;for(var t=0;t<this.requestHeaders.length;t++){var A=this.requestHeaders[t].header,i=this.requestHeaders[t].value;e.setRequestHeader(A,i)}e.addEventListener("load",this._onLoadHandler.bind(this)),e.addEventListener("error",this._onErrorHandler.bind(this)),this.requests.push(e),this._sendRequest()}},x3dom.RequestManager.abortAllRequests=function(){for(var e=0;e<this.activeRequests.length;e++)this.activeRequests[e].abort();this.requests=[],this.activeRequests=[],this.failedRequests=0,this.loadedRequests=0,this.totalRequests=0,this.onAbortAllRequests(this._getCounters())},x3dom.RequestManager._removeActiveRequest=function(e){var t=this.activeRequests.indexOf(e);return this.activeRequests.splice(t,1)},x3dom.RequestManager._onLoadHandler=function(e){this._removeActiveRequest(e.target),this.loadedRequests++,this._sendRequest()},x3dom.RequestManager._onErrorHandler=function(e){this._removeActiveRequest(e.target),this.failedRequests++,this._sendRequest()},x3dom.Properties=function(){this.properties={}},x3dom.Properties.prototype.setProperty=function(e,t){x3dom.debug.logInfo("Properties: Setting property '"+e+"' to value '"+t+"'"),this.properties[e]=t},x3dom.Properties.prototype.getProperty=function(e,t){return this.properties[e]?this.properties[e]:t},x3dom.Properties.prototype.merge=function(e){for(var t in e.properties)this.properties[t]=e.properties[t]},x3dom.Properties.prototype.toString=function(){var e="";for(var t in this.properties)e+="Name: "+t+" Value: "+this.properties[t]+"\n";return e},x3dom.DoublyLinkedList=function(){this.length=0,this.first=null,this.last=null},x3dom.DoublyLinkedList.ListNode=function(e,t,A,i,o){this.point=e,this.point_index=t,this.normals=A,this.colors=i,this.texCoords=o,this.next=null,this.prev=null},x3dom.DoublyLinkedList.prototype.appendNode=function(e){null===this.first?(e.prev=e,e.next=e,this.first=e,this.last=e):(e.prev=this.last,e.next=this.first,this.first.prev=e,this.last.next=e,this.last=e),this.length++},x3dom.DoublyLinkedList.prototype.insertAfterNode=function(e,t){t.prev=e,t.next=e.next,e.next.prev=t,e.next=t,t.prev==this.last&&(this.last=t),this.length++},x3dom.DoublyLinkedList.prototype.deleteNode=function(e){this.length>1?(e.prev.next=e.next,e.next.prev=e.prev,e==this.first&&(this.first=e.next),e==this.last&&(this.last=e.prev)):(this.first=null,this.last=null),e.prev=null,e.next=null,this.length--},x3dom.DoublyLinkedList.prototype.getNode=function(e){var t=null;if(e>this.length)return t;for(var A=0;A<this.length;A++)if(t=0==A?this.first:t.next,A==e)return t;return null},x3dom.DoublyLinkedList.prototype.invert=function(){for(var e=null,t=this.first,A=0;A<this.length;A++)e=t.prev,t.prev=t.next,t.next=e,t=t.prev;e=this.first,this.first=this.last,this.last=e},x3dom.EarClipping={getIndexes:function(e){var t,A,i,o,s,n=e.first.next,r=this.identifyPlane(n.prev.point,n.point,n.next.point);for(A=[],i=[],t=0;t<e.length;t++){switch(n=e.getNode(t),r){case"XY":o=n.point.x,s=n.point.y;break;case"XZ":o=n.point.z,s=n.point.x;break;default:o=n.point.y,s=n.point.z}A.push(s),A.push(o),i.push(n.point_index)}var a=x3dom.EarCut.triangulate(A,null,2);return a=a.map((function(e){return i[e]}))},getMultiIndexes:function(e){var t,A,i,o=e.first.next,s=this.identifyPlane(o.prev.point,o.point,o.next.point),n={indices:[],point:[],normals:[],colors:[],texCoords:[]},r={indices:[],point:[],normals:[],colors:[],texCoords:[]},a=[];for(t=0;t<e.length;t++){switch(o=e.getNode(t),s){case"XY":A=o.point.x,i=o.point.y;break;case"XZ":A=o.point.z,i=o.point.x;break;default:A=o.point.y,i=o.point.z}a.push(i),a.push(A),r.indices.push(o.point_index),r.point.push(o.point),o.normals&&r.normals.push(o.normals),o.colors&&r.colors.push(o.colors),o.texCoords&&r.texCoords.push(o.texCoords)}var d=x3dom.EarCut.triangulate(a,null,2);return n.indices=d.map((function(e){return r.indices[e]})),n.point=d.map((function(e){return r.point[e]})),o.normals&&(n.normals=d.map((function(e){return r.normals[e]}))),o.colors&&(n.colors=d.map((function(e){return r.colors[e]}))),o.texCoords&&(n.texCoords=d.map((function(e){return r.texCoords[e]}))),n},identifyPlane:function(e,t,A){var i,o,s,n,r,a,d,h,g;i=t.x-e.x,o=t.y-e.y,s=t.z-e.z,n=A.x-e.x,r=A.y-e.y,a=A.z-e.z,d=Math.abs(o*a-s*r),h=Math.abs(s*n-i*a),g=Math.abs(i*r-o*n);var l=Math.max(d,h,g);return l==d?"YZ":l==h?"XZ":l==g?"XY":"XZ"}},x3dom.EarCut={triangulate:function(e,t,A){return function(e,t,A){A=A||2;var n,r,a,d,l,c,f,u=t&&t.length,C=u?t[0]*A:e.length,_=function(e,t,A,i){var o,s,n=0;for(o=t,s=A-i;o<A;o+=i)n+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return n>0}(e,0,C,A),m=i(e,0,C,A,!0,_),p=[];if(!m)return p;u&&(m=function(e,t,A,s){var n,r,a,d,l,c=[];for(n=0,r=t.length;n<r;n++)a=t[n]*s,d=n<r-1?t[n+1]*s:e.length,(l=i(e,a,d,s,!1))===l.next&&(l.steiner=!0),c.push(I(l));for(c.sort(h),n=0;n<c.length;n++)g(c[n],A),A=o(A,A.next);return A}(e,t,m,A));if(e.length>80*A){n=a=e[0],r=d=e[1];for(var E=A;E<C;E+=A)l=e[E],c=e[E+1],l<n&&(n=l),c<r&&(r=c),l>a&&(a=l),c>d&&(d=c);f=Math.max(a-n,d-r)}s(m,p,A,n,r,f),!1===_&&p.reverse();return p}(e,t,A);function i(e,t,A,i,o,s){var n,r;if(o===s)for(n=t;n<A;n+=i)r=E(n,e[n],e[n+1],r);else for(n=A-i;n>=t;n-=i)r=E(n,e[n],e[n+1],r);return r}function o(e,t){if(!e)return e;t||(t=e);var A,i=e;do{if(A=!1,i.steiner||!C(i,i.next)&&0!==u(i.prev,i,i.next))i=i.next;else{if(B(i),(i=t=i.prev)===i.next)return null;A=!0}}while(A||i!==t);return t}function s(e,t,A,i,h,g,I){if(e){!I&&g&&function(e,t,A,i){var o=e;do{null===o.z&&(o.z=l(o.x,o.y,t,A,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,function(e){var t,A,i,o,s,n,r,a,d=1;do{for(A=e,e=null,s=null,n=0;A;){for(n++,i=A,r=0,t=0;t<d&&(r++,i=i.nextZ);t++);for(a=d;r>0||a>0&&i;)0===r?(o=i,i=i.nextZ,a--):0!==a&&i?A.z<=i.z?(o=A,A=A.nextZ,r--):(o=i,i=i.nextZ,a--):(o=A,A=A.nextZ,r--),s?s.nextZ=o:e=o,o.prevZ=s,s=o;A=i}s.nextZ=null,d*=2}while(n>1)}(o)}(e,i,h,g);for(var c,f,u=e;e.prev!==e.next;)if(c=e.prev,f=e.next,g?r(e,i,h,g):n(e))t.push(c.i/A),t.push(e.i/A),t.push(f.i/A),B(e),e=f.next,u=f.next;else if((e=f)===u){I?1===I?s(e=a(e,t,A),t,A,i,h,g,2):2===I&&d(e,t,A,i,h,g):s(o(e),t,A,i,h,g,1);break}}}function n(e){var t=e.prev,A=e,i=e.next;if(u(t,A,i)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(c(t.x,t.y,A.x,A.y,i.x,i.y,o.x,o.y)&&u(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function r(e,t,A,i){var o=e.prev,s=e,n=e.next;if(u(o,s,n)>=0)return!1;for(var r=o.x<s.x?o.x<n.x?o.x:n.x:s.x<n.x?s.x:n.x,a=o.y<s.y?o.y<n.y?o.y:n.y:s.y<n.y?s.y:n.y,d=o.x>s.x?o.x>n.x?o.x:n.x:s.x>n.x?s.x:n.x,h=o.y>s.y?o.y>n.y?o.y:n.y:s.y>n.y?s.y:n.y,g=l(r,a,t,A,i),I=l(d,h,t,A,i),f=e.nextZ;f&&f.z<=I;){if(f!==e.prev&&f!==e.next&&c(o.x,o.y,s.x,s.y,n.x,n.y,f.x,f.y)&&u(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=e.prevZ;f&&f.z>=g;){if(f!==e.prev&&f!==e.next&&c(o.x,o.y,s.x,s.y,n.x,n.y,f.x,f.y)&&u(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function a(e,t,A){var i=e;do{var o=i.prev,s=i.next.next;_(o,i,i.next,s)&&m(o,s)&&m(s,o)&&(t.push(o.i/A),t.push(i.i/A),t.push(s.i/A),B(i),B(i.next),i=e=s),i=i.next}while(i!==e);return i}function d(e,t,A,i,n,r){var a=e;do{for(var d=a.next.next;d!==a.prev;){if(a.i!==d.i&&f(a,d)){var h=p(a,d);return a=o(a,a.next),h=o(h,h.next),s(a,t,A,i,n,r),void s(h,t,A,i,n,r)}d=d.next}a=a.next}while(a!==e)}function h(e,t){return e.x-t.x}function g(e,t){if(t=function(e,t){var A,i=t,o=e.x,s=e.y,n=-1/0;do{if(s<=i.y&&s>=i.next.y){var r=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);r<=o&&r>n&&(n=r,A=i.x<i.next.x?i:i.next)}i=i.next}while(i!==t);if(!A)return null;var a,d=A,h=1/0;i=A.next;for(;i!==d;)o>=i.x&&i.x>=A.x&&c(s<A.y?o:n,s,A.x,A.y,s<A.y?n:o,s,i.x,i.y)&&((a=Math.abs(s-i.y)/(o-i.x))<h||a===h&&i.x>A.x)&&m(i,e)&&(A=i,h=a),i=i.next;return A}(e,t)){var A=p(t,e);o(A,A.next)}}function l(e,t,A,i,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-A)/o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function I(e){var t=e,A=e;do{t.x<A.x&&(A=t),t=t.next}while(t!==e);return A}function c(e,t,A,i,o,s,n,r){return(o-n)*(t-r)-(e-n)*(s-r)>=0&&(e-n)*(i-r)-(A-n)*(t-r)>=0&&(A-n)*(s-r)-(o-n)*(i-r)>=0}function f(e,t){return C(e,t)||e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var A=e;do{if(A.i!==e.i&&A.next.i!==e.i&&A.i!==t.i&&A.next.i!==t.i&&_(A,A.next,e,t))return!0;A=A.next}while(A!==e);return!1}(e,t)&&m(e,t)&&m(t,e)&&function(e,t){var A=e,i=!1,o=(e.x+t.x)/2,s=(e.y+t.y)/2;do{A.y>s!=A.next.y>s&&o<(A.next.x-A.x)*(s-A.y)/(A.next.y-A.y)+A.x&&(i=!i),A=A.next}while(A!==e);return i}(e,t)}function u(e,t,A){return(t.y-e.y)*(A.x-t.x)-(t.x-e.x)*(A.y-t.y)}function C(e,t){return e.x===t.x&&e.y===t.y}function _(e,t,A,i){return u(e,t,A)>0!=u(e,t,i)>0&&u(A,i,e)>0!=u(A,i,t)>0}function m(e,t){return u(e.prev,e,e.next)<0?u(e,t,e.next)>=0&&u(e,e.prev,t)>=0:u(e,t,e.prev)<0||u(e,e.next,t)<0}function p(e,t){var A=new Q(e.i,e.x,e.y),i=new Q(t.i,t.x,t.y),o=e.next,s=t.prev;return e.next=t,t.prev=e,A.next=o,o.prev=A,i.next=A,A.prev=i,s.next=i,i.prev=s,i}function E(e,t,A,i){var o=new Q(e,t,A);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function B(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Q(e,t,A){this.i=e,this.x=t,this.y=A,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}}},x3dom.FieldInterpolator=function(e,t,A,i){this.beginTime=e||0,this.endTime=t||1,this.beginValue=A||0,this.endValue=i||0,this.isInterpolating=!1},x3dom.FieldInterpolator.prototype.isActive=function(){return this.beginTime>0},x3dom.FieldInterpolator.prototype.calcFraction=function(e){var t=(e-this.beginTime)/(this.endTime-this.beginTime);return(Math.sin(t*Math.PI-Math.PI/2)+1)/2},x3dom.FieldInterpolator.prototype.reset=function(){this.isInterpolating=!1,this.beginTime=0,this.endTime=1,this.beginValue=0,this.endValue=0},x3dom.FieldInterpolator.prototype.interpolate=function(e){if(e<this.beginTime)return this.beginValue;if(e>=this.endTime){var t=this.endValue;return this.reset(),t}return this.isInterpolating=!0,this.beginValue+(this.endValue-this.beginValue)*this.calcFraction(e)},x3dom.Utils={},x3dom.Utils.maxIndexableCoords=65535,x3dom.Utils.needLineWidth=!1,x3dom.Utils.measurements=[],window.performance=window.performance||{},performance.now=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return(new Date).getTime()},x3dom.Utils.startMeasure=function(e){var t=e.toUpperCase();x3dom.Utils.measurements[t]||(x3dom.Utils.measurements[t]=performance.now())},x3dom.Utils.stopMeasure=function(e){var t=e.toUpperCase();if(x3dom.Utils.measurements[t]){var A=x3dom.Utils.measurements[t];return delete x3dom.Utils.measurements[t],performance.now()-A}return 0},x3dom.Utils.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},x3dom.Utils.createTexture2D=function(e,t,A,i,o,s,n,r,a){r=r||!1;var d=e.createTexture(),h=new Uint8Array([0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255]);e.bindTexture(e.TEXTURE_2D,d),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,2,2,0,e.RGBA,e.UNSIGNED_BYTE,h),n&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),d.ready=!1;var g=0;if(null==A||""==A)return d;var l=new Image;switch(o.toLowerCase()){case"anonymous":l.crossOrigin="anonymous";break;case"use-credentials":l.crossOrigin="use-credentials";break;case"none":break;default:x3dom.Utils.forbiddenBySOP(A)&&(l.crossOrigin="anonymous")}var I=function(){if(a&&0===a.getOrigChannelCount()){var e=new XMLHttpRequest;e.open("GET",A),e.onloadstart=function(){e.responseType="arraybuffer"},e.onload=function(){var t=e.getResponseHeader("Content-Type"),A=new Uint8Array(e.response),i=x3dom.Utils.detectChannelCount(A,t);i&&a.setOrigChannelCount(i),l.src=x3dom.Utils.arrayBufferToObjectURL(A,t)},e.onerror=function(){x3dom.debug.logError("[Utils|createTexture2D] Can't http request: "+A),l.src=A},x3dom.RequestManager.addRequest(e)}else l.src=A;t.incrementDownloads()};return I(),l.onload=function(){d.originalWidth=l.width,d.originalHeight=l.height,s&&(l=x3dom.Utils.scaleImage(l)),1!=i&&1!=r||e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,d),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,l),n&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),1!=i&&1!=r||e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),d.width=l.width,d.height=l.height,d.ready=!0,t.decrementDownloads(),t.needRender=!0},l.onerror=function(i){x3dom.Utils.tryDDSLoading(d,e,t,A,n,r,a).then((function(){t.decrementDownloads(),t.needRender=!0}),(function(){x3dom.debug.logError("[Utils|createTexture2D] Can't load Image: "+A),t.decrementDownloads(),g++,a&&g<a._vf.url.length&&(A=a._nameSpace.getURL(a._vf.url[g]),I())}))},d},x3dom.Utils.tryDDSLoading=function(e,t,A,i,o,s,n){return x3dom.DDSLoader.load(i).then((function(A){if(A&&(!A.isCompressed||x3dom.caps.COMPRESSED_TEXTURE)){for(var i in t.bindTexture(A.type,e),!1,x3dom.Utils.isPowerOfTwo(A.width)||x3dom.Utils.isPowerOfTwo(A.height)?A.generateMipmaps&&t.texParameteri(A.type,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR):(t.texParameteri(A.type,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(A.type,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(A.type,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(A.type,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),A.generateMipmaps=!1),A.data)for(var o=A.width,s=A.height,r=A.data[i],a=0;a<r.length;a++)0!=a&&(o=Math.max(.5*o,1),s=Math.max(.5*s,1)),A.format.internal<33776||A.format.internal>33779?t.texImage2D(+i,a,A.format.internal,o,s,0,A.format.format,A.format.type,r[a]):(t.compressedTexImage2D(+i,a,A.format.internal,o,s,0,r[a]),A.generateMipmaps=!1);A.generateMipmaps&&t.generateMipmap(A.type),t.bindTexture(A.type,null),e.width=A.width,e.height=A.height,e.ready=!0,e.textureCubeReady=!0,n&&A.channelCount&&n.setOrigChannelCount(A.channelCount)}}))},x3dom.Utils.createTextureCube=function(e,t,A,i,o,s,n,r){var a,d=new Uint8Array([0,0,0,255,0,0,0,255,0,0,0,255,0,0,0,255]),h=e.createTexture();a=i?[e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_X]:[e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_X],h.ready=!1,h.pendingTextureLoads=-1,h.textureCubeReady=!1;for(var g=0,l=0,I=0;I<a.length;I++)e.bindTexture(e.TEXTURE_CUBE_MAP,h),e.texImage2D(a[I],0,e.RGBA,2,2,0,e.RGBA,e.UNSIGNED_BYTE,d),e.bindTexture(e.TEXTURE_CUBE_MAP,null);if(1==A.length)t.incrementDownloads(),x3dom.Utils.tryDDSLoading(h,e,t,A[0],n,r).then((function(){t.decrementDownloads(),t.needRender=!0}),(function(){x3dom.debug.logError("[Utils|createTexture2D] Can't load Image: "+A),t.decrementDownloads()}));else if(6==A.length)for(I=0;I<a.length;I++){var c=a[I],f=new Image;switch(o.toLowerCase()){case"anonymous":f.crossOrigin="anonymous";break;case"use-credentials":f.crossOrigin="use-credentials";break;case"none":break;default:x3dom.Utils.forbiddenBySOP(A[I])&&(f.crossOrigin="anonymous")}h.pendingTextureLoads++,t.incrementDownloads(),f.onload=function(A,i,o,r){return function(){0==g&&0==l?(g=o.width,l=o.height):!s||g==o.width&&l==o.height||(x3dom.debug.logWarning("[Utils|createTextureCube] Rescaling CubeMap images, which are of different size!"),o=x3dom.Utils.rescaleImage(o,g,l)),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r),e.bindTexture(e.TEXTURE_CUBE_MAP,A),e.texImage2D(i,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,o),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),A.pendingTextureLoads--,t.decrementDownloads(),A.pendingTextureLoads<0&&(A.width=g,A.height=l,A.textureCubeReady=!0,n&&(e.bindTexture(e.TEXTURE_CUBE_MAP,A),e.generateMipmap(e.TEXTURE_CUBE_MAP),e.bindTexture(e.TEXTURE_CUBE_MAP,null)),x3dom.debug.logInfo("[Utils|createTextureCube] Loading CubeMap finished..."),t.needRender=!0)}}(h,c,f,i),f.onerror=function(){t.decrementDownloads(),x3dom.debug.logError("[Utils|createTextureCube] Can't load CubeMap!")},f.src=A[I]}return h},x3dom.Utils.detectChannelCount=function(e,t){switch(t){case"image/jpeg":return x3dom.Utils.detectChannelCountJPG(e);case"image/png":return x3dom.Utils.detectChannelCountPNG(e);case"image/gif":return x3dom.Utils.detectChannelCountGIF(e)}},x3dom.Utils.detectChannelCountJPG=function(e){if(255==e[0]&&216==e[1])for(var t=2,A=new DataView(e.buffer,e.byteOffset,e.byteLength);t+4<e.byteLength;)if(255==e[t]){var i=e[t+1];if(255!=e[t+=2]){var o=A.getUint16(t);if(t+o>e.byteLength)return;if(o>=7&&(192==i||194==i))return e[t+7];t+=o}}else t+=1},x3dom.Utils.detectChannelCountPNG=function(e){if(!(e.byteLength<29)&&137==e[0]&&80==e[1]&&78==e[2]&&71==e[3]&&13==e[4]&&10==e[5]&&26==e[6]&&10==e[7]&&73==e[12]&&72==e[13]&&68==e[14]&&82==e[15])return 0==e[25]?1:2==e[25]?3:4==e[25]?2:6==e[25]?4:void 0},x3dom.Utils.detectChannelCountGIF=function(e){if(71==e[0]&&73==e[1]&&70==e[2]&&56==e[3]&&(55==e[4]||57==e[4])&&97==e[5]&&1&e[10]){for(var t=224&e[10],A=13;A<t;A+=3)if(e[A]!=e[A+1]||e[A]!=e[A+2]||e[A+1]!=e[A+2])return 3;return 1}},x3dom.Utils.initFBO=function(e,t,A,i,o,s,n){var r=e.createTexture();r.width=t,r.height=A,e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,A,0,e.RGBA,i,null),o&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null);var a,d=null;if(x3dom.caps.DRAW_BUFFERS&&void 0!==n)for(d=[r],a=1;a<n;a++)d[a]=e.createTexture(),d[a].width=t,d[a].height=A,e.bindTexture(e.TEXTURE_2D,d[a]),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,A,0,e.RGBA,i,null),o&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null);var h=e.createFramebuffer(),g=null,l=null;if(s&&(null!==x3dom.caps.DEPTH_TEXTURE?(g=e.createTexture(),e.bindTexture(e.TEXTURE_2D,g),e.texImage2D(e.TEXTURE_2D,0,e.DEPTH_COMPONENT,t,A,0,e.DEPTH_COMPONENT,e.UNSIGNED_SHORT,null),o&&e.generateMipmap(e.TEXTURE_2D),e.bindTexture(e.TEXTURE_2D,null),g.width=t,g.height=A):(l=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,l),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t,A),e.bindRenderbuffer(e.RENDERBUFFER,null))),e.bindFramebuffer(e.FRAMEBUFFER,h),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),x3dom.caps.DRAW_BUFFERS&&void 0!==n)for(a=1;a<n;a++)e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+a,e.TEXTURE_2D,d[a],0);s&&null!==x3dom.caps.DEPTH_TEXTURE?e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,g,0):e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,l);var I=e.checkFramebufferStatus(e.FRAMEBUFFER);return I!=e.FRAMEBUFFER_COMPLETE&&x3dom.debug.logWarning("[Utils|InitFBO] FBO-Status: "+I),e.bindFramebuffer(e.FRAMEBUFFER,null),{fbo:h,dtex:g,rbo:l,tex:r,texTargets:d,width:t,height:A,type:i,mipMap:o}},x3dom.Utils.getFileName=function(e){return e.lastIndexOf("/")>-1?e.substr(e.lastIndexOf("/")+1):e.lastIndexOf("\\")>-1?e.substr(e.lastIndexOf("\\")+1):e},x3dom.Utils.isWebGL2Enabled=function(){var e=document.createElement("canvas");return!!(e.getContext("webgl2")||e.getContext("experimental-webgl2"))},x3dom.Utils.findTextureByName=function(e,t){for(var A=0;A<e.length;++A)if(t==e[A].samplerName)return e[A];return!1},x3dom.Utils.rescaleImage=function(e,t,A){var i=document.createElement("canvas");return i.width=t,i.height=A,i.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),i},x3dom.Utils.scaleImage=function(e){if(!x3dom.Utils.isPowerOfTwo(e.width)||!x3dom.Utils.isPowerOfTwo(e.height)){var t=document.createElement("canvas");t.width=x3dom.Utils.nextHighestPowerOfTwo(e.width),t.height=x3dom.Utils.nextHighestPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),e=t}return e},x3dom.Utils.isPowerOfTwo=function(e){return 0==(e&e-1)},x3dom.Utils.nextHighestPowerOfTwo=function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1},x3dom.Utils.nextBestPowerOfTwo=function(e){var t=Math.log(e)/.693147180559945;return Math.pow(2,Math.round(t))},x3dom.Utils.getDataTypeSize=function(e){switch(e){case"Int8":case"Uint8":return 1;case"Int16":case"Uint16":return 2;case"Int32":case"Uint32":case"Float32":return 4;case"Float64":default:return 8}},x3dom.Utils.getOffsetMultiplier=function(e,t){switch(e){case t.UNSIGNED_SHORT:return 1;case t.UNSIGNED_INT:return 2;case t.UNSIGNED_BYTE:return.5;default:return 1}},x3dom.Utils.getByteAwareOffset=function(e,t,A){switch(t){case A.UNSIGNED_SHORT:return 2*e;case A.UNSIGNED_INT:return 4*e;case A.UNSIGNED_BYTE:return e;default:return 2*e}},x3dom.Utils.getVertexAttribType=function(e,t){var A=t.NONE;switch(e){case"Int8":A=t.BYTE;break;case"Uint8":A=t.UNSIGNED_BYTE;break;case"Int16":A=t.SHORT;break;case"Uint16":A=t.UNSIGNED_SHORT;break;case"Int32":A=t.INT;break;case"Uint32":A=t.UNSIGNED_INT;break;case"Float32":A=t.FLOAT;break;case"Float64":default:x3dom.debug.logError("Can't find this.gl data type for "+e+", getting FLOAT..."),A=t.FLOAT}return A},x3dom.Utils.getArrayBufferView=function(e,t){var A=null;switch(e){case"Int8":A=new Int8Array(t);break;case"Uint8":A=new Uint8Array(t);break;case"Int16":A=new Int16Array(t);break;case"Uint16":A=new Uint16Array(t);break;case"Int32":A=new Int32Array(t);break;case"Uint32":A=new Uint32Array(t);break;case"Float32":A=new Float32Array(t);break;case"Float64":A=new Float64Array(t);break;default:x3dom.debug.logError("Can't create typed array view of type "+e+", trying Float32..."),A=new Float32Array(t)}return A},x3dom.Utils.isUnsignedType=function(e){return"Uint8"==e||"Uint16"==e||"Uint16"==e||"Uint32"==e},x3dom.Utils.checkDirtyLighting=function(e){return e.getLights().length+e._scene.getNavigationInfo()._vf.headlight+(e._scene.getFog()._vf.visibilityRange>0)},x3dom.Utils.checkDirtyPhysicalEnvironmentLight=function(e,t){return!!t.PHYSICALENVLIGHT!=e.hasPhysicalEnvironmentLight()},x3dom.Utils.checkDirtyEnvironment=function(e,t){var A=e._scene.getEnvironment();return t.GAMMACORRECTION!=A._vf.gammaCorrectionDefault},x3dom.Utils.minFilterDic=function(e,t){switch(t.toUpperCase()){case"NEAREST":return e.NEAREST;case"LINEAR":return e.LINEAR;case"NEAREST_MIPMAP_NEAREST":return e.NEAREST_MIPMAP_NEAREST;case"NEAREST_MIPMAP_LINEAR":return e.NEAREST_MIPMAP_LINEAR;case"LINEAR_MIPMAP_NEAREST":return e.LINEAR_MIPMAP_NEAREST;case"LINEAR_MIPMAP_LINEAR":return e.LINEAR_MIPMAP_LINEAR;case"AVG_PIXEL":return e.LINEAR;case"AVG_PIXEL_AVG_MIPMAP":return e.LINEAR_MIPMAP_LINEAR;case"AVG_PIXEL_NEAREST_MIPMAP":return e.LINEAR_MIPMAP_NEAREST;case"DEFAULT":return e.LINEAR_MIPMAP_LINEAR;case"FASTEST":case"NEAREST_PIXEL":return e.NEAREST;case"NEAREST_PIXEL_AVG_MIPMAP":return e.NEAREST_MIPMAP_LINEAR;case"NEAREST_PIXEL_NEAREST_MIPMAP":return e.NEAREST_MIPMAP_NEAREST;case"NICEST":return e.LINEAR_MIPMAP_LINEAR;default:return e.LINEAR}},x3dom.Utils.minFilterDicX3D=function(e){switch(e){case 9728:return"NEAREST";case 9729:return"LINEAR";case 9984:return"NEAREST_MIPMAP_NEAREST";case 9985:return"LINEAR_MIPMAP_NEAREST";case 9986:return"NEAREST_MIPMAP_LINEAR";case 9987:default:return"LINEAR_MIPMAP_LINEAR"}},x3dom.Utils.magFilterDic=function(e,t){switch(t.toUpperCase()){case"NEAREST":return e.NEAREST;case"LINEAR":case"AVG_PIXEL":case"DEFAULT":return e.LINEAR;case"FASTEST":case"NEAREST_PIXEL":return e.NEAREST;case"NICEST":default:return e.LINEAR}},x3dom.Utils.magFilterDicX3D=function(e){switch(e){case 9728:return"NEAREST";case 9729:default:return"LINEAR"}},x3dom.Utils.boundaryModesDicX3D=function(e){switch(e){case 10497:return"REPEAT";case 33071:return"CLAMP_TO_EDGE";case 33648:return"MIRRORED_REPEAT";default:return"REPEAT"}},x3dom.Utils.boundaryModesDic=function(e,t){switch(t.toUpperCase()){case"CLAMP":case"CLAMP_TO_EDGE":case"CLAMP_TO_BOUNDARY":return e.CLAMP_TO_EDGE;case"MIRRORED_REPEAT":return e.MIRRORED_REPEAT;case"REPEAT":default:return e.REPEAT}},x3dom.Utils.primTypeDic=function(e,t){switch(t.toUpperCase()){case"POINTS":return e.POINTS;case"LINES":return e.LINES;case"LINELOOP":return e.LINE_LOOP;case"LINESTRIP":return e.LINE_STRIP;case"TRIANGLES":return e.TRIANGLES;case"TRIANGLESTRIP":return e.TRIANGLE_STRIP;case"TRIANGLEFAN":return e.TRIANGLE_FAN;default:return e.TRIANGLES}},x3dom.Utils.depthFunc=function(e,t){switch(t.toUpperCase()){case"NEVER":return e.NEVER;case"ALWAYS":return e.ALWAYS;case"LESS":return e.LESS;case"EQUAL":return e.EQUAL;case"LEQUAL":return e.LEQUAL;case"GREATER":return e.GREATER;case"GEQUAL":return e.GEQUAL;case"NOTEQUAL":return e.NOTEQUAL;default:return e.LEQUAL}},x3dom.Utils.blendFunc=function(e,t){switch(t.toLowerCase()){case"zero":return e.ZERO;case"one":return e.ONE;case"dst_color":return e.DST_COLOR;case"dst_alpha":return e.DST_ALPHA;case"src_color":return e.SRC_COLOR;case"src_alpha":return e.SRC_ALPHA;case"one_minus_dst_color":return e.ONE_MINUS_DST_COLOR;case"one_minus_dst_alpha":return e.ONE_MINUS_DST_ALPHA;case"one_minus_src_color":return e.ONE_MINUS_SRC_COLOR;case"one_minus_src_alpha":return e.ONE_MINUS_SRC_ALPHA;case"src_alpha_saturate":return e.SRC_ALPHA_SATURATE;case"constant_color":return e.CONSTANT_COLOR;case"constant_alpha":return e.CONSTANT_ALPHA;case"one_minus_constant_color":return e.ONE_MINUS_CONSTANT_COLOR;case"one_minus_constant_alpha":return e.ONE_MINUS_CONSTANT_ALPHA;default:return 0}},x3dom.Utils.blendEquation=function(e,t){switch(t.toLowerCase()){case"func_add":return e.FUNC_ADD;case"func_subtract":return e.FUNC_SUBTRACT;case"func_reverse_subtract":return e.FUNC_REVERSE_SUBTRACT;case"min":case"max":case"logic_op":default:return 0}},x3dom.Utils.generateProperties=function(e,t){var A={},i=t._cf.geometry.node,o=t._cf.appearance.node,s=o?o._cf.texture.node:null,n=o?o._cf.material.node:null,r=e._scene.getEnvironment();return o&&o._shader&&x3dom.isa(o._shader,x3dom.nodeTypes.ComposedShader)?A.CSHADER=o._shader._id:i&&(A.CSHADER=-1,A.APPMAT=o&&(n||A.CSSHADER)?1:0,A.SOLID=t.isSolid()?1:0,A.TEXT=x3dom.isa(i,x3dom.nodeTypes.Text)?1:0,A.POPGEOMETRY=x3dom.isa(i,x3dom.nodeTypes.PopGeometry)?1:0,A.BUFFERGEOMETRY=x3dom.isa(i,x3dom.nodeTypes.BufferGeometry)?1:0,A.BINARYGEOMETRY=x3dom.isa(i,x3dom.nodeTypes.BinaryGeometry)?1:0,A.POINTLINE2D=i.needLighting()?0:1,A.VERTEXID=A.BINARYGEOMETRY&&i._vf.idsPerVertex?1:0,A.IS_PARTICLE=x3dom.isa(i,x3dom.nodeTypes.ParticleSet)?1:0,A.POINTPROPERTIES=o&&o._cf.pointProperties.node?1:0,A.TANGENTDATA=i._mesh._tangents[0].length>0&&i._mesh._binormals[0].length>0?1:0,A.PBR_MATERIAL=A.APPMAT&&x3dom.isa(n,x3dom.nodeTypes.PhysicalMaterial)?1:0,A.TWOSIDEDMAT=A.APPMAT&&x3dom.isa(n,x3dom.nodeTypes.TwoSidedMaterial)?1:0,A.SEPARATEBACKMAT=A.TWOSIDEDMAT&&n._vf.separateBackColor?1:0,A.SHADOW=e.getLightsShadow()?1:0,A.FOG=e._scene.getFog()._vf.visibilityRange>0?1:0,A.CSSHADER=o&&o._shader&&x3dom.isa(o._shader,x3dom.nodeTypes.CommonSurfaceShader)?1:0,A.LIGHTS=!A.POINTLINE2D&&o&&t.isLit()&&(n||A.CSSHADER)?e.getLights().length+e._scene.getNavigationInfo()._vf.headlight:0,A.TEXTURED=s||A.TEXT||A.CSSHADER&&o._shader.needTexcoords()||A.PBR_MATERIAL&&n.hasTextures()?1:0,A.CUBEMAP=s&&x3dom.isa(s,x3dom.nodeTypes.X3DEnvironmentTextureNode)||A.CSSHADER&&o._shader.getEnvironmentMap()?1:0,A.PIXELTEX=s&&x3dom.isa(s,x3dom.nodeTypes.PixelTexture)?1:0,A.TEXTRAFO=o&&o._cf.textureTransform.node?1:0,A.DIFFUSEMAP=s&&!x3dom.isa(s,x3dom.nodeTypes.X3DEnvironmentTextureNode)||A.CSSHADER&&o._shader.getDiffuseMap()||A.PBR_MATERIAL&&n._cf.baseColorTexture.node?1:0,A.NORMALMAP=A.CSSHADER&&o._shader.getNormalMap()||A.PBR_MATERIAL&&n._cf.normalTexture.node?1:0,A.SPECMAP=A.CSSHADER&&o._shader.getSpecularMap()?1:0,A.SHINMAP=A.CSSHADER&&o._shader.getShininessMap()?1:0,A.EMISSIVEMAP=A.PBR_MATERIAL&&n._cf.emissiveTexture.node?1:0,A.OCCLUSIONMAP=A.PBR_MATERIAL&&n._cf.occlusionTexture.node?1:0,A.DISPLACEMENTMAP=A.CSSHADER&&o._shader.getDisplacementMap()?1:0,A.DIFFPLACEMENTMAP=A.CSSHADER&&o._shader.getDiffuseDisplacementMap()?1:0,A.ALPHAMODE=A.PBR_MATERIAL?n._vf.alphaMode:"BLEND",A.ISROUGHNESSMETALLIC=A.PBR_MATERIAL&&"roughnessMetallic"==n._vf.model?1:0,A.ROUGHNESSMETALLICMAP=A.PBR_MATERIAL&&n._cf.roughnessMetallicTexture.node?1:0,A.SPECULARGLOSSINESSMAP=A.PBR_MATERIAL&&n._cf.specularGlossinessTexture.node?1:0,A.OCCLUSIONROUGHNESSMETALLICMAP=A.PBR_MATERIAL&&n._cf.occlusionRoughnessMetallicTexture.node?1:0,A.PHYSICALENVLIGHT=e.hasPhysicalEnvironmentLight()?1:0,A.NORMALSPACE=A.NORMALMAP&&A.CSSHADER?o._shader._vf.normalSpace.toUpperCase():A.NORMALMAP&&A.PBR_MATERIAL?n._vf.normalSpace.toUpperCase():"TANGENT",A.BLENDING=A.TEXT||A.CUBEMAP||A.CSSHADER||A.PBR_MATERIAL||s&&s._blending?1:0,A.REQUIREBBOX=void 0!==i._vf.coordType&&"Float32"!=i._vf.coordType?1:0,A.REQUIREBBOXNOR=void 0!==i._vf.normalType&&"Float32"!=i._vf.normalType?1:0,A.REQUIREBBOXCOL=void 0!==i._vf.colorType&&"Float32"!=i._vf.colorType?1:0,A.REQUIREBBOXTEX=void 0!==i._vf.texCoordType&&"Float32"!=i._vf.texCoordType?1:0,A.COLCOMPONENTS=i._mesh._numColComponents,A.NORCOMPONENTS=i._mesh._numNormComponents,A.POSCOMPONENTS=i._mesh._numPosComponents,A.SPHEREMAPPING=void 0!==i._cf.texCoord&&null!==i._cf.texCoord.node&&i._cf.texCoord.node._vf.mode&&"sphere"==i._cf.texCoord.node._vf.mode.toLowerCase()?1:0,A.VERTEXCOLOR=i._mesh._colors[0].length>0||A.POPGEOMETRY&&i.hasColor()||A.BUFFERGEOMETRY&&i.hasColor()||void 0!==i._vf.color&&i._vf.color.length>0?1:0,A.CLIPPLANES=t._clipPlanes.length,A.ALPHATHRESHOLD=o?o._vf.alphaClipThreshold.toFixed(2):.1,A.MULTITEXCOORD=A.BUFFERGEOMETRY&&i.hasMultiTexCoord()?1:0,A.DIFFUSEMAPCHANNEL=A.PBR_MATERIAL&&A.DIFFUSEMAP&&1===n._cf.baseColorTexture.node._vf.channel?1:0,A.NORMALMAPCHANNEL=A.PBR_MATERIAL&&A.NORMALMAP&&1===n._cf.normalTexture.node._vf.channel?1:0,A.EMISSIVEMAPCHANNEL=A.PBR_MATERIAL&&A.EMISSIVEMAP&&1===n._cf.emissiveTexture.node._vf.channel?1:0,A.OCCLUSIONMAPCHANNEL=A.PBR_MATERIAL&&A.OCCLUSIONMAP&&1===n._cf.occlusionTexture.node._vf.channel?1:0,A.ROUGHNESSMETALLICMAPCHANNEL=A.PBR_MATERIAL&&A.ROUGHNESSMETALLICMAP&&1===n._cf.roughnessMetallicTexture.node._vf.channel?1:0,A.OCCLUSIONROUGHNESSMETALLICMAPCHANNEL=A.PBR_MATERIAL&&A.OCCLUSIONROUGHNESSMETALLICMAP&&1===n._cf.occlusionRoughnessMetallicTexture.node._vf.channel?1:0,A.SPECULARGLOSSINESSMAPCHANNEL=A.PBR_MATERIAL&&A.SPECULARGLOSSINESSMAP&&1===n._cf.specularGlossinessTexture.node._vf.channel?1:0,A.ALPHAMASK=A.PBR_MATERIAL&&"MASK"==n._vf.alphaMode?1:0,A.UNLIT=A.PBR_MATERIAL&&n._vf.unlit?1:0,A.GAMMACORRECTION=r._vf.gammaCorrectionDefault,A.KHR_MATERIAL_COMMONS=0),A.toIdentifier=function(){delete this.id;var e="";for(var t in this)this[t]!=this.toIdentifier&&this[t]!=this.toString&&(e+=this[t]);return this.id=e,e},A.toString=function(){var e="";for(var t in this)this[t]!=this.toIdentifier&&this[t]!=this.toString&&(e+=t+": "+this[t]+", ");return e},A.toIdentifier(),A},x3dom.Utils.lerp=function(e,t,A){return e+(t-e)*(A=(A=A<0?0:A)>1?1:A)},x3dom.Utils.wrapProgram=function(e,t,A){var i,o,s={shaderID:A,program:t,bind:function(){e.useProgram(t)}},n=null,r=null,a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(i=0;i<a;++i){try{r=e.getActiveUniform(t,i)}catch(e){if(!r)continue}switch((o=e.getError())&&x3dom.debug.logError("GL-Error (on searching uniforms): name="+r.name+" type="+r.type+" size="+r.size+" Err="+o),n=e.getUniformLocation(t,r.name),r.type){case e.SAMPLER_2D:case e.SAMPLER_CUBE:case e.BOOL:s.__defineSetter__(r.name,function(t){return function(A){e.uniform1i(t,A)}}(n));break;case e.FLOAT:-1!=r.name.indexOf("[0]")?s.__defineSetter__(r.name.substring(0,r.name.length-3),function(t){return function(A){e.uniform1fv(t,new Float32Array(A))}}(n)):s.__defineSetter__(r.name,function(t){return function(A){e.uniform1f(t,A)}}(n));break;case e.FLOAT_VEC2:s.__defineSetter__(r.name,function(t){return function(A){e.uniform2f(t,A[0],A[1])}}(n));break;case e.FLOAT_VEC3:-1!=r.name.indexOf("[0]")?s.__defineSetter__(r.name.substring(0,r.name.length-3),function(t){return function(A){e.uniform3fv(t,new Float32Array(A))}}(n)):s.__defineSetter__(r.name,function(t){return function(A){e.uniform3f(t,A[0],A[1],A[2])}}(n));break;case e.FLOAT_VEC4:s.__defineSetter__(r.name,function(t){return function(A){e.uniform4f(t,A[0],A[1],A[2],A[3])}}(n));break;case e.FLOAT_MAT2:s.__defineSetter__(r.name,function(t){return function(A){e.uniformMatrix2fv(t,!1,new Float32Array(A))}}(n));break;case e.FLOAT_MAT3:s.__defineSetter__(r.name,function(t){return function(A){e.uniformMatrix3fv(t,!1,new Float32Array(A))}}(n));break;case e.FLOAT_MAT4:s.__defineSetter__(r.name,function(t){return function(A){e.uniformMatrix4fv(t,!1,new Float32Array(A))}}(n));break;case e.INT:s.__defineSetter__(r.name,function(t){return function(A){e.uniform1i(t,A)}}(n));break;default:x3dom.debug.logWarning("GLSL program variable "+r.name+" has unknown type "+r.type)}}var d=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(i=0;i<d;++i){try{r=e.getActiveAttrib(t,i)}catch(e){if(!r)continue}(o=e.getError())&&x3dom.debug.logError("GL-Error (on searching attributes): name="+r.name+" type="+r.type+" size="+r.size+" Err="+o),n=e.getAttribLocation(t,r.name),s[r.name]=n}return s},x3dom.Utils.arrayBufferToJSON=function(e,t,A){var i,o,s,n,r,a;for(t=null!=t?t:0,i="",s=A=null!=A?A:e.length,o=t;o<s;)switch((n=e[o++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i+=String.fromCharCode(n);break;case 12:case 13:r=e[o++],i+=String.fromCharCode((31&n)<<6|63&r);break;case 14:r=e[o++],a=e[o++],i+=String.fromCharCode((15&n)<<12|(63&r)<<6|(63&a)<<0)}return JSON.parse(i)},x3dom.Utils.arrayBufferToObjectURL=function(e,t){return URL.createObjectURL(new Blob([new Uint8Array(e)],{type:t}))},x3dom.Utils.dataURIToObjectURL=function(e){if(-1==e.indexOf("data:"))return e;for(var t=e.split(","),A=t[0].split(":")[1].split(";")[0],i=t[1],o=window.atob(i),s=o.length,n=new Uint8Array(s),r=0;r<s;r++)n[r]=o.charCodeAt(r);return URL.createObjectURL(new Blob([n],{type:A}))},x3dom.Utils.arrayBufferToDataURL=function(e,t){for(var A="",i=new Uint8Array(e),o=0;o<i.byteLength;o++)A+=String.fromCharCode(i[o]);return"data:"+t+";base64,"+window.btoa(A)},x3dom.Utils.forbiddenBySOP=function(e){var t,A,i,o,s,n=(e=e.toLowerCase()).split("//"),r=""===document.location.port?"80":document.location.port;return 2===n.length&&(t=n[0],s=(i=(1===(A=n[1].split("/")[0].split("?")[0].split("#")[0].split("@")).length?A[0]:A[1]).split(":"))[0],o=i[1]),o=o||r,s=s||document.location.host,t=t||document.location.protocol,!(o===r&&s===document.location.host&&t===document.location.protocol)},x3dom.States=function(e){var t=this;this.active=!1,this.viewer=document.createElement("div"),this.viewer.id="x3dom-state-viewer";var A=document.createElement("div");A.className="x3dom-states-head",A.appendChild(document.createTextNode("x3dom"));var i=document.createElement("span");i.className="x3dom-states-head2",i.appendChild(document.createTextNode("stats")),A.appendChild(i),this.renderMode=document.createElement("div"),this.renderMode.className="x3dom-states-rendermode-hardware",this.measureList=document.createElement("ul"),this.measureList.className="x3dom-states-list",this.infoList=document.createElement("ul"),this.infoList.className="x3dom-states-list",this.requestList=document.createElement("ul"),this.requestList.className="x3dom-states-list",this.viewer.appendChild(this.renderMode),this.viewer.appendChild(this.measureList),this.viewer.appendChild(this.infoList),this.viewer.appendChild(this.requestList),this.disableContextMenu=function(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1},this.thousandSeperator=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},this.toFixed=function(e){return e.toFixed(2)},this.addItem=function(e,t,A){var i=document.createElement("li");i.className="x3dom-states-item";var o=document.createElement("div");o.className="x3dom-states-item-title",o.appendChild(document.createTextNode(t));var s=document.createElement("div");s.className="x3dom-states-item-value",s.appendChild(document.createTextNode(A)),i.appendChild(o),i.appendChild(s),e.appendChild(i)},this.update=function(){if(e.runtime||void 0===this.updateMethodID){var t=e.runtime.states.infos,A=e.runtime.states.measurements,i=x3dom.caps.RENDERMODE;for(var o in"HARDWARE"==i?(this.renderMode.innerHTML="Hardware-Rendering",this.renderMode.className="x3dom-states-rendermode-hardware"):"SOFTWARE"==i&&(this.renderMode.innerHTML="Software-Rendering",this.renderMode.className="x3dom-states-rendermode-software"),this.measureList.innerHTML="",A)A.hasOwnProperty(o)&&this.addItem(this.measureList,o,this.toFixed(A[o]));for(var s in this.infoList.innerHTML="",t)t.hasOwnProperty(s)&&this.addItem(this.infoList,s,this.thousandSeperator(t[s]));this.requestList.innerHTML="",this.addItem(this.requestList,"#ACTIVE",x3dom.RequestManager.activeRequests.length),this.addItem(this.requestList,"#TOTAL",x3dom.RequestManager.totalRequests),this.addItem(this.requestList,"#LOADED",x3dom.RequestManager.loadedRequests),this.addItem(this.requestList,"#FAILED",x3dom.RequestManager.failedRequests)}else clearInterval(this.updateMethodID)},this.updateMethodID=window.setInterval((function(){t.update()}),1e3),this.viewer.addEventListener("contextmenu",t.disableContextMenu)},x3dom.States.prototype.display=function(e){this.active=void 0!==e?e:!this.active,this.viewer.style.display=this.active?"block":"none"},x3dom.StateManager=function(e){this.gl=e,this.states=[],this.initStates()},x3dom.StateManager.prototype.initStates=function(){this.states.shaderID=null,this.states.colorMask={red:null,green:null,blue:null,alpha:null},this.states.depthMask=null,this.states.stencilMask=null,this.states.cullFace=null,this.states.frontFace=null,this.states.lineWidth=null,this.states.blendColor={red:null,green:null,blue:null,alpha:null},this.states.blendEquation=null,this.states.blendEquationSeparate={modeRGB:null,modeAlpha:null},this.states.blendFunc={sfactor:null,dfactor:null},this.states.blendFuncSeparate={srcRGB:null,dstRGB:null,srcAlpha:null,dstAlpha:null},this.states.depthFunc=null,this.states.viewport={x:null,y:null,width:null,height:null},this.states.depthRange={zNear:null,zFar:null}},x3dom.StateManager.prototype.useProgram=function(e){return this.states.shaderID!=e.shaderID&&(this.gl.useProgram(e.program),this.states.shaderID=e.shaderID,!0)},x3dom.StateManager.prototype.unsetProgram=function(){this.states.shaderID=null},x3dom.StateManager.prototype.enable=function(e){!0!==this.states[e]&&(this.gl.enable(e),this.states[e]=!0)},x3dom.StateManager.prototype.disable=function(e){!1!==this.states[e]&&(this.gl.disable(e),this.states[e]=!1)},x3dom.StateManager.prototype.colorMask=function(e,t,A,i){this.states.colorMask.red==e&&this.states.colorMask.green==t&&this.states.colorMask.blue==A&&this.states.colorMask.alpha==i||(this.gl.colorMask(e,t,A,i),this.states.colorMask.red=e,this.states.colorMask.green=t,this.states.colorMask.blue=A,this.states.colorMask.alpha=i)},x3dom.StateManager.prototype.depthMask=function(e){this.states.depthMask!=e&&(this.gl.depthMask(e),this.states.depthMask=e)},x3dom.StateManager.prototype.stencilMask=function(e){this.states.stencilMask!=e&&(this.gl.stencilMask(e),this.states.stencilMask=e)},x3dom.StateManager.prototype.cullFace=function(e){this.states.cullFace!=e&&(this.gl.cullFace(e),this.states.cullFace=e)},x3dom.StateManager.prototype.frontFace=function(e){this.states.frontFace!=e&&(this.gl.frontFace(e),this.states.frontFace=e)},x3dom.StateManager.prototype.lineWidth=function(e){e=e<=1?1:e,this.states.lineWidth!=e&&(this.gl.lineWidth(e),this.states.lineWidth=e)},x3dom.StateManager.prototype.blendColor=function(e,t,A,i){this.states.blendColor.red==e&&this.states.blendColor.green==t&&this.states.blendColor.blue==A&&this.states.blendColor.alpha==i||(this.gl.blendColor(e,t,A,i),this.states.blendColor.red=e,this.states.blendColor.green=t,this.states.blendColor.blue=A,this.states.blendColor.alpha=i)},x3dom.StateManager.prototype.blendEquation=function(e){e&&this.states.blendEquation!=e&&(this.gl.blendEquation(e),this.states.blendEquation=e)},x3dom.StateManager.prototype.blendEquationSeparate=function(e,t){this.states.blendEquationSeparate.modeRGB==e&&this.states.blendEquationSeparate.modeAlpha==t||(this.gl.blendEquationSeparate(e,t),this.states.blendEquationSeparate.modeRGB=e,this.states.blendEquationSeparate.modeAlpha=t)},x3dom.StateManager.prototype.blendFunc=function(e,t){this.states.blendFunc.sfactor==e&&this.states.blendFunc.dfactor==t||(this.gl.blendFunc(e,t),this.states.blendFunc.sfactor=e,this.states.blendFunc.dfactor=t)},x3dom.StateManager.prototype.blendFuncSeparate=function(e,t,A,i){this.states.blendFuncSeparate.srcRGB==e&&this.states.blendFuncSeparate.dstRGB==t&&this.states.blendFuncSeparate.srcAlpha==A&&this.states.blendFuncSeparate.dstAlpha==i||(this.gl.blendFuncSeparate(e,t,A,i),this.states.blendFuncSeparate.srcRGB=e,this.states.blendFuncSeparate.dstRGB=t,this.states.blendFuncSeparate.srcAlpha=A,this.states.blendFuncSeparate.dstAlpha=i)},x3dom.StateManager.prototype.depthFunc=function(e){this.states.depthFunc!=e&&(this.gl.depthFunc(e),this.states.depthFunc=e)},x3dom.StateManager.prototype.depthRange=function(e,t){e<0||t<0||e>t||(e=e>1?1:e,t=t>1?1:t,this.states.depthRange.zNear==e&&this.states.depthRange.zFar==t||(this.gl.depthRange(e,t),this.states.depthRange.zNear=e,this.states.depthRange.zFar=t))},x3dom.StateManager.prototype.viewport=function(e,t,A,i){this.states.viewport.x==e&&this.states.viewport.y==t&&this.states.viewport.width==A&&this.states.viewport.height==i||(this.gl.viewport(e,t,A,i),this.states.viewport.x=e,this.states.viewport.y=t,this.states.viewport.width=A,this.states.viewport.height=i)},x3dom.StateManager.prototype.bindFramebuffer=function(e,t){this.gl.bindFramebuffer(e,t),this.initStates()},x3dom.BinaryContainerLoader={outOfMemory:!1,checkError:function(e){var t=e.getError();t&&(t==e.OUT_OF_MEMORY?(this.outOfMemory=!0,x3dom.debug.logError("GL-Error "+t+" on loading binary container (out of memory)."),console.error("WebGL: OUT_OF_MEMORY")):x3dom.debug.logError("GL-Error "+t+" on loading binary container."))}},x3dom.BinaryContainerLoader.setupBinGeo=function(e,t,A,i,o){if(!this.outOfMemory){var s=(new Date).getTime(),n=this,r=e._cf.geometry.node;e._webgl.binaryGeometry=-1,e._webgl.internalDownloadCount=(r._vf.index.length>0?1:0)+(r._hasStrideOffset&&r._vf.coord.length>0?1:0)+(!r._hasStrideOffset&&r._vf.coord.length>0?1:0)+(!r._hasStrideOffset&&r._vf.normal.length>0?1:0)+(!r._hasStrideOffset&&r._vf.texCoord.length>0?1:0)+(!r._hasStrideOffset&&r._vf.color.length>0?1:0);var a=0==r._vf.normalPerVertex||r._vf.index.length>0&&("Int32"==r._vf.indexType||"Uint32"==r._vf.indexType&&!x3dom.caps.INDEX_UINT);if(e._webgl.makeSeparateTris={index:null,coord:null,normal:null,texCoord:null,color:null,pushBuffer:function(t,A){this[t]=A,0==--e._webgl.internalDownloadCount&&(this.coord&&this.createMesh(),e._nameSpace.doc.needRender=!0),0==--e._nameSpace.doc.downloadCount&&(e._nameSpace.doc.needRender=!0)},createMesh:function(){var s=r;if(s._hasStrideOffset)x3dom.debug.logError(s._vf.indexType+" index type and per-face normals not supported for interleaved arrays.");else{for(var a=0;a<e._webgl.primType.length;a++)if(e._webgl.primType[a]==A.TRIANGLE_STRIP)return void x3dom.debug.logError("makeSeparateTris: triangle strips not yet supported for per-face normals.");var d,h,g=s._vf.coordType;e._webgl.coordType=x3dom.Utils.getVertexAttribType(g,A),e._webgl.coordType!=A.FLOAT?(4==s._mesh._numPosComponents&&x3dom.Utils.isUnsignedType(s._vf.coordType)?x3dom.fields.SFVec3f.copy(s.getMin()):x3dom.fields.SFVec3f.copy(s._vf.position),d=x3dom.fields.SFVec3f.copy(s._vf.size),h=s.getPrecisionMax("coordType")):(new x3dom.fields.SFVec3f(0,0,0),d=new x3dom.fields.SFVec3f(1,1,1),h=1);var l=e._coordStrideOffset[0]/x3dom.Utils.getDataTypeSize(s._vf.coordType);l=0==l?3:l,x3dom.debug.logWarning("makeSeparateTris.createMesh called with coord length "+l),this.color&&l!=e._colorStrideOffset[0]/x3dom.Utils.getDataTypeSize(s._vf.colorType)&&(this.color=null,x3dom.debug.logWarning("Color format not supported."));var I=this.texCoord?e._texCoordStrideOffset[0]/x3dom.Utils.getDataTypeSize(s._vf.texCoordType):0;s._vf.normalType="Float32",e._webgl.normalType=A.FLOAT,s._mesh._numNormComponents=3,e._normalStrideOffset=[0,0];var c,f,u,C=[],_=[],m=[],p=[],E=this.index?this.index.length-2:this.coord.length/3-2;for(c=0;c<E;c+=3){f=l*(this.index?this.index[c]:c);var B=new x3dom.fields.SFVec3f(d.x*this.coord[f]/h,d.y*this.coord[f+1]/h,d.z*this.coord[f+2]/h);C.push(this.coord[f]),C.push(this.coord[f+1]),C.push(this.coord[f+2]),l>3&&C.push(this.coord[f+3]),this.color&&(p.push(this.color[f]),p.push(this.color[f+1]),p.push(this.color[f+2]),l>3&&p.push(this.color[f+3])),this.texCoord&&(u=I*(this.index?this.index[c]:c),m.push(this.texCoord[u]),m.push(this.texCoord[u+1]),I>3&&(m.push(this.texCoord[u+2]),m.push(this.texCoord[u+3]))),f=l*(this.index?this.index[c+1]:c+1);var Q=new x3dom.fields.SFVec3f(d.x*this.coord[f]/h,d.y*this.coord[f+1]/h,d.z*this.coord[f+2]/h);C.push(this.coord[f]),C.push(this.coord[f+1]),C.push(this.coord[f+2]),l>3&&C.push(this.coord[f+3]),this.color&&(p.push(this.color[f]),p.push(this.color[f+1]),p.push(this.color[f+2]),l>3&&p.push(this.color[f+3])),this.texCoord&&(u=I*(this.index?this.index[c+1]:c+1),m.push(this.texCoord[u]),m.push(this.texCoord[u+1]),I>3&&(m.push(this.texCoord[u+2]),m.push(this.texCoord[u+3]))),f=l*(this.index?this.index[c+2]:c+2);var x=new x3dom.fields.SFVec3f(d.x*this.coord[f]/h,d.y*this.coord[f+1]/h,d.z*this.coord[f+2]/h);C.push(this.coord[f]),C.push(this.coord[f+1]),C.push(this.coord[f+2]),l>3&&C.push(this.coord[f+3]),this.color&&(p.push(this.color[f]),p.push(this.color[f+1]),p.push(this.color[f+2]),l>3&&p.push(this.color[f+3])),this.texCoord&&(u=I*(this.index?this.index[c+2]:c+2),m.push(this.texCoord[u]),m.push(this.texCoord[u+1]),I>3&&(m.push(this.texCoord[u+2]),m.push(this.texCoord[u+3])));var v=B.subtract(Q),y=Q.subtract(x),F=v.cross(y).normalize();for(f=0;f<3;f++)_.push(F.x),_.push(F.y),_.push(F.z)}var D=A.createBuffer();e._webgl.buffers[x3dom.BUFFER_IDX.POSITION]=D,A.bindBuffer(A.ARRAY_BUFFER,D),A.bufferData(A.ARRAY_BUFFER,x3dom.Utils.getArrayBufferView(s._vf.coordType,C),A.STATIC_DRAW),A.vertexAttribPointer(t.position,s._mesh._numPosComponents,e._webgl.coordType,!1,e._coordStrideOffset[0],e._coordStrideOffset[1]),A.enableVertexAttribArray(t.position),D=A.createBuffer(),e._webgl.buffers[x3dom.BUFFER_IDX.NORMAL]=D,A.bindBuffer(A.ARRAY_BUFFER,D),A.bufferData(A.ARRAY_BUFFER,new Float32Array(_),A.STATIC_DRAW),A.vertexAttribPointer(t.normal,s._mesh._numNormComponents,e._webgl.normalType,!1,e._normalStrideOffset[0],e._normalStrideOffset[1]),A.enableVertexAttribArray(t.normal),this.texCoord&&(D=A.createBuffer(),e._webgl.buffers[x3dom.BUFFER_IDX.TEXCOORD]=D,A.bindBuffer(A.ARRAY_BUFFER,D),A.bufferData(A.ARRAY_BUFFER,x3dom.Utils.getArrayBufferView(s._vf.texCoordType,m),A.STATIC_DRAW),A.vertexAttribPointer(t.texcoord,s._mesh._numTexComponents,e._webgl.texCoordType,!1,e._texCoordStrideOffset[0],e._texCoordStrideOffset[1]),A.enableVertexAttribArray(t.texcoord)),this.color&&(D=A.createBuffer(),e._webgl.buffers[x3dom.BUFFER_IDX.COLOR]=D,A.bindBuffer(A.ARRAY_BUFFER,D),A.bufferData(A.ARRAY_BUFFER,x3dom.Utils.getArrayBufferView(s._vf.colorType,p),A.STATIC_DRAW),A.vertexAttribPointer(t.color,s._mesh._numColComponents,e._webgl.colorType,!1,e._colorStrideOffset[0],e._colorStrideOffset[1]),A.enableVertexAttribArray(t.color)),s._vf.vertexCount=[],s._vf.vertexCount[0]=C.length/l,s._mesh._numCoords=s._vf.vertexCount[0],s._mesh._numFaces=s._vf.vertexCount[0]/3,e._webgl.primType=[],e._webgl.primType[0]=A.TRIANGLES,C=null,_=null,m=null,p=null,this.index=null,this.coord=null,this.normal=null,this.texCoord=null,this.color=null,n.checkError(A),delete e._webgl.shader,e._webgl.shader=o.cache.getDynamicShader(A,i,e)}}},r._vf.index.length>0){e._webgl.binaryGeometry=1;var d=new XMLHttpRequest;d.open("GET",e._nameSpace.getURL(r._vf.index),!0),d.responseType="arraybuffer",e._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(d),d.onload=function(){if(e._nameSpace.doc.decrementDownloads(),e._webgl.internalDownloadCount-=1,200==d.status){if(e._webgl)if(r._vf.compressed)x3dom.debug.logError("x3dom 1.8.2+ do not support compressed BinaryGeometries anymore");else{var t=d.response,i=r,o=i._vf.indexType,h=x3dom.Utils.getArrayBufferView(o,t);if(a)e._webgl.makeSeparateTris.pushBuffer("index",h);else{var g=A.createBuffer();x3dom.caps.INDEX_UINT&&"Uint32"==o?e._webgl.indexType=A.UNSIGNED_INT:e._webgl.indexType=A.UNSIGNED_SHORT,A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,g),A.bufferData(A.ELEMENT_ARRAY_BUFFER,h,A.STATIC_DRAW),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,null),0==i._vf.vertexCount[0]&&(i._vf.vertexCount[0]=h.length),i._mesh._numFaces=0;for(var l=0;l<i._vf.vertexCount.length;l++)e._webgl.primType[l]==A.TRIANGLE_STRIP?i._mesh._numFaces+=i._vf.vertexCount[l]-2:i._mesh._numFaces+=i._vf.vertexCount[l]/3;h=null,0==e._webgl.internalDownloadCount&&(e._nameSpace.doc.needRender=!0),n.checkError(A);var I=(new Date).getTime()-s;x3dom.debug.logInfo("XHR0/ index load time: "+I+" ms"),e._webgl.buffers[x3dom.BUFFER_IDX.INDEX]=g}}}else x3dom.debug.logError("XHR1/ index load failed with status: "+d.status)}}if(r._hasStrideOffset&&r._vf.coord.length>0){var h=new XMLHttpRequest;h.open("GET",e._nameSpace.getURL(r._vf.coord),!0),h.responseType="arraybuffer",e._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(h),h.onload=function(){if(e._nameSpace.doc.decrementDownloads(),e._webgl.internalDownloadCount-=1,200==h.status){if(e._webgl)if(r._vf.compressed)x3dom.debug.logError("x3dom 1.8.2+ do not support compressed BinaryGeometries anymore");else{var i=h.response,o=r,a=o._vf.coordType;e._webgl.coordType=x3dom.Utils.getVertexAttribType(a,A),e._webgl.normalType=e._webgl.coordType,e._webgl.texCoordType=e._webgl.coordType,e._webgl.colorType=e._webgl.coordType;var d=x3dom.Utils.getArrayBufferView(a,i),g=e._coordStrideOffset[0]/x3dom.Utils.getDataTypeSize(a);if(g&&(o._mesh._numCoords=d.length/g),0==o._vf.index.length)for(var l=0;l<o._vf.vertexCount.length;l++)e._webgl.primType[l]==A.TRIANGLE_STRIP?o._mesh._numFaces+=o._vf.vertexCount[l]-2:o._mesh._numFaces+=o._vf.vertexCount[l]/3;var I=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,I),A.bufferData(A.ARRAY_BUFFER,d,A.STATIC_DRAW),A.vertexAttribPointer(t.position,o._mesh._numPosComponents,e._webgl.coordType,!1,e._coordStrideOffset[0],e._coordStrideOffset[1]),A.enableVertexAttribArray(t.position),o._vf.normal.length>0&&(e._webgl.buffers[x3dom.BUFFER_IDX.NORMAL]=I,A.bindBuffer(A.ARRAY_BUFFER,I),A.bufferData(A.ARRAY_BUFFER,d,A.STATIC_DRAW),A.vertexAttribPointer(t.normal,o._mesh._numNormComponents,e._webgl.normalType,!1,e._normalStrideOffset[0],e._normalStrideOffset[1]),A.enableVertexAttribArray(t.normal)),o._vf.texCoord.length>0&&(e._webgl.buffers[x3dom.BUFFER_IDX.TEXCOORD]=I,A.bindBuffer(A.ARRAY_BUFFER,I),A.bufferData(A.ARRAY_BUFFER,d,A.STATIC_DRAW),A.vertexAttribPointer(t.texcoord,o._mesh._numTexComponents,e._webgl.texCoordType,!1,e._texCoordStrideOffset[0],e._texCoordStrideOffset[1]),A.enableVertexAttribArray(t.texcoord)),o._vf.color.length>0&&(e._webgl.buffers[x3dom.BUFFER_IDX.COLOR]=I,A.bindBuffer(A.ARRAY_BUFFER,I),A.bufferData(A.ARRAY_BUFFER,d,A.STATIC_DRAW),A.vertexAttribPointer(t.color,o._mesh._numColComponents,e._webgl.colorType,!1,e._colorStrideOffset[0],e._colorStrideOffset[1]),A.enableVertexAttribArray(t.color)),d=null,0==e._webgl.internalDownloadCount&&(e._nameSpace.doc.needRender=!0),n.checkError(A);var c=(new Date).getTime()-s;x3dom.debug.logInfo("XHR/ interleaved array load time: "+c+" ms"),e._webgl.buffers[x3dom.BUFFER_IDX.POSITION]=I}}else x3dom.debug.logError("XHR1/ interleaved array load failed with status: "+h.status)}}if(!r._hasStrideOffset&&r._vf.coord.length>0){var g=new XMLHttpRequest;g.open("GET",e._nameSpace.getURL(r._vf.coord),!0),g.responseType="arraybuffer",e._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(g),g.onload=function(){if(e._nameSpace.doc.decrementDownloads(),e._webgl.internalDownloadCount-=1,200==g.status){if(e._webgl)if(r._vf.compressed)x3dom.debug.logError("x3dom 1.8.2+ do not support compressed BinaryGeometries anymore");else{var i=g.response,o=r,d=0,h=o._vf.coordType;e._webgl.coordType=x3dom.Utils.getVertexAttribType(h,A);var l=x3dom.Utils.getArrayBufferView(h,i);if(a)e._webgl.makeSeparateTris.pushBuffer("coord",l);else{A.bindAttribLocation(t.program,0,"position");var I=A.createBuffer();if(A.bindBuffer(A.ARRAY_BUFFER,I),A.bufferData(A.ARRAY_BUFFER,l,A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),o._mesh._numCoords=l.length/o._mesh._numPosComponents,0==o._vf.index.length)for(d=0;d<o._vf.vertexCount.length;d++)e._webgl.primType[d]==A.TRIANGLE_STRIP?o._mesh._numFaces+=o._vf.vertexCount[d]-2:o._mesh._numFaces+=o._vf.vertexCount[d]/3;if("Float32"==h&&(e._vf.bboxSize.x<0||e._vf.bboxSize.y<0||e._vf.bboxSize.z<0)){var c=new x3dom.fields.SFVec3f(l[0],l[1],l[2]),f=new x3dom.fields.SFVec3f(l[0],l[1],l[2]);for(d=3;d<l.length;d+=3)c.x>l[d+0]&&(c.x=l[d+0]),c.y>l[d+1]&&(c.y=l[d+1]),c.z>l[d+2]&&(c.z=l[d+2]),f.x<l[d+0]&&(f.x=l[d+0]),f.y<l[d+1]&&(f.y=l[d+1]),f.z<l[d+2]&&(f.z=l[d+2]);e._vf.bboxCenter.setValues(c.add(f).multiply(.5)),e._vf.bboxSize.setValues(f.subtract(c))}l=null,0==e._webgl.internalDownloadCount&&(e._nameSpace.doc.needRender=!0),n.checkError(A);var u=(new Date).getTime()-s;x3dom.debug.logInfo("XHR1/ coord load time: "+u+" ms"),e._webgl.buffers[x3dom.BUFFER_IDX.POSITION]=I}}}else x3dom.debug.logError("XHR1/ coord load failed with status: "+g.status)}}if(!r._hasStrideOffset&&r._vf.normal.length>0){var l=new XMLHttpRequest;l.open("GET",e._nameSpace.getURL(r._vf.normal),!0),l.responseType="arraybuffer",e._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(l),l.onload=function(){if(e._nameSpace.doc.decrementDownloads(),e._webgl.internalDownloadCount-=1,200==l.status){if(e._webgl)if(r._vf.compressed)x3dom.debug.logError("x3dom 1.8.2+ do not support compressed BinaryGeometries anymore");else{var t=l.response,i=r._vf.normalType;e._webgl.normalType=x3dom.Utils.getVertexAttribType(i,A);var o=x3dom.Utils.getArrayBufferView(i,t);if(a)e._webgl.makeSeparateTris.pushBuffer("normal",o);else{var d=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,d),A.bufferData(A.ARRAY_BUFFER,o,A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),o=null,0==e._webgl.internalDownloadCount&&(e._nameSpace.doc.needRender=!0),n.checkError(A);var h=(new Date).getTime()-s;x3dom.debug.logInfo("XHR2/ normal load time: "+h+" ms"),e._webgl.buffers[x3dom.BUFFER_IDX.NORMAL]=d}}}else x3dom.debug.logError("XHR2/ normal load failed with status: "+l.status)}}if(!r._hasStrideOffset&&r._vf.texCoord.length>0){var I=new XMLHttpRequest;I.open("GET",e._nameSpace.getURL(r._vf.texCoord),!0),I.responseType="arraybuffer",e._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(I),I.onload=function(){var t,i;if(e._nameSpace.doc.decrementDownloads(),e._webgl.internalDownloadCount-=1,200==I.status){if(e._webgl)if(r._vf.compressed)x3dom.debug.logError("x3dom 1.8.2+ do not support compressed BinaryGeometries anymore");else{var o=I.response,d=r._vf.texCoordType;e._webgl.texCoordType=x3dom.Utils.getVertexAttribType(d,A);var h=x3dom.Utils.getArrayBufferView(d,o);if(a)e._webgl.makeSeparateTris.pushBuffer("texCoord",h);else{if(r._vf.idsPerVertex){var g=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,g);var l=x3dom.Utils.getArrayBufferView("Float32",h.length/2);for(t=0,i=0;t<h.length;t+=2,i++)l[i]=65536*h[t+1]+h[t];A.bufferData(A.ARRAY_BUFFER,l,A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),e._webgl.buffers[x3dom.BUFFER_IDX.ID]=g}else{var c=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,c),A.bufferData(A.ARRAY_BUFFER,h,A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),e._webgl.buffers[x3dom.BUFFER_IDX.TEXCOORD]=c}h=null,0==e._webgl.internalDownloadCount&&(e._nameSpace.doc.needRender=!0),n.checkError(A);var f=(new Date).getTime()-s;x3dom.debug.logInfo("XHR3/ texCoord load time: "+f+" ms")}}}else x3dom.debug.logError("XHR3/ texcoord load failed with status: "+I.status)}}if(!r._hasStrideOffset&&r._vf.color.length>0){var c=new XMLHttpRequest;c.open("GET",e._nameSpace.getURL(r._vf.color),!0),c.responseType="arraybuffer",e._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(c),c.onload=function(){if(e._nameSpace.doc.decrementDownloads(),e._webgl.internalDownloadCount-=1,200==c.status){if(e._webgl)if(r._vf.compressed)x3dom.debug.logError("x3dom 1.8.2+ do not support compressed BinaryGeometries anymore");else{var t=c.response,i=r._vf.colorType;e._webgl.colorType=x3dom.Utils.getVertexAttribType(i,A);var o=x3dom.Utils.getArrayBufferView(i,t);if(a)e._webgl.makeSeparateTris.pushBuffer("color",o);else{var d=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,d),A.bufferData(A.ARRAY_BUFFER,o,A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),o=null,0==e._webgl.internalDownloadCount&&(e._nameSpace.doc.needRender=!0),n.checkError(A);var h=(new Date).getTime()-s;x3dom.debug.logInfo("XHR4/ color load time: "+h+" ms"),e._webgl.buffers[x3dom.BUFFER_IDX.COLOR]=d}}}else x3dom.debug.logError("XHR4/ color load failed with status: "+c.status)}}if(!r._hasStrideOffset&&r._vf.tangent.length>0){var f=new XMLHttpRequest;f.open("GET",e._nameSpace.getURL(r._vf.normal),!0),f.responseType="arraybuffer",e._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(f),f.onload=function(){if(e._nameSpace.doc.decrementDownloads(),e._webgl.internalDownloadCount-=1,200==f.status){if(e._webgl)if(r._vf.compressed)x3dom.debug.logError("x3dom 1.8.2+ do not support compressed BinaryGeometries anymore");else{var t=f.response,i=r._vf.tangentType;e._webgl.tangentType=x3dom.Utils.getVertexAttribType(i,A);var o=x3dom.Utils.getArrayBufferView(i,t);if(a)e._webgl.makeSeparateTris.pushBuffer("tangent",o);else{var d=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,d),A.bufferData(A.ARRAY_BUFFER,o,A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),o=null,0==e._webgl.internalDownloadCount&&(e._nameSpace.doc.needRender=!0),n.checkError(A);var h=(new Date).getTime()-s;x3dom.debug.logInfo("XHR5/ normal load time: "+h+" ms"),e._webgl.buffers[x3dom.BUFFER_IDX.TANGENT]=d}}}else x3dom.debug.logError("XHR2/ normal load failed with status: "+f.status)}}if(!r._hasStrideOffset&&r._vf.binormal.length>0){var u=new XMLHttpRequest;u.open("GET",e._nameSpace.getURL(r._vf.normal),!0),u.responseType="arraybuffer",e._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(u),u.onload=function(){if(e._nameSpace.doc.decrementDownloads(),e._webgl.internalDownloadCount-=1,200==u.status){if(e._webgl)if(r._vf.compressed)x3dom.debug.logError("x3dom 1.8.2+ do not support compressed BinaryGeometries anymore");else{var t=u.response,i=r._vf.binormalType;e._webgl.binormalType=x3dom.Utils.getVertexAttribType(i,A);var o=x3dom.Utils.getArrayBufferView(i,t);if(a)e._webgl.makeSeparateTris.pushBuffer("binormal",o);else{var d=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,d),A.bufferData(A.ARRAY_BUFFER,o,A.STATIC_DRAW),A.bindBuffer(A.ARRAY_BUFFER,null),o=null,0==e._webgl.internalDownloadCount&&(e._nameSpace.doc.needRender=!0),n.checkError(A);var h=(new Date).getTime()-s;x3dom.debug.logInfo("XHR6/ normal load time: "+h+" ms"),e._webgl.buffers[x3dom.BUFFER_IDX.BITANGENT]=d}}}else x3dom.debug.logError("XHR6/ normal load failed with status: "+u.status)}}}},x3dom.BinaryContainerLoader.setupPopGeo=function(e,t,A,i,o){if(!this.outOfMemory){var s=e._cf.geometry.node;if(s.hasIndex()){e._webgl.popGeometry=1,e._webgl.buffers[x3dom.BUFFER_IDX.INDEX]=A.createBuffer(),A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,e._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),A.bufferData(A.ELEMENT_ARRAY_BUFFER,2*s.getTotalNumberOfIndices(),A.STATIC_DRAW),e._webgl.buffers[x3dom.BUFFER_IDX.ID]=A.createBuffer();var n=new Float32Array(s._vf.vertexBufferSize);!function(){for(var e=0;e<n.length;++e)n[e]=e}(),A.bindBuffer(A.ARRAY_BUFFER,e._webgl.buffers[x3dom.BUFFER_IDX.ID]),A.bufferData(A.ARRAY_BUFFER,n,A.STATIC_DRAW)}else e._webgl.popGeometry=-1;e._webgl.buffers[x3dom.BUFFER_IDX.POSITION]=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,e._webgl.buffers[x3dom.BUFFER_IDX.POSITION]),A.bufferData(A.ARRAY_BUFFER,s._vf.attributeStride*s._vf.vertexBufferSize,A.STATIC_DRAW);var r=s._vf.coordType;e._webgl.coordType=x3dom.Utils.getVertexAttribType(r,A),e._coordStrideOffset[0]=s.getAttributeStride(),e._coordStrideOffset[1]=s.getPositionOffset(),A.vertexAttribPointer(t.position,e._cf.geometry.node._mesh._numPosComponents,e._webgl.coordType,!1,e._coordStrideOffset[0],e._coordStrideOffset[1]),A.enableVertexAttribArray(t.position),s.hasNormal()&&(r=s._vf.normalType,e._webgl.normalType=x3dom.Utils.getVertexAttribType(r,A),e._normalStrideOffset[0]=s.getAttributeStride(),e._normalStrideOffset[1]=s.getNormalOffset(),e._webgl.buffers[x3dom.BUFFER_IDX.NORMAL]=e._webgl.buffers[x3dom.BUFFER_IDX.POSITION],A.vertexAttribPointer(t.normal,e._cf.geometry.node._mesh._numNormComponents,e._webgl.normalType,!1,e._normalStrideOffset[0],e._normalStrideOffset[1]),A.enableVertexAttribArray(t.normal)),s.hasTexCoord()&&(r=s._vf.texCoordType,e._webgl.texCoordType=x3dom.Utils.getVertexAttribType(r,A),e._webgl.buffers[x3dom.BUFFER_IDX.TEXCOORD]=e._webgl.buffers[x3dom.BUFFER_IDX.POSITION],e._texCoordStrideOffset[0]=s.getAttributeStride(),e._texCoordStrideOffset[1]=s.getTexCoordOffset(),A.vertexAttribPointer(t.texcoord,e._cf.geometry.node._mesh._numTexComponents,e._webgl.texCoordType,!1,e._texCoordStrideOffset[0],e._texCoordStrideOffset[1]),A.enableVertexAttribArray(t.texcoord)),s.hasColor()&&(r=s._vf.colorType,e._webgl.colorType=x3dom.Utils.getVertexAttribType(r,A),e._webgl.buffers[x3dom.BUFFER_IDX.COLOR]=e._webgl.buffers[x3dom.BUFFER_IDX.POSITION],e._colorStrideOffset[0]=s.getAttributeStride(),e._colorStrideOffset[1]=s.getColorOffset(),A.vertexAttribPointer(t.color,e._cf.geometry.node._mesh._numColComponents,e._webgl.colorType,!1,e._colorStrideOffset[0],e._colorStrideOffset[1]),A.enableVertexAttribArray(t.color)),e._webgl.currentNumIndices=0,e._webgl.currentNumVertices=0,e._webgl.numVerticesAtLevel=[],e._webgl.levelsAvailable=0,this.checkError(A),e._webgl.levelLoaded=[],function(){for(var t=0;t<s.getNumLevels();++t)e._webgl.levelLoaded.push(!1)}();var a=function(t,i){if(e._webgl.levelLoaded[i]=!0,e._webgl.numVerticesAtLevel[i]=0,t){var o=0,n=!1;if(s.hasIndex()&&(o=2*s.getNumIndicesByLevel(i))>0){n=!0;var r=new Uint8Array(t,0,o);A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,e._webgl.buffers[x3dom.BUFFER_IDX.INDEX]),function(){for(var e=0,t=0;t<i;++t)e+=s.getNumIndicesByLevel(t);A.bufferSubData(A.ELEMENT_ARRAY_BUFFER,2*e,r)}()}var a=t.byteLength-o;if(a>0){n=!0;var d=new Uint8Array(t,o,a);A.bindBuffer(A.ARRAY_BUFFER,e._webgl.buffers[x3dom.BUFFER_IDX.POSITION]),s.hasIndex()?A.bufferSubData(A.ARRAY_BUFFER,s.getVertexDataBufferOffset(i)*s.getAttributeStride(),d):A.bufferSubData(A.ARRAY_BUFFER,e._webgl.currentNumVertices*s.getAttributeStride(),d),e._webgl.numVerticesAtLevel[i]=a/s.getAttributeStride(),e._webgl.currentNumVertices+=e._webgl.numVerticesAtLevel[i]}!function(){for(var t=0,A=e._webgl.levelsAvailable;A<s.getNumLevels()&&!1!==e._webgl.levelLoaded[A];++A)t+=s.getNumIndicesByLevel(A),++e._webgl.levelsAvailable;e._webgl.currentNumIndices=t}(),s._mesh._numCoords=e._webgl.currentNumVertices,s._mesh._numFaces=(s.hasIndex()?e._webgl.currentNumIndices:e._webgl.currentNumVertices)/3,s.adaptVertexCount(s.hasIndex()?3*s._mesh._numFaces:s._mesh._numCoords),n&&(e._nameSpace.doc.needRender=!0)}},d=s.getDataURLs();e._webgl.downloadStartTimer=(new Date).getTime();for(var h=0;h<d.length;++h){e._nameSpace.doc.incrementDownloads();var g=new XMLHttpRequest;g.responseType="arraybuffer",g.open("GET",d[h]),g.onload=function(t,A){e._nameSpace.doc.decrementDownloads(),a(t.response,A)}.bind(this,g,h),x3dom.RequestManager.addRequest(g)}}},x3dom.BinaryContainerLoader.bufferGeoCache={},x3dom.BinaryContainerLoader.draco={DecoderModule:null,Decoder:null},x3dom.BinaryContainerLoader.setupBufferGeo=function(e,t,A,i,o){var s,n,r=e._cf.geometry.node,a=null,d=null,h=!0;e._webgl.bufferGeometry=r._indexed?1:-1;var g=r._vf.draco;r._mesh._numCoords=r._vf.vertexCount[0],r._mesh._numFaces=r._vf.vertexCount[0]/3;var l,I,c,f=function(e,t,A,i,o){return g?34963==i._vf.target?C():u(i,o):new Uint8Array(e,t,A)},u=function(e,t){var A=e._vf.dracoId,i=I.GetAttributeByUniqueId(c,A),o=r._cf.accessors.nodes.find((function(e){return e._vf.view==t}))._vf.componentType,s=x3dom.BinaryContainerLoader.getArrayBufferFromType(o).BYTES_PER_ELEMENT,n=c.num_points()*i.num_components(),a=n*s,d=l._malloc(a),h=(I.GetAttributeDataArrayForAllPoints(c,i,i.data_type(),a,d),x3dom.BinaryContainerLoader.getArrayBufferFromType(o,l.HEAPF32.buffer,d,n).slice());return l._free(d),h},C=function(){var e=3*c.num_faces(),t=4*e,i=l._malloc(t),o=(I.GetTrianglesUInt32Array(c,t,i),new Uint32Array(l.HEAPU32.buffer,i,e).slice());l._free(i);var s=r._cf.accessors.nodes.find((function(e){return"INDEX"==e._vf.bufferType})),n=s?s._vf.componentType:A.UNSIGNED_SHORT;return x3dom.BinaryContainerLoader.getArrayBufferFromType(n,o)},_=function(t){if(0!=h){var i=function(e){var t;if(d){var A=r._cf.views.nodes[d._vf.view];if(g)t=u(A,d._vf.view);else{var i=d._vf.byteOffset+A._vf.byteOffset,o=d._vf.count*d._vf.components;t=x3dom.BinaryContainerLoader.getArrayBufferFromType(d._vf.componentType,e,i,o)}}return t}(t),o=function(e){if(g)return C();var t;if(a){var A=r._cf.views.nodes[a._vf.view],i=a._vf.byteOffset+A._vf.byteOffset,o=a._vf.count*a._vf.components;t=x3dom.BinaryContainerLoader.getArrayBufferFromType(a._vf.componentType,e,i,o)}return t}(t),s=new Float32Array(3*d._vf.count),n=new x3dom.fields.SFVec3f,l=new x3dom.fields.SFVec3f,I=new x3dom.fields.SFVec3f,c=new x3dom.fields.SFVec3f,f=new x3dom.fields.SFVec3f;if(o)for(var _,m,p,E=0;E<o.length;E+=3)_=3*o[E],m=3*o[E+1],p=3*o[E+2],n.set(i[_],i[_+1],i[_+2]),l.set(i[m],i[m+1],i[m+2]),I.set(i[p],i[p+1],i[p+2]),c=c.subtractVectors(n,l),f=(f=(f=f.subtractVectors(I,l)).cross(c)).normalize(),s[_]=s[m]=s[p]=f.x,s[_+1]=s[m+1]=s[p+1]=f.y,s[_+2]=s[m+2]=s[p+2]=f.z;else if(i)for(E=0;E<i.length;E+=9)n.set(i[E],i[E+1],i[E+2]),l.set(i[E+3],i[E+4],i[E+5]),I.set(i[E+6],i[E+7],i[E+8]),c=c.subtractVectors(n,l),f=(f=(f=f.subtractVectors(I,l)).cross(c)).normalize(),s[E]=s[E+3]=s[E+6]=f.x,s[E+1]=s[E+4]=s[E+7]=f.y,s[E+2]=s[E+5]=s[E+8]=f.z;var B=A.createBuffer();A.bindBuffer(34962,B),A.bufferData(34962,s,A.STATIC_DRAW),A.bindBuffer(34962,null),e._webgl.buffers[x3dom.BUFFER_IDX.NORMAL]=B,e._normalStrideOffset=[12,0],e._webgl.normalType=5126,r._mesh._numNormComponents=3}};""!=r._vf.buffer&&(s=e._nameSpace.getURL(r._vf.buffer),n=s,g&&(n+=" "+r._cf.views.nodes[0]._vf.byteOffset),null==x3dom.BinaryContainerLoader.bufferGeoCache[n]&&(e._nameSpace.doc.incrementDownloads(),x3dom.BinaryContainerLoader.bufferGeoCache[n]={},x3dom.BinaryContainerLoader.bufferGeoCache[n].buffers=[],x3dom.BinaryContainerLoader.bufferGeoCache[n].shapes=[],x3dom.BinaryContainerLoader.bufferGeoCache[n].decrementDownload=!0,x3dom.BinaryContainerLoader.bufferGeoCache[n].promise=new Promise((function(e,t){var A=new XMLHttpRequest;A.open("GET",s),A.responseType="arraybuffer",A.onload=function(i){200!=A.status?t():e(A.response)},A.onerror=function(e){t()},x3dom.RequestManager.addRequest(A)}))),x3dom.BinaryContainerLoader.bufferGeoCache[n].promise.then((function(e){return g?x3dom.BinaryContainerLoader.draco.DecoderModule?(l=x3dom.BinaryContainerLoader.draco.DecoderModule,I=x3dom.BinaryContainerLoader.draco.Decoder,e):x3dom.DracoDecoderModule({wasmBinary:x3dom.DracoDecoderWASM.arrayBuffer}).then((function(t){return l=t,I=new t.Decoder,x3dom.BinaryContainerLoader.draco.DecoderModule=t,x3dom.BinaryContainerLoader.draco.Decoder=I,e})):e})).then((function(t){if(null!=e._webgl){if(g){var i=r._cf.views.nodes[0],o=new Int8Array(t).slice(i._vf.byteOffset,i._vf.byteOffset+i._vf.byteLength),s=I.GetEncodedGeometryType(o);s==l.TRIANGULAR_MESH&&(c=new l.Mesh,I.DecodeArrayToMesh(o,o.length,c)),s==l.POINT_CLOUD&&(c=new l.PointCloud,I.DecodeArrayToPointCloud(o,o.length,c))}!function(e){for(var t=r._cf.views.nodes,i=0;i<t.length;i++){var o=t[i],s=g?o._vf.dracoId:o._vf.idx,a=o._vf.byteOffset,d=o._vf.byteLength;if(null==x3dom.BinaryContainerLoader.bufferGeoCache[n].buffers[s]||!A.isBuffer(x3dom.BinaryContainerLoader.bufferGeoCache[n].buffers[s])){var h=f(e,a,d,o,i),l=A.createBuffer();A.bindBuffer(o._vf.target,l),A.bufferData(o._vf.target,h,A.STATIC_DRAW),A.bindBuffer(o._vf.target,null),x3dom.BinaryContainerLoader.bufferGeoCache[n].buffers[s]=l}}}(t),function(){for(var t=r._cf.accessors.nodes,A=0;A<t.length;A++){var i=t[A],o=i._vf.byteOffset,s=i._vf.byteStride,l=i._vf.bufferType,I=i._vf.components,c=i._vf.componentType,f=i._vf.normalized,u=i._vf.view;switch(l){case"INDEX":a=i,e._webgl.indexType=c,e._indexOffset=o;break;case"POSITION":d=i,e._coordStrideOffset=[s,o],e._webgl.coordType=c,e._webgl.coordNormalized=f,r._mesh._numPosComponents=I;break;case"NORMAL":h=!1,e._normalStrideOffset=[s,o],e._webgl.normalType=c,e._webgl.normalNormalized=f,r._mesh._numNormComponents=I;break;case"TEXCOORD_0":case"TEXCOORD":e._texCoordStrideOffset=[s,o],e._webgl.texCoordType=c,e._webgl.texCoordNormalized=f,r._mesh._numTexComponents=I;break;case"TEXCOORD_1":e._texCoord2StrideOffset=[s,o],e._webgl.texCoord2Type=c,e._webgl.texCoord2Normalized=f,r._mesh._numTex2Components=I;break;case"COLOR":case"COLOR_0":e._colorStrideOffset=[s,o],e._webgl.colorType=c,e._webgl.colorNormalized=f,r._mesh._numColComponents=I;break;case"TANGENT":e._tangentStrideOffset=[s,o],e._webgl.tangentType=c,e._webgl.tangentNormalized=f,r._mesh._numTangentComponents=I;break;case"BITANGENT":e._binormalStrideOffset=[s,o],e._webgl.binormalType=c,e._webgl.binormalNormalized=f,r._mesh._numBinormalComponents=I}var C=x3dom.BUFFER_IDX[i._vf.bufferType],_=r._cf.views.nodes[u],m=g?_._vf.dracoId:_._vf.idx;e._webgl.buffers[C]=x3dom.BinaryContainerLoader.bufferGeoCache[n].buffers[m]}}(),_(t),function(t){t.shapes.push(e),e._webgl._bufferGeoCache=t;var A=e._cleanupGLObjects;e._cleanupGLObjects=function(e,t){var i=this._webgl._bufferGeoCache;for(var o in i.buffers)delete i.buffers[o];var s=i.shapes.indexOf(this);s>-1&&i.shapes.splice(s,1),i.shapes.length>0||A.call(this,e,t)}}(x3dom.BinaryContainerLoader.bufferGeoCache[n]),g&&l.destroy(c),x3dom.BinaryContainerLoader.bufferGeoCache[n].decrementDownload&&(x3dom.BinaryContainerLoader.bufferGeoCache[n].decrementDownload=!1,e._nameSpace.doc.decrementDownloads(),e._nameSpace.doc.needRender=!0)}else x3dom.BinaryContainerLoader.bufferGeoCache[n]=void 0})).catch((function(){x3dom.BinaryContainerLoader.bufferGeoCache[n].decrementDownload&&(x3dom.BinaryContainerLoader.bufferGeoCache[n].decrementDownload=!1,e._nameSpace.doc.decrementDownloads())})))},x3dom.BinaryContainerLoader.setupBufferInterpolator=function(e){var t=function(e,t,A){for(var i=e._cf.views.nodes[t._vf.view],o=t._vf.byteOffset+i._vf.byteOffset,s=t._vf.count*t._vf.components,n=t._vf.componentType,r=x3dom.BinaryContainerLoader.getArrayBufferFromType(n,A,o,s),a=0,d=r.length;a<d;a++)r[a]=r[a]/e._vf.duration;return new x3dom.fields.MFFloat(r)},A=function(e,t,A){var i=e._cf.views.nodes[t._vf.view],o=t._vf.byteOffset+i._vf.byteOffset,s=t._vf.count*t._vf.components,n=t._vf.componentType,r=x3dom.BinaryContainerLoader.getArrayBufferFromType(n,A,o,s);return e.keyValueFromAccessor(r,n)},i=e._nameSpace.getURL(e._vf.buffer);null==x3dom.BinaryContainerLoader.bufferGeoCache[i]&&(e._nameSpace.doc.incrementDownloads(),x3dom.BinaryContainerLoader.bufferGeoCache[i]={},x3dom.BinaryContainerLoader.bufferGeoCache[i].buffers=[],x3dom.BinaryContainerLoader.bufferGeoCache[i].decrementDownload=!0,x3dom.BinaryContainerLoader.bufferGeoCache[i].promise=new Promise((function(e,t){var A=new XMLHttpRequest;A.open("GET",i),A.responseType="arraybuffer",A.onload=function(i){200!=A.status?t():e(A.response)},A.onerror=function(e){t()},x3dom.RequestManager.addRequest(A)}))),x3dom.BinaryContainerLoader.bufferGeoCache[i].promise.then((function(o){null!=e?(!function(i){for(var o,s,n=e._cf.accessors.nodes,r=0;r<n.length;r++){var a=n[r];switch(a._vf.bufferType){case"SAMPLER_INPUT":o=t(e,a,i),e._vf.key=o;break;case"SAMPLER_OUTPUT":s=A(e,a,i)}}if("STEP"===e._vf.interpolation){for(var d=o.copy(),h=s.copy(),g=(r=1,o.length);r<g;r++)d.splice(2*r,0,o[r]);for(r=0,g=s.length;r<g;r++)h.splice(2*r+1,0,s[r]);o=d,s=h}e._vf.keyValue=s}(o),x3dom.BinaryContainerLoader.bufferGeoCache[i].decrementDownload&&(x3dom.BinaryContainerLoader.bufferGeoCache[i].decrementDownload=!1,e._nameSpace.doc.decrementDownloads(),e._nameSpace.doc.needRender=!0)):x3dom.BinaryContainerLoader.bufferGeoCache[i]=void 0})).catch((function(){x3dom.BinaryContainerLoader.bufferGeoCache[i].decrementDownload&&(x3dom.BinaryContainerLoader.bufferGeoCache[i].decrementDownload=!1,e._nameSpace.doc.decrementDownloads())}))},x3dom.BinaryContainerLoader.getArrayBufferFromType=function(e,t,A,i){switch(e){case 5120:return new Int8Array(t,A,i);case 5121:return new Uint8Array(t,A,i);case 5122:return new Int16Array(t,A,i);case 5123:return new Uint16Array(t,A,i);case 5125:return new Uint32Array(t,A,i);case 5126:return new Float32Array(t,A,i)}},x3dom.DrawableCollection=function(e){this.collection=[],this.viewMatrix=e.viewMatrix,this.projMatrix=e.projMatrix,this.sceneMatrix=e.sceneMatrix,this.viewarea=e.viewArea;var t=this.viewarea._scene,A=t.getEnvironment(),i=t.getViewpoint();this.near=i.getNear(),this.pixelHeightAtDistOne=i.getImgPlaneHeightAtDistOne()/this.viewarea._height,this.context=e.context,this.gl=e.gl,this.viewFrustum=this.viewarea.getViewfrustum(this.sceneMatrix),this.worldVol=new x3dom.fields.BoxVolume,this.frustumCulling=e.frustumCulling&&null!=this.viewFrustum,this.smallFeatureThreshold=e.smallFeatureThreshold,this.sortOpaque=this.smallFeatureThreshold>0&&A._lowPriorityThreshold<1,this.sortTrans=e.sortTrans,this.prioLevels=10,this.maxTreshold=100,this.sortBySortKey=!1,this.sortByPriority=!1,this.numberOfNodes=0,this.length=0},x3dom.DrawableCollection.prototype.cull=function(e,t,A,i){var o=t.boundedNode;if(!o||!o.renderFlag())return-1;var s,n=o.getVolume();if(this.frustumCulling&&t.needCulling){if(A&&!t.worldVolume.isValid()?(t.worldVolume.transformFrom(e,n),s=t.worldVolume):i<63&&(this.worldVol.transformFrom(e,n),s=this.worldVol),i<63&&(i=this.viewFrustum.intersect(s,i)),-1==i)return-1}else i=63;if(t.coverage=-1,this.smallFeatureThreshold>0||o.forceUpdateCoverage()){var r=this.viewMatrix.mult(e);t.center=r.multMatrixPnt(n.getCenter());var a=r.multMatrixVec(n.getRadialVec()).length(),d=Math.max(-t.center.z-a,this.near)*this.pixelHeightAtDistOne;if(t.coverage=2*a/d,this.smallFeatureThreshold>0&&t.coverage<this.smallFeatureThreshold&&t.needCulling)return-1}return this.numberOfNodes++,i},x3dom.DrawableCollection.prototype.addShape=function(e,t,A){var i={};i.shape=e,i.transform=t,i.localTransform=A.localMatrix,i.localVolume=A.volume,i.worldVolume=x3dom.fields.BoxVolume.copy(A.worldVolume),i.priority=Math.max(0,A.coverage),i.shaderID=e.getShaderProperties(this.viewarea).id;var o=e._cf.appearance.node;if(i.sortType=o?o._vf.sortType.toLowerCase():"opaque",i.sortKey=o?o._vf.sortKey:0,"transparent"==i.sortType)if(this.smallFeatureThreshold>0)i.zPos=A.center.z;else{var s=t.multMatrixPnt(e.getCenter());s=this.viewMatrix.multMatrixPnt(s),i.zPos=s.z}this.sortBySortKey||0==i.sortKey||(this.sortBySortKey=!0),void 0===this.collection[i.sortType]&&(this.collection[i.sortType]=[]),this.collection[i.sortType].push(i),this.length++,this.context&&this.gl&&this.context.setupShape(this.gl,i,this.viewarea)},x3dom.DrawableCollection.prototype.addDrawable=function(e){e.shaderID=e.shape.getShaderProperties(this.viewarea).id;var t=e.shape._cf.appearance.node;if(e.sortType=t?t._vf.sortType.toLowerCase():"opaque",e.sortKey=t?t._vf.sortKey:0,"transparent"==e.sortType){var A=e.transform.multMatrixPnt(e.shape.getCenter());A=this.viewMatrix.multMatrixPnt(A),e.zPos=A.z}this.sortBySortKey||0==e.sortKey||(this.sortBySortKey=!0),void 0===this.collection[e.sortType]&&(this.collection[e.sortType]=[]),this.collection[e.sortType].push(e),this.length++,this.context&&this.gl&&this.context.setupShape(this.gl,e,this.viewarea)},x3dom.DrawableCollection.prototype.calculatePriority=function(e){var t=Math.max(0,e.coverage),A=this.prioLevels-1;return t=Math.min(Math.round(t/(this.maxTreshold/A)),A)},x3dom.DrawableCollection.prototype.concat=function(){var e=void 0!==this.collection.opaque?this.collection.opaque:[],t=void 0!==this.collection.transparent?this.collection.transparent:[];this.collection=e.concat(t)},x3dom.DrawableCollection.prototype.get=function(e){return this.collection[e]},x3dom.DrawableCollection.prototype.sort=function(){var e=[],t=[],A=this;void 0!==this.collection.opaque&&(this.sortOpaque&&this.collection.opaque.sort((function(e,t){return e.sortKey!=t.sortKey&&A.sortBySortKey?e.sortKey-t.sortKey:t.priority-e.priority})),e=this.collection.opaque),void 0!==this.collection.transparent&&(this.sortTrans&&this.collection.transparent.sort((function(e,t){return e.sortKey!=t.sortKey&&A.sortBySortKey?e.sortKey-t.sortKey:e.priority!=t.priority&&A.sortByPriority?t.priority-e.priority:e.zPos-t.zPos})),t=this.collection.transparent),this.collection=e.concat(t)},x3dom.DrawableCollection.prototype.forEach=function(e,t){var A,i,o,s;for(t=void 0!==t?Math.min(t,this.prioLevels):this.prioLevels,A=0;A<this.collection.opaque.length;++A)if(void 0!==this.collection.opaque[A])for(i=this.collection.opaque[A].length;i>0;--i)if(void 0!==this.collection.opaque[A][i])for(o in this.collection.opaque[A][i])for(s=0;s<this.collection.opaque[A][i][o].length;++s)e(this.collection.opaque[A][i][o][s]);for(A=0;A<this.collection.transparent.length;++A)if(void 0!==this.collection.transparent[A])for(i=this.collection.transparent[A].length;i>0;--i)if(void 0!==this.collection.transparent[A][i])for(var n in this.collection.transparent[A][i])for(this.collection.transparent[A][i][n].sort((function(e,t){return e.zPos-t.zPos})),s=0;s<this.collection.transparent[A][i][n].length;++s)e(this.collection.transparent[A][i][n][s])},x3dom.Moveable=function(e,t,A,i,o){this._x3domRoot=e,this._runtime=e.runtime,this._callback=A,this._gridSize=i||0,this._moveable=t,this._drag=!1,this._w=0,this._h=0,this._uPlane=null,this._vPlane=null,this._pPlane=null,this._isect=null,this._translationOffset=null,this._rotationOffset=null,this._scaleOffset=null,this._lastX=0,this._lastY=0,this._buttonState=0,this._mode=o&&o.length?o.toLowerCase():"translation",this._firstRay=null,this._matrixTrafo=null,this._navType="examine",this.attachHandlers()},x3dom.Moveable.prototype.setGridSize=function(e){this._gridSize=e},x3dom.Moveable.prototype.setMode=function(e){this._mode=e.toLowerCase()},x3dom.Moveable.prototype.attachHandlers=function(){this._moveable._iMove=this,this._x3domRoot._iMove||(this._x3domRoot._iMove=[]),this._x3domRoot._iMove.push(this),this._moveable.addEventListener("mousedown",this.start,!1),this._moveable.addEventListener("mouseover",this.over,!1),this._moveable.addEventListener("mouseout",this.out,!1),1==this._x3domRoot._iMove.length&&(this._x3domRoot.addEventListener("mouseup",this.stop,!1),this._x3domRoot.addEventListener("mouseout",this.stop,!1),this._x3domRoot.addEventListener("mousemove",this.move,!0),this._runtime.canvas.disableTouch||(this._x3domRoot.addEventListener("MozTouchDown",this.touchStartHandlerMoz,!1),this._x3domRoot.addEventListener("MozTouchMove",this.touchMoveHandlerMoz,!0),this._x3domRoot.addEventListener("MozTouchUp",this.touchEndHandlerMoz,!1),this._x3domRoot.addEventListener("touchstart",this.touchStartHandler,!1),this._x3domRoot.addEventListener("touchmove",this.touchMoveHandler,!0),this._x3domRoot.addEventListener("touchend",this.touchEndHandler,!1)))},x3dom.Moveable.prototype.detachHandlers=function(){var e=this._x3domRoot._iMove;if(e)for(var t=0,A=e.length;t<A;t++)if(e[t]==this){e.splice(t,1);break}this._moveable.removeEventListener("mousedown",this.start,!1),this._moveable.removeEventListener("mouseover",this.over,!1),this._moveable.removeEventListener("mouseout",this.out,!1),0==e.length&&(this._x3domRoot.removeEventListener("mouseup",this.stop,!1),this._x3domRoot.removeEventListener("mouseout",this.stop,!1),this._x3domRoot.removeEventListener("mousemove",this.move,!0),this._runtime.canvas.disableTouch||(this._x3domRoot.removeEventListener("MozTouchDown",this.touchStartHandlerMoz,!1),this._x3domRoot.removeEventListener("MozTouchMove",this.touchMoveHandlerMoz,!0),this._x3domRoot.removeEventListener("MozTouchUp",this.touchEndHandlerMoz,!1),this._x3domRoot.removeEventListener("touchstart",this.touchStartHandler,!1),this._x3domRoot.removeEventListener("touchmove",this.touchMoveHandler,!0),this._x3domRoot.removeEventListener("touchend",this.touchEndHandler,!1))),this._moveable._iMove&&delete this._moveable._iMove},x3dom.Moveable.prototype.calcViewPlane=function(e){this._w=this._runtime.getWidth(),this._h=this._runtime.getHeight();var t=this._runtime.getViewingRay(0,this._h-1),A=t.pos.add(t.dir),i=(t=this._runtime.getViewingRay(this._w-1,this._h-1)).pos.add(t.dir),o=(t=this._runtime.getViewingRay(0,0)).pos.add(t.dir);this._uPlane=i.subtract(A).normalize(),this._vPlane=o.subtract(A).normalize(),0===arguments.length?this._pPlane=A:this._pPlane=x3dom.fields.SFVec3f.copy(e)},x3dom.Moveable.prototype.det=function(e){return e[0][0]*e[1][1]*e[2][2]+e[0][1]*e[1][2]*e[2][0]+e[0][2]*e[2][1]*e[1][0]-e[2][0]*e[1][1]*e[0][2]-e[0][0]*e[2][1]*e[1][2]-e[1][0]*e[0][1]*e[2][2]},x3dom.Moveable.prototype.translateXY=function(e){for(var t=null,A=[],i=[],o=0;o<3;o++)A[o]=[],i[o]=[],A[o][0]=this._uPlane.at(o),i[o][0]=A[o][0],A[o][1]=this._vPlane.at(o),i[o][1]=A[o][1],A[o][2]=e.pos.subtract(this._pPlane).at(o),i[o][2]=-e.dir.at(o);var s=this.det(i);if(0!==s){var n=this.det(A)/s;t=e.pos.addScaled(e.dir,n)}return t&&(this._isect&&(t=t.subtract(this._isect)),t=t.add(this._translationOffset)),t},x3dom.Moveable.prototype.translateZ=function(e,t){var A=this._runtime.getSceneBBox(),i=(t<this._lastY?1:-1)*A.max.subtract(A.min).length()/100;return this._translationOffset=this._translationOffset.addScaled(e.dir,i),this._translationOffset},x3dom.Moveable.prototype.rotate=function(e,t){var A=2*Math.PI,i=(t-this._lastY)*A/this._w,o=(e-this._lastX)*A/this._h,s=x3dom.fields.Quaternion.axisAngle(this._uPlane,i),n=s.toMatrix();this._rotationOffset=n.mult(this._rotationOffset),n=(s=x3dom.fields.Quaternion.axisAngle(this._vPlane,o)).toMatrix(),this._rotationOffset=n.mult(this._rotationOffset);var r=this._rotationOffset.mult(x3dom.fields.SFMatrix4f.scale(this._scaleOffset)),a=new x3dom.fields.Quaternion(0,0,1,0);return a.setValue(r),a},x3dom.Moveable.prototype.over=function(e){this._iMove._runtime.getCanvas().style.cursor="crosshair"},x3dom.Moveable.prototype.out=function(e){var t=this._iMove;t._drag||(t._runtime.getCanvas().style.cursor="pointer")},x3dom.Moveable.prototype.start=function(e){var t=this._iMove;switch(t._mode){case"translation":t._buttonState=4==e.button?1:3&e.button;break;case"rotation":t._buttonState=4;break;case"all":default:t._buttonState=e.button}if(!t._drag&&t._buttonState){t._lastX=e.layerX,t._lastY=e.layerY,t._drag=!0,t._navType=t._runtime.navigationType(),t._runtime.noNav(),t._isect=new x3dom.fields.SFVec3f(e.worldX,e.worldY,e.worldZ),t.calcViewPlane(t._isect),t._firstRay=t._runtime.getViewingRay(e.layerX,e.layerY);var A=t._moveable.getAttribute("translation");if(t._matrixTrafo=null,A){t._translationOffset=x3dom.fields.SFVec3f.parse(A);var i=t._moveable.getAttribute("rotation");i=i?x3dom.fields.Quaternion.parseAxisAngle(i):new x3dom.fields.Quaternion(0,0,1,0),t._rotationOffset=i.toMatrix();var o=t._moveable.getAttribute("scale");t._scaleOffset=o?x3dom.fields.SFVec3f.parse(o):new x3dom.fields.SFVec3f(1,1,1)}else if(A=t._moveable.getAttribute("matrix")){t._matrixTrafo=x3dom.fields.SFMatrix4f.parse(A).transpose();var s=new x3dom.fields.SFVec3f(0,0,0),n=new x3dom.fields.SFVec3f(1,1,1),r=new x3dom.fields.Quaternion(0,0,1,0),a=new x3dom.fields.Quaternion(0,0,1,0);t._matrixTrafo.getTransform(s,r,n,a),t._translationOffset=s,t._rotationOffset=r.toMatrix(),t._scaleOffset=n}else t._translationOffset=new x3dom.fields.SFVec3f(0,0,0),t._rotationOffset=new x3dom.fields.SFMatrix4f,t._scaleOffset=new x3dom.fields.SFVec3f(1,1,1);t._runtime.getCanvas().style.cursor="crosshair"}},x3dom.Moveable.prototype.move=function(e){for(var t=0,A=this._iMove.length;t<A;t++){var i=this._iMove[t];if(i._drag){var o=i._runtime.mousePosition(e),s=i._runtime.getViewingRay(o[0],o[1]),n=null;if(n=2==i._buttonState?i.translateZ(i._firstRay,o[1]):1==i._buttonState?i.translateXY(s):i.rotate(o[0],o[1])){if(i._gridSize>0&&4!=i._buttonState){var r=i._gridSize*Math.round(n.x/i._gridSize),a=i._gridSize*Math.round(n.y/i._gridSize),d=i._gridSize*Math.round(n.z/i._gridSize);n=new x3dom.fields.SFVec3f(r,a,d)}i._matrixTrafo?(4==i._buttonState?i._matrixTrafo.setRotate(n):i._matrixTrafo.setTranslate(n),i._moveable.setAttribute("matrix",i._matrixTrafo.toGL().toString())):4==i._buttonState?i._moveable.setAttribute("rotation",n.toAxisAngle().toString()):i._moveable.setAttribute("translation",n.toString()),i._callback&&i._callback(i._moveable,n)}i._lastX=o[0],i._lastY=o[1]}}},x3dom.Moveable.prototype.stop=function(e){for(var t=0,A=this._iMove.length;t<A;t++){var i=this._iMove[t];if(i._drag)i._lastX=e.layerX,i._lastY=e.layerY,i._isect=null,i._drag=!1,i._runtime.canvas.doc._scene.getNavigationInfo().setType(i._navType),i._runtime.getCanvas().style.cursor="pointer"}},x3dom.Moveable.prototype.touchStartHandler=function(e){e.preventDefault()},x3dom.Moveable.prototype.touchStartHandlerMoz=function(e){e.preventDefault()},x3dom.Moveable.prototype.touchMoveHandler=function(e){e.preventDefault()},x3dom.Moveable.prototype.touchMoveHandlerMoz=function(e){e.preventDefault()},x3dom.Moveable.prototype.touchEndHandler=function(e){if(this._iMove.length){var t=this._iMove[0];t.stop.apply(t._x3domRoot,[e])}e.preventDefault()},x3dom.Moveable.prototype.touchEndHandlerMoz=function(e){if(this._iMove.length){var t=this._iMove[0];t.stop.apply(t._x3domRoot,[e])}e.preventDefault()},function(){"use strict";function e(e){return"function"==typeof e}function t(){var e=setTimeout;return function(){return e(A,1)}}function A(){for(var e=0;e<C;e+=2)(0,y[e])(y[e+1]),y[e]=void 0,y[e+1]=void 0;C=0}function i(e,t){var A=this,i=new this.constructor(s);void 0===i[D]&&f(i);var o=A._state;if(o){var n=arguments[o-1];p((function(){return c(o,i,n,A._result)}))}else l(A,i,e,t);return i}function o(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(s);return a(t,e),t}function s(){}function n(e){try{return e.then}catch(e){return T.error=e,T}}function r(t,A,s){A.constructor===t.constructor&&s===i&&A.constructor.resolve===o?function(e,t){t._state===w?h(e,t._result):t._state===N?g(e,t._result):l(t,void 0,(function(t){return a(e,t)}),(function(t){return g(e,t)}))}(t,A):s===T?(g(t,T.error),T.error=null):void 0===s?h(t,A):e(s)?function(e,t,A){p((function(e){var i=!1,o=function(e,t,A,i){try{e.call(t,A,i)}catch(e){return e}}(A,t,(function(A){i||(i=!0,t!==A?a(e,A):h(e,A))}),(function(t){i||(i=!0,g(e,t))}),e._label);!i&&o&&(i=!0,g(e,o))}),e)}(t,A,s):h(t,A)}function a(e,t){e===t?g(e,new TypeError("You cannot resolve a promise with itself")):function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)?r(e,t,n(t)):h(e,t)}function d(e){e._onerror&&e._onerror(e._result),I(e)}function h(e,t){e._state===S&&(e._result=t,e._state=w,0!==e._subscribers.length&&p(I,e))}function g(e,t){e._state===S&&(e._state=N,e._result=t,p(d,e))}function l(e,t,A,i){var o=e._subscribers,s=o.length;e._onerror=null,o[s]=t,o[s+w]=A,o[s+N]=i,0===s&&e._state&&p(I,e)}function I(e){var t=e._subscribers,A=e._state;if(0!==t.length){for(var i=void 0,o=void 0,s=e._result,n=0;n<t.length;n+=3)i=t[n],o=t[n+A],i?c(A,i,o,s):o(s);e._subscribers.length=0}}function c(t,A,i,o){var s=e(i),n=void 0,r=void 0,d=void 0,l=void 0;if(s){if((n=function(e,t){try{return e(t)}catch(e){return T.error=e,T}}(i,o))===T?(l=!0,r=n.error,n.error=null):d=!0,A===n)return void g(A,new TypeError("A promises callback cannot return that same promise."))}else n=o,d=!0;A._state!==S||(s&&d?a(A,n):l?g(A,r):t===w?h(A,n):t===N&&g(A,n))}function f(e){e[D]=b++,e._state=void 0,e._result=void 0,e._subscribers=[]}var u=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},C=0,_=void 0,m=void 0,p=function(e,t){y[C]=e,y[C+1]=t,2===(C+=2)&&(m?m(A):F())},E="undefined"!=typeof window?window:void 0,B=E||{},Q=B.MutationObserver||B.WebKitMutationObserver,x="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),v="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,y=new Array(1e3),F=void 0;F=x?function(){return process.nextTick(A)}:Q?function(){var e=0,t=new Q(A),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}():v?function(){var e=new MessageChannel;return e.port1.onmessage=A,function(){return e.port2.postMessage(0)}}():void 0===E&&"function"==typeof require?function(){try{var e=Function("return this")().require("vertx");return void 0!==(_=e.runOnLoop||e.runOnContext)?function(){_(A)}:t()}catch(e){return t()}}():t();var D=Math.random().toString(36).substring(2),S=void 0,w=1,N=2,T={error:null},b=0,M=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(s),this.promise[D]||f(this.promise),u(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?h(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&h(this.promise,this._result))):g(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===S&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var A=this._instanceConstructor,a=A.resolve;if(a===o){var d=n(e);if(d===i&&e._state!==S)this._settledAt(e._state,t,e._result);else if("function"!=typeof d)this._remaining--,this._result[t]=e;else if(A===R){var h=new A(s);r(h,e,d),this._willSettleAt(h,t)}else this._willSettleAt(new A((function(t){return t(e)})),t)}else this._willSettleAt(a(e),t)},e.prototype._settledAt=function(e,t,A){var i=this.promise;i._state===S&&(this._remaining--,e===N?g(i,A):this._result[t]=A),0===this._remaining&&h(i,this._result)},e.prototype._willSettleAt=function(e,t){var A=this;l(e,void 0,(function(e){return A._settledAt(w,t,e)}),(function(e){return A._settledAt(N,t,e)}))},e}(),R=function(){function e(t){this[D]=b++,this._result=this._state=void 0,this._subscribers=[],s!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t((function(t){a(e,t)}),(function(t){g(e,t)}))}catch(t){g(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then((function(A){return t.resolve(e()).then((function(){return A}))}),(function(A){return t.resolve(e()).then((function(){throw A}))}))},e}();R.prototype.then=i,R.all=function(e){return new M(this,e).promise},R.race=function(e){var t=this;return new t(u(e)?function(A,i){for(var o=e.length,s=0;s<o;s++)t.resolve(e[s]).then(A,i)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},R.resolve=o,R.reject=function(e){var t=new this(s);return g(t,e),t},R._setScheduler=function(e){m=e},R._setAsap=function(e){p=e},R._asap=p,R.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var A=null;try{A=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===A&&!t.cast)return}e.Promise=R},R.Promise=R,R.polyfill()}(),x3dom.glTF2Loader=function(e){this._nameSpace=e,this._definitions={},this._supportedExtensions=["KHR_materials_pbrSpecularGlossiness","KHR_materials_unlit","KHR_texture_transform"],x3dom.DracoDecoderModule&&this._supportedExtensions.push("KHR_draco_mesh_compression")},x3dom.glTF2Loader.prototype.load=function(e,t){this._gltf=this._getGLTF(e,t);var A=this._generateX3DScene(),i=this._gltf.scene||0,o=this._gltf.scenes[i];if(this._generateX3DWorldInfo(o,A),this._unsupportedExtensionsRequired())return x3dom.debug.logWarning("Cannot render glTF."),x3dom.debug.logWarning("Some required extension of "+this._gltf.extensionsRequired+" not supported."),A;for(var s=0;s<o.nodes.length;s++){var n=this._gltf.nodes[o.nodes[s]];this._traverseNodes(n,A,o.nodes[s])}if(this._gltf.animations)for(s=0;s<this._gltf.animations.length;s++){var r=this._gltf.animations[s],a="glTF_ANIMATION_"+s;this._generateX3DAnimationNodes(A,r,a)}return A},x3dom.glTF2Loader.prototype._unsupportedExtensionsRequired=function(){return!!this._gltf.extensionsRequired&&this._gltf.extensionsRequired.some((function(e){return this._supportedExtensions.indexOf(e)<0}),this)},x3dom.glTF2Loader.prototype._generateX3DWorldInfo=function(e,t){if(this._gltf.asset){var A,i,o=this._gltf.asset,s=["copyright","generator","version","minversion"],n=document.createElement("worldinfo"),r=new x3dom.fields.MFString;for(i=0;i<s.length;i++)o[A=s[i]]&&r.push('"'+s[i]+":"+o[A]+'"');n.setAttribute("info",r.toString()),o.extras&&o.extras.title&&n.setAttribute("title",o.extras.title);var a=document.createElement("MetadataSet");a.setAttribute("name","global"),a.setAttribute("containerfield","metadata"),this._generateX3DMetadata(o,a,"asset_extras","value"),this._generateX3DMetadata(e,a,"scene_extras","value"),a.hasChildNodes()&&n.appendChild(a),t.appendChild(n)}},x3dom.glTF2Loader.prototype._generateX3DMetadata=function(e,t,A,i){if(e.extras){i=i||"metadata";var o=s(A=A||"extras",e.extras,i);t.appendChild(o)}else;function s(e,t,A){var i=typeof t;return"string"==i||null===t||"undefined"==i?n("MetadataString",e,JSON.stringify(t),A):"number"==i?n("MetadataFloat",e,t,A):"boolean"==i?n("MetadataBoolean",e,t,A):"object"==i?function(e,t,A){var i=document.createElement("MetadataSet");i.setAttribute("name",e),i.setAttribute("containerfield",A);var o,n,r=Object.keys(t);for(n=0;n<r.length;n++)o=r[n],i.appendChild(s(o,t[o],"value"));return i}(e,t,A):n("MetadataString",e,t,A)}function n(e,t,A,i){var o=document.createElement(e);return o.setAttribute("name",t),o.setAttribute("value",A),o.setAttribute("containerfield",i),o}},x3dom.glTF2Loader.prototype._traverseNodes=function(e,t,A){var i=this._generateX3DNode(e,A);if(t.appendChild(i),e.children)for(var o=0;o<e.children.length;o++){var s=this._gltf.nodes[e.children[o]];this._traverseNodes(s,i,e.children[o])}},x3dom.glTF2Loader.prototype._generateX3DNode=function(e,t){var A;if(e.name=e.name?e.name:t,A=null!=e.matrix?this._generateX3DMatrixTransform(e):(null!=e.translation||null!=e.rotation||e.scale,this._generateX3DTransform(e)),this._generateX3DMetadata(e,A),null!=e.mesh)for(var i=this._gltf.meshes[e.mesh],o=0;o<i.primitives.length;o++)A.appendChild(this._generateX3DShape(i.primitives[o]));if(null!=e.model){var s=this._gltf.models[e.model];null!=s.uri&&A.appendChild(this._generateX3DInline(s))}return null!=e.camera&&A.appendChild(this._generateX3DViewpoint(e)),A},x3dom.glTF2Loader.prototype._generateX3DScene=function(){return document.createElement("scene")},x3dom.glTF2Loader.prototype._generateX3DTransform=function(e){var t=document.createElement("transform");return null!=e.translation&&t.setAttribute("translation",e.translation.join(" ")),null!=e.rotation&&t.setAttribute("rotation",this._toAxisAngle(e.rotation).join(" ")),null!=e.scale&&t.setAttribute("scale",e.scale.join(" ")),null!=e.name&&t.setAttribute("DEF","glTF_NODE_"+e.name),t},x3dom.glTF2Loader.prototype._generateX3DMatrixTransform=function(e){var t=document.createElement("matrixtransform");return null!=e.matrix&&t.setAttribute("matrix",e.matrix.join(" ")),null!=e.name&&t.setAttribute("DEF","glTF_NODE_"+e.name),t},x3dom.glTF2Loader.prototype._generateX3DGroup=function(e){return document.createElement("group")},x3dom.glTF2Loader.prototype._generateX3DInline=function(e){var t=document.createElement("inline");return t.setAttribute("url",e.uri),null!=e.mimeType&&t.setAttribute("contentType",e.mimeType),t},x3dom.glTF2Loader.prototype._generateX3DViewpoint=function(e){var t=this._gltf.cameras[e.camera],A="glTF_CAMERA_"+e.camera;switch(t.type){case"orthographic":return this._generateX3DOrthoViewpoint(A,t.orthographic);case"perspective":default:return this._generateX3DPerspectiveViewpoint(A,t.perspective)}},x3dom.glTF2Loader.prototype._generateX3DPerspectiveViewpoint=function(e,t){var A=document.createElement("viewpoint");this._generateX3DMetadata(t,A);var i=t.yfov||.785398,o=t.znear||-1,s=t.zfar||-1;return s/o>1e5&&(s=o=-1),A.setAttribute("DEF",e),A.setAttribute("fieldOfView",i),A.setAttribute("zNear",o),A.setAttribute("zFar",s),A.setAttribute("position","0 0 0"),A},x3dom.glTF2Loader.prototype._generateX3DOrthoViewpoint=function(e,t){var A=document.createElement("orthoviewpoint");this._generateX3DMetadata(t,A);var i=t.xmag||1,o=t.ymag||1,s=t.znear||-1,n=t.zfar||-1,r=[-i,-o,i,o];return A.setAttribute("DEF",e),A.setAttribute("fieldOfView",r),A.setAttribute("zNear",s),A.setAttribute("zFar",n),A.setAttribute("position","0 0 0"),A},x3dom.glTF2Loader.prototype._generateX3DShape=function(e){var t=document.createElement("shape");this._generateX3DMetadata(e,t);var A=null!=e.material?this._gltf.materials[e.material]:{name:"DEFAULT"};null==A.name&&(A.name=e.material),t.appendChild(this._generateX3DAppearance(A));var i=null;return e.extensions&&e.extensions.KHR_draco_mesh_compression&&(i=e.extensions.KHR_draco_mesh_compression),i&&!x3dom.DracoDecoderModule?t:(t.appendChild(this._generateX3DBufferGeometry(e,i)),t)},x3dom.glTF2Loader.prototype._generateX3DAppearance=function(e){var t=document.createElement("appearance");return this._generateX3DMetadata(e,t),"BLEND"===e.alphaMode?t.setAttribute("sortType","transparent"):t.setAttribute("sortType","opaque"),t.setAttribute("alphaClipThreshold",0),t.appendChild(this._generateX3DPhysicalMaterial(e)),this._textureTransform&&(t.appendChild(this._textureTransform),this._textureTransform=void 0),t},x3dom.glTF2Loader.prototype._generateX3DPhysicalMaterial=function(e){var t=document.createElement("physicalmaterial");if(this._USEorDEF(t,"glTF_MATERIAL_"+e.name))return t;var A,i,o=[1,1,1,1],s=e.emissiveFactor||[0,0,0],n=1,r=1,a=e.alphaMode||"OPAQUE",d=e.alphaCutoff||.5,h=!0,g=void 0,l=void 0,I=0;if(e.pbrMetallicRoughness?(l=e.pbrMetallicRoughness,g="roughnessMetallic"):e.extensions&&e.extensions.KHR_materials_pbrSpecularGlossiness&&(l=e.extensions.KHR_materials_pbrSpecularGlossiness,g="specularGlossiness"),"roughnessMetallic"==g){o=l.baseColorFactor||[1,1,1,1],n=null!=l.metallicFactor?l.metallicFactor:1,r=null!=l.roughnessFactor?l.roughnessFactor:1;l.baseColorTexture&&(I=l.baseColorTexture.texCoord?1:0,A=this._gltf.textures[l.baseColorTexture.index],i=l.baseColorTexture.extensions&&l.baseColorTexture.extensions.KHR_texture_transform?l.baseColorTexture.extensions.KHR_texture_transform:void 0,t.appendChild(this._generateX3DImageTexture(A,"baseColorTexture",I,i))),l.metallicRoughnessTexture&&(I=l.metallicRoughnessTexture.texCoord?1:0,A=this._gltf.textures[l.metallicRoughnessTexture.index],i=l.metallicRoughnessTexture.extensions&&l.metallicRoughnessTexture.extensions.KHR_texture_transform?l.metallicRoughnessTexture.extensions.KHR_texture_transform:void 0,e.occlusionTexture&&e.occlusionTexture.index==l.metallicRoughnessTexture.index?(h=!1,t.appendChild(this._generateX3DImageTexture(A,"occlusionRoughnessMetallicTexture",I,i))):t.appendChild(this._generateX3DImageTexture(A,"roughnessMetallicTexture",I,i))),t.setAttribute("baseColorFactor",o.join(" ")),t.setAttribute("metallicFactor",n),t.setAttribute("roughnessFactor",r)}else if("specularGlossiness"==g){var c=l.diffuseFactor||[1,1,1,1],f=l.specularFactor||[1,1,1],u=null!=l.glossinessFactor?l.glossinessFactor:1;l.diffuseTexture&&(I=l.diffuseTexture.texCoord?1:0,A=this._gltf.textures[l.diffuseTexture.index],i=l.diffuseTexture.extensions&&l.diffuseTexture.extensions.KHR_texture_transform?l.diffuseTexture.extensions.KHR_texture_transform:void 0,t.appendChild(this._generateX3DImageTexture(A,"baseColorTexture",I,i))),l.specularGlossinessTexture&&(I=l.specularGlossinessTexture.texCoord?1:0,A=this._gltf.textures[l.specularGlossinessTexture.index],i=l.specularGlossinessTexture.extensions&&l.specularGlossinessTexture.extensions.KHR_texture_transform?l.specularGlossinessTexture.extensions.KHR_texture_transform:void 0,t.appendChild(this._generateX3DImageTexture(A,"specularGlossinessTexture",I,i))),t.setAttribute("diffuseFactor",c.join(" ")),t.setAttribute("specularFactor",f.join(" ")),t.setAttribute("glossinessFactor",u)}return e.normalTexture&&(I=e.normalTexture.texCoord?1:0,A=this._gltf.textures[e.normalTexture.index],i=e.normalTexture.extensions&&e.normalTexture.extensions.KHR_texture_transform?e.normalTexture.extensions.KHR_texture_transform:void 0,t.appendChild(this._generateX3DImageTexture(A,"normalTexture",I,i))),e.emissiveTexture&&(I=e.emissiveTexture.texCoord?1:0,A=this._gltf.textures[e.emissiveTexture.index],i=e.emissiveTexture.extensions&&e.emissiveTexture.extensions.KHR_texture_transform?e.emissiveTexture.extensions.KHR_texture_transform:void 0,t.appendChild(this._generateX3DImageTexture(A,"emissiveTexture",I,i))),e.occlusionTexture&&h&&(I=e.occlusionTexture.texCoord?1:0,A=this._gltf.textures[e.occlusionTexture.index],i=e.occlusionTexture.extensions&&e.occlusionTexture.extensions.KHR_texture_transform?e.occlusionTexture.extensions.KHR_texture_transform:void 0,t.appendChild(this._generateX3DImageTexture(A,"occlusionTexture",I,i))),e.extensions&&e.extensions.KHR_materials_unlit&&t.setAttribute("unlit",!0),t.setAttribute("emissiveFactor",s.join(" ")),t.setAttribute("alphaMode",a),t.setAttribute("alphaCutoff",d),t.setAttribute("model",g),t},x3dom.glTF2Loader.prototype._generateX3DImageTexture=function(e,t,A,i){var o=this._gltf.images[e.source],s=document.createElement("imagetexture");if(this._generateX3DMetadata(e,s),s.setAttribute("origChannelCount","2"),s.setAttribute("flipY","true"),t&&s.setAttribute("containerField",t),null!=o.uri&&s.setAttribute("url",x3dom.Utils.dataURIToObjectURL(o.uri)),null!=e.sampler){var n=this._gltf.samplers[e.sampler];s.appendChild(this._createX3DTextureProperties(n))}return A&&s.setAttribute("channel","1"),i&&(this._textureTransform=this._createX3DTextureTransform(s,i)),s},x3dom.glTF2Loader.prototype._createX3DTextureProperties=function(e){var t=document.createElement("textureproperties");return t.setAttribute("boundaryModeS",x3dom.Utils.boundaryModesDicX3D(e.wrapS)),t.setAttribute("boundaryModeT",x3dom.Utils.boundaryModesDicX3D(e.wrapT)),t.setAttribute("magnificationFilter",x3dom.Utils.magFilterDicX3D(e.magFilter)),t.setAttribute("minificationFilter",x3dom.Utils.minFilterDicX3D(e.minFilter)),(null==e.minFilter||e.minFilter>=9984&&e.minFilter<=9987)&&t.setAttribute("generateMipMaps","true"),t},x3dom.glTF2Loader.prototype._createX3DTextureTransform=function(e,t){var A=document.createElement("matrixtexturetransform"),i=t.offset||[0,0],o=t.rotation||0,s=t.scale||[1,1],n=new x3dom.fields.SFVec3f(-0,-0,0),r=new x3dom.fields.SFVec3f(0,0,0),a=new x3dom.fields.SFVec3f(i[0],i[1],0),d=new x3dom.fields.SFVec3f(s[0],s[1],0),h=x3dom.fields.SFMatrix4f.translation(r.add(a)).mult(x3dom.fields.SFMatrix4f.rotationZ(-1*o)).mult(x3dom.fields.SFMatrix4f.scale(d)).mult(x3dom.fields.SFMatrix4f.translation(n));return A.setAttribute("matrix",h.toString()),t.texCoord&&e.setAttribute("channel",texCoord),A},x3dom.glTF2Loader.prototype._generateX3DBufferGeometry=function(e,t){var A,i,o,s,n=[],r=document.createElement("buffergeometry"),a=this._getCenterAndSize(e);(A=t?x3dom.Utils.dataURIToObjectURL(this._gltf.buffers[this._gltf.bufferViews[t.bufferView].buffer].uri):this._bufferURI(e),r.setAttribute("buffer",A),r.setAttribute("position",a.center.join(" ")),r.setAttribute("size",a.size.join(" ")),r.setAttribute("vertexCount",this._getVertexCount(e)),r.setAttribute("primType",this._primitiveType(e.mode)),r.setAttribute("draco",null!==t),null!=e.material)&&(this._gltf.materials[e.material].doubleSided&&r.setAttribute("solid","false"));null!=e.indices&&(s=this._gltf.accessors[e.indices],t?((i=Object.assign({},this._gltf.bufferViews[t.bufferView])).idx=t.bufferView,i.target=34963,o=n.push(i)-1):((i=Object.assign({},this._gltf.bufferViews[s.bufferView])).idx=s.bufferView,i.target=34963,o=n.indexOf(i),null!=i.target&&-1==o&&(o=n.push(i)-1)),r.appendChild(this._generateX3DBufferAccessor("INDEX",s,o)));var d=t?t.attributes:e.attributes;for(var h in d)s=this._gltf.accessors[e.attributes[h]],t?((i=Object.assign({},this._gltf.bufferViews[t.bufferView])).target=34962,i.idx=t.bufferView,i.dracoUniqueId=t.attributes[h],o=n.push(i)-1):((i=Object.assign({},this._gltf.bufferViews[s.bufferView])).target=34962,i.idx=s.bufferView,o=n.indexOf(i),null!=i.target&&-1==o&&(o=n.push(i)-1)),r.appendChild(this._generateX3DBufferAccessor(h,s,o));for(var g=0;g<n.length;g++)r.appendChild(this._generateX3DBufferView(n[g]));return r},x3dom.glTF2Loader.prototype._generateX3DBufferView=function(e){var t=document.createElement("bufferview");return t.setAttribute("target",e.target),t.setAttribute("byteOffset",e.byteOffset||0),t.setAttribute("byteLength",e.byteLength),t.setAttribute("idx",e.idx),t.setAttribute("dracoId",void 0!==e.dracoUniqueId?e.dracoUniqueId:-1),t},x3dom.glTF2Loader.prototype._generateX3DBufferAccessor=function(e,t,A){var i=this._componentsOf(t.type),o="bufferView"in t?this._gltf.bufferViews[t.bufferView]:{},s="byteStride"in o?o.byteStride:0,n="byteOffset"in t?t.byteOffset:0,r=document.createElement("bufferaccessor");return r.setAttribute("bufferType",e.replace("_0","")),r.setAttribute("view",A),r.setAttribute("byteOffset",n),r.setAttribute("byteStride",s),r.setAttribute("normalized",t.normalized||!1),r.setAttribute("components",i),r.setAttribute("componentType",t.componentType),r.setAttribute("count",t.count),r},x3dom.glTF2Loader.prototype._generateX3DAnimationNodes=function(e,t,A){var i=this._animationDuration(t),o=A+"_TIMESENSOR";e.appendChild(this._generateX3DTimeSensor(o,i));for(var s=0;s<t.channels.length;s++){var n=t.channels[s],r=n.target.path,a=n.target.node,d=t.samplers[n.sampler],h="glTF_NODE_"+this._gltf.nodes[a].name,g=A+"_INTERPOLATOR_"+s;e.appendChild(this._generateX3DInterpolator(g,r,d,i)),e.appendChild(this._createX3DRoute("fraction_changed",o,"set_fraction",g)),e.appendChild(this._createX3DRoute("value_changed",g,"set_"+r,h))}},x3dom.glTF2Loader.prototype._generateX3DTimeSensor=function(e,t){var A=document.createElement("TimeSensor");return A.setAttribute("loop","true"),A.setAttribute("cycleInterval",t),A.setAttribute("DEF",e),A},x3dom.glTF2Loader.prototype._generateX3DInterpolator=function(e,t,A,i){var o,s=A.interpolation||"LINEAR",n=this._gltf.accessors[A.input],r=this._gltf.accessors[A.output],a=this._gltf.bufferViews[n.bufferView],d=this._gltf.bufferViews[r.bufferView];switch(t){case"scale":case"translation":o=document.createElement("PositionInterpolator");break;case"rotation":o=document.createElement("OrientationInterpolator");break;case"weights":o=document.createElement("ScalarInterpolator")}return o.setAttribute("DEF",e),o.setAttribute("buffer",this._bufferURI(A)),o.setAttribute("interpolation",s),o.setAttribute("duration",i),o.appendChild(this._generateX3DBufferAccessor("SAMPLER_INPUT",n,0)),o.appendChild(this._generateX3DBufferAccessor("SAMPLER_OUTPUT",r,1)),o.appendChild(this._generateX3DBufferView(a)),o.appendChild(this._generateX3DBufferView(d)),o},x3dom.glTF2Loader.prototype._createX3DRoute=function(e,t,A,i){var o=document.createElement("ROUTE");return o.setAttribute("fromField",e),o.setAttribute("fromNode",t),o.setAttribute("toField",A),o.setAttribute("toNode",i),o},x3dom.glTF2Loader.prototype._getCenterAndSize=function(e){var t=[1,1,1],A=[0,0,0];if(null!=e.attributes.POSITION){var i=this._gltf.accessors[e.attributes.POSITION];t[0]=i.max[0]-i.min[0],t[1]=i.max[1]-i.min[1],t[2]=i.max[2]-i.min[2],A[0]=i.min[0]+.5*t[0],A[1]=i.min[1]+.5*t[1],A[2]=i.min[2]+.5*t[2]}return{center:A,size:t}},x3dom.glTF2Loader.prototype._getVertexCount=function(e){var t=0;return null!=e.indices?t=this._gltf.accessors[e.indices].count:null!=e.attributes.POSITION&&(t=this._gltf.accessors[e.attributes.POSITION].count),t},x3dom.glTF2Loader.prototype._sizeInBytes=function(e){switch(e){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5125:case 5126:return 4}},x3dom.glTF2Loader.prototype._componentsOf=function(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}},x3dom.glTF2Loader.prototype._bufferURI=function(e){var t,A="";if(null!=e.attributes&&null!=e.attributes.POSITION?t=e.attributes.POSITION:e.input&&(t=e.input),null!=t){var i=this._gltf.accessors[t],o=this._gltf.bufferViews[i.bufferView],s=this._gltf.buffers[o.buffer];A=x3dom.Utils.dataURIToObjectURL(s.uri)}return A},x3dom.glTF2Loader.prototype._USEorDEF=function(e,t){return null!=this._definitions[t]?(e.setAttribute("USE",t),!0):(e.setAttribute("DEF",t),this._definitions[t]=t,!1)},x3dom.glTF2Loader.prototype._primitiveType=function(e){switch(e){case 0:return"POINTS";case 1:return"LINES";case 2:return"LINE_LOOP";case 3:return"LINE_STRIP";case 4:return"TRIANGLES";case 5:return"TRIANGLE_STRIP";case 6:return"TRIANGLE_FAN";default:return"TRIANGLES"}},x3dom.glTF2Loader.prototype._isDefaultSampler=function(e){return 10497==e.wrapS&&10497==e.wrapT&&9729==e.magFilter&&9729==e.minFilter},x3dom.glTF2Loader.prototype._toAxisAngle=function(e){var t=[],A=(e=new x3dom.fields.Quaternion(e[0],e[1],e[2],e[3])).toAxisAngle();return t[0]=A[0].x,t[1]=A[0].y,t[2]=A[0].z,t[3]=A[1],t},x3dom.glTF2Loader.prototype._getGLTF=function(e,t){if(!t)return"string"==typeof e?JSON.parse(e):e;var A=0,i=new Uint32Array(e,A,3);if(1179937895==i[0]||2==i[1]){A+=12;var o=new Uint32Array(e,A,2);if(1313821514==o[1]){A+=8;var s=new Uint8Array(e,A,o[0]);A+=o[0];var n=new Uint32Array(e,A,2);if(5130562==n[1]){A+=8;var r=new Uint8Array(e,A,n[0]),a=x3dom.Utils.arrayBufferToJSON(s);return a.buffers[0].uri=x3dom.Utils.arrayBufferToObjectURL(r,"application/octet-stream"),this._convertBinaryImages(a,e,A),a}}}},x3dom.glTF2Loader.prototype._convertBinaryImages=function(e,t,A){if(null!=e.images)for(var i=0;i<e.images.length;i++){var o=e.images[i];if(null!=o.bufferView){var s=e.bufferViews[o.bufferView];s.byteOffset=s.byteOffset||0;var n=new Uint8Array(t,A+s.byteOffset,s.byteLength);o.uri=x3dom.Utils.arrayBufferToObjectURL(n,o.mimeType)}}},x3dom.glTF2Loader.prototype._animationDuration=function(e){for(var t=-1,A=0;A<e.channels.length;A++){var i=e.channels[A],o=e.samplers[i.sampler],s=this._gltf.accessors[o.input];t=Math.max(s.max[0],t)}return t},x3dom.DDSLoader={},x3dom.DDSLoader.load=function(e){return new Promise((function(t,A){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){var e=x3dom.DDSLoader._read(i.response);e?t(e):A(e)},i.onerror=function(){A()},x3dom.RequestManager.addRequest(i)}))},x3dom.DDSLoader._read=function(e){if(!(void 0===e||e.byteLength<148)){var t={isCompressed:!1,isVolume:!1,isCubeMap:!1,targets:[],data:[]},A=new Uint32Array(e,0,32);if(t.header=x3dom.DDSLoader._readHeader(A),A=new Uint32Array(e,128,5),t.header10=x3dom.DDSLoader._readHeader10(t,A),542327876==t.header.dwMagic&&124==t.header.dwSize&&x3dom.DDSLoader._readFormat(t))return x3dom.DDSLoader._readMipmapCount(t),x3dom.DDSLoader._readType(t),this._readData(t,e),t}},x3dom.DDSLoader._readHeader=function(e){return{dwMagic:e[0],dwSize:e[1],dwFlags:x3dom.DDSLoader._readDDSFlags(e[2]),dwHeight:e[3],dwWidth:e[4],dwPitchOrLinearSize:e[5],dwDepth:e[6],dwMipMapCount:e[7],dwReserved1:"UNUSED",ddspf:{dwSize:e[19],dwFlags:x3dom.DDSLoader._readPFFlags(e[20]),dwFourCC:x3dom.DDSLoader.int32ToFourCC(e[21]),dwRGBBitCount:e[22],dwRBitMask:e[23],dwGBitMask:e[24],dwBBitMask:e[25],dwABitMask:e[26]},dwCaps:x3dom.DDSLoader._readCapsFlags(e[27]),dwCaps2:x3dom.DDSLoader._readCaps2Flags(e[28]),dwCaps3:"UNUSED",dwCaps4:"UNUSED",dwReserved2:"UNUSED"}},x3dom.DDSLoader._readHeader10=function(e,t){return"DX10"!=e.header.ddspf.dwFourCC?null:{dxgiFormat:t[0],resourceDimension:x3dom.DDSLoader._readResourceDimension(t[1]),miscFlags:x3dom.DDSLoader._readMiscFlags(t[2]),arraySize:t[3],miscFlags2:x3dom.DDSLoader._readMiscFlags2(t[4])}},x3dom.DDSLoader._readMipmapCount=function(e){e.numberOfMipmaps=e.header.dwFlags.DDSD_MIPMAPCOUNT?e.header.dwMipMapCount:1},x3dom.DDSLoader._readType=function(e){e.header.dwFlags.DDSD_DEPTH&&e.header.dwCaps2.DDSCAPS2_VOLUME?(e.type=32879,e.numberOfImages=e.header.dwCaps.DDSD_DEPTH):e.header.dwCaps2.DDSCAPS2_CUBEMAP?(e.type=34067,e.header.dwCaps2.DDSCAPS2_CUBEMAP_POSITIVEX&&e.targets.push(34069),e.header.dwCaps2.DDSCAPS2_CUBEMAP_NEGATIVEX&&e.targets.push(34070),e.header.dwCaps2.DDSCAPS2_CUBEMAP_POSITIVEY&&e.targets.push(34071),e.header.dwCaps2.DDSCAPS2_CUBEMAP_NEGATIVEY&&e.targets.push(34072),e.header.dwCaps2.DDSCAPS2_CUBEMAP_POSITIVEZ&&e.targets.push(34073),e.header.dwCaps2.DDSCAPS2_CUBEMAP_NEGATIVEZ&&e.targets.push(34074),e.numberOfImages=e.targets.length):(e.type=3553,e.targets.push(3553),e.numberOfImages=e.targets.length)},x3dom.DDSLoader._readDDSFlags=function(e){return{DDSD_CAPS:!!(1&e),DDSD_HEIGHT:!!(2&e),DDSD_WIDTH:!!(4&e),DDSD_PITCH:!!(8&e),DDSD_PIXELFORMAT:!!(4096&e),DDSD_MIPMAPCOUNT:!!(131072&e),DDSD_LINEARSIZE:!!(524288&e),DDSD_DEPTH:!!(8388608&e)}},x3dom.DDSLoader._readPFFlags=function(e){return{DDPF_ALPHAPIXELS:!!(1&e),DDPF_ALPHA:!!(2&e),DDPF_FOURCC:!!(4&e),DDPF_RGB:!!(64&e),DDPF_YUV:!!(512&e),DDPF_LUMINANCE:!!(131072&e)}},x3dom.DDSLoader._readCapsFlags=function(e){return{DDSCAPS_COMPLEX:!!(8&e),DDSCAPS_MIPMAP:!!(4194304&e),DDSCAPS_TEXTURE:!!(4096&e)}},x3dom.DDSLoader._readCaps2Flags=function(e){return{DDSCAPS2_CUBEMAP:!!(512&e),DDSCAPS2_CUBEMAP_POSITIVEX:!!(1024&e),DDSCAPS2_CUBEMAP_NEGATIVEX:!!(2048&e),DDSCAPS2_CUBEMAP_POSITIVEY:!!(4096&e),DDSCAPS2_CUBEMAP_NEGATIVEY:!!(8192&e),DDSCAPS2_CUBEMAP_POSITIVEZ:!!(16384&e),DDSCAPS2_CUBEMAP_NEGATIVEZ:!!(32768&e),DDSCAPS2_VOLUME:!!(131072&e)}},x3dom.DDSLoader._readResourceDimension=function(e){switch(e){case 0:return"D3D10_RESOURCE_DIMENSION_UNKNOWN";case 1:return"D3D10_RESOURCE_DIMENSION_BUFFER";case 2:return"D3D10_RESOURCE_DIMENSION_TEXTURE1D";case 3:return"D3D10_RESOURCE_DIMENSION_TEXTURE2D";case 4:return"D3D10_RESOURCE_DIMENSION_TEXTURE3D"}},x3dom.DDSLoader._readMiscFlags=function(e){return{D3D11_RESOURCE_MISC_GENERATE_MIPS:!!(1&e),D3D11_RESOURCE_MISC_SHARED:!!(2&e),D3D11_RESOURCE_MISC_TEXTURECUBE:!!(4&e),D3D11_RESOURCE_MISC_DRAWINDIRECT_ARGS:!!(16&e),D3D11_RESOURCE_MISC_BUFFER_ALLOW_RAW_VIEWS:!!(32&e),D3D11_RESOURCE_MISC_BUFFER_STRUCTURED:!!(64&e),D3D11_RESOURCE_MISC_RESOURCE_CLAMP:!!(128&e),D3D11_RESOURCE_MISC_SHARED_KEYEDMUTEX:!!(256&e),D3D11_RESOURCE_MISC_GDI_COMPATIBLE:!!(512&e),D3D11_RESOURCE_MISC_SHARED_NTHANDLE:!!(2048&e),D3D11_RESOURCE_MISC_RESTRICTED_CONTENT:!!(4096&e),D3D11_RESOURCE_MISC_RESTRICT_SHARED_RESOURCE:!!(8192&e),D3D11_RESOURCE_MISC_RESTRICT_SHARED_RESOURCE_DRIVER:!!(16384&e),D3D11_RESOURCE_MISC_GUARDED:!!(32768&e),D3D11_RESOURCE_MISC_TILE_POOL:!!(131072&e),D3D11_RESOURCE_MISC_TILED:!!(262144&e),D3D11_RESOURCE_MISC_HW_PROTECTED:!!(524288&e)}},x3dom.DDSLoader._readMiscFlags2=function(e){var t={};switch(e){case 0:case 1:case 2:case 3:case 4:t.alphaMode="DDS_ALPHA_MODE_UNKNOWN"}return t},x3dom.DDSLoader._readData=function(e,t,A,i){var o,s,n,r=e.header10?148:128;e.width=e.header.dwWidth,e.height=e.header.dwHeight,e.generateMipmaps=e.numberOfMipmaps<=1&&!e.isCompressed;for(var a=0;a<e.numberOfImages;a++){s=e.header.dwWidth,n=e.header.dwHeight,e.data[e.targets[a]]=[];for(var d=0;d<e.numberOfMipmaps;d++)0!=d&&(s=Math.max(.5*s,1),n=Math.max(.5*n,1)),e.isCompressed?(o=this._readCompressedData(t,s,n,r,e.blockSize),e.data[e.targets[a]][d]=o):(o=this._readUncompressedData(t,s,n,r,e.format),e.data[e.targets[a]][d]=o),r+=o.length*o.BYTES_PER_ELEMENT*e.format.bytesPerElementFactor}return e.format.overwriteType&&(e.format.type=e.format.overwriteType),e.format.overwriteInternalType&&(e.format.internal=e.format.overwriteInternalType),e},x3dom.DDSLoader._readCompressedData=function(e,t,A,i,o){var s=Math.max(1,parseInt((t+3)/4))*Math.max(1,parseInt((A+3)/4))*o;return new Uint8Array(e.slice(i,i+s))},x3dom.DDSLoader._readUncompressedData=function(e,t,A,i,o,s){if(o.bytesPerElementFactor=1,6406==o.internal)return new Uint8Array(e.slice(i,i+t*A));if(6409==o.internal)return new Uint8Array(e.slice(i,i+t*A));if(6410==o.internal)return new Uint8Array(e.slice(i,i+t*A*2));if(6407==o.internal)return x3dom.DDSLoader.R8G8B8_To_B8G8R8(new Uint8Array(e.slice(i,i+t*A*3)));if(36194==o.internal)return new Uint16Array(e.slice(i,i+t*A*2));if(6408==o.internal&&36193!=o.type&&5126!=o.type)return x3dom.DDSLoader.A8R8G8B8_To_A8B8G8R8(new Uint8Array(e.slice(i,i+t*A*4)));if(32854==o.internal)return x3dom.DDSLoader.A4R4G4B4_To_A4B4G4R4(new Uint16Array(e.slice(i,i+t*A*2)));if(32855==o.internal)return x3dom.DDSLoader.A1R5G5B5_To_A1B5G5R5(new Uint16Array(e.slice(i,i+t*A*2)));if(34842==o.internal||36193==o.type)return x3dom.caps.HFP_TEXTURES||2==x3dom.caps.WEBGL_VERSION?new Uint16Array(e.slice(i,i+t*A*4*2)):x3dom.caps.FP_TEXTURES?(o.overwriteType=5126,o.overwriteInternalType=2==x3dom.caps.WEBGL_VERSION?34836:6408,o.bytesPerElementFactor=.5,x3dom.DDSLoader.UI16_To_F32(new Uint16Array(e.slice(i,i+t*A*4*2)))):(o.overwriteType=5121,o.overwriteInternalType=6408,o.bytesPerElementFactor=2,x3dom.DDSLoader.UI16_To_UI8(new Uint16Array(e.slice(i,i+t*A*4*2))));if(34836==o.internal||5126==o.type){if(x3dom.caps.FP_TEXTURES||2==x3dom.caps.WEBGL_VERSION)return new Float32Array(e.slice(i,i+t*A*4*4))}else if(35898==o.internal)return new Uint8Array(e.slice(i,i+t*A*3))},x3dom.DDSLoader._readFormat=function(e){var t=e.header.ddspf;if(t.dwFlags.DDPF_FOURCC)if("DXT1"==t.dwFourCC)e.channelCount=3,e.blockSize=8,e.isCompressed=!0,e.format={internal:33776,format:6407,type:5121};else if("DXT3"==t.dwFourCC)e.channelCount=3,e.blockSize=16,e.isCompressed=!0,e.format={internal:33778,format:6408,type:5121};else if("DXT5"==t.dwFourCC)e.channelCount=4,e.blockSize=16,e.isCompressed=!0,e.format={internal:33779,format:6408,type:5121};else if("t"==t.dwFourCC)e.channelCount=4,2==x3dom.caps.WEBGL_VERSION?e.format={internal:34836,format:6408,type:5126}:e.format={internal:6408,format:6408,type:5126};else{if("q"!=t.dwFourCC&&"$"!=t.dwFourCC)return!1;e.channelCount=4,2==x3dom.caps.WEBGL_VERSION?e.format={internal:34842,format:6408,type:5131}:e.format={internal:6408,format:6408,type:36193}}else if(t.dwFlags.DDPF_RGB&&!t.dwFlags.DDPF_ALPHAPIXELS)if(e.channelCount=3,24==t.dwRGBBitCount&&16711680==t.dwRBitMask&&65280==t.dwGBitMask&&255==t.dwBBitMask)e.format={internal:6407,format:6407,type:5121};else{if(16!=t.dwRGBBitCount||63488!=t.dwRBitMask||2016!=t.dwGBitMask||31!=t.dwBBitMask)return!1;e.format={internal:36194,format:6407,type:33635}}else if(t.dwFlags.DDPF_RGB&&t.dwFlags.DDPF_ALPHAPIXELS)if(e.channelCount=4,32==t.dwRGBBitCount&&16711680==t.dwRBitMask&&65280==t.dwGBitMask&&255==t.dwBBitMask&&4278190080==t.dwABitMask)e.format={internal:6408,format:6408,type:5121};else if(16==t.dwRGBBitCount&&3840==t.dwRBitMask&&240==t.dwGBitMask&&15==t.dwBBitMask&&61440==t.dwABitMask)e.format={internal:32854,format:6408,type:32819};else{if(16!=t.dwRGBBitCount||31744!=t.dwRBitMask||992!=t.dwGBitMask||31!=t.dwBBitMask||32768!=t.dwABitMask)return!1;e.format={internal:32855,format:6408,type:32820}}else if(t.dwFlags.DDPF_LUMINANCE&&!t.dwFlags.DDPF_ALPHAPIXELS){if(8!=t.dwRGBBitCount||255!=t.dwRBitMask)return!1;e.format={internal:6409,format:6409,type:5121},e.channelCount=1}else if(t.dwFlags.DDPF_LUMINANCE&&t.dwFlags.DDPF_ALPHAPIXELS){if(16!=t.dwRGBBitCount||255!=t.dwRBitMask||65280!=t.dwABitMask)return!1;e.format={internal:6410,format:6410,type:5121},e.channelCount=2}else{if(!t.dwFlags.DDPF_ALPHA)return!1;if(8!=t.dwRGBBitCount||255!=t.dwABitMask)return!1;e.format={internal:6406,format:6406,type:5121},e.channelCount=1}return!0},x3dom.DDSLoader.int32ToFourCC=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255).replace(/[\x00]/g,"")},x3dom.DDSLoader.R8G8B8_To_B8G8R8=function(e){for(var t=new Uint8Array(e.length),A=0;A<e.length;A+=3)t[A]=e[A+1],t[A+1]=e[A+0],t[A+2]=e[A+2];return t},x3dom.DDSLoader.A8R8G8B8_To_A8B8G8R8=function(e){for(var t=new Uint8Array(e.length),A=0;A<e.length;A+=4)t[A]=e[A+2],t[A+1]=e[A+1],t[A+2]=e[A+0],t[A+3]=e[A+3];return t},x3dom.DDSLoader.UI16_To_UI8=function(e){for(var t=new Uint8Array(e.length),A=0;A<e.length;A+=4)t[A]=255*x3dom.DDSLoader.UI16_To_UI8_2(e[A]),t[A+1]=255*x3dom.DDSLoader.UI16_To_UI8_2(e[A+1]),t[A+2]=255*x3dom.DDSLoader.UI16_To_UI8_2(e[A+2]),t[A+3]=255*x3dom.DDSLoader.UI16_To_UI8_2(e[A+3]);return t},x3dom.DDSLoader.UI16_To_F32=function(e){for(var t=new Float32Array(e.length),A=0;A<e.length;A+=4)t[A]=x3dom.DDSLoader.UI16_To_F16(e[A]),t[A+1]=x3dom.DDSLoader.UI16_To_F16(e[A+1]),t[A+2]=x3dom.DDSLoader.UI16_To_F16(e[A+2]),t[A+3]=x3dom.DDSLoader.UI16_To_F16(e[A+3]);return t},x3dom.DDSLoader.UI16_To_F16=function(e){var t=e>>15&1,A=e>>10&1023,i=e&Math.pow(2,10)-1;return 0!==A?Math.pow(-1,t)*(1+i/Math.pow(2,10))*Math.pow(2,A-15):0===i?0:Math.pow(-1,t)*i/Math.pow(2,10)*Math.pow(2,-14)},x3dom.DDSLoader.UI16_To_UI8_2=function(e){var t=x3dom.DDSLoader.UI16_To_F16(e);return t/(t+1)},x3dom.DDSLoader.A4R4G4B4_To_A4B4G4R4=function(e){for(var t,A,i,o,s=new Uint16Array(e.length),n=0;n<e.length;n++)t=e[n]>>12&15,A=e[n]>>8&15,i=e[n]>>4&15,o=15&e[n],s[n]=A<<12&i<<8&o<<4&t;return s},x3dom.DDSLoader.A1R5G5B5_To_A1B5G5R5=function(e){for(var t,A,i,o,s=new Uint16Array(e.length),n=0;n<e.length;n++)t=e[n]>>15&1,A=e[n]>>10&31,i=e[n]>>5&95,o=95&e[n],s[n]=A<<11&i<<6&o<<1&t;return s},x3dom.VRControllerManager=function(e){this.leftInline=void 0,this.leftTransform=void 0,this.rightInline=void 0,this.rightTransform=void 0,this.wasPresenting=!1,this.modelsAdded=!1,this._doc=e,this._controllers={"htc-vive":{left:"https://x3dom.org/download/assets/vr/vive.glb",right:"https://x3dom.org/download/assets/vr/vive.glb",scaleFactor:new x3dom.fields.SFVec3f(40,40,40),offset:new x3dom.fields.SFVec3f,axesScale:[1,1]},"oculus-touch":{left:"https://x3dom.org/download/assets/vr/oculus-touch-left.glb",right:"https://x3dom.org/download/assets/vr/oculus-touch-right.glb",scaleFactor:new x3dom.fields.SFVec3f(39.5,39.5,39.5),offset:new x3dom.fields.SFVec3f,axesScale:[1,1]},"oculus-go":{left:"https://x3dom.org/download/assets/vr/oculus-go.glb",right:"https://x3dom.org/download/assets/vr/oculus-go.glb",scaleFactor:new x3dom.fields.SFVec3f(1,1,1),offset:new x3dom.fields.SFVec3f(.2,-.3,-.3),axesScale:[-1,1]}},this._addInlines()},x3dom.VRControllerManager.prototype._addInlines=function(){var e=document.querySelector("scene")||document.querySelector("Scene");e&&(this.leftTransform=document.createElement("matrixtransform"),this.leftInline=document.createElement("inline"),this.rightTransform=document.createElement("matrixtransform"),this.rightInline=document.createElement("inline"),this.leftInline.setAttribute("render","false"),this.rightInline.setAttribute("render","false"),this.leftTransform.appendChild(this.leftInline),this.rightTransform.appendChild(this.rightInline),e.appendChild(this.leftTransform),e.appendChild(this.rightTransform))},x3dom.VRControllerManager.prototype._addControllerModels=function(e){if(!this.modelsAdded){if(e.left){const t=this._getControllerModelURL(e.left.type,"left");this.leftInline.setAttribute("url",t)}if(e.right){const t=this._getControllerModelURL(e.right.type,"right");this.rightInline.setAttribute("url",t)}this.modelsAdded=!0}},x3dom.VRControllerManager.prototype._getControllerAxesScale=function(e){return void 0===this._controllers[e]?[1,1]:this._controllers[e].axesScale},x3dom.VRControllerManager.prototype._getControllerDirection=function(e){return(e.orientation?x3dom.fields.Quaternion.fromArray(e.orientation):new x3dom.fields.Quaternion).toMatrix().e2()},x3dom.VRControllerManager.prototype._getControllerModelURL=function(e,t){return void 0===this._controllers[e]?"":this._controllers[e][t]},x3dom.VRControllerManager.prototype._getControllerOffset=function(e){return void 0===this._controllers[e]?[0,0,0]:this._controllers[e].offset},x3dom.VRControllerManager.prototype._getControllerScaleFactor=function(e){return void 0===this._controllers[e]?[1,1,1]:this._controllers[e].scaleFactor},x3dom.VRControllerManager.prototype.fit=function(e){var t=e._scene._lastMin,A=e._scene._lastMax.subtract(t).multiply(.5).length(),i=e.vrLeftViewMatrix.e2(),o=Math.min(e._width/e._height,1),s=A/Math.tan(.5*Math.PI/2)/o;e._movement=i.multiply(-.001*s)},x3dom.VRControllerManager.prototype.update=function(e,t){t?(this.wasPresenting||(this.leftInline.setAttribute("render","true"),this.rightInline.setAttribute("render","true"),this.fit(e),this.wasPresenting=!0),this._addControllerModels(t.controllers),this._updateMatrices(e,t.controllers),this._updateControllerModels(e,t.controllers)):this.wasPresenting&&(this.leftInline.setAttribute("render","false"),this.rightInline.setAttribute("render","false"),this.wasPresenting=!1)},x3dom.VRControllerManager.prototype._updateMatrices=function(e,t){var A=new x3dom.fields.SFMatrix4f,i=new x3dom.fields.SFMatrix4f,o=[0,0];if(t.left){var s=this._getControllerAxesScale(t.left.type);if(o[0]+=t.left.gamepad.axes[0]*s[0],o[1]+=t.left.gamepad.axes[1]*s[1],t.left.gamepad.buttons[0].pressed){const A=t.left.pose,i=this._getControllerDirection(A),o=this._getViewAreaZoom(e);e._movement=e._movement.add(i.multiply(o))}}if(t.right){s=this._getControllerAxesScale(t.right.type);if(o[0]+=t.right.gamepad.axes[0]*s[0],o[1]+=t.right.gamepad.axes[1]*s[1],t.right.gamepad.buttons[0].pressed){const A=t.right.pose,i=this._getControllerDirection(A),o=this._getViewAreaZoom(e);e._movement=e._movement.add(i.multiply(o))}}var n=5*o[0],r=5*o[1],a=e.vrLeftViewMatrix.e2(),d=e.vrLeftViewMatrix.e0(),h=e._scene._lastMax.subtract(e._scene._lastMin).length();h=h<x3dom.fields.Eps?1:h,a=new x3dom.fields.SFVec3f(-a.x,-a.y,a.z).multiply(h*(r/e._height)),d=new x3dom.fields.SFVec3f(-d.x,-d.y,d.z).multiply(h*(n/e._width)),e._movement=e._movement.add(d).add(a),A=x3dom.fields.SFMatrix4f.translation(e._movement),e.vrLeftViewMatrix=e.vrLeftViewMatrix.mult(A).mult(i),e.vrRightViewMatrix=e.vrRightViewMatrix.mult(A).mult(i)},x3dom.VRControllerManager.prototype._updateControllerModels=function(e,t){if(t.left){var A=t.left.pose,i=this._getControllerOffset(t.left.type),o=A.orientation?x3dom.fields.Quaternion.fromArray(A.orientation):new x3dom.fields.Quaternion,s=A.position?x3dom.fields.SFVec3f.fromArray(A.position):i,n=this._getControllerScaleFactor(t.left.type);s=s.subtract(e._movement);var r=x3dom.fields.SFMatrix4f.fromRotationTranslationScale(o,s,n);this.leftTransform.setAttribute("matrix",r.toString())}if(t.right){A=t.right.pose,i=this._getControllerOffset(t.right.type),o=A.orientation?x3dom.fields.Quaternion.fromArray(A.orientation):new x3dom.fields.Quaternion,s=A.position?x3dom.fields.SFVec3f.fromArray(A.position):i,n=this._getControllerScaleFactor(t.right.type);s=s.subtract(e._movement);r=x3dom.fields.SFMatrix4f.fromRotationTranslationScale(o,s,n);this.rightTransform.setAttribute("matrix",r.toString())}},x3dom.VRControllerManager.prototype._getViewAreaZoom=function(e){var t=e._scene.getNavigationInfo(),A=e._scene.getViewpoint(),i=e._scene._lastMax.subtract(e._scene._lastMin).length();return(i=((i=Math.min(i,A.getFar()))<x3dom.fields.Eps?1:i)*t._vf.speed)*(60/this._doc._x3dElem.runtime.getFPS())/e._height},x3dom.JSONParser=function(e){this.x3djsonNS="http://www.web3d.org/specifications/x3d-namespace"},x3dom.JSONParser.prototype.constructor=x3dom.JSONParser,x3dom.JSONParser.prototype.parseJavaScript=function(e){var t=this.CreateElement("X3D");return this.ConvertToX3DOM(e,"",t),t},x3dom.JSONParser.prototype.elementSetAttribute=function(e,t,A){"SON schema"===t||"ncoding"===t||"function"==typeof e.setAttribute&&e.setAttribute(t,A)},x3dom.JSONParser.prototype.ConvertChildren=function(e,t,A){var i;for(i in t)"object"==typeof t[i]&&(isNaN(parseInt(i))?this.ConvertObject(i,t,A,e.substr(1)):this.ConvertToX3DOM(t[i],i,A,e.substr(1)))},x3dom.JSONParser.prototype.CreateElement=function(e,t){var A=null;return void 0===this.x3djsonNS?A=document.createElement(e):null==(A=document.createElementNS(this.x3djsonNS,e))&&(console.error("Trouble creating element for",e),A=document.createElement(e)),void 0!==t&&this.elementSetAttribute(A,"containerField",t),A},x3dom.JSONParser.prototype.CDATACreateFunction=function(e,t,A){var i=A.trim().replace(/\\"/g,'\\"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");do{i=(A=i).replace(/'([^'\r\n]*)\n([^']*)'/g,"'$1\\n$2'")}while(i!=A);var o="<script> <![CDATA[ "+i+" ]]> <\/script>",s=(new DOMParser).parseFromString(o,"application/xml").children[0].childNodes[1];t.appendChild(s)},x3dom.JSONParser.prototype.ConvertObject=function(e,t,A,i){var o;if(null!==t&&"object"==typeof t[e])if(e.startsWith("@"))this.ConvertToX3DOM(t[e],e,A);else if(e.startsWith("-"))this.ConvertChildren(e,t[e],A);else if("#comment"===e)for(var s in t[e])o=document.createComment(this.CommentStringToXML(t[e][s])),A.appendChild(o);else if("#sourceText"===e||"#sourceCode"===e)this.CDATACreateFunction(document,A,t[e].join("\r\n")+"\r\n");else if("connect"===e||"fieldValue"===e||"field"===e||"meta"===e||"component"===e)for(var n in t[e])"object"==typeof t[e][n]&&(o=this.CreateElement(e,i),this.ConvertToX3DOM(t[e][n],n,o),A.appendChild(o),A.appendChild(document.createTextNode("\n")));else o=this.CreateElement(e,i),this.ConvertToX3DOM(t[e],e,o),A.appendChild(o),A.appendChild(document.createTextNode("\n"))},x3dom.JSONParser.prototype.CommentStringToXML=function(e){return e=e.replace(/\\\\/g,"\\")},x3dom.JSONParser.prototype.SFStringToXML=function(e){return e=(e=e.replace(/\\/g,"\\\\")).replace(/"/g,'\\"')},x3dom.JSONParser.prototype.JSONStringToXML=function(e){return e=(e=e.replace(/\\/g,"\\\\")).replace(/\n/g,"\\n")},x3dom.JSONParser.prototype.ConvertToX3DOM=function(e,t,A,i){var o,s=[],n=!1,r=!1;for(o in e)if(n=!isNaN(parseInt(o)))"number"==typeof e[o]?s.push(e[o]):"string"==typeof e[o]?(s.push(e[o]),r=!0):"boolean"==typeof e[o]?s.push(e[o]):"object"==typeof e[o]?this.ConvertToX3DOM(e[o],o,A):void 0===e[o]||console.error("Unknown type found in array "+typeof e[o]);else if("object"==typeof e[o])if("X3D"===o)this.ConvertToX3DOM(e[o],o,A);else if("-skin"===o||"-skeleton"===o||"-value"===o){var a=e[o][0];for(var d in a)a[d]["@containerField"]=o.substr(1),console.log(a[d]),this.ConvertObject(o,e,A,a[d]["@containerField"])}else 0===o.indexOf("HAnim")&&"HAnimHumanoid"!==o&&void 0!==e[o]["@USE"]?(e[o]["@containerField"]=o.substr(5).toLowerCase()+"s",this.ConvertObject(o,e,A,e[o]["@containerField"])):this.ConvertObject(o,e,A);else if("number"==typeof e[o])this.elementSetAttribute(A,o.substr(1),e[o]);else if("string"==typeof e[o])if("#comment"!==o)this.elementSetAttribute(A,o.substr(1),this.JSONStringToXML(e[o]));else{var h=document.createComment(this.CommentStringToXML(e[o]));A.appendChild(h)}else"boolean"==typeof e[o]?this.elementSetAttribute(A,o.substr(1),e[o]):void 0===e[o]||(console.error("Unknown type found in object "+typeof e[o]),console.error(e));if(n&&t.startsWith("@"))if(r){for(var g in s)s[g]=this.SFStringToXML(s[g]);this.elementSetAttribute(A,t.substr(1),'"'+s.join('" "')+'"')}else this.elementSetAttribute(A,t.substr(1),s.join(" "));return A},x3dom.PROTOS=function(){this.protos={},this.names={},this.protoField={},this.scriptField={},this.interfaceField={},this.envField={},this.scopecount=0,this.privatescope=[],this.defs={},this.founddef=null,this.SFNodes={"-appearance":1,"-body":1,"-child":1,"-collidable":1,"-collider":1,"-color":1,"-composableRenderStyle":1,"-coord":1,"-emitter":1,"-fillProperties":1,"-fogCoord":1,"-fontStyle":1,"-geometry":1,"-geoOrigin":1,"-layout":1,"-lineProperties":1,"-massDensityModel":1,"-material":1,"-metadata":1,"-normal":1,"-nurbsCurve":1,"-nurbsCurve2D":1,"-pickingGeometry":1,"-renderStyle":1,"-shape":1,"-source":1,"-texCoord":1,"-texCoordNurbs":1,"-texCoordRamp":1,"-texture":1,"-texture2D":1,"-texture2DMulti":1,"-texture3D":1,"-textureProperties":1,"-textureTransform":1,"-transferFunction":1,"-viewport":1}},x3dom.PROTOS.prototype={flattenerArray:function(e,t){var A=[],i=0;for(var o in e){var s=this.flattener(e[o],A,e.length);if(Array.isArray(s)){for(var n in s)A[parseInt(o)+i+parseInt(n)]=s[n];i+=s.length-1}else A[parseInt(o)+i]=s}return A},flattenerObject:function(e,t,A){var i={};for(var o in e){var s=this.flattener(e[o],t,A);if(Array.isArray(s))if(this.SFNodes[o]){if(i[o]=s[0],s.length>1){t[A]={Switch:{"@whichChoice":-1,"-children":[{Group:{"-children":[]}}]}};for(var n=1;n<s.length;n++)t[A].Switch["-children"][0].Group["-children"][n-1]=s[n]}}else i[o]=s;else this.SFNodes[o]&&"object"==typeof s&&s["#comment"]?i["-children"]?(i[o]={},i["-children"].push(s)):(i[o]={},i["-children"]=[s]):i[o]=s}return i},flattener:function(e,t,A){if("object"==typeof e){if(Array.isArray(e))var i=this.flattenerArray(e,t);else i=this.flattenerObject(e,t,A);return i}return e},pushScope:function(e){this.privatescope.push(e)},popScope:function(){this.privatescope.pop()},saveDef:function(e){return this.defs[e]=this.getScope(),this.getScope(e)},getDef:function(e){return this.defs[e]},getField:function(e,t){return e+"_"+t},getScope:function(e){var t,A=(t=e?this.defs[e]?this.defs[e]+"_"+e:e:this.privatescope.join("_")).lastIndexOf("DECL");return A>0&&(t=t.substring(A)),t},scopeLength:function(){return this.privatescope.length},upScope:function(e){return this.privatescope.slice(0,this.privatescope.length-e).join("_")},setValueFromInterface:function(e,t,A){var i=this.getInterface(e),o="@";if(void 0!==i&&void 0!==i[0]&&(o=i[0].substr(0,1)),"@"===o&&"children"===A&&(o="-"),"-"===o&&"value"===A&&(o="@"),A=o+A,void 0!==i&&void 0!==i[1]&&void 0!==i[0]&&void 0!==i[1][i[0]]){var s=i[1][i[0]];return Array.isArray(s)&&"SFNode"===i[1]["@type"]&&"-children"!==A&&(console.error("SFNode is array, reducing",s),s=s[0]),Array.isArray(s)||"-children"!==A||(A="@value"),t[A]=s,[i[1]["@type"],i[2]]}},getObjectField:function(e,t){var A="value";for(var i in 1===t.indexOf("FNode")&&(A="children"),e)"@value"!==i&&"-children"!==i||(A=i.substr(1));return A},findFieldByName:function(e,t){for(var A in e){var i=e[A];if(i["@name"]===t)return i}throw"Can't find "+t},getScriptFieldFieldTypeFieldByNameAttribute:function(e,t){var A=this.findFieldByName(e,t),i=A["@name"],o=A["@type"];return[A,i,o,t=this.getObjectField(A,o)]},getScriptFieldFieldTypeField:function(e,t){var A=e[t],i=A["@name"],o=A["@type"];return[A,i,o,this.getObjectField(A,o)]},setScriptFields:function(e,t){var A=this.getScope();for(var i in e){var o=this.getScriptFieldFieldTypeField(e,i),s=o[0],n=o[1],r=o[2],a=o[3],d=this.setValueFromInterface(n,s,a);this.setScriptField(A,n,s,a,r,t),void 0!==d&&this.setScriptField(d[1],n,s,a,r,t)}},setScriptField:function(e,t,A,i,o,s){void 0===this.scriptField[this.getField(e,t)]&&(this.scriptField[this.getField(e,t)]=[]),this.scriptField[this.getField(e,t)][this.scriptField[this.getField(e,t)].length]=[A,i,o,s]},setEnv:function(e,t,A,i,o,s){var n=this.getInterface(t);void 0!==n&&(e=n[2]),void 0===this.envField[this.getField(e,t)]&&(this.envField[this.getField(e,t)]=[]),this.envField[this.getField(e,t)][this.envField[this.getField(e,t)].length]=[A,i,o,s]},getEnv:function(e,t){return this.envField[this.getField(e,t)]},setConnectField:function(e,t,A,i,o,s){void 0===this.protoField[this.getField(e,t)]&&(this.protoField[this.getField(e,t)]=[]),this.protoField[this.getField(e,t)][this.protoField[this.getField(e,t)].length]=[A,i,o,s]},setConnectFields:function(e,t,A){var i=e["@DEF"],o=this.saveDef(i),s=e[t].connect,n=this.getScope();for(var r in s){var a=s[r];if(a){var d=this.getScope(a["@protoField"]),h=a["@nodeField"],g=this.setValueFromInterface(d,A,h),l=void 0;void 0!==g?(l=g[0],this.setEnv(n,d,A,h,l,o),this.setConnectField(n,d,A,h,l,o),this.setConnectField(g[1],d,A,h,l,o)):(this.setEnv(n,d,A,h,l,o),this.setConnectField(n,d,A,h,l,o))}}},setScriptConnectFields:function(e,t,A,i){var o=t[A].connect,s=this.getScope(),n=t["@DEF"];i.field=this.realPrototypeExpander(e,t.field,!0);i["@DEF"];for(var r in o){var a=o[r];if(a){var d=this.getScope(a["@protoField"]),h=a["@nodeField"],g=this.getScriptFieldFieldTypeFieldByNameAttribute(i.field,h);a=g[0];g[1];var l=g[2];h=g[3];var I=this.setValueFromInterface(d,a,h);void 0!==I?(l=I[0],this.setScriptField(s,d,a,h,l,n),this.setScriptField(I[1],d,a,h,l,n)):this.setScriptField(s,d,a,h,l,n)}}},getInterface:function(e){for(var t=0;t<this.scopeLength();t++){var A=this.upScope(t);if(!A)break;var i=this.interfaceField[this.getField(A,e)];if(i)return i}},setInterface:function(e,t){var A=this.getScope();this.interfaceField[this.getField(A,e["@name"])]=[t,e,A]},clearScope:function(e,t){var A=this.getScope();delete this.scriptField[this.getField(A,e)],delete this.protoField[this.getField(A,e)],this.zap(e,t)},extractConnectedDef:function(e,t){var A;for(var i in this.scriptField[this.getField(e,t)])if(void 0===A){var o=this.scriptField[this.getField(e,t)][i];if(void 0!==o&&void 0!==o[3]){var s=this.getField(e,o[3]);-1==s.indexOf("DECL",1)&&(A=[s,o[0]["@name"]])}}if(void 0===A)for(var n in this.protoField[this.getField(e,t)]){var r=this.protoField[this.getField(e,t)][n];void 0!==r&&(A=[r[3],r[1]])}if(void 0===A)for(var a in this.protoField[this.getField(e,"__DEF_FIELD__")]){var d=this.protoField[this.getField(e,"__DEF_FIELD__")][a];void 0!==d&&(A=[d[3],t])}return void 0===A&&(A=[e,t]),A},setObjectValues:function(e,t,A,i){var o=!1;for(var s in this.protoField[this.getField(e,t)]){var n=this.protoField[this.getField(e,t)][s];void 0!==n&&(this.setObjectValue(e,t,n,A,i),o=!0)}for(var r in this.scriptField[this.getField(e,t)]){var a=this.scriptField[this.getField(e,t)][r];void 0!==a&&(this.setObjectValue(e,t,a,A,i),o=!0)}if(!o)for(var d=0;d<this.scopeLength();d++){var h=this.upScope(d);if(!h)break;var g=this.getEnv(h,t);for(var l in g){var I=g[l];void 0!==I&&I[3].indexOf(h)===I[3].lastIndexOf(h)&&this.setObjectValue(h,I[1],I,A,i)}}},setObjectValue:function(e,t,A,i,o){Array.isArray(o)&&void 0!==A[2]&&("SFNode"===A[2]?o=o[0]:A[2]);var s=A[1].substr(0,1);"@"===(s="-"!==s&&"@"!==s?i.substr(0,1):"")&&"children"===A[1]&&(s="-"),"-"===s&&"value"===A[1]&&(s="@"),Array.isArray(o)||"children"!==A[1]||(o=[o]),A[0][s+A[1]]=o},zap:function(e,t){var A;if("object"==typeof t)for(A in t)if("is"===A.toLowerCase()){var i=t[A].connect;for(var o in i){var s=i[o];s&&s["@protoField"]===e&&delete i[o]}}else this.zap(e,t[A]);return t},zapIs:function(e){var t;if("object"==typeof e)for(t in e)"is"===t.toLowerCase()?delete e[t]:this.zapIs(e[t]);return e},prototypeExpander:function(e,t){return t},readCode:function(e,t,A,i,o,s){void 0!==e&&(s[o]["#sourceText"]=e.split(/\r?\n/),delete s[o]["@url"])},handleScript:function(e,t,A,i){i[A]=this.realPrototypeExpander(e,t[A],!0),this.setScriptFields(i[A].field,i[A]["@DEF"]);var o=i[A]["@url"];this.loadURLs(e,o,this.readCode,null,(function(){}),A,i)},handleProtoDeclare:function(e,t,A){var i=t[A]["@name"],o=t[A]["@DEF"];return this.protos[i]=t[A],this.saveDef(o),void 0!==t[A]["@appinfo"]&&(this.protos[i]["@appinfo"]=t[A]["@appinfo"]),void 0!==t[A]["@documentation"]&&(this.protos[i]["@documentation"]=t[A]["@documentation"]),this.pushScope("DECL"+i),this.names[o]=i,this.realPrototypeExpander(e,t[A],!1),this.popScope(),t},handleProtoInterface:function(e,t,A){var i=t[A].field;for(var o in i){var s=i[o];void 0!==s["@value"]?this.setInterface(s,"@value"):void 0!==s["-children"]?this.setInterface(s,"-children"):this.setInterface(s)}return t},handleProtoInstance:function(e,t,A){var i=t[A]["@name"],o=t[A]["@DEF"],s=t[A]["@USE"];this.names[o]=i,void 0===i&&void 0!==s&&(i=this.names[s]),this.pushScope("DECL"+i);var n,r={};if(void 0===o&&void 0===s&&(o="INSTANCE"),this.getDef(o)&&void 0===s&&(this.scopecount+=1e3,o+=""+this.scopecount),void 0!==o){this.saveDef(o);this.pushScope(o)}if(void 0===this.protos[i]||void 0===this.protos[i].ProtoBody)console.error("ProtoBody undefined for",i);else{var a=this.protos[i].ProtoBody["-children"];for(var d in a){var h=a[d];for(var g in h)if(void 0===n&&(n=h[g]["@DEF"],void 0!==s)){this.saveDef(s);this.pushScope(s)}}r=JSON.parse(JSON.stringify(a))}for(var l=r;Array.isArray(l)&&null!==l[0]&&void 0!==l[0];)l=l[0];if(void 0!==s&&"object"==typeof l){(I={})[g]={},I[g]["@USE"]=this.getScope(),void 0!==n&&this.popScope()}else{var I=this.realPrototypeExpander(e,r,!1),c=t[A].fieldValue;for(var f in c){var u=c[f],C=u["@name"],_="@value",m=u[_];for(var p in u)"@name"!==p&&(m=u[_=p],this.pushScope("FIELD"+C),"object"==typeof l&&void 0!==l[g]&&(l[g]["@DEF"]=this.getScope()),m=this.realPrototypeExpander(e,m,!1),this.popScope(),this.getInterface(C),this.setObjectValues(this.getScope(),C,_,m))}}return void 0!==s&&this.popScope(),void 0!==o&&this.popScope(),this.popScope(),I},realPrototypeExpander:function(e,t,A){if("object"==typeof t){var i=null;for(var o in i=Array.isArray(t)?[]:{},t){var s=o.toLowerCase();if("script"===s)this.handleScript(e,t,o,i);else if("protodeclare"===s)this.handleProtoDeclare(e,t,o);else if("protointerface"===s)this.handleProtoInterface(e,t,o);else if("protobody"===s)this.realPrototypeExpander(e,t[o],A);else if("protoinstance"===s)i=this.handleProtoInstance(e,t,o);else if("connect"===s)this.realPrototypeExpander(e,t[o],A);else if("fieldvalue"===s)this.realPrototypeExpander(e,t[o],A);else if("field"===s)i[o]=this.realPrototypeExpander(e,t[o],A);else if("@value"===s)i[o]=this.realPrototypeExpander(e,t[o],A);else if("-children"===s)i[o]=this.realPrototypeExpander(e,t[o],A);else if("is"===s)A?this.setScriptConnectFields(e,t,o,i):this.setConnectFields(t,o,i),this.realPrototypeExpander(e,t[o],A);else if("route"===s){i[o]={};var n=this.extractConnectedDef(this.getScope(t[o]["@fromNode"]),t[o]["@fromField"]);i[o]["@fromNode"]=n[0],i[o]["@fromField"]=n[1];var r=this.extractConnectedDef(this.getScope(t[o]["@toNode"]),t[o]["@toField"]);i[o]["@toNode"]=r[0],i[o]["@toField"]=r[1]}else"@name"===s?i[o]=t[o]:"@def"===s?(i[o]=this.saveDef(t[o]),this.setConnectField(this.getScope(),"__DEF_FIELD__",i,t[o],"SFString",i[o])):i[o]="@use"===s?this.getScope(t[o]):this.realPrototypeExpander(e,t[o],A)}return i}return t},searchForProtoDeclare:function(e,t){var A,i;if("object"==typeof e)for(A in e)"ProtoDeclare"===A&&(e[A]["@name"]===t&&(i=e),void 0===i&&null===this.founddef&&(this.founddef=e)),void 0===i&&(i=this.searchForProtoDeclare(e[A],t));return i},searchAndReplaceProto:function(e,t,A,i,o,s){var n=this.searchForProtoDeclare(t,A);if(void 0===n&&(n=i),null===n||void 0===n.ProtoDeclare)console.error("ProtoDeclare is still null or undefined",e,A,JSON.stringify(t));else{var r=o["@name"],a=o["@appinfo"],d=o["@description"];n.ProtoDeclare["@name"]=r,n.ProtoDeclare["@appinfo"]=a,n.ProtoDeclare["@description"]=d}s(n)},loadedProto:function(e,t,A,i,o,s){if(void 0!==e)try{this.founddef=null;var n={};try{n=JSON.parse(e),o.searchAndReplaceProto(i,n,t,o.founddef,A,s)}catch(n){if("function"==typeof DOM2JSONSerializer)try{var r=(new DOM2JSONSerializer).serializeToString(null,e.firstElementChild,i,mapToMethod,fieldTypes);o.searchAndReplaceProto(i,JSON.parse(r),t,o.founddef,A,s)}catch(e){"function"==typeof alert&&alert(e),console.error("Convert failed",e)}else console.error("Did not convert XML to JSON.  Oops!")}}catch(e){console.error("Failed to parse JSON in ",i,e)}else console.error("data is undefined for file",i)},doLoad:function(e,t,A,i,o,s){var n=s["@name"],r=t.indexOf("#"),a=n;r>=0&&(a=t.substring(r+1));try{A.loadedProto(e,a,s,t,A,(function(e){i(o,e,A)}))}catch(e){console.error("Error searching for proto",e)}},processURLs:function(e,t){var A;for(A in e){if(0===e[A].indexOf("http://")||0===e[A].indexOf("https://"));else if(0===e[A].indexOf("urn:web3d:media:textures/panoramas/")){var i=e[A].lastIndexOf("/");i>0&&(e[A]="examples/Basic/UniversalMediaPanoramas/"+e[A].substring(i+1))}else{var o=e[A].indexOf("#"),s=t.lastIndexOf("/"),n=t;for(s>=0&&(n=t.substring(0,s));e[A].startsWith("../");){e[A]=e[A].substr(3);s=n.lastIndexOf("/");n=s>=0?n.substring(0,s):""}e[A]=0==o?t+e[A]:n+"/"+e[A]}var r=e[A].lastIndexOf("#"),a="";r>=0&&(a=e[A].substring(r),e[A]=e[A].substring(0,r));var d=e[A].lastIndexOf(".wrl");d===e[A].length-4&&(e[A]=e[A].substring(0,d)+".json"+a);var h=e[A].lastIndexOf(".wrz");h===e[A].length-4&&(e[A]=e[A].substring(0,h)+".json"+a)}return e},loadURLs:function(e,t,A,i,o,s,n){if(void 0!==t)for(var r in t=this.processURLs(t,e))try{!function(t){var r=t.indexOf("://"),a="file",d="localhost",h="/"+e;if(r>0){a=t.substring(0,r);var g=t.indexOf("/",r+3);d=t.substring(r+3,g),h=t.substring(g)}if("http"===a){if("undefined"!=typeof http)http.get({host:d,path:h},(function(e){var r="";e.on("data",(function(e){r+=e})),e.on("end",(function(){A(r,t,i,o,s,n)}))}));else if((I=new XMLHttpRequest).open("GET",t,!1),I.send(null),200===I.status){var l=I.responseText;A(l,t,i,o,s,n)}}else if("https"===a){if("undefined"!=typeof https)https.get({host:d,path:h},(function(e){var r="";e.on("data",(function(e){r+=e})),e.on("end",(function(){A(r,t,i,o,s,n)}))}));else if((I=new XMLHttpRequest).open("GET",t,!1),I.send(null),200===I.status){l=I.responseText;A(l,t,i,o,s,n)}}else if("undefined"==typeof fs||a.startsWith("http")){var I;if((I=new XMLHttpRequest).open("GET",t,!1),I.send(null),200===I.status){l=I.responseText;A(l,t,i,o,s,n)}else console.error("Didn't load",t,".  No file system or http request.")}else{var c=t.indexOf("#");c>0&&(t=t.substring(0,c));try{var l=fs.readFileSync(t);A(l.toString(),t,i,o,s,n)}catch(e){var f=t;f.endsWith(".json")&&(f=f.substring(0,f.lastIndexOf("."))+".x3d","function"==typeof runAndSend&&runAndSend(["---silent",f],(function(e){l=JSON.stringify(e),A(l,f,i,o,s,n)})))}}}(t[r])}catch(e){console.error(e)}},load:function(e,t,A,i,o){var s=A[e],n=s["@url"];this.loadURLs(t,n,i.doLoad,i,o,e,s)},externalPrototypeExpander:function(e,t){if("object"==typeof t){var A=null;for(var i in A=Array.isArray(t)?[]:{},t)"ExternProtoDeclare"===i?this.load(i,e,t,this,(function(t,i,o){null!=i&&void 0!==i&&(A.ProtoDeclare=o.externalPrototypeExpander(e,i).ProtoDeclare)})):A[i]=this.externalPrototypeExpander(e,t[i]);for(var o=Object.keys(t).length;o>Object.keys(A).length+1;);return setTimeout((function(){}),50),A}return t}},x3dom.protoExpander=new x3dom.PROTOS,x3dom.ProtoDeclaration=function(e,t,A,i,o,s){this._nameSpace=e,this.name=t,this._protoBody=A||null,this.fields=i||[],this.isExternProto=o||!1,this.url=s||[],this.needsLoading=!0,this.instanceQueue=[]},x3dom.ProtoDeclaration.prototype.registerNode=function(){var e=this;x3dom.registerNodeType(e.name,"Core",defineClass(x3dom.nodeTypes.X3DNode,(function(t){x3dom.nodeTypes[e.name].superClass.call(this,t),this._cf_hash={},e.fields.forEach((function(A){if(A.dataType.endsWith("ode")){t&&t.xmlNode&&0==t.xmlNode.querySelectorAll("[containerField='"+A.name+"']").length&&A.cfValue.forEach((function(e){t.xmlNode.appendChild(e.cloneNode(!0))}));var i=x3dom.nodeTypes.X3DNode,o=e._protoBody._ISRoutes;if(A.name in o){var s=o[A.name][0],n=s.nodeField,r=e._protoBody.querySelector("[DEF="+s.nodeDEF+"]"),a=r.localName.toLowerCase();if(a in x3dom.nodeTypesLC){var d={doc:t.doc,runtime:t.runtime,xmlNode:r.cloneNode(!0),nameSpace:t.nameSpace},h=new x3dom.nodeTypesLC[a](d);n in h._cf&&(i=h._cf[n].type)}}else x3dom.debug.logWarning(e.name+" Proto: field without IS connection - "+A.name);this["addField_"+A.dataType](A.name,i),this._cf_hash[A.name]="trigger"}else t&&t.xmlNode&&!t.xmlNode.hasAttribute(A.name)&&A.value&&t.xmlNode.setAttribute(A.name,A.value),this["addField_"+A.dataType](t,A.name,A.value)}),this);var A="protoNS";t.xmlNode.hasAttribute("DEF")&&(A=t.xmlNode.getAttribute("DEF")+"NS"),this.innerNameSpace=new x3dom.NodeNameSpace(A,t.doc),this.innerNameSpace.setBaseURL(t.nameSpace.baseURL+e.name),e._nameSpace.addSpace(this.innerNameSpace),e._nameSpace.protos.forEach((function(e){this.innerNameSpace.protos.push(e)}),this),this.nodes=[],this.protoBodyClone=e._protoBody.cloneNode(!0),this.declaration=e,this.isProtoInstance=!0,this._changing=!1,this._externTries=0,this._maxTries=5}),{nodeChanged:function(e){if(!this._changing){this._changing=!0;var t=this.protoBodyClone;t.querySelectorAll(":scope > *").forEach((function(e){var A=e.localName.toLowerCase();"protodeclare"==A?this.innerNameSpace.protoDeclare(e):"externprotodeclare"==A?this.innerNameSpace.externProtoDeclare(e):"protoinstance"==A&&this.innerNameSpace.protoInstance(e,t)}),this);var A,i=this.protoBodyClone.childNodes;for(A=0;A<i.length;A++){var o=this.innerNameSpace.setupTree.call(this.innerNameSpace,i[A],this);null!=o&&this.nodes.push(o)}this.typeNode=this.nodes[0],this.helperNodes=this.nodes.slice(1);var s,n=this._xmlNode.attributes;for(A=0;A<n.length;A++)(s=n[A]).name.startsWith("on")&&this.typeNode._xmlNode.setAttribute(s.name,s.value);for(var r in this._vf)this.fieldChanged(r);for(r in this._cf){"nodes"in this._cf[r]&&this._cf_hash[r]===this._get_cf_hash(r)&&r!=e||this.fieldChanged(r)}for(r in this._vf){r in this.declaration._protoBody._ISRoutes&&this._setupFieldWatchers(r)}for(r in this._changing=!1,this._cf)"nodes"in this._cf[r]&&(this._cf_hash[r]=this._get_cf_hash(r))}},fieldChanged:function(e){try{var t=this.declaration._protoBody._ISRoutes;if(!(e in t))return;t[e].forEach((function(t){var A=this.innerNameSpace.defMap[t.nodeDEF];if(null!=A){this._externTries=0;var i=this._normalizeName(t.nodeField,A);if(e in this._vf)A._vf[i]=this._vf[e],A.fieldChanged(i);else if(e in this._cf){A._cf[i]=this._cf[e];var o=[];if("MFNode"==A._cfFieldTypes[i]?o=this._cf[e].nodes:"SFNode"==A._cfFieldTypes[i]&&this._cf[e].node?o=[this._cf[e].node]:x3dom.debug.logWarning("Unexpected field type: "+A._cfFieldTypes[i]),A._childNodes.forEach((function(e){A.removeChild(e,i,"force")})),o.forEach((function(e){A.addChild(e,i)})),"MFNode"==A._cfFieldTypes[i])for(var s=0;s<o.length;s++)for(var n=o[s],r=o.length-1;r>s;r--)n==o[r]&&o.splice(r,1);A.nodeChanged(i)}}else{if("protoinstance"==this.protoBodyClone.querySelector("[DEF="+t.nodeDEF+"]").tagName.toLowerCase()&&this._externTries++<this._maxTries){x3dom.debug.logWarning(" ExternProto instance attempt: "+this._externTries);setTimeout(this.fieldChanged.bind(this),1e3,e)}}}),this)}catch(e){x3dom.debug.logWarning("Proto warning: "+e)}},_normalizeName:function(e,t){return e in t._vf?e:e.replace(/^set_/,"").replace(/_changed$/,"")},_setupFieldWatchers:function(e){this.declaration._protoBody._ISRoutes[e].forEach((function(t){var A=this.innerNameSpace.defMap[t.nodeDEF];if(null!=A){var i=this._normalizeName(t.nodeField,A);A._fieldWatchers[i]||(A._fieldWatchers[i]=[]);var o=this.postMessage.bind(this,e),s=A._fieldWatchers[i];s.push(o);var n=s.length-1;this._fieldWatchers[e]||(this._fieldWatchers[e]=[]);var r=function(e){s.splice(n,1),A.postMessage(i,e),s.push(o),n=s.length-1}.bind(A);this._fieldWatchers[e].push(r)}else{if("protoinstance"==this.protoBodyClone.querySelector("[DEF="+t.nodeDEF+"]").tagName.toLowerCase()&&this._externTries++<this._maxTries){x3dom.debug.logWarning(" retrying ExternProto: "+this._externTries);setTimeout(this._setupFieldWatchers.bind(this),1e3,e)}}}),this)},_get_cf_hash:function(e){return this._cf[e].nodes.length}}))},x3dom.shader={},x3dom.shader.PICKING="picking",x3dom.shader.PICKING_24="picking24",x3dom.shader.PICKING_ID="pickingId",x3dom.shader.PICKING_COLOR="pickingColor",x3dom.shader.PICKING_TEXCOORD="pickingTexCoord",x3dom.shader.FRONTGROUND_TEXTURE="frontgroundTexture",x3dom.shader.BACKGROUND_TEXTURE="backgroundTexture",x3dom.shader.BACKGROUND_SKYTEXTURE="backgroundSkyTexture",x3dom.shader.BACKGROUND_CUBETEXTURE="backgroundCubeTexture",x3dom.shader.BACKGROUND_CUBETEXTURE_DDS="backgroundCubeTextureDDS",x3dom.shader.BLUR="blur",x3dom.shader.DEPTH="depth",x3dom.shader.NORMAL="normal",x3dom.shader.TEXTURE_REFINEMENT="textureRefinement",x3dom.shader.SSAO="ssao",x3dom.shader.material=function(){return"uniform vec3  diffuseColor;\nuniform vec3  specularColor;\nuniform vec3  emissiveColor;\nuniform float shininess;\nuniform float transparency;\nuniform float ambientIntensity;\n"},x3dom.shader.physicalMaterial=function(){return"uniform vec3  baseColorFacor;\nuniform vec3  emissiveFactor;\nuniform float metallicFactor;\nuniform float roughnessFactor;\n"};x3dom.shader.twoSidedMaterial=function(){return"uniform vec3  backDiffuseColor;\nuniform vec3  backSpecularColor;\nuniform vec3  backEmissiveColor;\nuniform float backShininess;\nuniform float backTransparency;\nuniform float backAmbientIntensity;\n"},x3dom.shader.fog=function(){return"uniform vec3  fogColor;\nuniform float fogType;\nuniform float fogRange;\nvarying vec3 fragEyePosition;\nfloat calcFog(in vec3 eye) {\n   float f0 = 0.0;\n   if(fogType == 0.0) {\n       if(length(eye) < fogRange){\n           f0 = (fogRange-length(eye)) / fogRange;\n       }\n   }else{\n       if(length(eye) < fogRange){\n           f0 = exp(-length(eye) / (fogRange-length(eye) ) );\n       }\n   }\n   f0 = clamp(f0, 0.0, 1.0);\n   return f0;\n}\n"},x3dom.shader.clipPlanes=function(e){var t,A="";for(t=0;t<e;t++)A+="uniform vec4 clipPlane"+t+"_Plane;\n",A+="uniform float clipPlane"+t+"_CappingStrength;\n",A+="uniform vec3 clipPlane"+t+"_CappingColor;\n";for(A+="vec3 calculateClipPlanes() {\n",t=0;t<e;t++)A+="vec4 clipPlane"+t+";\n",A+="if(fragEyeIdx == 1.0){\n",A+="    clipPlane"+t+" = clipPlane"+t+"_Plane * viewMatrixInverse2;\n",A+="}else{\n",A+="    clipPlane"+t+" = clipPlane"+t+"_Plane * viewMatrixInverse;\n",A+="}\n",A+="float dist"+t+" = dot(fragPosition, clipPlane"+t+");\n";for(A+="    if( ",t=0;t<e;t++)0!=t&&(A+=" || "),A+="dist"+t+" < 0.0";for(A+=" ) ",A+="{ discard; }\n",t=0;t<e;t++)A+="    if( abs(dist"+t+") < clipPlane"+t+"_CappingStrength ) ",A+="{ return clipPlane"+t+"_CappingColor; }\n";return A+="    return vec3(-1.0, -1.0, -1.0);\n",A+="}\n"},x3dom.shader.gammaCorrectionDecl=function(e){var t="";return"none"===e.GAMMACORRECTION||("fastlinear"===e.GAMMACORRECTION?(t+="vec4 gammaEncode(vec4 color){\n  vec4 tmp = sqrt(color);\n  return vec4(tmp.rgb, color.a);\n}\n",t+="vec4 gammaDecode(vec4 color){\n  vec4 tmp = color * color;\n  return vec4(tmp.rgb, color.a);\n}\n",t+="vec3 gammaEncode(vec3 color){\n  return sqrt(color);\n}\n",t+="vec3 gammaDecode(vec3 color){\n  return (color * color);\n}\n"):(t+="const vec4 gammaEncode4Vector = vec4(0.4545454545454545, 0.4545454545454545, 0.4545454545454545, 1.0);\n",t+="const vec4 gammaDecode4Vector = vec4(2.2, 2.2, 2.2, 1.0);\n",t+="vec4 gammaEncode(vec4 color){\n    return pow(abs(color), gammaEncode4Vector);\n}\n",t+="vec4 gammaDecode(vec4 color){\n    return pow(abs(color), gammaDecode4Vector);\n}\n",t+="const vec3 gammaEncode3Vector = vec3(0.4545454545454545, 0.4545454545454545, 0.4545454545454545);\n",t+="const vec3 gammaDecode3Vector = vec3(2.2, 2.2, 2.2);\n",t+="vec3 gammaEncode(vec3 color){\n    return pow(abs(color), gammaEncode3Vector);\n}\n",t+="vec3 gammaDecode(vec3 color){\n    return pow(abs(color), gammaDecode3Vector);\n}\n")),t},x3dom.shader.encodeGamma=function(e,t){return"none"===e.GAMMACORRECTION?t:"gammaEncode ("+t+")"},x3dom.shader.decodeGamma=function(e,t){return"none"===e.GAMMACORRECTION?t:"gammaDecode ("+t+")"},x3dom.shader.rgbaPacking=function(){return"vec4 packDepth(float depth){\n    depth = (depth + 1.0)*0.5;\n    vec4 outVal = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\n    outVal = fract(outVal);\n      outVal -= outVal.yzww * vec4(1.0/255.0, 1.0/255.0, 1.0/255.0, 0.0);\n      return outVal;\n}\n","float unpackDepth(vec4 color){\n    float depth = dot(color, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0));\n    return (2.0*depth - 1.0);\n}\n","vec4 packDepth(float depth){\n    depth = (depth + 1.0)*0.5;\n    vec4 outVal = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\n    outVal = fract(outVal);\n      outVal -= outVal.yzww * vec4(1.0/255.0, 1.0/255.0, 1.0/255.0, 0.0);\n      return outVal;\n}\nfloat unpackDepth(vec4 color){\n    float depth = dot(color, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0));\n    return (2.0*depth - 1.0);\n}\n"},x3dom.shader.calcMipLevel=function(){return"vec2 dirToCubeUV( vec3 dir ) {\n    vec2 uv = vec2(0.0);\n    vec3 absDir = abs(dir);\n    if( absDir.x >= absDir.y && absDir.x >= absDir.z) {\n        if(dir.x < 0.0) {\n           uv.x = 1.0 - (((dir.z/absDir.x) + 1.0) * 0.5);\n           uv.y = 1.0 - (((-dir.y/absDir.x) + 1.0) * 0.5);\n       } else {\n           uv.x = 1.0 - (((-dir.z/absDir.x) + 1.0) * 0.5);\n           uv.y = 1.0 - (((-dir.y/absDir.x) + 1.0) * 0.5);\n       }\n   } else if( absDir.y >= absDir.x && absDir.y >= absDir.z) {\n       if(dir.y < 0.0) {\n              uv.x = ((dir.x/absDir.y) + 1.0) * 0.5;\n           uv.y = ((-dir.z/absDir.y) + 1.0) * 0.5;\n       } else {\n           uv.x = ((dir.x/absDir.y) + 1.0) * 0.5;\n           uv.y = ((dir.z/absDir.y) + 1.0) * 0.5;\nif(uv.y == 0.0) { uv.x = 1.0; uv.y = 0.0; }\n       }\n   } else if( absDir.z >= absDir.x && absDir.z >= absDir.y) {\n       if(dir.z < 0.0) {\n           uv.x = (((-dir.x/absDir.z) + 1.0) * 0.5);\n           uv.y = 1.0 - (((-dir.y/absDir.z) + 1.0) * 0.5);\n       } else {\n           uv.x = ((dir.x/absDir.z) + 1.0) * 0.5;\n           uv.y = 1.0 - (((-dir.y/absDir.z) + 1.0) * 0.5);\n       }\n   }\n   float a = pow(64.0,2.0) / pow(64.0,3.0);\n    uv.x = a * pow(uv.x, 3.0) + uv.x;\n    uv.y = a * pow(uv.y, 3.0) + uv.y;\n   return uv;\n}\n","float calcMipLevel( vec2 uv ) {\n    vec2  dx_vtc        = dFdx(uv) * 64.0;\n    vec2  dy_vtc        = dFdy(uv) * 64.0;\n    float delta_max_sqr = max(dot(dx_vtc, dx_vtc), dot(dy_vtc, dy_vtc));\n    return 0.5 * log2(delta_max_sqr);\n}\n","vec3 fixSeams(vec3 vec, float mipmapIndex) {\n    float scale = 1.0 - exp2(mipmapIndex) / 64.0;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}","vec2 dirToCubeUV( vec3 dir ) {\n    vec2 uv = vec2(0.0);\n    vec3 absDir = abs(dir);\n    if( absDir.x >= absDir.y && absDir.x >= absDir.z) {\n        if(dir.x < 0.0) {\n           uv.x = 1.0 - (((dir.z/absDir.x) + 1.0) * 0.5);\n           uv.y = 1.0 - (((-dir.y/absDir.x) + 1.0) * 0.5);\n       } else {\n           uv.x = 1.0 - (((-dir.z/absDir.x) + 1.0) * 0.5);\n           uv.y = 1.0 - (((-dir.y/absDir.x) + 1.0) * 0.5);\n       }\n   } else if( absDir.y >= absDir.x && absDir.y >= absDir.z) {\n       if(dir.y < 0.0) {\n              uv.x = ((dir.x/absDir.y) + 1.0) * 0.5;\n           uv.y = ((-dir.z/absDir.y) + 1.0) * 0.5;\n       } else {\n           uv.x = ((dir.x/absDir.y) + 1.0) * 0.5;\n           uv.y = ((dir.z/absDir.y) + 1.0) * 0.5;\nif(uv.y == 0.0) { uv.x = 1.0; uv.y = 0.0; }\n       }\n   } else if( absDir.z >= absDir.x && absDir.z >= absDir.y) {\n       if(dir.z < 0.0) {\n           uv.x = (((-dir.x/absDir.z) + 1.0) * 0.5);\n           uv.y = 1.0 - (((-dir.y/absDir.z) + 1.0) * 0.5);\n       } else {\n           uv.x = ((dir.x/absDir.z) + 1.0) * 0.5;\n           uv.y = 1.0 - (((-dir.y/absDir.z) + 1.0) * 0.5);\n       }\n   }\n   float a = pow(64.0,2.0) / pow(64.0,3.0);\n    uv.x = a * pow(uv.x, 3.0) + uv.x;\n    uv.y = a * pow(uv.y, 3.0) + uv.y;\n   return uv;\n}\nfloat calcMipLevel( vec2 uv ) {\n    vec2  dx_vtc        = dFdx(uv) * 64.0;\n    vec2  dy_vtc        = dFdy(uv) * 64.0;\n    float delta_max_sqr = max(dot(dx_vtc, dx_vtc), dot(dy_vtc, dy_vtc));\n    return 0.5 * log2(delta_max_sqr);\n}\nvec3 fixSeams(vec3 vec, float mipmapIndex) {\n    float scale = 1.0 - exp2(mipmapIndex) / 64.0;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}"},x3dom.shader.shadowRendering=function(){var e="";return e+="float getLightInfluence(float lType, float lShadowIntensity, float lOn, vec3 lLocation, vec3 lDirection, float lCutOffAngle, float lBeamWidth, vec3 lAttenuation, float lRadius, vec3 eyeCoords) {\n    if (lOn == 0.0 || lShadowIntensity == 0.0){ return 0.0;\n    } else if (lType == 0.0) {\n        return 1.0;\n    } else {\n       float attenuation = 0.0;\n       vec3 lightVec = (lLocation - (eyeCoords));\n       float distance = length(lightVec);\n        lightVec = normalize(lightVec);\n        eyeCoords = normalize(-eyeCoords);\n       if(lRadius == 0.0 || distance <= lRadius) {\n           attenuation = 1.0 / max(lAttenuation.x + lAttenuation.y * distance + lAttenuation.z * (distance * distance), 1.0);\n        }\n         if (lType == 1.0) return attenuation;\n       float spotAngle = acos(max(0.0, dot(-lightVec, normalize(lDirection))));\n       if(spotAngle >= lCutOffAngle) return 0.0;\n       else if(spotAngle <= lBeamWidth) return attenuation;\n       else return attenuation * (spotAngle - lCutOffAngle) / (lBeamWidth - lCutOffAngle);\n    }\n}\n",e+="void getShadowValues(inout vec4 shadowMapValues, inout float viewSampleDepth, in mat4 lightMatrix, in vec4 worldCoords, in sampler2D shadowMap){\n    vec4 lightSpaceCoords = lightMatrix*worldCoords;\n    vec3 lightSpaceCoordsCart = lightSpaceCoords.xyz / lightSpaceCoords.w;\n    vec2 textureCoords = (lightSpaceCoordsCart.xy + 1.0)*0.5;\n    viewSampleDepth = lightSpaceCoordsCart.z;\n    shadowMapValues = texture2D(shadowMap, textureCoords);\n",x3dom.caps.FP_TEXTURES||(e+="    shadowMapValues = vec4(1.0,1.0,unpackDepth(shadowMapValues),1.0);\n"),e+="}\n",e+="void getShadowValuesPointLight(inout vec4 shadowMapValues, inout float viewSampleDepth, in vec3 lLocation, in vec4 worldCoords, in mat4 lightViewMatrix,in mat4 lMatrix_0, in mat4 lMatrix_1, in mat4 lMatrix_2, in mat4 lMatrix_3, in mat4 lMatrix_4, in mat4 lMatrix_5,in sampler2D shadowMap_0, in sampler2D shadowMap_1, in sampler2D shadowMap_2, in sampler2D shadowMap_3,in sampler2D shadowMap_4, in sampler2D shadowMap_5){\n    vec4 transformed = lightViewMatrix * worldCoords;\n    vec3 lightVec = normalize(transformed.xyz/transformed.w);\n    vec3 lightVecAbs = abs(lightVec);\n    float maximum = max(max(lightVecAbs.x, lightVecAbs.y),lightVecAbs.z);\n    if (lightVecAbs.x == maximum) {\n        if (lightVec.x < 0.0) getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_3,worldCoords,shadowMap_3);\n        else getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_1,worldCoords,shadowMap_1);\n    }\n    else if (lightVecAbs.y == maximum) {\n        if (lightVec.y < 0.0) getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_4,worldCoords,shadowMap_4);\n        else getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_5,worldCoords,shadowMap_5);\n    }\n    else if (lightVec.z < 0.0) getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_0,worldCoords,shadowMap_0);\n    else getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_2,worldCoords,shadowMap_2);\n}\n",e+="void getShadowValuesCascaded(inout vec4 shadowMapValues, inout float viewSampleDepth, in vec4 worldCoords, in float eyeDepth, in mat4 lMatrix_0, in mat4 lMatrix_1, in mat4 lMatrix_2,in mat4 lMatrix_3, in mat4 lMatrix_4, in mat4 lMatrix_5, in sampler2D shadowMap_0, in sampler2D shadowMap_1, in sampler2D shadowMap_2,in sampler2D shadowMap_3, in sampler2D shadowMap_4, in sampler2D shadowMap_5, in float split_0, in float split_1, in float split_2, in float split_3, in float split_4){\n    if (eyeDepth < split_0) getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_0, worldCoords, shadowMap_0);\n    else if (eyeDepth < split_1) getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_1, worldCoords, shadowMap_1);\n    else if (eyeDepth < split_2) getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_2, worldCoords, shadowMap_2);\n    else if (eyeDepth < split_3) getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_3, worldCoords, shadowMap_3);\n    else if (eyeDepth < split_4) getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_4, worldCoords, shadowMap_4);\n    else getShadowValues(shadowMapValues, viewSampleDepth, lMatrix_5, worldCoords, shadowMap_5);\n}\n",e+="float ESM(float shadowMapDepth, float viewSampleDepth, float offset){\n",x3dom.caps.FP_TEXTURES?e+="    return shadowMapDepth * exp(-80.0*(1.0-offset)*viewSampleDepth);\n":e+="    float d = viewSampleDepth - shadowMapDepth;\n    d = step( 0.002, abs(d) ) * d;\n    return exp(-80.0*(1.0-offset)*d);\n",e+="}\n",e+="float VSM(vec2 moments, float viewSampleDepth, float offset){\n    viewSampleDepth = (viewSampleDepth + 1.0) * 0.5;\n    if (viewSampleDepth <= moments.x) return 1.0;\n    float variance = moments.y - moments.x * moments.x;\n    variance = max(variance, 0.00002 + offset*0.01);\n    float d = viewSampleDepth - moments.x;\n    return variance/(variance + d*d);\n}\n"},x3dom.shader.light=function(e){for(var t="",A=0;A<e;A++)t+="uniform float light"+A+"_On;\nuniform float light"+A+"_Type;\nuniform vec3  light"+A+"_Location;\nuniform vec3  light"+A+"_Direction;\nuniform vec3  light"+A+"_Color;\nuniform vec3  light"+A+"_Attenuation;\nuniform float light"+A+"_Radius;\nuniform float light"+A+"_Intensity;\nuniform float light"+A+"_AmbientIntensity;\nuniform float light"+A+"_BeamWidth;\nuniform float light"+A+"_CutOffAngle;\nuniform float light"+A+"_ShadowIntensity;\n";return t+="void lighting(in float lType, in vec3 lLocation, in vec3 lDirection, in vec3 lColor, in vec3 lAttenuation, in float lRadius, in float lIntensity, in float lAmbientIntensity, in float lBeamWidth, in float lCutOffAngle, in vec3 positionVS, in vec3 N, in vec3 V, float shin, float ambIntensity, vec3 reflectivity, inout vec3 ambient, inout vec3 diffuse, inout vec3 specular)\n{\n   vec3 L;\n   float spot = 1.0, attentuation = 0.0;\n   if(lType == 0.0) {\n       L = -normalize(lDirection);\n        V = normalize(V);\n        attentuation = 1.0;\n   } else{\n       L = (lLocation - (-V));\n       float d = length(L);\n        L = normalize(L);\n        V = normalize(V);\n       if(lRadius == 0.0 || d <= lRadius) {\n           attentuation = 1.0 / max(lAttenuation.x + lAttenuation.y * d + lAttenuation.z * (d * d), 1.0);\n        }\n       if(lType == 2.0) {\n           float spotAngle = acos(max(0.0, dot(-L, normalize(lDirection))));\n           if(spotAngle >= lCutOffAngle) spot = 0.0;\n           else if(spotAngle <= lBeamWidth) spot = 1.0;\n           else spot = (spotAngle - lCutOffAngle ) / (lBeamWidth - lCutOffAngle);\n       }\n   }\n   vec3  H = normalize( L + V );\n   float NdotL = clamp(dot(L, N), 0.0, 1.0);\n   float NdotH = clamp(dot(H, N), 0.0, 1.0);\n   float ambientFactor  = lAmbientIntensity * ambIntensity;\n   float diffuseFactor  = lIntensity * NdotL;\n   float specularFactor = lIntensity * pow(NdotH, shin*128.0);\n   ambient  += lColor * ambientFactor * attentuation * spot;\n   diffuse  += lColor * diffuseFactor * attentuation * spot;\n   specular += lColor * specularFactor * attentuation * spot;\n}\n"},x3dom.shader.lightPBR=function(e){for(var t="",A=0;A<e;A++)t+="uniform float light"+A+"_On;\nuniform float light"+A+"_Type;\nuniform vec3  light"+A+"_Location;\nuniform vec3  light"+A+"_Direction;\nuniform vec3  light"+A+"_Color;\nuniform vec3  light"+A+"_Attenuation;\nuniform float light"+A+"_Radius;\nuniform float light"+A+"_Intensity;\nuniform float light"+A+"_AmbientIntensity;\nuniform float light"+A+"_BeamWidth;\nuniform float light"+A+"_CutOffAngle;\nuniform float light"+A+"_ShadowIntensity;\n";return t+="void lighting(in float lType, in vec3 lLocation, in vec3 lDirection, in vec3 lColor, in vec3 lAttenuation, in float lRadius, in float lIntensity, in float lAmbientIntensity, in float lBeamWidth, in float lCutOffAngle, in vec3 positionVS, in vec3 N, in vec3 V, float shin, float ambIntensity, vec3 reflectivity, inout vec3 ambient, inout vec3 diffuse, inout vec3 specular)\n{\n   vec3 L;\n   float spot = 1.0, attentuation = 0.0;\n   if(lType == 0.0) {\n       L = -normalize(lDirection);\n        V = normalize(V);\n        attentuation = 1.0;\n   } else{\n       L = (lLocation - (-V));\n       float d = length(L);\n        L = normalize(L);\n        V = normalize(V);\n       if(lRadius == 0.0 || d <= lRadius) {\n           attentuation = 1.0 / max(lAttenuation.x + lAttenuation.y * d + lAttenuation.z * (d * d), 1.0);\n        }\n       if(lType == 2.0) {\n           float spotAngle = acos(max(0.0, dot(-L, normalize(lDirection))));\n           if(spotAngle >= lCutOffAngle) spot = 0.0;\n           else if(spotAngle <= lBeamWidth) spot = 1.0;\n           else spot = (spotAngle - lCutOffAngle ) / (lBeamWidth - lCutOffAngle);\n       }\n   }\n   vec3  fresnel = vec3(1.0, 1.0, 1.0);\n   vec3  H = normalize( L + V );\n   float NoL = clamp( dot( N, L ), 0.0, 1.0 );\n   float NoH = clamp( dot( N, H ), 0.0, 1.0 );\n   float NoV = clamp( dot( N, V ), 0.0, 1.0 );\n   float VoH = clamp( dot( V, H ), 0.0, 1.0 );\n   float ambientFactor  = lAmbientIntensity * ambIntensity;\n   float diffuseFactor  = lIntensity * NoL;\n   float spec  = lIntensity * NoL;\n   float roughness = 1.0 - shin;\n   float a = max( roughness * roughness, 5e-4 );\n   float a2 = a * a;\n   float denom = NoH * NoH * ( a2 - 1.0 ) + 1.0;\n   float D = a2 / ( denom * denom );\n   float k = a / 2.0;\n   float G_V = ( NoV * ( 1.0 - k ) + k );\n   float G_L = ( NoL * ( 1.0 - k ) + k );\n   float G = 0.25 / ( G_V * G_L );\n   vec3 F = reflectivity + (fresnel - fresnel*reflectivity) * exp2( (-5.55473 * VoH - 6.98316) * VoH );\n   vec3 specularFactor = (D * G) * (F * spec);\n   ambient  += lColor * ambientFactor * attentuation * spot;\n   diffuse  += lColor * diffuseFactor * attentuation * spot;\n   specular += lColor * specularFactor * attentuation * spot;\n}\n"},x3dom.shader.TBNCalculation=function(){return"mat3 cotangent_frame(vec3 N, vec3 p, vec2 uv)\n{\n    // get edge vectors of the pixel triangle\n    vec3 dp1 = dFdx( p );\n    vec3 dp2 = dFdy( p );\n    vec2 duv1 = dFdx( uv );\n    vec2 duv2 = dFdy( uv );\n\n    // solve the linear system\n    vec3 dp2perp = cross( dp2, N );\n    vec3 dp1perp = cross( N, dp1 );\n    vec3 T = dp2perp * duv1.x + dp1perp * duv2.x;\n    vec3 B = dp2perp * duv1.y + dp1perp * duv2.y;\n\n    // construct a scale-invariant frame\n    float invmax = inversesqrt( max( dot(T,T), dot(B,B) ) );\n    return mat3( T * invmax, B * invmax, N );\n}\n\n","vec3 perturb_normal( vec3 N, vec3 V, vec2 texcoord, vec3 bias )\n{\n    // assume N, the interpolated vertex normal and\n    // V, the view vector (vertex to eye)\n    vec3 map = texture2D(normalMap, texcoord ).xyz;\n    map = 2.0 * map - 1.0;\n    map = map * bias;\n    mat3 TBN = cotangent_frame(N, -V, texcoord);\n    return normalize(TBN * map);\n}\n\n","mat3 cotangent_frame(vec3 N, vec3 p, vec2 uv)\n{\n    // get edge vectors of the pixel triangle\n    vec3 dp1 = dFdx( p );\n    vec3 dp2 = dFdy( p );\n    vec2 duv1 = dFdx( uv );\n    vec2 duv2 = dFdy( uv );\n\n    // solve the linear system\n    vec3 dp2perp = cross( dp2, N );\n    vec3 dp1perp = cross( N, dp1 );\n    vec3 T = dp2perp * duv1.x + dp1perp * duv2.x;\n    vec3 B = dp2perp * duv1.y + dp1perp * duv2.y;\n\n    // construct a scale-invariant frame\n    float invmax = inversesqrt( max( dot(T,T), dot(B,B) ) );\n    return mat3( T * invmax, B * invmax, N );\n}\n\nvec3 perturb_normal( vec3 N, vec3 V, vec2 texcoord, vec3 bias )\n{\n    // assume N, the interpolated vertex normal and\n    // V, the view vector (vertex to eye)\n    vec3 map = texture2D(normalMap, texcoord ).xyz;\n    map = 2.0 * map - 1.0;\n    map = map * bias;\n    mat3 TBN = cotangent_frame(N, -V, texcoord);\n    return normalize(TBN * map);\n}\n\n"},x3dom.shader.toneMapping=function(){return"uniform float tonemappingOperator;\n","vec3 tonemapReinhard(vec3 color) { \n    return color / (color + vec3(1.0));\n}\n\n","vec3 uncharted2Tonemap(vec3 color) { \n    float A = 0.15;\n    float B = 0.50;\n    float C = 0.10;\n    float D = 0.20;\n    float E = 0.02;\n    float F = 0.30;\n    return ((color*(A*color+C*B)+D*E)/(color*(A*color+B)+D*F))-E/F;\n}\n\n","vec3 tonemapUncharted2(vec3 color) { \n    float W = 11.2;\n   float exposureBias = 2.0;\n    vec3 curr = uncharted2Tonemap(exposureBias * color);\n    vec3 whiteScale = 1.0 / uncharted2Tonemap(vec3(W));\n    return curr * whiteScale;\n}\n\n","vec3 tonemapeFilmic(vec3 color) { \n    const float a = 2.51;\n    const float b = 0.03;\n    const float c = 2.43;\n    const float d = 0.59;\n    const float e = 0.14;\n    return clamp((color * (a * color + b)) / (color * (c * color + d ) + e), 0.0, 1.0);\n}\n\n","vec3 tonemap(vec3 color) { \n    if(tonemappingOperator == 0.0) {\n       return color;\n    }\n    if(tonemappingOperator == 1.0) {\n       return tonemapReinhard(color);\n    }\n    if(tonemappingOperator == 2.0) {\n       return tonemapUncharted2(color);\n    }\n    if(tonemappingOperator == 3.0) {\n       return tonemapeFilmic(color);\n    }\n}\n\n","uniform float tonemappingOperator;\nvec3 tonemapReinhard(vec3 color) { \n    return color / (color + vec3(1.0));\n}\n\nvec3 uncharted2Tonemap(vec3 color) { \n    float A = 0.15;\n    float B = 0.50;\n    float C = 0.10;\n    float D = 0.20;\n    float E = 0.02;\n    float F = 0.30;\n    return ((color*(A*color+C*B)+D*E)/(color*(A*color+B)+D*F))-E/F;\n}\n\nvec3 tonemapUncharted2(vec3 color) { \n    float W = 11.2;\n   float exposureBias = 2.0;\n    vec3 curr = uncharted2Tonemap(exposureBias * color);\n    vec3 whiteScale = 1.0 / uncharted2Tonemap(vec3(W));\n    return curr * whiteScale;\n}\n\nvec3 tonemapeFilmic(vec3 color) { \n    const float a = 2.51;\n    const float b = 0.03;\n    const float c = 2.43;\n    const float d = 0.59;\n    const float e = 0.14;\n    return clamp((color * (a * color + b)) / (color * (c * color + d ) + e), 0.0, 1.0);\n}\n\nvec3 tonemap(vec3 color) { \n    if(tonemappingOperator == 0.0) {\n       return color;\n    }\n    if(tonemappingOperator == 1.0) {\n       return tonemapReinhard(color);\n    }\n    if(tonemappingOperator == 2.0) {\n       return tonemapUncharted2(color);\n    }\n    if(tonemappingOperator == 3.0) {\n       return tonemapeFilmic(color);\n    }\n}\n\n"},x3dom.shader.DynamicShader=function(e,t){this.program=e.createProgram();var A=this.generateVertexShader(e,t,x3dom.caps.WEBGL_VERSION),i=this.generateFragmentShader(e,t,x3dom.caps.WEBGL_VERSION);return e.attachShader(this.program,A),e.attachShader(this.program,i),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.DynamicShader.prototype.generateVertexShader=function(e,t,A){var i="";i+="uniform mat4 modelMatrix;\n",i+="uniform mat4 modelViewMatrix;\n",i+="uniform mat4 modelViewProjectionMatrix;\n",i+="uniform mat4 modelViewMatrix2;\n",i+="uniform mat4 modelViewProjectionMatrix2;\n",i+="uniform float isVR;\n",i+="attribute float eyeIdx;\n",i+="varying float vrOffset;\n",i+="varying float fragEyeIdx;\n",3==t.POSCOMPONENTS?i+="attribute vec3 position;\n":4==t.POSCOMPONENTS&&(i+="attribute vec4 position;\n"),t.POPGEOMETRY&&(i+="uniform float PG_precisionLevel;\n",i+="uniform float PG_powPrecision;\n",i+="uniform vec3 PG_maxBBSize;\n",i+="uniform vec3 PG_bbMin;\n",i+="uniform vec3 PG_bbMaxModF;\n",i+="uniform vec3 PG_bboxShiftVec;\n",i+="uniform float PG_numAnchorVertices;\n",i+="attribute float PG_vertexID;\n"),(t.LIGHTS||t.PBR_MATERIAL)&&(t.NORMALMAP&&"OBJECT"==t.NORMALSPACE||(i+="varying vec3 fragNormal;\n",i+="uniform mat4 normalMatrix;\n",i+="uniform mat4 normalMatrix2;\n",2==t.NORCOMPONENTS?4!=t.POSCOMPONENTS&&(i+="attribute vec2 normal;\n"):3==t.NORCOMPONENTS&&(i+="attribute vec3 normal;\n"))),t.VERTEXCOLOR&&(3==t.COLCOMPONENTS?(i+="attribute vec3 color;\n",i+="varying vec3 fragColor;\n"):4==t.COLCOMPONENTS&&(i+="attribute vec4 color;\n",i+="varying vec4 fragColor;\n")),t.TEXTURED&&(i+="varying vec2 fragTexcoord;\n",t.MULTITEXCOORD&&(i+="varying vec2 fragTexcoord2;\n"),t.SPHEREMAPPING||t.IS_PARTICLE||(i+="attribute vec2 texcoord;\n",t.MULTITEXCOORD&&(i+="attribute vec2 texcoord2;\n")),t.TEXTRAFO&&(i+="uniform mat4 texTrafoMatrix;\n"),t.NORMALMAP&&"TANGENT"==t.NORMALSPACE&&(t.TANGENTDATA||x3dom.caps.STD_DERIVATIVES||x3dom.debug.logWarning("Your System doesn't support the 'OES_STANDARD_DERIVATIVES' Extension. You must set tangents and binormals manually via the FloatVertexAttribute-Node to use normal maps"),i+="attribute vec3 tangent;\n",i+="attribute vec3 binormal;\n",i+="varying vec3 fragTangent;\n",i+="varying vec3 fragBinormal;\n"),t.DISPLACEMENTMAP&&(i+="uniform sampler2D displacementMap;\n",i+="uniform float displacementFactor;\n",i+="uniform float displacementWidth;\n",i+="uniform float displacementHeight;\n",i+="uniform float displacementAxis;\n"),t.DIFFPLACEMENTMAP&&(i+="uniform sampler2D diffuseDisplacementMap;\n",i+="uniform float displacementFactor;\n",i+="uniform float displacementWidth;\n",i+="uniform float displacementHeight;\n",i+="uniform float displacementAxis;\n")),(t.CUBEMAP||t.PBR_MATERIAL)&&(i+="varying vec3 fragViewDir;\n",i+="uniform mat4 viewMatrix;\n",i+="uniform mat4 viewMatrix2;\n"),t.VERTEXID&&(i+="attribute float id;\n",i+="varying float fragID;\n"),t.IS_PARTICLE&&(i+="attribute vec3 particleSize;\n"),t.POINTPROPERTIES&&(i+="uniform vec3 pointSizeAttenuation;\n",i+="uniform float pointSizeFactor;\n",i+="uniform float minPointSize;\n",i+="uniform float maxPointSize;\n"),(t.LIGHTS||t.FOG||t.CLIPPLANES||t.POINTPROPERTIES)&&(i+="uniform vec3 eyePosition;\n",i+="varying vec4 fragPosition;\n",i+="varying vec4 fragPositionWS;\n",t.FOG&&(i+="varying vec3 fragEyePosition;\n")),t.REQUIREBBOX&&(i+="uniform vec3 bgCenter;\n",i+="uniform vec3 bgSize;\n",i+="uniform float bgPrecisionMax;\n"),t.REQUIREBBOXNOR&&(i+="uniform float bgPrecisionNorMax;\n"),t.REQUIREBBOXCOL&&(i+="uniform float bgPrecisionColMax;\n"),t.REQUIREBBOXTEX&&(i+="uniform float bgPrecisionTexMax;\n"),i+="void main(void) {\n",i+="mat4 mat_mvp = modelViewProjectionMatrix;\n",i+="mat4 mat_mv  = modelViewMatrix;\n",i+="fragEyeIdx = eyeIdx;\n",(t.CUBEMAP||t.PBR_MATERIAL)&&(i+="mat4 mat_v   = viewMatrix;\n"),(t.LIGHTS||t.PBR_MATERIAL)&&(t.NORMALMAP&&"OBJECT"==t.NORMALSPACE||(i+="mat4 mat_n   = normalMatrix;\n")),i+="if(eyeIdx == 1.0){\n",i+="    mat_mvp = modelViewProjectionMatrix2;\n",(t.CUBEMAP||t.PBR_MATERIAL)&&(i+="    mat_v   = viewMatrix2;\n"),(t.LIGHTS||t.PBR_MATERIAL)&&(t.NORMALMAP&&"OBJECT"==t.NORMALSPACE||(i+="mat4 mat_n   = normalMatrix2;\n")),i+="}\n",i+="vec3 vertPosition = position.xyz;\n",t.POPGEOMETRY?(i+="vec3 offsetVec = step(vertPosition / bgPrecisionMax, PG_bbMaxModF) * PG_bboxShiftVec;\n",i+="if ((PG_precisionLevel <= 2.0) || PG_vertexID >= PG_numAnchorVertices) {\n",i+="   vertPosition = floor(vertPosition / PG_powPrecision) * PG_powPrecision;\n",i+="   vertPosition /= (65536.0 - PG_powPrecision);\n",i+="}\n",i+="else {\n",i+="   vertPosition /= bgPrecisionMax;\n",i+="}\n",i+="vertPosition = (vertPosition + offsetVec + PG_bbMin) * PG_maxBBSize;\n"):t.REQUIREBBOX&&(i+="vertPosition = bgCenter + bgSize * vertPosition / bgPrecisionMax;\n"),t.LIGHTS&&(2==t.NORCOMPONENTS?(4==t.POSCOMPONENTS?(i+="vec3 vertNormal = vec3(position.w / 256.0); \n",i+="vertNormal.x = floor(vertNormal.x) / 255.0; \n",i+="vertNormal.y = fract(vertNormal.y) * 1.00392156862745; \n"):t.REQUIREBBOXNOR&&(i+="vec3 vertNormal = vec3(normal.xy, 0.0) / bgPrecisionNorMax;\n"),i+="vec2 thetaPhi = 3.14159265358979 * vec2(vertNormal.x, vertNormal.y*2.0-1.0); \n",i+="vec4 sinCosThetaPhi = sin( vec4(thetaPhi, thetaPhi + 1.5707963267949) ); \n",i+="vertNormal.x = sinCosThetaPhi.x * sinCosThetaPhi.w; \n",i+="vertNormal.y = sinCosThetaPhi.x * sinCosThetaPhi.y; \n",i+="vertNormal.z = sinCosThetaPhi.z; \n"):t.NORMALMAP&&"OBJECT"==t.NORMALSPACE||(i+="vec3 vertNormal = normal;\n",t.REQUIREBBOXNOR&&(i+="vertNormal = vertNormal / bgPrecisionNorMax;\n"),t.POPGEOMETRY&&(i+="vertNormal = 2.0*vertNormal - 1.0;\n"))),t.VERTEXCOLOR&&(i+="fragColor = color;\n",t.REQUIREBBOXCOL&&(i+="fragColor = fragColor / bgPrecisionColMax;\n")),t.TEXTURED&&!t.SPHEREMAPPING&&(t.IS_PARTICLE||t.POINTPROPERTIES?i+="vec2 vertTexCoord = vec2(0.0);\n":(i+="vec2 vertTexCoord = texcoord;\n",t.MULTITEXCOORD&&(i+="vec2 vertTexCoord2 = texcoord2;\n"),t.REQUIREBBOXTEX&&(i+="vertTexCoord = vertTexCoord / bgPrecisionTexMax;\n"))),t.LIGHTS&&(!t.DISPLACEMENTMAP&&!t.DIFFPLACEMENTMAP||t.NORMALMAP?t.NORMALMAP&&"OBJECT"==t.NORMALSPACE||(i+="fragNormal = (mat_n * vec4(vertNormal, 0.0)).xyz;\n"):(i+="float dx = 1.0 / displacementWidth;\n",i+="float dy = 1.0 / displacementHeight;\n",t.DISPLACEMENTMAP?(i+="float s1 = texture2D(displacementMap, vec2(vertTexCoord.x - dx, 1.0 - vertTexCoord.y)).r;\n",i+="float s2 = texture2D(displacementMap, vec2(vertTexCoord.x, 1.0 - vertTexCoord.y - dy)).r;\n",i+="float s3 = texture2D(displacementMap, vec2(vertTexCoord.x + dx, 1.0 - vertTexCoord.y)).r;\n",i+="float s4 = texture2D(displacementMap, vec2(vertTexCoord.x, 1.0 - vertTexCoord.y + dy)).r;\n"):t.DIFFPLACEMENTMAP&&(i+="float s1 = texture2D(diffuseDisplacementMap, vec2(vertTexCoord.x - dx, 1.0 - vertTexCoord.y)).a;\n",i+="float s2 = texture2D(diffuseDisplacementMap, vec2(vertTexCoord.x, 1.0 - vertTexCoord.y - dy)).a;\n",i+="float s3 = texture2D(diffuseDisplacementMap, vec2(vertTexCoord.x + dx, 1.0 - vertTexCoord.y)).a;\n",i+="float s4 = texture2D(diffuseDisplacementMap, vec2(vertTexCoord.x, 1.0 - vertTexCoord.y + dy)).a;\n"),i+="float coef = displacementFactor;\n",i+="vec3 calcNormal;\n",i+="if (displacementAxis == 0.0) {\n",i+="calcNormal = vec3((s1 - s3) * coef, -5.0, (s2 - s4) * coef);\n",i+="} else if(displacementAxis == 1.0) {\n",i+="calcNormal = vec3((s1 - s3) * coef, -5.0, (s2 - s4) * coef);\n",i+="} else {\n",i+="calcNormal = vec3((s1 - s3) * coef, -(s2 - s4) * coef, 5.0);\n",i+="}\n",i+="calcNormal = normalize(calcNormal);\n",i+="fragNormal = (mat_n * vec4(calcNormal, 0.0)).xyz;\n")),(t.CUBEMAP||t.PBR_MATERIAL)&&(i+="fragViewDir = (mat_v[3].xyz);\n"),t.TEXTURED&&(t.SPHEREMAPPING?(i+=" fragTexcoord = 0.5 + fragNormal.xy / 2.0;\n",t.TEXTRAFO&&(i+=" fragTexcoord = (texTrafoMatrix * vec4(fragTexcoord, 1.0, 1.0)).xy;\n")):t.TEXTRAFO?i+=" fragTexcoord = (texTrafoMatrix * vec4(vertTexCoord, 1.0, 1.0)).xy;\n":(i+=" fragTexcoord = vertTexCoord;\n",t.MULTITEXCOORD&&(i+=" fragTexcoord2 = vertTexCoord2;\n"),t.POPGEOMETRY&&!0===x3dom.debug.usePrecisionLevelAsTexCoord&&(i+="fragTexcoord = vec2(0.03125 + 0.9375 * (PG_precisionLevel / 16.0), 1.0);")),t.NORMALMAP&&"TANGENT"==t.NORMALSPACE&&t.TANGENTDATA&&(i+="fragTangent  = (mat_n * vec4(tangent, 0.0)).xyz;\n",i+="fragBinormal = (mat_n * vec4(binormal, 0.0)).xyz;\n")),(t.LIGHTS||t.FOG||t.CLIPPLANES||t.POINTPROPERTIES)&&(i+="fragPosition = (mat_mv * vec4(vertPosition, 1.0));\n",i+="fragPositionWS = (modelMatrix * vec4(vertPosition, 1.0));\n",t.FOG&&(i+="fragEyePosition = eyePosition - fragPosition.xyz;\n")),t.DISPLACEMENTMAP?i+="vertPosition += normalize(vertNormal) * texture2D(displacementMap, vec2(fragTexcoord.x, 1.0-fragTexcoord.y)).r * displacementFactor;\n":t.DIFFPLACEMENTMAP&&(i+="vertPosition += normalize(vertNormal) * texture2D(diffuseDisplacementMap, vec2(fragTexcoord.x, 1.0-fragTexcoord.y)).a * displacementFactor;\n"),i+="gl_Position = mat_mvp * vec4(vertPosition, 1.0);\n",i+="if(isVR == 1.0){\n",i+="    vrOffset = eyeIdx * 0.5;\n",i+="    gl_Position.x *= 0.5;\n",i+="    gl_Position.x += vrOffset * gl_Position.w;\n",i+="}\n",t.IS_PARTICLE?(i+="float spriteDist = (gl_Position.w > 0.000001) ? gl_Position.w : 0.000001;\n",i+="float pointSize = floor(length(particleSize) * 256.0 / spriteDist + 0.5);\n",i+="gl_PointSize = clamp(pointSize, 2.0, 256.0);\n"):t.POINTPROPERTIES?(i+="float r = length( fragPosition.xyz );\n",i+="vec3 a = pointSizeAttenuation;\n",i+="float attFactor = ( a.x + a.y * r + a.z * r * r );\n",i+="float pointSize =  pointSizeFactor * 1.0 / attFactor;\n",i+="gl_PointSize = clamp(pointSize, minPointSize, maxPointSize);\n"):i+="gl_PointSize = 2.0;\n",i+="}\n",2==A&&(i=x3dom.shader.convertVertexShader(i));var o=e.createShader(e.VERTEX_SHADER);return e.shaderSource(o,i),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)||(x3dom.debug.logInfo("VERTEX:\n"+i),x3dom.debug.logError("VertexShader "+e.getShaderInfoLog(o))),o},x3dom.shader.DynamicShader.prototype.generateFragmentShader=function(e,t,A){var i="#ifdef GL_FRAGMENT_PRECISION_HIGH\n";if(i+=" precision highp float;\n",i+="#else\n",i+=" precision mediump float;\n",i+="#endif\n\n",t.PBR_MATERIAL&&x3dom.caps.TEXTURE_LOD&&(i+="#extension GL_EXT_shader_texture_lod : enable\n"),(t.PBR_MATERIAL||t.NORMALMAP)&&x3dom.caps.STD_DERIVATIVES&&(i+="#extension GL_OES_standard_derivatives:enable\n"),i+="//@insertFragColor\n",i+="uniform float isVR;\n",i+="varying float vrOffset;\n",i+="varying float fragEyeIdx;\n",i+="uniform float screenWidth;\n",i+="uniform vec3 cameraPosWS;\n",i+="uniform float alphaCutoff;\n",i+=x3dom.shader.material(),i+=x3dom.shader.toneMapping(),t.PBR_MATERIAL&&!x3dom.caps.TEXTURE_LOD&&1==x3dom.caps.WEBGL_VERSION&&(i+=x3dom.shader.calcMipLevel()),t.TWOSIDEDMAT&&(i+=x3dom.shader.twoSidedMaterial()),t.PBR_MATERIAL&&(t.ISROUGHNESSMETALLIC&&(i+="uniform float metallicFactor;\n"),i+="uniform sampler2D brdfMap;\n",i+="uniform samplerCube diffuseEnvironmentMap;\n",i+="uniform samplerCube specularEnvironmentMap;\n"),t.VERTEXCOLOR&&(3==t.COLCOMPONENTS?i+="varying vec3 fragColor;  \n":4==t.COLCOMPONENTS&&(i+="varying vec4 fragColor;  \n")),(t.CUBEMAP||t.CLIPPLANES||t.PBR_MATERIAL)&&(i+="uniform mat4 viewMatrixInverse;\n",i+="uniform mat4 viewMatrixInverse2;\n",i+="uniform mat4 modelViewMatrixInverse;\n",i+="uniform mat4 modelViewMatrixInverse2;\n"),t.VERTEXID&&(i+="varying float fragID;\n"),t.TEXTURED&&(i+="varying vec2 fragTexcoord;\n",t.MULTITEXCOORD&&(i+="varying vec2 fragTexcoord2;\n"),(t.TEXTURED||t.DIFFUSEMAP)&&(i+="uniform sampler2D diffuseMap;\n"),(t.CUBEMAP||t.PBR_MATERIAL)&&(i+="uniform samplerCube environmentMap;\n",i+="varying vec3 fragViewDir;\n",t.CSSHADER&&(i+="uniform float environmentFactor;\n")),t.EMISSIVEMAP&&(i+="uniform sampler2D emissiveMap;\n"),t.OCCLUSIONMAP&&(i+="uniform sampler2D occlusionMap;\n"),t.ROUGHNESSMETALLICMAP&&(i+="uniform sampler2D roughnessMetallicMap;\n"),t.SPECULARGLOSSINESSMAP&&(i+="uniform sampler2D specularGlossinessMap;\n"),t.OCCLUSIONROUGHNESSMETALLICMAP&&(i+="uniform sampler2D occlusionRoughnessMetallicMap;\n"),t.SPECMAP&&(i+="uniform sampler2D specularMap;\n"),t.SHINMAP&&(i+="uniform sampler2D shininessMap;\n"),t.DISPLACEMENTMAP&&(i+="uniform sampler2D displacementMap;\n",i+="uniform float displacementWidth;\n",i+="uniform float displacementHeight;\n"),t.DIFFPLACEMENTMAP&&(i+="uniform sampler2D diffuseDisplacementMap;\n",i+="uniform float displacementWidth;\n",i+="uniform float displacementHeight;\n"),t.NORMALMAP&&(i+="uniform sampler2D normalMap;\n",i+="uniform vec3 normalBias;\n","TANGENT"==t.NORMALSPACE?x3dom.caps.STD_DERIVATIVES||2==x3dom.caps.WEBGL_VERSION?i+=x3dom.shader.TBNCalculation():(i+="varying vec3 fragTangent;\n",i+="varying vec3 fragBinormal;\n"):"OBJECT"==t.NORMALSPACE&&(i+="uniform mat4 normalMatrix;\n",i+="uniform mat4 normalMatrix2;\n"))),t.FOG&&(i+=x3dom.shader.fog()),(t.LIGHTS||t.CLIPPLANES)&&(i+="varying vec4 fragPosition;\n",i+="varying vec4 fragPositionWS;\n",i+="uniform float isOrthoView;\n"),t.LIGHTS){t.NORMALMAP&&"OBJECT"==t.NORMALSPACE||(i+="varying vec3 fragNormal;\n");var o=t.LIGHTS;t.PHYSICALENVLIGHT&&o--,t.PBR_MATERIAL&&o?i+=x3dom.shader.lightPBR(t.LIGHTS):o&&(i+=x3dom.shader.light(t.LIGHTS))}if(t.CLIPPLANES&&(i+=x3dom.shader.clipPlanes(t.CLIPPLANES)),i+=x3dom.shader.gammaCorrectionDecl(t),i+="void main(void) {\n",(t.CUBEMAP||t.CLIPPLANES||t.PBR_MATERIAL)&&(i+="mat4 mat_mvi = modelViewMatrixInverse;\n",i+="mat4 mat_vi  = viewMatrixInverse;\n"),"OBJECT"==t.NORMALSPACE&&(i+="mat4 mat_n = normalMatrix;\n"),i+="if(fragEyeIdx == 1.0){\n",(t.CUBEMAP||t.CLIPPLANES)&&(i+="    mat_mvi   = modelViewMatrixInverse2;\n",i+="    mat_vi    = viewMatrixInverse2;\n"),"OBJECT"==t.NORMALSPACE&&(i+="    mat_n   = normalMatrix2;\n"),i+="}\n",i+="if ( isVR == 1.0) {\n",i+="    if ( ( step( 0.5, gl_FragCoord.x / screenWidth ) - 0.5 ) * vrOffset < 0.0 ) discard;\n",i+="}\n",t.CLIPPLANES&&(i+="vec3 cappingColor = calculateClipPlanes();\n"),i+="vec4 color;\n",i+="vec4 texColor;\n",i+="color.rgb = diffuseColor;\n",i+="color.a = 1.0 - transparency;\n",i+="vec3 _emissiveColor     = emissiveColor;\n",i+="float _shininess        = shininess;\n",i+="vec3 _specularColor     = specularColor;\n",i+="float _ambientIntensity = ambientIntensity;\n",i+="float _transparency     = transparency;\n",i+="float _occlusion        = 1.0;\n","OPAQUE"==t.ALPHAMODE&&(i+="color.a = 1.0;\n"),t.PBR_MATERIAL&&t.ISROUGHNESSMETALLIC&&(i+="float _metallic         = metallicFactor;\n"),t.SEPARATEBACKMAT&&(i+="  if(!gl_FrontFacing) {\n",i+="    color.rgb = backDiffuseColor;\n",i+="    color.a = 1.0 - backTransparency;\n",i+="    _transparency = 1.0 - backTransparency;\n",i+="    _shininess = backShininess;\n",i+="    _emissiveColor = backEmissiveColor;\n",i+="    _specularColor = backSpecularColor;\n",i+="    _ambientIntensity = backAmbientIntensity;\n",i+="  }\n"),t.VERTEXCOLOR&&(3!==t.COLCOMPONENTS&&"OPAQUE"!=t.ALPHAMODE||!t.PBR_MATERIAL?3!==t.COLCOMPONENTS||t.PBR_MATERIAL?4===t.COLCOMPONENTS&&t.PBR_MATERIAL?i+="color *= fragColor;\n":4!==t.COLCOMPONENTS||t.PBR_MATERIAL||(i+="color = fragColor;\n"):i+="color.rgb = fragColor.rgb;\n":i+="color.rgb *= fragColor.rgb;\n"),t.IS_PARTICLE||t.POINTPROPERTIES?(i+="vec2 texcoord = clamp(gl_PointCoord, 0.01, 0.99);\n",t.MULTITEXCOORD&&(i+="vec2 texcoord2 = texcoord;\n")):t.TEXTURED&&(i+="vec2 texcoord = fragTexcoord;\n",t.MULTITEXCOORD&&(i+="vec2 texcoord2 = fragTexcoord2;\n")),t.UNLIT)t.DIFFUSEMAP&&(t.DIFFUSEMAPCHANNEL?i+="texColor = "+x3dom.shader.decodeGamma(t,"texture2D(diffuseMap, vec2(texcoord2.x, 1.0 - texcoord2.y))")+";\n":i+="texColor = "+x3dom.shader.decodeGamma(t,"texture2D(diffuseMap, vec2(texcoord.x, 1.0 - texcoord.y))")+";\n","OPAQUE"==t.ALPHAMODE&&(i+="texColor.a = 1.0;\n"),i+="color *= texColor;\n");else if(t.LIGHTS){if(i+="vec3 ambient   = vec3(0.0, 0.0, 0.0);\n",i+="vec3 diffuse   = vec3(0.0, 0.0, 0.0);\n",i+="vec3 specular  = vec3(0.0, 0.0, 0.0);\n",i+="vec3 eye;\n",i+="vec3 positionVS = fragPosition.rgb;\n",i+="if ( isOrthoView > 0.0 ) {\n",i+="    eye = vec3(0.0, 0.0, 1.0);\n",i+="} else {\n",i+="    eye = -fragPosition.xyz;\n",i+="}\n",t.NORMALMAP&&(i+="vec3 _normalBias = normalBias;\n"),t.NORMALMAP&&"OBJECT"==t.NORMALSPACE?i+="vec3 normal = vec3(0.0, 0.0, 0.0);\n":i+="vec3 normal = normalize(fragNormal);\n",t.SOLID&&!t.TWOSIDEDMAT||(i+="if (dot(normalize(fragNormal), eye) < 0.0) {\n",i+="  normal *= -1.0;\n",t.NORMALMAP&&(i+="  _normalBias = _normalBias * _normalBias;\n"),i+="}\n"),t.TEXTURED&&(t.NORMALMAP&&("TANGENT"==t.NORMALSPACE?(i+="vec3 n = normal;\n",t.TANGENTDATA||!x3dom.caps.STD_DERIVATIVES&&2!=x3dom.caps.WEBGL_VERSION?(i+="vec3 t = normalize( fragTangent );\n",i+="vec3 b = normalize( fragBinormal );\n",i+="mat3 tangentToWorld = mat3(t, b, n);\n",i+="normal = texture2D( normalMap, vec2(texcoord.x, 1.0-texcoord.y) ).rgb;\n",i+="normal = 2.0 * normal - 1.0;\n",i+="normal = normalize( normal * tangentToWorld );\n"):i+="normal = perturb_normal( n, fragPosition.xyz, vec2(texcoord.x, 1.0 - texcoord.y), _normalBias);\n"):"OBJECT"==t.NORMALSPACE&&(i+="normal = texture2D( normalMap, vec2(texcoord.x, 1.0-texcoord.y) ).rgb;\n",i+="normal = 2.0 * normal - 1.0;\n",i+="normal = (mat_n * vec4(normal, 0.0)).xyz;\n",i+="normal = normalize(normal);\n")),t.CUBEMAP?(i+="vec3 viewDir = normalize(fragViewDir);\n",i+="vec3 reflected = reflect(-eye, normal);\n",i+="reflected = (mat_mvi * vec4(reflected, 0.0)).xyz;\n",i+="texColor = "+x3dom.shader.decodeGamma(t,"textureCube(environmentMap, reflected)")+";\n"):t.DIFFPLACEMENTMAP?i+="texColor = texture2D(diffuseDisplacementMap, vec2(texcoord.x, 1.0-texcoord.y));\n":(t.DIFFUSEMAP||t.TEXT)&&(t.PIXELTEX?t.DIFFUSEMAPCHANNEL?i+="texColor = "+x3dom.shader.decodeGamma(t,"texture2D(diffuseMap, texcoord2)")+";\n":i+="texColor = "+x3dom.shader.decodeGamma(t,"texture2D(diffuseMap, texcoord)")+";\n":t.DIFFUSEMAPCHANNEL?i+="texColor = "+x3dom.shader.decodeGamma(t,"texture2D(diffuseMap, vec2(texcoord2.x, 1.0 - texcoord2.y))")+";\n":i+="texColor = "+x3dom.shader.decodeGamma(t,"texture2D(diffuseMap, vec2(texcoord.x, 1.0 - texcoord.y))")+";\n"),"OPAQUE"==t.ALPHAMODE&&(i+="texColor.a = 1.0;\n"),t.BLENDING&&(t.DIFFUSEMAP||t.TEXT||t.DIFFPLACEMENTMAP||t.CUBEMAP)?t.CUBEMAP&&t.CSSHADER?i+="color.rgb *= mix(vec3(1.0,1.0,1.0), texColor.rgb, environmentFactor);\n":i+="color *= texColor;\n":!t.BLENDING&&(t.DIFFUSEMAP||t.TEXT||t.DIFFPLACEMENTMAP||t.CUBEMAP)&&(i+="color = texColor;\n"),t.SHINMAP&&(i+="_shininess *= texture2D( shininessMap, vec2(texcoord.x, 1.0-texcoord.y) ).r;\n"),t.SPECMAP&&(i+="_specularColor = texture2D(specularMap, vec2(texcoord.x, 1.0-texcoord.y)).rgb;\n"),t.EMISSIVEMAP&&(t.EMISSIVEMAPCHANNEL?i+="_emissiveColor = _emissiveColor * texture2D(emissiveMap, vec2(texcoord2.x, 1.0-texcoord2.y)).rgb;\n":i+="_emissiveColor = _emissiveColor * texture2D(emissiveMap, vec2(texcoord.x, 1.0-texcoord.y)).rgb;\n"),t.ROUGHNESSMETALLICMAP&&(t.ROUGHNESSMETALLICMAPCHANNEL?i+="vec3 roughnessMetallic = texture2D(roughnessMetallicMap, vec2(texcoord2.x, 1.0-texcoord2.y)).rgb;\n":i+="vec3 roughnessMetallic = texture2D(roughnessMetallicMap, vec2(texcoord.x, 1.0-texcoord.y)).rgb;\n",i+="_shininess = 1.0 - (roughnessMetallic.g * (1.0 - _shininess));\n",i+="_metallic  = roughnessMetallic.b * metallicFactor;\n"),t.SPECULARGLOSSINESSMAP&&(t.SPECULARGLOSSINESSMAPCHANNEL?i+="vec4 specularGlossiness = "+x3dom.shader.decodeGamma(t,"texture2D(specularGlossinessMap, vec2(texcoord2.x, 1.0 - texcoord2.y))")+";\n":i+="vec4 specularGlossiness = "+x3dom.shader.decodeGamma(t,"texture2D(specularGlossinessMap, vec2(texcoord.x, 1.0 - texcoord.y))")+";\n",i+="_shininess = specularGlossiness.a * _shininess;\n"),t.OCCLUSIONROUGHNESSMETALLICMAP&&(t.OCCLUSIONROUGHNESSMETALLICMAPCHANNEL?i+="vec3 occlusionRoughnessMetallic = texture2D(occlusionRoughnessMetallicMap, vec2(texcoord2.x, 1.0-texcoord2.y)).rgb;\n":i+="vec3 occlusionRoughnessMetallic = texture2D(occlusionRoughnessMetallicMap, vec2(texcoord.x, 1.0-texcoord.y)).rgb;\n",i+="_occlusion = occlusionRoughnessMetallic.r;\n",i+="_shininess = 1.0 - occlusionRoughnessMetallic.g;\n",i+="_metallic  = occlusionRoughnessMetallic.b;\n"),t.OCCLUSIONMAP&&(t.OCCLUSIONMAPCHANNEL?i+="_occlusion = texture2D(occlusionMap, vec2(texcoord2.x, 1.0-texcoord2.y)).r;\n":i+="_occlusion = texture2D(occlusionMap, vec2(texcoord.x, 1.0-texcoord.y)).r;\n")),t.PBR_MATERIAL&&t.ISROUGHNESSMETALLIC?(i+="_specularColor = mix(vec3(0.04, 0.04, 0.04), color.rgb, _metallic);\n",i+="color.rgb *= (1.0 - _metallic);\n"):t.PBR_MATERIAL&&t.SPECULARGLOSSINESSMAP&&(i+="_specularColor = specularGlossiness.rgb * _specularColor;\n"),o){for(var s=0;s<o;s++){i+=" lighting(light"+s+"_Type, light"+s+"_Location, light"+s+"_Direction, "+("light"+s+"_Color")+", light"+s+"_Attenuation, light"+s+"_Radius, light"+s+"_Intensity, light"+s+"_AmbientIntensity, light"+s+"_BeamWidth, light"+s+"_CutOffAngle, positionVS, normal, eye, _shininess, _ambientIntensity, _specularColor, ambient, diffuse, specular);\n"}i+="ambient = max(ambient, 0.0);\n",i+="diffuse = max(diffuse, 0.0);\n",i+="specular = max(specular, 0.0);\n"}t.PBR_MATERIAL&&t.PHYSICALENVLIGHT&&(i+="float camDistance = length(cameraPosWS.xyz - fragPositionWS.xyz);\n",i+="vec3 N = (mat_vi * vec4(normal, 0.0)).rgb;\n",i+="vec3 V = normalize ( cameraPosWS.xyz - fragPositionWS.xyz );\n",i+="vec3 R = normalize( reflect ( -V, N ) );\n",i+="float roughness  =  1.0 - _shininess;\n",i+="float NoV = clamp(dot( N, V ), 0.0, 1.0);\n",i+="float lod = roughness * 6.0;",i+="diffuse = textureCube( diffuseEnvironmentMap, N ).rgb;\n",x3dom.caps.TEXTURE_LOD||2==x3dom.caps.WEBGL_VERSION?i+="specular = textureCubeLodEXT( specularEnvironmentMap, R, lod ).rgb;\n":(i+="float level = calcMipLevel(dirToCubeUV(R));\n",i+="float bias  = lod - level;\n",i+="specular    = textureCube( specularEnvironmentMap, R, bias ).rgb;\n"),i+="vec3 brdf      = texture2D( brdfMap, vec2( NoV, roughness ) ).rgb;\n",i+="_specularColor = ( _specularColor * brdf.x + brdf.y );\n"),i+="color.rgb = _emissiveColor + ((ambient + diffuse) * color.rgb + specular * _specularColor) * _occlusion;\n",(t.IS_PARTICLE||t.POINTPROPERTIES)&&(t.TEXTURED?i+="if (color.a < 0.01 ) discard;\n":(i+="float pAlpha = 1.0 - clamp(length((gl_PointCoord - 0.5) * 2.0), 0.0, 1.0);\n",i+="if ( pAlpha < 0.01 ) discard;\n"))}else!t.APPMAT||t.VERTEXCOLOR||t.TEXTURED||t.PBR_MATERIAL||(i+="color = vec4(0.0, 0.0, 0.0, 1.0 - _transparency);\n"),t.TEXTURED&&(t.DIFFUSEMAP||t.DIFFPLACEMENTMAP||t.TEXT)?(t.PIXELTEX?t.IS_PARTICLE||t.POINTPROPERTIES?i+="vec2 texCoord = clamp(gl_PointCoord, 0.01, 0.99);\n":i+="vec2 texCoord = fragTexcoord;\n":t.IS_PARTICLE||t.POINTPROPERTIES?(i+="vec2 texCoord = clamp(gl_PointCoord, 0.01, 0.99);\n",i+="texCoord.y = 1.0 - texCoord.y;\n"):i+="vec2 texCoord = vec2(fragTexcoord.x, 1.0-fragTexcoord.y);\n",i+="texColor = "+x3dom.shader.decodeGamma(t,"texture2D(diffuseMap, texCoord)")+";\n",i+="color.a = texColor.a;\n",t.BLENDING||t.IS_PARTICLE||t.POINTPROPERTIES?(i+="if (color.a < 0.01 ) discard;\n",i+="color.rgb += _emissiveColor.rgb;\n",i+="color.rgb *= texColor.rgb;\n"):i+="color = texColor;\n"):t.VERTEXCOLOR||t.PBR_MATERIAL||t.POINTLINE2D?t.VERTEXCOLOR||t.PBR_MATERIAL||!t.POINTLINE2D?t.IS_PARTICLE?(i+="float pAlpha = 1.0 - clamp(length((gl_PointCoord - 0.5) * 2.0), 0.0, 1.0);\n",i+="color.rgb *= vec3(pAlpha);\n",i+="color.a = pAlpha;\n"):t.POINTPROPERTIES&&!t.TEXTURED&&(i+="float pAlpha = 1.0 - clamp(length((gl_PointCoord - 0.5) * 2.0), 0.0, 1.0);\n",i+="if ( pAlpha < 0.01 ) discard;\n"):(i+="color.rgb = _emissiveColor;\n",t.IS_PARTICLE?(i+="float pAlpha = 1.0 - clamp(length((gl_PointCoord - 0.5) * 2.0), 0.0, 1.0);\n",i+="color.rgb *= vec3(pAlpha);\n",i+="color.a = pAlpha;\n"):t.POINTPROPERTIES&&!t.TEXTURED&&(i+="float pAlpha = 1.0 - clamp(length((gl_PointCoord - 0.5) * 2.0), 0.0, 1.0);\n",i+="if ( pAlpha < 0.01 ) discard;\n")):i+="color.rgb += _emissiveColor;\n";t.CLIPPLANES&&(i+="if (cappingColor.r != -1.0) {\n",i+="    color.rgb = cappingColor;\n",i+="}\n"),t.TEXT?i+="if (color.a < (1.0 - _transparency) * 0.5) discard;\n":t.ALPHAMASK?(i+="if (color.a < alphaCutoff) discard;\n",i+="color.a = 1.0;\n"):+t.ALPHATHRESHOLD>0&&(i+="if (color.a <= alphaCutoff) discard;\n"),i+="if(tonemappingOperator == 1.0) {\n",i+="       color.rgb = tonemapReinhard(color.rgb);\n",i+="    }\n",i+="    if(tonemappingOperator == 2.0) {\n",i+="       color.rgb = tonemapUncharted2(color.rgb);\n",i+="    }\n",i+="    if(tonemappingOperator == 3.0) {\n",i+="       color.rgb = tonemapeFilmic(color.rgb);\n",i+="    }\n",i+="color = "+x3dom.shader.encodeGamma(t,"color")+";\n",t.FOG&&!t.SHADOW&&(i+="float f0 = calcFog(fragEyePosition);\n",i+="color.rgb = fogColor * (1.0-f0) + f0 * (color.rgb);\n"),i+="gl_FragColor = color;\n",i+="}\n",2==A&&(i=x3dom.shader.convertFragmentShader(i));var n=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||(x3dom.debug.logInfo("FRAGMENT:\n"+i),x3dom.debug.logError("FragmentShader "+e.getShaderInfoLog(n))),n},x3dom.shader.DynamicShaderPicking=function(e,t,A){this.program=e.createProgram();var i=this.generateVertexShader(e,t,A),o=this.generateFragmentShader(e,t,A);return e.attachShader(this.program,i),e.attachShader(this.program,o),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.DynamicShaderPicking.prototype.generateVertexShader=function(e,t,A){var i="";i+="uniform mat4 modelMatrix;\n",i+="uniform mat4 modelViewProjectionMatrix;\n",i+="uniform mat4 modelMatrix2;\n",i+="uniform mat4 modelViewProjectionMatrix2;\n",i+="uniform float isVR;\n",i+="attribute float eyeIdx;\n",i+="varying float vrOffset;\n",i+="varying float fragEyeIdx;\n",i+="attribute vec3 position;\n",i+="uniform vec3 from;\n",i+="varying vec3 worldCoord;\n",1==A?(i+="attribute vec3 color;\n",i+="varying vec3 fragColor;\n"):2==A&&(i+="attribute vec2 texcoord;\n",i+="varying vec3 fragColor;\n"),t.REQUIREBBOX&&(i+="uniform vec3 bgCenter;\n",i+="uniform vec3 bgSize;\n",i+="uniform float bgPrecisionMax;\n"),t.REQUIREBBOXCOL&&(i+="uniform float bgPrecisionColMax;\n"),t.REQUIREBBOXTEX&&(i+="uniform float bgPrecisionTexMax;\n"),t.VERTEXID&&(i+="uniform float shadowIDs;\n",i+=3==A?"varying vec3 idCoord;\n":"varying vec2 idCoord;\n",i+="varying float fragID;\n",i+="attribute float id;\n"),t.POPGEOMETRY&&(i+="uniform float PG_precisionLevel;\n",i+="uniform float PG_powPrecision;\n",i+="uniform vec3 PG_maxBBSize;\n",i+="uniform vec3 PG_bbMin;\n",i+="uniform vec3 PG_bbMaxModF;\n",i+="uniform vec3 PG_bboxShiftVec;\n",i+="uniform float PG_numAnchorVertices;\n",i+="attribute float PG_vertexID;\n"),t.IS_PARTICLE&&(i+="attribute vec3 particleSize;\n"),t.POINTPROPERTIES&&(i+="uniform vec3 pointSizeAttenuation;\n",i+="uniform float pointSizeFactor;\n",i+="uniform float minPointSize;\n",i+="uniform float maxPointSize;\n"),(t.CLIPPLANES||t.POINTPROPERTIES)&&(i+="uniform mat4 modelViewMatrix;\n",i+="uniform mat4 modelViewMatrix2;\n",i+="uniform vec3 eyePosition;\n",i+="varying vec4 fragPosition;\n",i+="varying vec4 fragPositionWS;\n"),i+="void main(void) {\n",i+="fragEyeIdx = eyeIdx;\n",i+="vec3 pos = position;\n",t.VERTEXID&&(0==A?(i+="idCoord = vec2((id + shadowIDs) / 256.0);\n",i+="idCoord.x = floor(idCoord.x) / 255.0;\n",i+="idCoord.y = fract(idCoord.y) * 1.00392156862745;\n",i+="fragID = id;\n"):3==A?(i+="float ID = id + shadowIDs;\n",i+="float h = floor(ID / 256.0);\n",i+="idCoord.x = ID - (h * 256.0);\n",i+="idCoord.z = floor(h / 256.0);\n",i+="idCoord.y = h - (idCoord.z * 256.0);\n",i+="idCoord = idCoord.zyx / 255.0;\n",i+="fragID = id;\n"):4==A&&(i+="idCoord = vec2((id + shadowIDs) / 256.0);\n",i+="idCoord.x = floor(idCoord.x) / 255.0;\n",i+="idCoord.y = fract(idCoord.y) * 1.00392156862745;\n",i+="fragID = id;\n")),t.POPGEOMETRY?(i+="vec3 offsetVec = step(pos / bgPrecisionMax, PG_bbMaxModF) * PG_bboxShiftVec;\n",i+="if (PG_precisionLevel <= 2.0) {\n",i+="pos = floor(pos / PG_powPrecision) * PG_powPrecision;\n",i+="pos /= (65536.0 - PG_powPrecision);\n",i+="}\n",i+="else {\n",i+="pos /= bgPrecisionMax;\n",i+="}\n",i+="pos = (pos + offsetVec + PG_bbMin) * PG_maxBBSize;\n"):(t.REQUIREBBOX&&(i+="pos = bgCenter + bgSize * pos / bgPrecisionMax;\n"),1!=A||t.REQUIREBBOXCOL?1==A&&t.REQUIREBBOXCOL?i+="fragColor = color / bgPrecisionColMax;\n":2!=A||t.REQUIREBBOXTEX?2==A&&t.REQUIREBBOXTEX&&(i+="vec2 texCoord = texcoord / bgPrecisionTexMax;\n",i+="fragColor = vec3(abs(texCoord.x), abs(texCoord.y), 0.0);\n"):i+="fragColor = vec3(abs(texcoord.x), abs(texcoord.y), 0.0);\n":i+="fragColor = color;\n"),(t.CLIPPLANES||t.POINTPROPERTIES)&&(i+="if(eyeIdx == 1.0){\n",i+="    fragPosition = (modelViewMatrix2 * vec4(pos, 1.0));\n",i+="}else{\n",i+="    fragPosition = (modelViewMatrix * vec4(pos, 1.0));\n",i+="}\n"),t.IS_PARTICLE?(i+="float spriteDist = (gl_Position.w > 0.000001) ? gl_Position.w : 0.000001;\n",i+="float pointSize = floor(length(particleSize) * 256.0 / spriteDist + 0.5);\n",i+="gl_PointSize = clamp(pointSize, 2.0, 256.0);\n"):t.POINTPROPERTIES?(i+="float r = length( fragPosition.xyz );\n",i+="vec3 a = pointSizeAttenuation;\n",i+="float attFactor = ( a.x + a.y * r + a.z * r * r );\n",i+="float pointSize =  pointSizeFactor * 1.0 / attFactor;\n",i+="gl_PointSize = clamp(pointSize, minPointSize, maxPointSize);\n"):i+="gl_PointSize = 2.0;\n",i+="worldCoord = (modelMatrix * vec4(pos, 1.0)).xyz - from;\n",i+="if(eyeIdx == 1.0){\n",i+="    gl_Position = modelViewProjectionMatrix2 * vec4(pos, 1.0);\n",i+="}else{\n",i+="    gl_Position = modelViewProjectionMatrix * vec4(pos, 1.0);\n",i+="}\n",i+="if(isVR == 1.0){\n",i+="    vrOffset = eyeIdx * 0.5;\n",i+="    gl_Position.x *= 0.5;\n",i+="    gl_Position.x += vrOffset * gl_Position.w;\n",i+="}\n",i+="}\n";var o=e.createShader(e.VERTEX_SHADER);return e.shaderSource(o,i),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)||(x3dom.debug.logInfo("VERTEX:\n"+i),x3dom.debug.logError("VertexShader "+e.getShaderInfoLog(o))),o},x3dom.shader.DynamicShaderPicking.prototype.generateFragmentShader=function(e,t,A){var i="#ifdef GL_FRAGMENT_PRECISION_HIGH\n";i+=" precision highp float;\n",i+="#else\n",i+=" precision mediump float;\n",i+="#endif\n\n",i+="uniform float highBit;\n",i+="uniform float lowBit;\n",i+="uniform float sceneSize;\n",i+="varying vec3 worldCoord;\n",i+="uniform float isVR;\n",i+="varying float vrOffset;\n",i+="varying float fragEyeIdx;\n",i+="uniform float screenWidth;\n",1!=A&&2!=A||(i+="varying vec3 fragColor;\n"),t.VERTEXID&&(i+=3==A?"varying vec3 idCoord;\n":"varying vec2 idCoord;\n",i+="varying float fragID;\n"),t.CLIPPLANES&&(i+="uniform mat4 viewMatrixInverse;\n",i+="uniform mat4 viewMatrixInverse2;\n",i+="varying vec4 fragPosition;\n"),t.CLIPPLANES&&(i+=x3dom.shader.clipPlanes(t.CLIPPLANES)),i+="void main(void) {\n",i+="if ( isVR == 1.0) {\n",i+="    if ( ( step( 0.5, gl_FragCoord.x / screenWidth ) - 0.5 ) * vrOffset < 0.0 ) discard;\n",i+="}\n",t.CLIPPLANES&&(i+="calculateClipPlanes();\n"),i+=1==A||2==A?"vec4 color = vec4(fragColor, lowBit);\n":4==A?"vec4 color = vec4(highBit, lowBit, 0.0, 0.0);\n":"vec4 color = vec4(0.0, 0.0, highBit, lowBit);\n",t.VERTEXID&&(0==A||4==A?i+="color.ba = idCoord;\n":3==A&&(i+="color.gba = idCoord;\n")),1!=A&&2!=A&&(i+="float d = length(worldCoord) / sceneSize;\n"),0==A?(i+="vec2 comp = fract(d * vec2(256.0, 1.0));\n",i+="color.rg = comp - (comp.rr * vec2(0.0, 1.0/256.0));\n"):3==A&&(i+="color.r = d;\n"),!t.POINTPROPERTIES&&!t.IS_PARTICLE||t.TEXTURED||(i+="float pAlpha = 1.0 - clamp(length((gl_PointCoord - 0.5) * 2.0), 0.0, 1.0);\n",i+="if ( pAlpha < 0.01 ) discard;\n"),i+="gl_FragColor = color;\n",i+="}\n";var o=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(o,i),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)||(x3dom.debug.logInfo("FRAGMENT:\n"+i),x3dom.debug.logError("FragmentShader "+e.getShaderInfoLog(o))),o},x3dom.shader.DynamicShadowShader=function(e,t){this.program=e.createProgram();var A=this.generateVertexShader(e,t),i=this.generateFragmentShader(e,t);return e.attachShader(this.program,A),e.attachShader(this.program,i),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.DynamicShadowShader.prototype.generateVertexShader=function(e,t){var A="";A+="attribute vec3 position;\n",A+="uniform mat4 modelViewProjectionMatrix;\n",A+="varying vec4 projCoords;\n",t.VERTEXID&&(A+="varying float fragID;\n",A+="attribute float id;\n"),t.REQUIREBBOX&&(A+="uniform vec3 bgCenter;\n",A+="uniform vec3 bgSize;\n",A+="uniform float bgPrecisionMax;\n"),t.POPGEOMETRY&&(A+="uniform float PG_precisionLevel;\n",A+="uniform float PG_powPrecision;\n",A+="uniform vec3 PG_maxBBSize;\n",A+="uniform vec3 PG_bbMin;\n",A+="uniform vec3 PG_bbMaxModF;\n",A+="uniform vec3 PG_bboxShiftVec;\n",A+="uniform float PG_numAnchorVertices;\n",A+="attribute float PG_vertexID;\n"),t.CLIPPLANES&&(A+="uniform mat4 modelViewMatrix;\n",A+="varying vec4 fragPosition;\n"),A+="void main(void) {\n",A+="    vec3 pos = position;\n",t.POPGEOMETRY?(A+="    vec3 offsetVec = step(pos / bgPrecisionMax, PG_bbMaxModF) * PG_bboxShiftVec;\n",A+="    if (PG_precisionLevel <= 2.0) {\n",A+="        pos = floor(pos / PG_powPrecision) * PG_powPrecision;\n",A+="        pos /= (65536.0 - PG_powPrecision);\n",A+="    }\n",A+="    else {\n",A+="        pos /= bgPrecisionMax;\n",A+="    }\n",A+="    pos = (pos + offsetVec + PG_bbMin) * PG_maxBBSize;\n"):t.REQUIREBBOX&&(A+="    pos = bgCenter + bgSize * pos / bgPrecisionMax;\n"),t.VERTEXID&&(A+="    fragID = id;\n"),t.CLIPPLANES&&(A+="    fragPosition = (modelViewMatrix * vec4(pos, 1.0));\n"),A+="    projCoords = modelViewProjectionMatrix * vec4(pos, 1.0);\n",A+="    gl_Position = projCoords;\n",A+="}\n";var i=e.createShader(e.VERTEX_SHADER);return e.shaderSource(i,A),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)||x3dom.debug.logError("[ShadowShader] VertexShader "+e.getShaderInfoLog(i)),i},x3dom.shader.DynamicShadowShader.prototype.generateFragmentShader=function(e,t){var A="";A+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n",A+="    precision highp float;\n",A+="#else\n",A+="    precision mediump float;\n",A+="#endif\n\n",A+="varying vec4 projCoords;\n",A+="uniform float offset;\n",A+="uniform bool cameraView;\n",t.VERTEXID&&(A+="varying float fragID;\n"),t.CLIPPLANES&&(A+="uniform mat4 viewMatrixInverse;\n",A+="varying vec4 fragPosition;\n",A+=x3dom.shader.clipPlanes(t.CLIPPLANES)),x3dom.caps.FP_TEXTURES||(A+=x3dom.shader.rgbaPacking()),A+="void main(void) {\n",t.CLIPPLANES&&(A+="calculateClipPlanes();\n"),A+="    vec3 proj = (projCoords.xyz / projCoords.w);\n",x3dom.caps.FP_TEXTURES?(A+="       if (!cameraView){\n",A+="           proj.z = (proj.z + 1.0)*0.5;\n",A+="           proj.y = proj.z * proj.z;\n",A+="       }\n",A+="    gl_FragColor = vec4(proj, 1.0);\n"):A+="    gl_FragColor = packDepth(proj.z);\n",A+="}\n";var i=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(i,A),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)||x3dom.debug.logError("[ShadowShader] FragmentShader "+e.getShaderInfoLog(i)),i},x3dom.shader.ComposedShader=function(e,t){this.program=e.createProgram();var A=this.generateVertexShader(e,t),i=this.generateFragmentShader(e,t);return e.attachShader(this.program,A),e.attachShader(this.program,i),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.ComposedShader.prototype.generateVertexShader=function(e,t){var A=t._cf.appearance.node._shader._vertex._vf.url[0];A=this.injectVRPartsVS(A);var i=e.createShader(e.VERTEX_SHADER);return e.shaderSource(i,A),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)||x3dom.debug.logError("[ComposedShader] VertexShader "+e.getShaderInfoLog(i)),i},x3dom.shader.ComposedShader.prototype.generateFragmentShader=function(e,t){var A=t._cf.appearance.node._shader._fragment._vf.url[0];A=this.injectVRPartsFS(A);var i=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(i,A),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)||x3dom.debug.logError("[ComposedShader] FragmentShader "+e.getShaderInfoLog(i)),i},x3dom.shader.ComposedShader.prototype.injectVRPartsVS=function(e){var t=this.extractShaderSections(e);return t.before+"attribute float eyeIdx;\nuniform   float isVR;\nuniform   mat4  modelViewProjectionMatrix2;\nuniform   mat4  modelViewProjectionInverseMatrix;\nvarying   float vrOffset;\nvarying   float fragEyeIdx;\n"+t.mainStart+t.main+"fragEyeIdx = eyeIdx;\nif(isVR == 1.0)\n{\n    vec4 webVRPos = modelViewProjectionInverseMatrix * gl_Position;\n    webVRPos.xyz = webVRPos.xyz / webVRPos.w;\n    if(fragEyeIdx == 1.0) {\n        gl_Position = modelViewProjectionMatrix2 * webVRPos;\n    } else {\n        gl_Position = modelViewProjectionMatrix  * webVRPos;\n    }\n    vrOffset = fragEyeIdx * 0.5;\n    gl_Position.x *= 0.5;\n    gl_Position.x += vrOffset * gl_Position.w;\n}"+t.mainEnd},x3dom.shader.ComposedShader.prototype.injectVRPartsFS=function(e){var t=this.extractShaderSections(e);return t.before+"uniform   float isVR;\nuniform   float screenWidth;\nvarying   float vrOffset;\nvarying   float fragEyeIdx;\n"+t.mainStart+"if ( isVR == 1.0) {\n    if ( ( step( 0.5, gl_FragCoord.x / screenWidth ) - 0.5 ) * vrOffset < 0.0 ) discard;\n}\n"+t.main+t.mainEnd},x3dom.shader.ComposedShader.prototype.extractShaderSections=function(e){var t=/void\s*main\s*\(\s*(?:void)?\s*\)\s*{[\s\S]*}/.exec(e),A=t[0].indexOf("{")+t.index+1,i=t[0].lastIndexOf("}")+t.index;return{before:e.substring(0,t.index),mainStart:e.substring(t.index,A),main:e.substring(A,i),mainEnd:e.substring(i,e.length)}},x3dom.shader.NormalShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.NormalShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec3 position;\nattribute vec3 normal;\nuniform vec3 bgCenter;\nuniform vec3 bgSize;\nuniform float bgPrecisionMax;\nuniform float bgPrecisionNorMax;\nuniform mat4 normalMatrix;\nuniform mat4 modelViewProjectionMatrix;\nvarying vec3 fragNormal;\nvoid main(void) {\n    vec3 pos = bgCenter + bgSize * position / bgPrecisionMax;\n    fragNormal = (normalMatrix * vec4(normal / bgPrecisionNorMax, 0.0)).xyz;\n    gl_Position = modelViewProjectionMatrix * vec4(pos, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[NormalShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.NormalShader.prototype.generateFragmentShader=function(e){var t=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(t,"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\n precision mediump float;\n#endif\n\nvarying vec3 fragNormal;\nvoid main(void) {\n    gl_FragColor = vec4(normalize(fragNormal) / 2.0 + 0.5, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[NormalShader] FragmentShader "+e.getShaderInfoLog(t)),t},x3dom.shader.FrontgroundTextureShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.FrontgroundTextureShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec3 position;\nvarying vec2 fragTexCoord;\n\nvoid main(void) {\n    vec2 texCoord = (position.xy + 1.0) * 0.5;\n    fragTexCoord = texCoord;\n    gl_Position = vec4(position.xy, 0.0, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[FrontgroundTextureShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.FrontgroundTextureShader.prototype.generateFragmentShader=function(e){var t=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(t,"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\n precision mediump float;\n#endif\n\nuniform sampler2D tex;\nvarying vec2 fragTexCoord;\n\nvoid main(void) {\n    vec4 col = texture2D(tex, fragTexCoord);\n    gl_FragColor = vec4(col.rgb, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[FrontgroundTextureShader] FragmentShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BackgroundTextureShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.BackgroundTextureShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec3 position;\nvarying vec2 fragTexCoord;\nuniform vec2 scale;\nuniform vec2 translation;\nuniform float isVR;\nattribute float eyeIdx;\nvarying float vrOffset;\nvarying float fragEyeIdx;\n\nvoid main(void) {\n   vec2 texCoord = (position.xy + 1.0) * 0.5;\n   fragTexCoord = texCoord * scale + translation;\n    fragEyeIdx = eyeIdx;\n   gl_Position = vec4(position.xy, 0.0, 1.0);\n    if(isVR == 1.0){\n        vrOffset = eyeIdx * 0.5;\n        gl_Position.x *= 0.5;\n        gl_Position.x += vrOffset * gl_Position.w;\n    }\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[BackgroundTextureShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BackgroundTextureShader.prototype.generateFragmentShader=function(e){var t=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(t,"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\n precision mediump float;\n#endif\n\nuniform float isVR;\nvarying float vrOffset;\nvarying float fragEyeIdx;\nuniform float screenWidth;\nuniform sampler2D tex;\nvarying vec2 fragTexCoord;\n\nvoid main(void) {\n       if ( isVR == 1.0 ) {\n        if ( ( step( 0.5, gl_FragCoord.x / screenWidth ) - 0.5 ) * vrOffset < 0.0 ) discard;\n       }\n    gl_FragColor = texture2D(tex, fragTexCoord);\n}"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[BackgroundTextureShader] FragmentShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BackgroundSkyTextureShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.BackgroundSkyTextureShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec3 position;\nattribute vec2 texcoord;\nuniform mat4 modelViewProjectionMatrix;\nuniform mat4 modelViewProjectionMatrix2;\nvarying vec2 fragTexCoord;\nuniform float isVR;\nattribute float eyeIdx;\nvarying float vrOffset;\nvarying float fragEyeIdx;\n\nvoid main(void) {\n    fragTexCoord = texcoord;\n     fragEyeIdx = eyeIdx;\n     if(eyeIdx == 1.0){\n       gl_Position = modelViewProjectionMatrix2 * vec4(position, 1.0);\n     } else {\n       gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);\n     }\n     if(isVR == 1.0){\n        vrOffset = eyeIdx * 0.5;\n        gl_Position.x *= 0.5;\n        gl_Position.x += vrOffset * gl_Position.w;\n     }\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[BackgroundSkyTextureShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BackgroundSkyTextureShader.prototype.generateFragmentShader=function(e){var t=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(t,"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\n precision mediump float;\n#endif\n\nuniform float isVR;\nvarying float vrOffset;\nvarying float fragEyeIdx;\nuniform float screenWidth;\nuniform sampler2D tex;\nvarying vec2 fragTexCoord;\n\nvoid main(void) {\n    if ( isVR == 1.0 ) {\n        if ( ( step( 0.5, gl_FragCoord.x / screenWidth ) - 0.5 ) * vrOffset < 0.0 ) discard;\n    }\n    gl_FragColor = texture2D(tex, fragTexCoord);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[BackgroundSkyTextureShader] FragmentShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BackgroundCubeTextureShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.BackgroundCubeTextureShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec3 position;\nuniform mat4 modelViewProjectionMatrix;\nvarying vec3 fragNormal;\n\nvoid main(void) {\n    fragNormal = normalize(position);\n    gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[BackgroundCubeTextureShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BackgroundCubeTextureShader.prototype.generateFragmentShader=function(e){var t=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(t,"#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\n precision mediump float;\n#endif\n\nuniform samplerCube tex;\nvarying vec3 fragNormal;\n\nfloat magn(float val) {\n    return ((val >= 0.0) ? val : -1.0 * val);\n}\nvoid main(void) {\n    gl_FragColor = textureCube(tex, fragNormal);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[BackgroundCubeTextureShader] FragmentShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BackgroundCubeTextureDDSShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);if(e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),!e.getProgramParameter(this.program,e.LINK_STATUS))throw"Error linking shaders:"+e.getProgramInfoLog(this.program);return this.program},x3dom.shader.BackgroundCubeTextureDDSShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec3 position;\nuniform mat4 modelViewProjectionMatrix;\nuniform mat4 modelViewProjectionMatrix2;\nvarying vec3 fragNormal;\nuniform float isVR;\nattribute float eyeIdx;\nvarying float vrOffset;\nvarying float fragEyeIdx;\n\nvoid main(void) {\n    fragEyeIdx = eyeIdx;\n   fragNormal = normalize(position);\n    if(eyeIdx == 1.0){\n       gl_Position = modelViewProjectionMatrix2 * vec4(position, 1.0);\n    } else {\n       gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);\n    }\n    if(isVR == 1.0){\n        vrOffset = eyeIdx * 0.5;\n        gl_Position.x *= 0.5;\n        gl_Position.x += vrOffset * gl_Position.w;\n    }\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[BackgroundCubeTextureDDSShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BackgroundCubeTextureDDSShader.prototype.generateFragmentShader=function(e){var t="#ifdef GL_FRAGMENT_PRECISION_HIGH\n";t+="precision highp float;\n",t+="#else\n",t+=" precision mediump float;\n",t+="#endif\n\n",t+=x3dom.shader.toneMapping();var A={GAMMACORRECTION:e.canvas.parent.doc._viewarea._scene.getEnvironment()._vf.gammaCorrectionDefault};t+=x3dom.shader.gammaCorrectionDecl(A),t+="uniform float isVR;\nvarying float vrOffset;\nvarying float fragEyeIdx;\nuniform float screenWidth;\nuniform samplerCube tex;\nvarying vec3 fragNormal;\n\nvoid main(void) {\n    if ( isVR == 1.0 ) {\n       if ( ( step( 0.5, gl_FragCoord.x / screenWidth ) - 0.5 ) * vrOffset < 0.0 ) discard;\n    }\n   vec4 color = textureCube(tex, fragNormal);\n    if(tonemappingOperator == 1.0) {\n       color.rgb = tonemapReinhard(color.rgb);\n    }\n    if(tonemappingOperator == 2.0) {\n       color.rgb = tonemapUncharted2(color.rgb);\n    }\n    if(tonemappingOperator == 3.0) {\n       color.rgb = tonemapeFilmic(color.rgb);\n    }\n   color = "+x3dom.shader.encodeGamma(A,"color")+";\n   gl_FragColor = color;\n}\n";var i=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)||x3dom.debug.logError("[BackgroundCubeTextureDDSShader] FragmentShader "+e.getShaderInfoLog(i)),i},x3dom.shader.ShadowRenderingShader=function(e,t,A){this.program=e.createProgram();var i=this.generateVertexShader(e),o=this.generateFragmentShader(e,t,A);return e.attachShader(this.program,i),e.attachShader(this.program,o),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.ShadowRenderingShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec2 position;\nvarying vec2 vPosition;\nvoid main(void) {\n vPosition = position;\n gl_Position = vec4(position, -1.0, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[ShadowRendering] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.ShadowRenderingShader.prototype.generateFragmentShader=function(e,t,A){var i="#ifdef GL_FRAGMENT_PRECISION_HIGH\n";i+="precision highp float;\n",i+="#else\n",i+=" precision mediump float;\n",i+="#endif\n\n",i+="uniform mat4 inverseViewProj;\n",i+="uniform mat4 inverseProj;\n",i+="varying vec2 vPosition;\n",i+="uniform sampler2D sceneMap;\n";for(var o=0;o<5;o++)i+="uniform float cascade"+o+"_Depth;\n";for(var s=0;s<t.length;s++){i+="uniform float light"+s+"_On;\nuniform float light"+s+"_Type;\nuniform vec3  light"+s+"_Location;\nuniform vec3  light"+s+"_Direction;\nuniform vec3  light"+s+"_Attenuation;\nuniform float light"+s+"_Radius;\nuniform float light"+s+"_BeamWidth;\nuniform float light"+s+"_CutOffAngle;\nuniform float light"+s+"_ShadowIntensity;\nuniform float light"+s+"_ShadowOffset;\nuniform mat4 light"+s+"_ViewMatrix;\n";for(var n=0;n<6;n++)i+="uniform mat4 light"+s+"_"+n+"_Matrix;\n",i+="uniform sampler2D light"+s+"_"+n+"_ShadowMap;\n";for(n=0;n<5;n++)i+="uniform float light"+s+"_"+n+"_Split;\n"}x3dom.caps.FP_TEXTURES||(i+=x3dom.shader.rgbaPacking()),i+=x3dom.shader.shadowRendering(),i+=x3dom.shader.gammaCorrectionDecl({}),A.FOG&&(i+=x3dom.shader.fog()),i+="void main(void) {\n    vec4 color = vec4( 1.0 );\n    vec2 texCoordsSceneMap = (vPosition + 1.0)*0.5;\n    vec4 projCoords = texture2D(sceneMap, texCoordsSceneMap);\n    if ( projCoords == vec4(1.0, 1.0, 1.0, 0.0) ){ gl_FragColor = vec4( 1.0 ); return; }\n",x3dom.caps.FP_TEXTURES||(i+="        projCoords.z = unpackDepth(projCoords);\n        projCoords.w = 1.0;\n"),i+="    projCoords = projCoords / projCoords.w;\n    projCoords.xy = vPosition;\n    vec4 eyeCoords = inverseProj*projCoords;\n",A.FOG&&(i+="    if (fogType < 2.0) {\n        vec3 eye = eyeCoords.xyz / eyeCoords.w;\n        float f0 = calcFog( eye );\n        color = vec4(  1.0 - f0, 1.0 - f0, 1.0 - f0, 1.0 );\n    }\n    else {\n"),i+="    float shadowValue = 1.0;\n    vec4 worldCoords = inverseViewProj*projCoords;\n    float lightInfluence = 0.0;\n";for(s=0;s<t.length;s++)i+="    lightInfluence = getLightInfluence(light"+s+"_Type, light"+s+"_ShadowIntensity, light"+s+"_On, light"+s+"_Location, light"+s+"_Direction, light"+s+"_CutOffAngle, light"+s+"_BeamWidth, light"+s+"_Attenuation, light"+s+"_Radius, eyeCoords.xyz/eyeCoords.w);\n    if (lightInfluence != 0.0){\n        vec4 shadowMapValues;\n        float viewSampleDepth;\n",x3dom.isa(t[s],x3dom.nodeTypes.PointLight)?i+="        getShadowValuesPointLight(shadowMapValues, viewSampleDepth, light"+s+"_Location, worldCoords, light"+s+"_ViewMatrix, light"+s+"_0_Matrix,light"+s+"_1_Matrix,light"+s+"_2_Matrix,light"+s+"_3_Matrix,light"+s+"_4_Matrix,light"+s+"_5_Matrix,light"+s+"_0_ShadowMap,light"+s+"_1_ShadowMap,light"+s+"_2_ShadowMap,light"+s+"_3_ShadowMap,light"+s+"_4_ShadowMap,light"+s+"_5_ShadowMap);\n":i+="        getShadowValuesCascaded(shadowMapValues, viewSampleDepth, worldCoords, -eyeCoords.z/eyeCoords.w,light"+s+"_0_Matrix,light"+s+"_1_Matrix,light"+s+"_2_Matrix,light"+s+"_3_Matrix,light"+s+"_4_Matrix,light"+s+"_5_Matrix,light"+s+"_0_ShadowMap,light"+s+"_1_ShadowMap,light"+s+"_2_ShadowMap,light"+s+"_3_ShadowMap,light"+s+"_4_ShadowMap,light"+s+"_5_ShadowMap, light"+s+"_0_Split, light"+s+"_1_Split, light"+s+"_2_Split, light"+s+"_3_Split, \nlight"+s+"_4_Split);\n",x3dom.caps.FP_TEXTURES?i+="     shadowValue *= clamp(VSM(shadowMapValues.zy, viewSampleDepth, light"+s+"_ShadowOffset),                 1.0 - light"+s+"_ShadowIntensity*lightInfluence, 1.0);\n":i+="    shadowValue *= clamp(ESM(shadowMapValues.z, viewSampleDepth, light"+s+"_ShadowOffset),                 1.0 - light"+s+"_ShadowIntensity*lightInfluence, 1.0);\n",i+="    }\n";i+="    color = "+x3dom.shader.encodeGamma({},"vec4(shadowValue, shadowValue, shadowValue, 1.0)")+" ;\n",A.FOG&&(i+="    }\n"),i+="    gl_FragColor = color;\n}\n";var r=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(r,i),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||x3dom.debug.logError("[ShadowRendering] FragmentShader "+e.getShaderInfoLog(r)),r},x3dom.shader.TextureRefinementShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.TextureRefinementShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec2 position;\nvarying vec2 fragTexCoord;\n\nvoid main(void) {\n    fragTexCoord = (position.xy + 1.0) / 2.0;\n    gl_Position = vec4(position, -1.0, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[TextureRefinementShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.TextureRefinementShader.prototype.generateFragmentShader=function(e){var t=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(t,"#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n#else\n precision mediump float;\n#endif\n\nuniform sampler2D stamp;\nuniform sampler2D lastTex;\nuniform sampler2D curTex;\nuniform int mode;\nuniform vec2 repeat;\nvarying vec2 fragTexCoord;\n\nvoid init(void);\nvoid refine(void);\n\nvoid main(void) {\n    if (mode == 0) { init(); }\n    else { refine(); }\n}\n\nvoid init(void) {\n    gl_FragColor = texture2D(curTex, fragTexCoord);\n}\n\nvoid refine(void) {\n    vec3 red = texture2D(stamp, repeat * fragTexCoord).rgb;\n    vec3 v1  = texture2D(lastTex, fragTexCoord).rgb;\n    vec3 v2  = texture2D(curTex, fragTexCoord).rgb;\n    if (red.r <= 0.5) {\n        gl_FragColor = vec4(v1, 1.0);\n    }\n    else {\n        gl_FragColor = vec4(v2, 1.0);\n    }\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[TextureRefinementShader] FragmentShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BlurShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.BlurShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec2 position;\nvarying vec2 vPosition;\nvoid main(void) {\n vPosition = position;\n gl_Position = vec4(position, -1.0, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[BlurShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.BlurShader.prototype.generateFragmentShader=function(e){var t="#ifdef GL_FRAGMENT_PRECISION_HIGH\n";t+="precision highp float;\n",t+="#else\n",t+=" precision mediump float;\n",t+="#endif\n\n",t+="varying vec2 vPosition;\nuniform sampler2D texture;\nuniform bool horizontal;\nuniform float pixelSizeHor;\nuniform float pixelSizeVert;\nuniform int filterSize;\n",x3dom.caps.FP_TEXTURES?t+="void main(void) {\n    vec2 texCoords = (vPosition + 1.0)*0.5;\n    vec2 offset;\n    if (horizontal) offset = vec2(pixelSizeHor, 0.0);\n    else offset = vec2(0.0, pixelSizeVert);\n    vec4 color = texture2D(texture, texCoords);\n    if (filterSize == 3){\n        color = color * 0.3844;\n        color += 0.3078*texture2D(texture, texCoords-offset);\n        color += 0.3078*texture2D(texture, texCoords+offset);\n    } else if (filterSize == 5){\n        color = color * 0.2921;\n        color += 0.2339*texture2D(texture, texCoords-offset);\n        color += 0.2339*texture2D(texture, texCoords+offset);\n        color += 0.1201*texture2D(texture, texCoords-2.0*offset);\n        color += 0.1201*texture2D(texture, texCoords+2.0*offset);\n    } else if (filterSize == 7){\n        color = color * 0.2161;\n        color += 0.1907*texture2D(texture, texCoords-offset);\n        color += 0.1907*texture2D(texture, texCoords+offset);\n        color += 0.1311*texture2D(texture, texCoords-2.0*offset);\n        color += 0.1311*texture2D(texture, texCoords+2.0*offset);\n        color += 0.0702*texture2D(texture, texCoords-3.0*offset);\n        color += 0.0702*texture2D(texture, texCoords+3.0*offset);\n    }\n    gl_FragColor = color;\n}\n":t+=x3dom.shader.rgbaPacking()+"void main(void) {\n    vec2 texCoords = (vPosition + 1.0)*0.5;\n    vec2 offset;\n    if (horizontal) offset = vec2(pixelSizeHor, 0.0);\n    else offset = vec2(0.0, pixelSizeVert);\n    vec4 packedDepth = texture2D(texture, texCoords);\n    const vec4 clearColor = vec4(1.0, 1.0, 1.0, 0.0);\n    if ( packedDepth == clearColor ) { discard; };\n    float depth = unpackDepth(packedDepth);\n    if (filterSize == 3){\n        vec4 packedDn1 = texture2D(texture, texCoords-offset);\n        vec4 packedDp1 = texture2D(texture, texCoords+offset);\n        if ( (packedDn1 - clearColor) * (packedDp1 - clearColor) == vec4(0.0) ) { discard; };\n        depth = depth * 0.3844;\n        depth += 0.3078*unpackDepth(packedDn1);\n        depth += 0.3078*unpackDepth(packedDp1);\n    } else if (filterSize == 5){\n        vec4 packedDn1 = texture2D(texture, texCoords-offset);\n        vec4 packedDp1 = texture2D(texture, texCoords+offset);\n        vec4 packedDn2 = texture2D(texture, texCoords-2.0*offset);\n        vec4 packedDp2 = texture2D(texture, texCoords+2.0*offset);\n        if ( packedDn1 == clearColor || packedDp1 == clearColor ||              packedDn2 == clearColor || packedDp2 == clearColor ) { discard; };\n        depth = depth * 0.2921;\n        depth += 0.2339*unpackDepth(packedDn1);\n        depth += 0.2339*unpackDepth(packedDp1);\n        depth += 0.1201*unpackDepth(packedDn2);\n        depth += 0.1201*unpackDepth(packedDp2);\n    } else if (filterSize == 7){\n        vec4 packedDn1 = texture2D(texture, texCoords-offset);\n        vec4 packedDp1 = texture2D(texture, texCoords+offset);\n        vec4 packedDn2 = texture2D(texture, texCoords-2.0*offset);\n        vec4 packedDp2 = texture2D(texture, texCoords+2.0*offset);\n        vec4 packedDn3 = texture2D(texture, texCoords-3.0*offset);\n        vec4 packedDp3 = texture2D(texture, texCoords+3.0*offset);\n        if ( packedDn1 == clearColor || packedDp1 == clearColor ||              packedDn2 == clearColor || packedDp2 == clearColor ||              packedDn3 == clearColor || packedDp3 == clearColor ) { discard; };\n        depth = depth * 0.2161;\n        depth += 0.1907*unpackDepth(packedDn1);\n        depth += 0.1907*unpackDepth(packedDp1);\n        depth += 0.1311*unpackDepth(packedDn2);\n        depth += 0.1311*unpackDepth(packedDp2);\n        depth += 0.0702*unpackDepth(packedDn3);\n        depth += 0.0702*unpackDepth(packedDp3);\n    }\n    gl_FragColor = packDepth(depth);\n}\n";var A=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(A,t),e.compileShader(A),e.getShaderParameter(A,e.COMPILE_STATUS)||x3dom.debug.logError("[BlurShader] FragmentShader "+e.getShaderInfoLog(A)),A},x3dom.shader.SSAOShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.SSAOShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec3 position;\nvarying vec2 depthTexCoord;\nvarying vec2 randomTexCoord;\nuniform vec2 randomTextureTilingFactor;\n\nvoid main(void) {\n    vec2 texCoord = (position.xy + 1.0) * 0.5;\n    depthTexCoord = texCoord;\n     randomTexCoord = randomTextureTilingFactor*texCoord;\n    gl_Position = vec4(position.xy, 0.0, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[SSAOShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.SSAOShader.depthReconsructionFunctionCode=function(){var e="uniform float depthReconstructionConstantA;\nuniform float depthReconstructionConstantB;\n";return x3dom.caps.FP_TEXTURES||(e+=x3dom.shader.rgbaPacking()),e+="float getDepth(vec2 depthTexCoord) {\n    vec4 col = texture2D(depthTexture, depthTexCoord);\n    float d;\n",x3dom.caps.FP_TEXTURES?e+="    d = col.b;\n":e+="    d = unpackDepth(col);\n",e+="    return depthReconstructionConstantB/(depthReconstructionConstantA+d);\n",e+="}\n"},x3dom.shader.SSAOShader.prototype.generateFragmentShader=function(e){var t="#ifdef GL_FRAGMENT_PRECISION_HIGH\n";t+="precision highp float;\n",t+="#else\n",t+=" precision mediump float;\n",t+="#endif\n\n",t+="uniform sampler2D depthTexture;\nuniform sampler2D randomTexture;\nuniform float nearPlane;\nuniform float farPlane;\nuniform float radius;\nuniform float depthBufferEpsilon;\nuniform vec3 samples[16];\nvarying vec2 depthTexCoord;\nvarying vec2 randomTexCoord;\n",t+=x3dom.shader.SSAOShader.depthReconsructionFunctionCode(),t+="void main(void) {\n    float referenceDepth = getDepth(depthTexCoord);\n    if(referenceDepth == 1.0)\n    {\n        gl_FragColor = vec4(1.0,1.0,1.0, 1.0);\n        return;\n    }\n    int numOcclusions = 0;\n    for(int i = 0; i<16; ++i){\n        float scale  = 1.0/referenceDepth;\n        vec3 samplepos = reflect(samples[i],texture2D(randomTexture,randomTexCoord).xyz*2.0-vec3(1.0,1.0,1.0));\n        float sampleDepth = getDepth(depthTexCoord+samplepos.xy*scale*radius);\n        //if(abs(sampleDepth-referenceDepth)<=radius*(1.0/nearPlane))\n        if( sampleDepth < referenceDepth-depthBufferEpsilon) {\n            ++numOcclusions;\n        }\n    }\n    float r = 1.0-float(numOcclusions)/16.0;\n    r*=2.0;\n    gl_FragColor = vec4(r,r,r, 1.0);\n}\n";var A=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(A,t),e.compileShader(A),e.getShaderParameter(A,e.COMPILE_STATUS)||x3dom.debug.logError("[SSAOhader] FragmentShader "+e.getShaderInfoLog(A)),A},x3dom.shader.SSAOBlurShader=function(e){this.program=e.createProgram();var t=this.generateVertexShader(e),A=this.generateFragmentShader(e);return e.attachShader(this.program,t),e.attachShader(this.program,A),e.bindAttribLocation(this.program,0,"position"),e.linkProgram(this.program),this.program},x3dom.shader.SSAOBlurShader.prototype.generateVertexShader=function(e){var t=e.createShader(e.VERTEX_SHADER);return e.shaderSource(t,"attribute vec3 position;\nvarying vec2 fragTexCoord;\n\nvoid main(void) {\n    vec2 texCoord = (position.xy + 1.0) * 0.5;\n    fragTexCoord = texCoord;\n    gl_Position = vec4(position.xy, 0.0, 1.0);\n}\n"),e.compileShader(t),e.getShaderParameter(t,e.COMPILE_STATUS)||x3dom.debug.logError("[SSAOShader] VertexShader "+e.getShaderInfoLog(t)),t},x3dom.shader.SSAOBlurShader.prototype.generateFragmentShader=function(e){var t="#ifdef GL_FRAGMENT_PRECISION_HIGH\n";t+="precision highp float;\n",t+="#else\n",t+=" precision mediump float;\n",t+="#endif\n\n",t+="uniform sampler2D SSAOTexture;\nuniform sampler2D depthTexture;\nuniform float nearPlane;\nuniform float farPlane;\nuniform float amount;\nuniform vec2 pixelSize;\nuniform float depthThreshold;\nvarying vec2 fragTexCoord;\n",t+=x3dom.shader.SSAOShader.depthReconsructionFunctionCode(),t+="void main(void) {\n    float sum = 0.0;\n    float numSamples = 0.0;\n    float referenceDepth = getDepth(fragTexCoord);\n    for(int i = -2; i<2;i++){\n        for(int j = -2; j<2;j++){\n            vec2 sampleTexCoord = fragTexCoord+vec2(pixelSize.x*float(i),pixelSize.y*float(j));\n            if(abs(referenceDepth - getDepth(sampleTexCoord))<depthThreshold){\n                sum+= texture2D(SSAOTexture,sampleTexCoord).r;\n                numSamples++;\n    }}}\n    float intensity = mix(1.0,sum/numSamples,amount);\n    gl_FragColor = vec4(intensity,intensity,intensity,1.0);\n}\n";var A=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(A,t),e.compileShader(A),e.getShaderParameter(A,e.COMPILE_STATUS)||x3dom.debug.logError("[SSAOhader] FragmentShader "+e.getShaderInfoLog(A)),A},x3dom.shader.FRAG_COLOR="x3dom_fragColor",x3dom.shader.convertVertexShader=function(e){return"#version 300 es\n"+(e=(e=(e=e.replace(/attribute/g,"in")).replace(/varying/g,"out")).replace(/texture2D/g,"texture"))},x3dom.shader.convertFragmentShader=function(e){return"#version 300 es\n"+(e=(e=(e=(e=(e=e.replace(/varying/g,"in")).replace(/textureCubeLodEXT/g,"textureLod")).replace(/texture2D|textureCube/g,"texture")).replace(/\/\/@insertFragColor/g,"out vec4 "+x3dom.shader.FRAG_COLOR+";\n")).replace(/gl_FragColor/g,x3dom.shader.FRAG_COLOR))},x3dom.registerNodeType("X3DNode","Core",defineClass(null,(function(e){this._xmlNode=null,this._runtime=e&&e.runtime?e.runtime:null,this._DEF=null,this._nameSpace=e&&e.nameSpace?e.nameSpace:null,this._vf={},this._vfFieldTypes={},this._cf={},this._cfFieldTypes={},this._fieldWatchers={},this._routes={},this._listeners={},this._parentNodes=[],this._childNodes=[],this.addField_SFNode("metadata",x3dom.nodeTypes.X3DMetadataObject)}),{type:function(){return this.constructor},typeName:function(){return this.constructor._typeName},addChild:function(e,t){if(e&&"isProtoInstance"in e){if(this.addChild(e.typeNode,t),e.helperNodes.length>0){var A=new x3dom.nodeTypes.Switch;A._nameSpace=this._nameSpace,e.helperNodes.forEach((function(e){A.addChild(e,"children")})),this.addChild2(A)}}else this.addChild2(e,t)},addChild2:function(e,t){if(e){var A=null;if(t)A=this._cf[t];else for(var i in this._cf)if(this._cf.hasOwnProperty(i)){var o=this._cf[i];if(x3dom.isa(e,o.type)){A=o;break}}if(A&&A.addLink(e))return e._parentNodes.push(this),this._childNodes.push(e),"isProtoInstance"in this||e.parentAdded(this),!0;if("isProtoInstance"in this)if("isProtoInstance"in e)this.nodes.concat(e.nodes);else{this.nodes.push(e),that=this,function e(t){Object.keys(t).forEach((function(A){t[A].node&&t[A].node._DEF&&(that.innerNameSpace.defMap[t[A].node._DEF]=t[A].node),t[A].node&&t[A].node._cf&&e(t[A].node._cf)}))}({child:{node:e}})}}return!1},removeChild:function(e,t,A){if(t=t||"any",e)for(var i in this._cf){if(this._cf.hasOwnProperty(i)&&("any"==t||i==t))if(this._cf[i].rmLink(e)||A){for(var o=e._parentNodes.length-1;o>=0;o--)e._parentNodes[o]===this&&(e._parentNodes.splice(o,1),e.parentRemoved(this));for(var s=this._childNodes.length-1;s>=0;s--)if(this._childNodes[s]===e)return e.onRemove(),this._childNodes.splice(s,1),!0}}return!1},onRemove:function(){},parentAdded:function(e){},parentRemoved:function(e){for(var t=0,A=this._childNodes.length;t<A;t++)this._childNodes[t]&&this._childNodes[t].parentRemoved(this)},getCurrentTransform:function(){return this._parentNodes.length>=1?this.transformMatrix(this._parentNodes[0].getCurrentTransform()):x3dom.fields.SFMatrix4f.identity()},transformMatrix:function(e){return e},getVolume:function(){return null},invalidateVolume:function(){},invalidateCache:function(){},volumeValid:function(){return!1},collectDrawableObjects:function(e,t,A,i,o,s){},highlight:function(e,t){this._vf.hasOwnProperty("diffuseColor")&&(e?(void 0===this._actDiffuseColor&&(this._actDiffuseColor=new x3dom.fields.SFColor,this._highlightOn=!1),this._highlightOn||(this._actDiffuseColor.setValues(this._vf.diffuseColor),this._highlightOn=!0),this._vf.diffuseColor.setValues(t)):void 0!==this._actDiffuseColor&&(this._vf.diffuseColor.setValues(this._actDiffuseColor),this._highlightOn=!1,delete this._actDiffuseColor));for(var A=0,i=this._childNodes.length;A<i;A++)this._childNodes[A]&&this._childNodes[A].highlight(e,t)},getRuntime:function(){return this._runtime},findX3DDoc:function(){return this._nameSpace?this._nameSpace.doc:null},doIntersect:function(e){for(var t=!1,A=0;A<this._childNodes.length;A++)this._childNodes[A]&&(t=this._childNodes[A].doIntersect(e)||t);return t},postMessage:function(e,t){this._vf[e]=t;var A=this._fieldWatchers[e],i=this;A&&A.forEach((function(e){e.call(i,t)}));var o={target:i._xmlNode,type:"outputchange",fieldName:e,value:t};this.callEvtHandler("onoutputchange",o)},updateField:function(e,t){var A=this._vf[e];if(void 0===A){for(var i in this._vf)if(i.toLowerCase()==e){e=i,A=this._vf[e];break}if(void 0===A&&0==e.indexOf("set_")){var o=e.substr("set_".length,e.length-1);void 0!==this._vf[o]&&(e=o,A=this._vf[e])}void 0===A&&(A=null,this._vf[e]=A)}if(null!==A){try{this._vf[e].setValueByStr(t)}catch(i){try{switch((typeof this._vf[e]).toString()){case"number":this._vf[e]="number"==typeof t?t:+t;break;case"boolean":this._vf[e]="boolean"==typeof t?t:"true"==t.toLowerCase();break;case"string":this._vf[e]=t}}catch(e){x3dom.debug.logError("updateField: setValueByStr() NYI for "+typeof A)}}this.fieldChanged(e)}},setupRoute:function(e,t,A){var i,o="set_",s="_changed";this._vf[e]||(0===e.indexOf(o)?(i=e.substr(o.length,e.length-1),void 0!==this._vf[i]&&(e=i)):e.indexOf(s)>0&&(i=e.substr(0,e.length-s.length),void 0!==this._vf[i]&&(e=i))),t._vf[A]||(0===A.indexOf(o)?(i=A.substr(o.length,A.length-1),void 0!==t._vf[i]&&(A=i)):A.indexOf(s)>0&&(i=A.substr(0,A.length-s.length),void 0!==t._vf[i]&&(A=i)));var n=this._DEF+"&"+e+"&"+t._DEF+"&"+A;this._routes[n]||(this._fieldWatchers[e]||(this._fieldWatchers[e]=[]),this._fieldWatchers[e].push((function(e){t.postMessage(A,e)})),t._fieldWatchers[A]||(t._fieldWatchers[A]=[]),t._fieldWatchers[A].push((function(e){t._vf[A]=e,t.fieldChanged(A)})),this._routes[n]={from:this._fieldWatchers[e].length-1,to:t._fieldWatchers[A].length-1})},removeRoute:function(e,t,A){var i,o="set_",s="_changed";this._vf[e]||(0===e.indexOf(o)?(i=e.substr(o.length,e.length-1),void 0!==this._vf[i]&&(e=i)):e.indexOf(s)>0&&(i=e.substr(0,e.length-s.length),void 0!==this._vf[i]&&(e=i))),t._vf[A]||(0===A.indexOf(o)?(i=A.substr(o.length,A.length-1),void 0!==t._vf[i]&&(A=i)):A.indexOf(s)>0&&(i=A.substr(0,A.length-s.length),void 0!==t._vf[i]&&(A=i)));var n=this._DEF+"&"+e+"&"+t._DEF+"&"+A;this._routes[n]&&(this._fieldWatchers[e].splice(this._routes[n].from,1),t._fieldWatchers[A].splice(this._routes[n].to,1),delete this._routes[n])},fieldChanged:function(e){},nodeChanged:function(){},callEvtHandler:function(e,t){var A=this._xmlNode;if(!this._xmlNode)return t.cancelBubble;if(!A.getAttribute(e)&&!A[e]&&!this._listeners[t.type])return t.cancelBubble;try{var i=A[e];if(t.target=A,"function"==typeof i)i.call(this._xmlNode,t);else if(A.hasAttribute(e)){var o=A.getAttribute(e);new Function("event",o).call(A,t)}var s=this._listeners[t.type];if(s)for(var n=0;n<s.length;n++)s[n].call(A,t)}catch(e){x3dom.debug.logException(e)}return t.cancelBubble},hasEventListener:function(e){return this._xmlNode&&(this._xmlNode["on"+e]||this._xmlNode.hasAttribute("on"+e)||this._listeners[e])},initSetter:function(e,t){if(e&&t){var A=t.toLowerCase();if(e.__defineSetter__&&e.__defineGetter__?(e.__defineSetter__(t,(function(A){e.setAttribute(t,A)})),e.__defineGetter__(t,(function(){return e.getAttribute(t)})),A!=t&&(e.__defineSetter__(A,(function(A){e.setAttribute(t,A)})),e.__defineGetter__(A,(function(){return e.getAttribute(t)})))):Object.defineProperty(e,t,{set:function(A){e.setAttribute(t,A)},get:function(){return e.getAttribute(t)},configurable:!0,enumerable:!0}),void 0!==this._vf[t]&&!e.attributes[t]&&!e.attributes[t.toLowerCase()]){var i="";try{i=this._vf[t].toGL?this._vf[t].toGL().toString():this._vf[t].toString()}catch(e){i=this._vf[t].toString()}i||(i=""),e.setAttribute(t,i)}}},addField_SFInt32:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?parseInt(e.xmlNode.getAttribute(t),10):A,e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFInt32"},addField_SFFloat:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?+e.xmlNode.getAttribute(t):A,e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFFloat"},addField_SFDouble:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?+e.xmlNode.getAttribute(t):A,e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFDouble"},addField_SFTime:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?+e.xmlNode.getAttribute(t):A,e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFTime"},addField_SFBool:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?"true"===e.xmlNode.getAttribute(t).toLowerCase():A,e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFBool"},addField_SFString:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?e.xmlNode.getAttribute(t):A,e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFString"},addField_SFColor:function(e,t,A,i,o){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFColor.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFColor(A,i,o),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFColor"},addField_SFColorRGBA:function(e,t,A,i,o,s){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFColorRGBA.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFColorRGBA(A,i,o,s),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFColorRGBA"},addField_SFVec2f:function(e,t,A,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFVec2f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFVec2f(A,i),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFVec2f"},addField_SFVec3f:function(e,t,A,i,o){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFVec3f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFVec3f(A,i,o),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFVec3f"},addField_SFVec4f:function(e,t,A,i,o,s){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFVec4f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFVec4f(A,i,o,s),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFVec4f"},addField_SFVec3d:function(e,t,A,i,o){this.addField_SFVec3f(e,t,A,i,o),this._vfFieldTypes[t]="SFVec3d"},addField_SFRotation:function(e,t,A,i,o,s){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.Quaternion.parseAxisAngle(e.xmlNode.getAttribute(t)):x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(A,i,o),s),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFRotation"},addField_SFMatrix4f:function(e,t,A,i,o,s,n,r,a,d,h,g,l,I,c,f,u,C){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFMatrix4f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFMatrix4f(A,i,o,s,n,r,a,d,h,g,l,I,c,f,u,C),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFMatrix4f"},addField_SFImage:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFImage.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFImage(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="SFImage"},addField_MFString:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFString.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFString(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFString"},addField_MFBoolean:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFBoolean.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFBoolean(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFBoolean"},addField_MFInt32:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFInt32.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFInt32(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFInt32"},addField_MFFloat:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFFloat.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFFloat(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFFloat"},addField_MFDouble:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFFloat.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFFloat(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFDouble"},addField_MFColor:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFColor.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFColor(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFColor"},addField_MFColorRGBA:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFColorRGBA.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFColorRGBA(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFColorRGBA"},addField_MFVec2f:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFVec2f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFVec2f(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFVec2f"},addField_MFVec3f:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFVec3f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFVec3f(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFVec3f"},addField_MFVec3d:function(e,t,A){this.addField_MFVec3f(e,t,A),this._vfFieldTypes[t]="MFVec3d"},addField_MFRotation:function(e,t,A){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFRotation.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFRotation(A),e&&e.xmlNode&&this.initSetter(e.xmlNode,t),this._vfFieldTypes[t]="MFRotation"},addField_SFNode:function(e,t){this._cf[e]=new x3dom.fields.SFNode(t),this._cfFieldTypes[e]="SFNode"},addField_MFNode:function(e,t){this._cf[e]=new x3dom.fields.MFNode(t),this._cfFieldTypes[e]="MFNode"}})),x3dom.registerNodeType("X3DMetadataObject","Core",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.X3DMetadataObject.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_SFString(e,"reference","")}))),x3dom.registerNodeType("MetadataBoolean","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,(function(e){x3dom.nodeTypes.MetadataBoolean.superClass.call(this,e),this.addField_MFBoolean(e,"value",[])}))),x3dom.registerNodeType("MetadataDouble","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,(function(e){x3dom.nodeTypes.MetadataDouble.superClass.call(this,e),this.addField_MFDouble(e,"value",[])}))),x3dom.registerNodeType("MetadataFloat","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,(function(e){x3dom.nodeTypes.MetadataFloat.superClass.call(this,e),this.addField_MFFloat(e,"value",[])}))),x3dom.registerNodeType("MetadataInteger","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,(function(e){x3dom.nodeTypes.MetadataInteger.superClass.call(this,e),this.addField_MFInt32(e,"value",[])}))),x3dom.registerNodeType("MetadataSet","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,(function(e){x3dom.nodeTypes.MetadataSet.superClass.call(this,e),this.addField_MFNode("value",x3dom.nodeTypes.X3DMetadataObject)}))),x3dom.registerNodeType("MetadataString","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,(function(e){x3dom.nodeTypes.MetadataString.superClass.call(this,e),this.addField_MFString(e,"value",[])}))),x3dom.registerNodeType("Field","Core",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.Field.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_SFString(e,"type",""),this.addField_SFString(e,"value","")}),{fieldChanged:function(e){var t=this;"value"===e&&this._parentNodes.forEach((function(e){e.fieldChanged(t._vf.name)}))}})),x3dom.registerNodeType("X3DChildNode","Core",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.X3DChildNode.superClass.call(this,e)}))),x3dom.registerNodeType("X3DBindableNode","Core",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DBindableNode.superClass.call(this,e),this.addField_SFBool(e,"bind",!1),this.addField_SFString(e,"description",""),this.addField_SFBool(e,"isActive",!1),this._autoGen=!(!e||!e.autoGen),this._autoGen&&(this._vf.description="default"+this.constructor.superClass._typeName),this._stack=null,this._bindAnimation=!0}),{bind:function(e){this._stack?e?this._stack.push(this):this._stack.pop(this):x3dom.debug.logError("No BindStack in "+this.typeName()+"Bindable")},activate:function(e){this.postMessage("isActive",!0),x3dom.debug.logInfo("activate "+this.typeName()+"Bindable "+this._DEF+"/"+this._vf.description)},deactivate:function(e){this.postMessage("isActive",!1),x3dom.debug.logInfo("deactivate "+this.typeName()+"Bindable "+this._DEF+"/"+this._vf.description)},fieldChanged:function(e){e.indexOf("bind")>=0&&this.bind(this._vf.bind)},nodeChanged:function(){this._stack=this._nameSpace.doc._bindableBag.addBindable(this)}})),x3dom.registerNodeType("X3DInfoNode","Core",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DInfoNode.superClass.call(this,e)}))),x3dom.registerNodeType("WorldInfo","Core",defineClass(x3dom.nodeTypes.X3DInfoNode,(function(e){x3dom.nodeTypes.WorldInfo.superClass.call(this,e),this.addField_MFString(e,"info",[]),this.addField_SFString(e,"title",""),x3dom.debug.logInfo(this._vf.info),x3dom.debug.logInfo(this._vf.title)}))),x3dom.registerNodeType("X3DSensorNode","Core",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DSensorNode.superClass.call(this,e),this.addField_SFBool(e,"enabled",!0)}))),x3dom.registerNodeType("Param","Core",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.Param.superClass.call(this,e),x3dom.debug.logWarning('DEPRECATED: Param element needs to be child of X3D element [<a href="http://x3dom.org/docs/latest/configuration.html">DOCS</a>]')}))),x3dom.registerNodeType("X3DBoundedObject","Grouping",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DBoundedObject.superClass.call(this,e),this.addField_SFBool(e,"render",!0),this.addField_SFBool(e,"visible",!0),this.addField_SFVec3f(e,"bboxCenter",0,0,0),this.addField_SFVec3f(e,"bboxSize",-1,-1,-1),this.addField_SFBool(e,"bboxDisplay",!1),this.addField_SFFloat(e,"bboxMargin",.01),this.addField_SFColor(e,"bboxColor",1,1,0),this._graph={boundedNode:this,localMatrix:x3dom.fields.SFMatrix4f.identity(),globalMatrix:null,volume:new x3dom.fields.BoxVolume,lastVolume:new x3dom.fields.BoxVolume,worldVolume:new x3dom.fields.BoxVolume,center:new x3dom.fields.SFVec3f(0,0,0),coverage:-1,needCulling:!0},this._render=!0,this._bboxNode=null,this._bboxColor=new x3dom.fields.SFColor}),{fieldChanged:function(e){this._vf.hasOwnProperty(e)&&this.invalidateVolume()},nodeChanged:function(){this.invalidateVolume()},parentAdded:function(e){this.invalidateVolume()},getVolume:function(){var e=this._graph.volume;if(!this.volumeValid()&&(this._vf.bboxDisplay||this.renderFlag&&this.renderFlag()))for(var t=0,A=this._childNodes.length;t<A;t++){var i=this._childNodes[t];if(i&&(!i.renderFlag||!0===i.renderFlag()||i._vf.bboxDisplay)){var o=i.getVolume();o&&o.isValid()&&e.extendBounds(o.min,o.max)}}if(!e.equals(this._graph.lastVolume)){this._graph.lastVolume=x3dom.fields.BoxVolume.copy(e);var s={target:this._xmlNode,type:"volumechanged",volume:x3dom.fields.BoxVolume.copy(e)};this.callEvtHandler("onvolumechanged",s)}return e},invalidateVolume:function(){var e=this._graph;e.volume.invalidate(),e.worldVolume.invalidate(),e.globalMatrix=null;for(var t=0,A=this._parentNodes.length;t<A;t++){var i=this._parentNodes[t];i&&i.invalidateVolume()}},invalidateCache:function(){var e=this._graph;e.worldVolume.invalidate(),e.globalMatrix=null},cacheInvalid:function(){return null==this._graph.globalMatrix||!this._graph.worldVolume.isValid()},volumeValid:function(){return this._graph.volume.isValid()},graphState:function(){return this._graph},forceUpdateCoverage:function(){return!1},renderFlag:function(){return this._render!==this._vf.render?(this._vf.visible=this._vf.render,this._render=this._vf.visible):this._render!==this._vf.visible&&(this._vf.render=this._vf.visible,this._render=this._vf.visible),this._render},getBboxNode:function(){if(null==this._bboxNode){var e=x3dom.bboxDom.cloneNode(!0);this._bboxNode=this._nameSpace.setupTree(e,this._xmlNode.parentElement)}var t=this._graph.volume;bboxNode=this._bboxNode,bboxNode._vf.translation=t.center;var A=t.max.subtract(t.min),i=t.diameter*this._vf.bboxMargin;if(bboxNode._vf.scale.set(A.x+i,A.y+i,A.z+i),bboxNode.fieldChanged("scale"),!this._bboxColor.equals(this._vf.bboxColor,.01)){this._bboxColor.setValues(this._vf.bboxColor);var o=this._bboxNode._cf.children.nodes[0]._cf.appearance.node._cf.material.node;o._vf.emissiveColor=this._bboxColor.multiply(.8),o._vf.diffuseColor=this._bboxColor.multiply(.2),o.fieldChanged("emissiveColor")}return this._bboxNode},collectBbox:function(e,t,A,i,o,s){this._vf.bboxDisplay&&this.getBboxNode().collectDrawableObjects(e,t,A,i,o,s)}})),x3dom.bboxDom=(new DOMParser).parseFromString("<Transform><Shape isPickable='false'>  <Appearance>   <Material transparency='0.6' specularColor='0.3 0.3 0.3' diffuseColor='0 0.5 0' emissiveColor='1 0.5 0'></Material>   </Appearance>  <Box size='1 1 1'></Box></Shape></Transform>","text/xml").children[0],x3dom.registerNodeType("X3DGroupingNode","Grouping",defineClass(x3dom.nodeTypes.X3DBoundedObject,(function(e){x3dom.nodeTypes.X3DGroupingNode.superClass.call(this,e),this.addField_MFNode("children",x3dom.nodeTypes.X3DChildNode)}),{collectDrawableObjects:function(e,t,A,i,o,s){var n,r;if(A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),A?(this._graph.globalMatrix||(this._graph.globalMatrix=this.transformMatrix(e)),r=this._graph.globalMatrix):r=this.transformMatrix(e),this.collectBbox(e,t,A,i,o,s),!((o=t.cull(e,this.graphState(),A,o))<0)){var a=this._childNodes.length;if(x3dom.nodeTypes.ClipPlane.count>0){for(var d=[],h=0;h<a;h++)(n=this._childNodes[h])&&x3dom.isa(n,x3dom.nodeTypes.ClipPlane)&&n._vf.on&&n._vf.enabled&&d.push({plane:n,trafo:r});s=d.concat(s)}for(var g=0;g<a;g++)(n=this._childNodes[g])&&n.collectDrawableObjects(r,t,A,i,o,s)}}})),x3dom.registerNodeType("Switch","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Switch.superClass.call(this,e),this.addField_SFInt32(e,"whichChoice",-1)}),{fieldChanged:function(e){"whichChoice"==e&&this.invalidateVolume()},getVolume:function(){var e=this._graph.volume;if(!this.volumeValid()&&(this._vf.bboxDisplay||this.renderFlag&&this.renderFlag())&&this._vf.whichChoice>=0&&this._vf.whichChoice<this._childNodes.length){var t=this._childNodes[this._vf.whichChoice],A=t&&(t._vf.bboxDisplay||t.renderFlag&&t.renderFlag())?t.getVolume():null;A&&A.isValid()&&e.extendBounds(A.min,A.max)}return e},collectDrawableObjects:function(e,t,A,i,o,s){var n,r;A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),A?(this._graph.globalMatrix||(this._graph.globalMatrix=this.transformMatrix(e)),r=this._graph.globalMatrix):r=this.transformMatrix(e),this.collectBbox(r,t,A,i,o,s),this._vf.whichChoice<0||this._vf.whichChoice>=this._childNodes.length||(o=t.cull(e,this.graphState(),A,o))<0||(n=this._childNodes[this._vf.whichChoice])&&n.collectDrawableObjects(r,t,A,i,o,s)},doIntersect:function(e){if(this._vf.whichChoice<0||this._vf.whichChoice>=this._childNodes.length)return!1;var t=this._childNodes[this._vf.whichChoice];return!!t&&t.doIntersect(e)}})),x3dom.registerNodeType("X3DTransformNode","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.X3DTransformNode.superClass.call(this,e),e?e.doc._nodeBag.trans.push(this):x3dom.debug.logWarning("X3DTransformNode: No runtime context found!"),this._trafo=null,this._needCssStyleUpdates=!0}),{tick:function(e){var t=this._xmlNode;if(t&&(t.ontransform||t.hasAttribute("ontransform")||this._listeners.transform)){var A=this.getCurrentTransform(),i={target:t,type:"transform",worldX:A._03,worldY:A._13,worldZ:A._23,cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0}};this.callEvtHandler("ontransform",i)}if(this._needCssStyleUpdates&&t){var o=x3dom.getStyle(t,"-webkit-transform")||x3dom.getStyle(t,"-moz-transform")||x3dom.getStyle(t,"-ms-transform")||x3dom.getStyle(t,"transform");if(o&&"none"!=o)return this._trafo.setValueByStr(o),this.invalidateVolume(),!0;this._needCssStyleUpdates=!1}return!1},transformMatrix:function(e){return e.mult(this._trafo)},getVolume:function(){var e=this._graph.volume;if(!this.volumeValid()&&(this._vf.bboxDisplay||this.renderFlag&&this.renderFlag())){this._graph.localMatrix=this._trafo;for(var t=0,A=this._childNodes.length;t<A;t++){var i=this._childNodes[t];if(i&&(!i.renderFlag||!0===i.renderFlag()||i._vf.bboxDisplay)){var o=i.getVolume();o&&o.isValid()&&e.extendBounds(o.min,o.max)}}e.isValid()&&e.transform(this._trafo)}return e},doIntersect:function(e){var t=!1,A=this._trafo.inverse(),i=new x3dom.fields.SFVec3f(e.pos.x,e.pos.y,e.pos.z),o=new x3dom.fields.SFVec3f(e.dir.x,e.dir.y,e.dir.z);e.pos=A.multMatrixPnt(e.pos),e.dir=A.multMatrixVec(e.dir),e.hitObject&&(e.dist*=e.dir.length());for(var s=0;s<this._childNodes.length;s++)this._childNodes[s]&&(t=this._childNodes[s].doIntersect(e)||t);return e.pos.setValues(i),e.dir.setValues(o),t&&(e.hitPoint=this._trafo.multMatrixPnt(e.hitPoint),e.dist*=e.dir.length()),t},parentRemoved:function(e){var t,A,i=this.findX3DDoc();if(i)for(t=0,A=i._nodeBag.trans.length;t<A;t++)i._nodeBag.trans[t]===this&&i._nodeBag.trans.splice(t,1);for(t=0,A=this._childNodes.length;t<A;t++)this._childNodes[t]&&this._childNodes[t].parentRemoved(this)}})),x3dom.registerNodeType("Transform","Grouping",defineClass(x3dom.nodeTypes.X3DTransformNode,(function(e){x3dom.nodeTypes.Transform.superClass.call(this,e),this.addField_SFVec3f(e,"center",0,0,0),this.addField_SFVec3f(e,"translation",0,0,0),this.addField_SFRotation(e,"rotation",0,0,1,0),this.addField_SFVec3f(e,"scale",1,1,1),this.addField_SFRotation(e,"scaleOrientation",0,0,1,0),this._trafo=x3dom.fields.SFMatrix4f.translation(this._vf.translation.add(this._vf.center)).mult(this._vf.rotation.toMatrix()).mult(this._vf.scaleOrientation.toMatrix()).mult(x3dom.fields.SFMatrix4f.scale(this._vf.scale)).mult(this._vf.scaleOrientation.toMatrix().inverse()).mult(x3dom.fields.SFMatrix4f.translation(this._vf.center.negate()))}),{fieldChanged:function(e){"center"==e||"translation"==e||"rotation"==e||"scale"==e||"scaleOrientation"==e?(this._trafo=x3dom.fields.SFMatrix4f.translation(this._vf.translation.add(this._vf.center)).mult(this._vf.rotation.toMatrix()).mult(this._vf.scaleOrientation.toMatrix()).mult(x3dom.fields.SFMatrix4f.scale(this._vf.scale)).mult(this._vf.scaleOrientation.toMatrix().inverse()).mult(x3dom.fields.SFMatrix4f.translation(this._vf.center.negate())),this.invalidateVolume()):"render"==e&&this.invalidateVolume()}})),x3dom.registerNodeType("MatrixTransform","Grouping",defineClass(x3dom.nodeTypes.X3DTransformNode,(function(e){x3dom.nodeTypes.MatrixTransform.superClass.call(this,e),this.addField_SFMatrix4f(e,"matrix",1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this._trafo=this._vf.matrix.transpose()}),{fieldChanged:function(e){"matrix"==e?(this._trafo=this._vf.matrix.transpose(),this.invalidateVolume()):"render"==e&&this.invalidateVolume()}})),x3dom.registerNodeType("Group","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Group.superClass.call(this,e)}))),x3dom.registerNodeType("Block","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Block.superClass.call(this,e),this.addField_MFString(e,"nameSpaceName",[])}))),x3dom.registerNodeType("StaticGroup","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.StaticGroup.superClass.call(this,e),x3dom.debug.logWarning("StaticGroup erroneously also bakes parent transforms, if happens use Group node!"),this.addField_SFBool(e,"debug",!1),this.addField_SFBool(e,"showDebugBoxVolumes",!1),this.addField_SFString(e,"bvhType","jsBIH"),this.addField_SFInt32(e,"maxObjectsPerNode",1),this.addField_SFInt32(e,"maxDepth",-1),this.addField_SFFloat(e,"minRelativeBBoxSize",.01),this.needBvhRebuild=!0,this.drawableCollection=null,this.bvh=null}),{getMaxDepth:function(){return-1==this._vf.maxDepth?"jsBIH"==this._vf.bvhType?50:4:this._vf.maxDepth},collectDrawableObjects:function(e,t,A,i,o,s){if(A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),!((o=t.cull(e,this.graphState(),A,o))<0)){var n,r;if(A?(this._graph.globalMatrix||(this._graph.globalMatrix=this.transformMatrix(e)),r=this._graph.globalMatrix):r=this.transformMatrix(e),this.needBvhRebuild){var a={viewArea:t.viewarea,sortTrans:t.sortTrans,viewMatrix:t.viewMatrix,projMatrix:t.projMatrix,sceneMatrix:t.sceneMatrix,frustumCulling:!1,smallFeatureThreshold:0,context:t.context};this.drawableCollection=new x3dom.DrawableCollection(a);var d,h=this._childNodes.length;for(d=0;d<h;d++)(n=this._childNodes[d])&&n.collectDrawableObjects(r,this.drawableCollection,A,i,o,s);this.drawableCollection.concat();var g=this._nameSpace.doc._scene,l=new x3dom.bvh.Settings(this._vf.debug,this._vf.showDebugBoxVolumes,this._vf.bvhType,this._vf.maxObjectsPerNode,this.getMaxDepth(),this._vf.minRelativeBBoxSize);for(this.bvh="jsBIH"==this._vf.bvhType?new x3dom.bvh.BIH(g,l):new x3dom.bvh.Culler(this.drawableCollection,g,l),(this._vf.debug||this._vf.showDebugBoxVolumes)&&(this.bvh=new x3dom.bvh.DebugDecorator(this.bvh,g,l)),h=this.drawableCollection.length,d=0;d<h;d++)this.bvh.addDrawable(this.drawableCollection.get(d));this.bvh.compile(),this._vf.debug&&this.bvh.showCompileStats(),this.needBvhRebuild=!1}x3dom.Utils.startMeasure("bvhTraverse"),this.bvh.collectDrawables(t);var I=x3dom.Utils.stopMeasure("bvhTraverse");this._nameSpace.doc.ctx.x3dElem.runtime.addMeasurement("BVH",I),this.bvh.showTraverseStats(this._nameSpace.doc.ctx.x3dElem.runtime)}}})),x3dom.registerNodeType("RemoteSelectionGroup","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.RemoteSelectionGroup.superClass.call(this,e),this.addField_MFString(e,"url",["ws://localhost:35668/cstreams/0"]),this.addField_MFString(e,"label",[]),this.addField_SFInt32(e,"maxRenderedIds",-1),this.addField_SFBool(e,"reconnect",!0),this.addField_SFFloat(e,"scaleRenderedIdsOnMove",1),this.addField_SFBool(e,"enableCulling",!0),this.addField_MFString(e,"invisibleNodes",[]),this._idList=[],this._websocket=null,this._nameObjMap={},this._createTime=[],this._visibleList=[],e?this.initializeSocket():x3dom.debug.logWarning("RemoteSelectionGroup: No runtime context found!")}),{initializeSocket:function(){var e=this;if("WebSocket"in window){var t="ws://localhost:35668/cstreams/0";this._vf.url.length&&this._vf.url[0].length&&(t=this._vf.url[0]),this._websocket=new WebSocket(t),this._websocket._lastMsg=null,this._websocket._lastData="",this._websocket.onopen=function(t){x3dom.debug.logInfo("WS Connected");var A=e._nameSpace.doc._viewarea.getViewMatrix();this._lastMsg=A.toGL().toString(),A=e._nameSpace.doc._viewarea.getProjectionMatrix(),this._lastMsg+=","+A.toGL().toString(),this.send(this._lastMsg),x3dom.debug.logInfo("WS Sent: "+this._lastMsg),this._lastMsg="",this._lastData=""},this._websocket.onclose=function(t){x3dom.debug.logInfo("WS Disconnected"),e._vf.reconnect&&window.setTimeout((function(){e.initializeSocket()}),2e3)},this._websocket.onmessage=function(t){if(e._vf.maxRenderedIds<0)e._idList=x3dom.fields.MFString.parse(t.data);else if(e._vf.maxRenderedIds>0){e._idList=[];for(var A=x3dom.fields.MFString.parse(t.data),i=Math.min(A.length,Math.abs(e._vf.maxRenderedIds)),o=0;o<i;++o)e._idList[o]=A[o]}0!=e._vf.maxRenderedIds&&this._lastData!=t.data&&(this._lastData=t.data,e._nameSpace.doc.needRender=!0,e.invalidateVolume())},this._websocket.onerror=function(e){x3dom.debug.logError(e.data)},this._websocket.updateCamera=function(){var t=e._nameSpace.doc._viewarea.getViewMatrix(),A=t.toGL().toString();A+=","+(t=e._nameSpace.doc._viewarea.getProjectionMatrix()).toGL().toString(),null!=this._lastMsg&&this._lastMsg!=A&&(this._lastMsg=A,this.send(A))}}else x3dom.debug.logError("Browser has no WebSocket support!")},nodeChanged:function(){var e=this._vf.label.length;this._nameObjMap={},this._createTime=new Array(e),this._visibleList=new Array(e);for(var t=0;t<e;++t){var A=this._childNodes[t];A&&x3dom.isa(A,x3dom.nodeTypes.X3DShapeNode)?(this._nameObjMap[this._vf.label[t]]={shape:A,pos:t},this._visibleList[t]=!0):(this._visibleList[t]=!1,x3dom.debug.logError("Invalid children: "+this._vf.label[t])),this._createTime[t]=0}this.invalidateVolume(),x3dom.debug.logInfo("RemoteSelectionGroup has "+e+" entries.")},fieldChanged:function(e){if("url"==e)this._websocket&&(this._websocket.close(),this._websocket=null),this.initializeSocket();else if("invisibleNodes"==e){for(var t=0,A=this._vf.label.length;t<A;++t){var i=this._childNodes[t];if(i&&x3dom.isa(i,x3dom.nodeTypes.X3DShapeNode)){this._visibleList[t]=!0;for(var o=0,s=this._vf.invisibleNodes.length;o<s;++o){var n=this._vf.invisibleNodes[o],r=n.lastIndexOf("*"),a=!1;if(r>0&&(n=n.substring(0,r),a=!0),!(n.length<=1)&&(a&&0==this._vf.label[t].indexOf(n)||this._vf.label[t]==n)){this._visibleList[t]=!1;break}}}else this._visibleList[t]=!1}this.invalidateVolume()}else"render"==e&&this.invalidateVolume()},getNumRenderedObjects:function(e,t){var A=e;if(this._vf.maxRenderedIds>0){var i=Math.max(this._vf.maxRenderedIds,16),o=1;t&&(o=Math.min(this._vf.scaleRenderedIdsOnMove,1)),i=Math.max(Math.round(o*i),0),A=Math.min(A,i)}return A},collectDrawableObjects:function(e,t,A,i,o,s){if(A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),!((o=t.cull(e,this.graphState(),A,o))<=0)){var n,r,a=this._nameSpace.doc._viewarea.isMovingOrAnimating(),d=(new Date).getTime(),h=this._childNodes.length;if(this._vf.enableCulling){if(this._websocket&&this._websocket.updateCamera(),this._vf.label.length){for(r=this.getNumRenderedObjects(this._idList.length,a),n=0;n<r;n++){var g=this._nameObjMap[this._idList[n]];g&&g.shape?(g.shape.collectDrawableObjects(e,t,A,i,o,s),this._createTime[g.pos]=d):x3dom.debug.logError("Invalid label: "+this._idList[n])}for(n=0;n<this._childNodes.length;n++)this._childNodes[n]&&!a&&this._createTime[n]>0&&d-this._createTime[n]>1e4&&this._childNodes[n]._cleanupGLObjects&&(this._childNodes[n]._cleanupGLObjects(!0),this._createTime[n]=0)}}else{r=this.getNumRenderedObjects(h,a);var l=0;for(n=0;n<h;n++){var I=this._childNodes[n];if(I){var c=!0;this._visibleList[n]&&l<r&&I.collectDrawableObjects(e,t,A,i,o,s)&&(this._createTime[n]=d,l++,c=!1),c&&!a&&this._createTime[n]>0&&d-this._createTime[n]>1e4&&I._cleanupGLObjects&&(I._cleanupGLObjects(!0),this._createTime[n]=0)}}}}}})),x3dom.registerNodeType("Scene","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Scene.superClass.call(this,e),this.addField_SFString(e,"pickMode","idBuf"),this.addField_SFBool(e,"doPickPass",!0),this.addField_SFString(e,"shadowObjectIdMapping",""),this._lastMin=new x3dom.fields.SFVec3f(0,0,0),this._lastMax=new x3dom.fields.SFVec3f(1,1,1),this._shadowIdMap=null,this.loadMapping()}),{fieldChanged:function(e){"shadowObjectIdMapping"==e&&this.loadMapping()},updateVolume:function(){var e=this.getVolume();e.isValid()&&(this._lastMin=x3dom.fields.SFVec3f.copy(e.min),this._lastMax=x3dom.fields.SFVec3f.copy(e.max))},loadMapping:function(){if(this._shadowIdMap=null,0!=this._vf.shadowObjectIdMapping.length){var e=this,t=new XMLHttpRequest;t.open("GET",this._nameSpace.getURL(this._vf.shadowObjectIdMapping),!0),x3dom.RequestManager.addRequest(t),t.onload=function(){e._shadowIdMap=JSON.parse(t.response),e._shadowIdMap&&e._shadowIdMap.mapping?x3dom.debug.assert(e._shadowIdMap.maxID<=e._shadowIdMap.mapping.length,"Too few ID map entries in "+e._vf.shadowObjectIdMapping+", length of mapping array is only "+e._shadowIdMap.mapping.length+" instead of "+e._shadowIdMap.ids.length+"!"):x3dom.debug.logWarning("Invalid ID map: "+e._vf.shadowObjectIdMapping)}}}})),x3dom.registerNodeType("X3DGeometryNode","Rendering",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.X3DGeometryNode.superClass.call(this,e),this.addField_SFBool(e,"solid",!0),this.addField_SFBool(e,"ccw",!0),this.addField_SFBool(e,"useGeoCache",!!this._nameSpace&&"true"==this._nameSpace.doc.properties.getProperty("useGeoCache","true").toLowerCase()),this.addField_SFBool(e,"lit",!0),this._mesh=new x3dom.Mesh(this)}),{getVolume:function(){return this._mesh.getVolume()},invalidateVolume:function(){this._mesh.invalidate()},getCenter:function(){return this._mesh.getCenter()},getDiameter:function(){return this._mesh.getDiameter()},doIntersect:function(e){return this._mesh.doIntersect(e)},forceUpdateCoverage:function(){return!1},hasIndexOffset:function(){return!1},getColorTexture:function(){return null},getColorTextureURL:function(){return null},parentAdded:function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)&&(e._cleanupGLObjects&&e._cleanupGLObjects(!0),e.setAllDirty(),e.invalidateVolume())},needLighting:function(){var e=this._mesh._primType.indexOf("TRIANGLE")>=0;return this._vf.lit&&e}})),x3dom.registerNodeType("Mesh","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.Mesh.superClass.call(this,e),this.addField_SFString(e,"primType","triangle"),this.addField_MFInt32(e,"index",[]),this.addField_MFNode("vertexAttributes",x3dom.nodeTypes.X3DVertexAttributeNode)}),{nodeChanged:function(){var e,t=(new Date).getTime(),A=this._cf.vertexAttributes.nodes.length;for(e=0;e<A;e++){var i=this._cf.vertexAttributes.nodes[e]._vf.name;switch(i.toLowerCase()){case"position":this._mesh._positions[0]=this._cf.vertexAttributes.nodes[e]._vf.value.toGL();break;case"normal":this._mesh._normals[0]=this._cf.vertexAttributes.nodes[e]._vf.value.toGL();break;case"texcoord":this._mesh._texCoords[0]=this._cf.vertexAttributes.nodes[e]._vf.value.toGL();break;case"color":this._mesh._colors[0]=this._cf.vertexAttributes.nodes[e]._vf.value.toGL();break;default:this._mesh._dynamicFields[i]={},this._mesh._dynamicFields[i].numComponents=this._cf.vertexAttributes.nodes[e]._vf.numComponents,this._mesh._dynamicFields[i].value=this._cf.vertexAttributes.nodes[e]._vf.value.toGL()}}this._mesh._indices[0]=this._vf.index.toGL(),this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3;var o=(new Date).getTime()-t;x3dom.debug.logWarning("Mesh load time: "+o+" ms")}})),x3dom.registerNodeType("PointSet","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.PointSet.superClass.call(this,e),this.addField_SFNode("coord",x3dom.nodeTypes.X3DCoordinateNode),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this.addField_SFNode("normal",x3dom.nodeTypes.Normal),this._mesh._primType="POINTS"}),{nodeChanged:function(){var e=(new Date).getTime(),t=this._cf.coord.node;x3dom.debug.assert(t,"PointSet without coord node!");var A=t.getPoints(),i=3,o=this._cf.color.node,s=new x3dom.fields.MFColor;o&&(s=o._vf.color,x3dom.debug.assert(A.length==s.length,"Size of color and coord array differs!"),x3dom.isa(o,x3dom.nodeTypes.ColorRGBA)&&(i=4));var n=this._cf.normal.node,r=new x3dom.fields.MFVec3f;n&&(r=n._vf.vector),this._mesh._numColComponents=i,this._mesh._lit=!1,this._mesh._indices[0]=[],this._mesh._positions[0]=A.toGL(),this._mesh._colors[0]=s.toGL(),this._mesh._normals[0]=r.toGL(),this._mesh._texCoords[0]=[],this.invalidateVolume(),this._mesh._numCoords=this._mesh._positions[0].length/3;(new Date).getTime()},fieldChanged:function(e){var t=null;"coord"==e?(t=this._cf.coord.node.getPoints(),this._mesh._positions[0]=t.toGL(),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))):"color"==e&&(t=this._cf.color.node._vf.color,this._mesh._colors[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.colors=!0})))},needLighting:function(){return this._vf.lit&&this._cf.normal.node}})),x3dom.registerNodeType("X3DComposedGeometryNode","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.X3DComposedGeometryNode.superClass.call(this,e),this.addField_SFBool(e,"colorPerVertex",!0),this.addField_SFBool(e,"normalPerVertex",!0),this.addField_SFString(e,"normalUpdateMode","fast"),this.addField_MFNode("attrib",x3dom.nodeTypes.X3DVertexAttributeNode),this.addField_SFNode("coord",x3dom.nodeTypes.X3DCoordinateNode),this.addField_SFNode("normal",x3dom.nodeTypes.Normal),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this.addField_SFNode("texCoord",x3dom.nodeTypes.X3DTextureCoordinateNode)}),{handleAttribs:function(){var e,t=this._cf.attrib.nodes.length;for(e=0;e<t;e++){var A=this._cf.attrib.nodes[e]._vf.name;switch(A.toLowerCase()){case"position":this._mesh._positions[0]=this._cf.attrib.nodes[e]._vf.value.toGL();break;case"normal":this._mesh._normals[0]=this._cf.attrib.nodes[e]._vf.value.toGL();break;case"texcoord":this._mesh._texCoords[0]=this._cf.attrib.nodes[e]._vf.value.toGL();break;case"color":this._mesh._colors[0]=this._cf.attrib.nodes[e]._vf.value.toGL();break;default:this._mesh._dynamicFields[A]={},this._mesh._dynamicFields[A].numComponents=this._cf.attrib.nodes[e]._vf.numComponents,this._mesh._dynamicFields[A].value=this._cf.attrib.nodes[e]._vf.value.toGL()}}}})),x3dom.registerNodeType("LineSet","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.LineSet.superClass.call(this,e),this.addField_MFInt32(e,"vertexCount",[]),this.addField_MFNode("attrib",x3dom.nodeTypes.X3DVertexAttributeNode),this.addField_SFNode("coord",x3dom.nodeTypes.X3DCoordinateNode),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this._mesh._primType="LINES",x3dom.Utils.needLineWidth=!0}),{nodeChanged:function(){var e=this._cf.coord.node;x3dom.debug.assert(e);var t=e.getPoints();this._mesh._positions[0]=t.toGL();var A=this._cf.color.node;if(A){var i=A._vf.color;this._mesh._colors[0]=i.toGL(),this._mesh._numColComponents=3,x3dom.isa(A,x3dom.nodeTypes.ColorRGBA)&&(this._mesh._numColComponents=4)}var o=0;this._mesh._indices[0]=[];for(var s=0,n=this._vf.vertexCount.length;s<n;s++){var r=this._vf.vertexCount[s];if(r<2){x3dom.debug.logError("LineSet.vertexCount must not be smaller than 2!");break}for(var a=r-2;a>=0;a--)this._mesh._indices[0].push(o++,o),0==a&&o++}},fieldChanged:function(e){if("coord"==e){var t=this._cf.coord.node.getPoints();this._mesh._positions[0]=t.toGL(),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))}else if("color"==e){var A=this._cf.color.node._vf.color;this._mesh._colors[0]=A.toGL(),this._parentNodes.forEach((function(e){e._dirty.colors=!0}))}}})),x3dom.registerNodeType("IndexedLineSet","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.IndexedLineSet.superClass.call(this,e),this.addField_SFBool(e,"colorPerVertex",!0),this.addField_MFNode("attrib",x3dom.nodeTypes.X3DVertexAttributeNode),this.addField_SFNode("coord",x3dom.nodeTypes.X3DCoordinateNode),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this.addField_MFInt32(e,"coordIndex",[]),this.addField_MFInt32(e,"colorIndex",[]),this._mesh._primType="LINES",x3dom.Utils.needLineWidth=!0}),{_buildGeometry:function(){var e=(new Date).getTime(),t=this._vf.coordIndex;-1!=t.slice(-1)[0]&&t.push(-1);var A=t.filter((function(e){return-1==e})).length,i=this._vf.colorPerVertex,o=this._vf.colorIndex;if(0==o.length&&!i)for(;o.length<A;)o.push(o.length);var s,n,r=!1,a=!1;i&&o.length>=t.length&&(a=!0),!i&&o.length>=A&&(a=!0);var d=this._cf.coord.node;x3dom.debug.assert(d),s=d.getPoints();var h,g,l,I,c,f,u,C,_=3,m=this._cf.color.node;if(m&&(r=!0,n=m._vf.color,x3dom.isa(m,x3dom.nodeTypes.ColorRGBA)&&(_=4)),this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._colors[0]=[],r&&a||s.length>x3dom.Utils.maxIndexableCoords){for(g=0,l=0,I=0,h=0;h<t.length;++h)if(!(t[h]>s.length-1))if(-1!==t[h])switch(a&&x3dom.debug.assert(-1!=o[h]),g){case 0:c=+t[h],u=a&&i?+o[h]:a&&!i?+o[I]:c,g=1;break;case 1:E(this._mesh),g=2;break;case 2:c=f,u=C,E(this._mesh)}else g=0,I+=i?0:1;s.length>x3dom.Utils.maxIndexableCoords&&this._mesh.splitMesh(2)}else{var p=t.length;for(g=0,h=0;h<p;++h)if(-1!=t[h])switch(g){case 0:c=+t[h],g=1;break;case 1:f=+t[h],g=2,this._mesh._indices[0].push(c,f);break;case 2:c=f,f=+t[h],this._mesh._indices[0].push(c,f)}else g=0;this._mesh._positions[0]=s.toGL(),r&&(this._mesh._colors[0]=n.toGL(),this._mesh._numColComponents=_)}for(this.invalidateVolume(),this._mesh._numCoords=0,h=0;h<this._mesh._indices.length;h++)this._mesh._numCoords+=this._mesh._positions[h].length/3;(new Date).getTime();function E(e){f=+t[h],C=a&&i?+o[h]:a&&!i?+o[I]:f,e._indices[0].push(l++,l++),e._positions[0].push(s[c].x),e._positions[0].push(s[c].y),e._positions[0].push(s[c].z),e._positions[0].push(s[f].x),e._positions[0].push(s[f].y),e._positions[0].push(s[f].z),r&&(i||(u=C),e._colors[0].push(n[u].r),e._colors[0].push(n[u].g),e._colors[0].push(n[u].b),e._colors[0].push(n[C].r),e._colors[0].push(n[C].g),e._colors[0].push(n[C].b)),I+=i?1:0}},nodeChanged:function(){this._buildGeometry()},fieldChanged:function(e){"coord"==e?(this._buildGeometry(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))):"color"==e?(this._buildGeometry(),this._parentNodes.forEach((function(e){e._dirty.colors=!0}))):"coordIndex"==e?(this._buildGeometry(),this._parentNodes.forEach((function(e){e._dirty.indexes=!0,e.invalidateVolume()}))):"colorIndex"==e&&(this._buildGeometry(),this._parentNodes.forEach((function(e){e._dirty.colors=!0,e.invalidateVolume()})))}})),x3dom.registerNodeType("IndexedTriangleSet","Rendering",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,(function(e){x3dom.nodeTypes.IndexedTriangleSet.superClass.call(this,e),this.addField_MFInt32(e,"index",[])}),{nodeChanged:function(){var e=(new Date).getTime();this.handleAttribs();var t,A,i,o,s=this._vf.colorPerVertex,n=this._vf.normalPerVertex,r=this._vf.ccw,a=this._vf.index,d=!1,h=!1,g=!1,l=this._cf.coord.node;x3dom.debug.assert(l),t=l._vf.point;var I=this._cf.normal.node;I?(d=!0,A=I._vf.vector):d=!1;var c="",f=2,u=this._cf.texCoord.node;x3dom.isa(u,x3dom.nodeTypes.MultiTextureCoordinate)&&u._cf.texCoord.nodes.length&&(u=u._cf.texCoord.nodes[0]),u?u._vf.point?(h=!0,i=u._vf.point,x3dom.isa(u,x3dom.nodeTypes.TextureCoordinate3D)&&(f=3)):u._vf.mode&&(c=u._vf.mode):h=!1;var C,_,m,p,E,B,Q,x,v,y,F,D,S,w,N,T,b,M=3,R=this._cf.color.node;for(R?(g=!0,o=R._vf.color,x3dom.isa(R,x3dom.nodeTypes.ColorRGBA)&&(M=4)):g=!1,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];t.length%3>0;)t.push(t.length-1);if(E=t.length,!n||!s||E>x3dom.Utils.maxIndexableCoords){for(_=0,m=0,p=0,this._mesh._multiIndIndices=[],this._mesh._posSize=t.length,C=0;C<a.length;++C)switch(C>0&&C%3==0&&(_=0,p++),_){case 0:B=+a[C],n?v=B:n||(v=p),D=B,s?N=B:s||(N=p),_=1;break;case 1:Q=+a[C],n?y=Q:n||(y=p),S=Q,s?T=Q:s||(T=p),_=2;break;case 2:x=+a[C],n?F=x:n||(F=p),w=x,s?b=x:s||(b=p),_=3,this._mesh._indices[0].push(m++,m++,m++),this._mesh._positions[0].push(t[B].x),this._mesh._positions[0].push(t[B].y),this._mesh._positions[0].push(t[B].z),this._mesh._positions[0].push(t[Q].x),this._mesh._positions[0].push(t[Q].y),this._mesh._positions[0].push(t[Q].z),this._mesh._positions[0].push(t[x].x),this._mesh._positions[0].push(t[x].y),this._mesh._positions[0].push(t[x].z),d?(this._mesh._normals[0].push(A[v].x),this._mesh._normals[0].push(A[v].y),this._mesh._normals[0].push(A[v].z),this._mesh._normals[0].push(A[y].x),this._mesh._normals[0].push(A[y].y),this._mesh._normals[0].push(A[y].z),this._mesh._normals[0].push(A[F].x),this._mesh._normals[0].push(A[F].y),this._mesh._normals[0].push(A[F].z)):this._mesh._multiIndIndices.push(B,Q,x),g&&(this._mesh._colors[0].push(o[N].r),this._mesh._colors[0].push(o[N].g),this._mesh._colors[0].push(o[N].b),4===M&&this._mesh._colors[0].push(o[N].a),this._mesh._colors[0].push(o[T].r),this._mesh._colors[0].push(o[T].g),this._mesh._colors[0].push(o[T].b),4===M&&this._mesh._colors[0].push(o[T].a),this._mesh._colors[0].push(o[b].r),this._mesh._colors[0].push(o[b].g),this._mesh._colors[0].push(o[b].b),4===M&&this._mesh._colors[0].push(o[b].a)),h&&(this._mesh._texCoords[0].push(i[D].x),this._mesh._texCoords[0].push(i[D].y),3===f&&this._mesh._texCoords[0].push(i[D].z),this._mesh._texCoords[0].push(i[S].x),this._mesh._texCoords[0].push(i[S].y),3===f&&this._mesh._texCoords[0].push(i[S].z),this._mesh._texCoords[0].push(i[w].x),this._mesh._texCoords[0].push(i[w].y),3===f&&this._mesh._texCoords[0].push(i[w].z))}d||this._mesh.calcNormals(n?Math.PI:0),h||this._mesh.calcTexCoords(c),this._mesh.splitMesh()}else{for(p=0,C=0;C<a.length;C++)C>0&&C%3==0&&p++,this._mesh._indices[0].push(a[C]),!n&&d&&(this._mesh._normals[0].push(A[p].x),this._mesh._normals[0].push(A[p].y),this._mesh._normals[0].push(A[p].z)),!s&&g&&(this._mesh._colors[0].push(o[p].r),this._mesh._colors[0].push(o[p].g),this._mesh._colors[0].push(o[p].b),4===M&&this._mesh._colors[0].push(o[p].a));this._mesh._positions[0]=t.toGL(),d?this._mesh._normals[0]=A.toGL():this._mesh.calcNormals(n?Math.PI:0,r),h?(this._mesh._texCoords[0]=i.toGL(),this._mesh._numTexComponents=f):this._mesh.calcTexCoords(c),g&&s&&(this._mesh._colors[0]=o.toGL(),this._mesh._numColComponents=M)}for(this.invalidateVolume(),this._mesh._numFaces=0,this._mesh._numCoords=0,C=0;C<this._mesh._indices.length;C++)this._mesh._numFaces+=this._mesh._indices[C].length/3,this._mesh._numCoords+=this._mesh._positions[C].length/3;(new Date).getTime()},fieldChanged:function(e){var t=this._cf.coord.node._vf.point;if(t.length>x3dom.Utils.maxIndexableCoords)x3dom.debug.logWarning("IndexedTriangleSet: fieldChanged with too many coordinates not yet implemented!");else if("coord"==e)this._mesh._positions[0]=t.toGL(),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}));else if("color"==e){if(t=this._cf.color.node._vf.color,this._vf.colorPerVertex)this._mesh._colors[0]=t.toGL();else if(!this._vf.colorPerVertex){var A=0,i=3;x3dom.isa(this._cf.color.node,x3dom.nodeTypes.ColorRGBA)&&(i=4),this._mesh._colors[0]=[];for(var o=this._vf.index,s=0;s<o.length;++s)s>0&&s%3==0&&A++,this._mesh._colors[0].push(t[A].r),this._mesh._colors[0].push(t[A].g),this._mesh._colors[0].push(t[A].b),4===i&&this._mesh._colors[0].push(t[A].a)}this._parentNodes.forEach((function(e){e._dirty.colors=!0}))}else if("normal"==e){if(t=this._cf.normal.node._vf.vector,this._vf.normalPerVertex)this._mesh._normals[0]=t.toGL();else if(!this._vf.normalPerVertex){o=this._vf.index;this._mesh._normals[0]=[];for(A=0,s=0;s<o.length;++s)s>0&&s%3==0&&A++,this._mesh._normals[0].push(t[A].x),this._mesh._normals[0].push(t[A].y),this._mesh._normals[0].push(t[A].z)}this._parentNodes.forEach((function(e){e._dirty.normals=!0}))}else if("texCoord"==e){var n=this._cf.texCoord.node;x3dom.isa(n,x3dom.nodeTypes.MultiTextureCoordinate)&&n._cf.texCoord.nodes.length&&(n=n._cf.texCoord.nodes[0]),t=n._vf.point,this._mesh._texCoords[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.texcoords=!0}))}}})),x3dom.registerNodeType("IndexedTriangleStripSet","Rendering",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,(function(e){x3dom.nodeTypes.IndexedTriangleStripSet.superClass.call(this,e),this.addField_MFInt32(e,"index",[]),this._hasIndexOffset=!1,this._indexOffset=null}),{hasIndexOffset:function(){return this._hasIndexOffset},nodeChanged:function(){this.handleAttribs();var e,t,A,i,o=!1,s=!1,n=!1,r=this._vf.colorPerVertex,a=this._vf.normalPerVertex,d=this._vf.index;d.length&&-1!=d[d.length-1]&&d.push(-1);var h=this._cf.coord.node;x3dom.debug.assert(h),e=h._vf.point;var g=this._cf.normal.node;g?(o=!0,t=g._vf.vector):o=!1;var l="",I=2,c=this._cf.texCoord.node;x3dom.isa(c,x3dom.nodeTypes.MultiTextureCoordinate)&&c._cf.texCoord.nodes.length&&(c=c._cf.texCoord.nodes[0]),c?c._vf.point?(s=!0,A=c._vf.point,x3dom.isa(c,x3dom.nodeTypes.TextureCoordinate3D)&&(I=3)):c._vf.mode&&(l=c._vf.mode):s=!1,this._mesh._numTexComponents=I;var f=3,u=this._cf.color.node;u?(n=!0,i=u._vf.color,x3dom.isa(u,x3dom.nodeTypes.ColorRGBA)&&(f=4)):n=!1,this._mesh._numColComponents=f,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[],this.invalidateVolume(),this._mesh._numFaces=0,this._mesh._numCoords=0;var C=0,_=0;if(o&&e.length<=x3dom.Utils.maxIndexableCoords){this._hasIndexOffset=!0,this._indexOffset=[],this._mesh._primType="TRIANGLESTRIP";var m=[0];for(M=0;M<d.length;M++)-1==d[M]?(C++,m.push(this._mesh._indices[0].length)):(this._mesh._indices[0].push(+d[M]),a||(this._mesh._normals[0].push(t[C].x),this._mesh._normals[0].push(t[C].y),this._mesh._normals[0].push(t[C].z)),r||(this._mesh._colors[0].push(i[C].r),this._mesh._colors[0].push(i[C].g),this._mesh._colors[0].push(i[C].b),4===f&&this._mesh._colors[0].push(i[C].a)));for(this._mesh._positions[0]=e.toGL(),a&&(this._mesh._normals[0]=t.toGL()),s?(this._mesh._texCoords[0]=A.toGL(),this._mesh._numTexComponents=I):x3dom.debug.logWarning("IndexedTriangleStripSet: no texCoords given and won't calculate!"),n&&(r&&(this._mesh._colors[0]=i.toGL()),this._mesh._numColComponents=f),M=1;M<m.length;M++){var p=m[M]-m[M-1];this._indexOffset.push({count:p,offset:2*m[M-1]}),this._mesh._numFaces+=p-2}this._mesh._numCoords=this._mesh._positions[0].length/3}else{var E,B,Q,x,v,y,F,D,S,w,N,T;this._hasIndexOffset=!1;for(var b=!1,M=1;M<d.length-2;++M)-1!=d[M+1]?(b?(E=d[M],B=d[M-1],Q=d[M+1]):(E=d[M-1],B=d[M],Q=d[M+1]),b=!b,a?(x=E,v=B,y=Q):x=v=y=C,F=E,D=B,S=Q,r?(w=E,N=B,T=Q):w=N=T=C,this._mesh._indices[0].push(_++,_++,_++),this._mesh._positions[0].push(e[E].x),this._mesh._positions[0].push(e[E].y),this._mesh._positions[0].push(e[E].z),this._mesh._positions[0].push(e[B].x),this._mesh._positions[0].push(e[B].y),this._mesh._positions[0].push(e[B].z),this._mesh._positions[0].push(e[Q].x),this._mesh._positions[0].push(e[Q].y),this._mesh._positions[0].push(e[Q].z),o&&(this._mesh._normals[0].push(t[x].x),this._mesh._normals[0].push(t[x].y),this._mesh._normals[0].push(t[x].z),this._mesh._normals[0].push(t[v].x),this._mesh._normals[0].push(t[v].y),this._mesh._normals[0].push(t[v].z),this._mesh._normals[0].push(t[y].x),this._mesh._normals[0].push(t[y].y),this._mesh._normals[0].push(t[y].z)),n&&(this._mesh._colors[0].push(i[w].r),this._mesh._colors[0].push(i[w].g),this._mesh._colors[0].push(i[w].b),4===f&&this._mesh._colors[0].push(i[w].a),this._mesh._colors[0].push(i[N].r),this._mesh._colors[0].push(i[N].g),this._mesh._colors[0].push(i[N].b),4===f&&this._mesh._colors[0].push(i[N].a),this._mesh._colors[0].push(i[T].r),this._mesh._colors[0].push(i[T].g),this._mesh._colors[0].push(i[T].b),4===f&&this._mesh._colors[0].push(i[T].a)),s&&(this._mesh._texCoords[0].push(A[F].x),this._mesh._texCoords[0].push(A[F].y),3===I&&this._mesh._texCoords[0].push(A[F].z),this._mesh._texCoords[0].push(A[D].x),this._mesh._texCoords[0].push(A[D].y),3===I&&this._mesh._texCoords[0].push(A[D].z),this._mesh._texCoords[0].push(A[S].x),this._mesh._texCoords[0].push(A[S].y),3===I&&this._mesh._texCoords[0].push(A[S].z))):(M+=2,C++);for(o||this._mesh.calcNormals(Math.PI),s||this._mesh.calcTexCoords(l),this._mesh.splitMesh(),this.invalidateVolume(),M=0;M<this._mesh._indices.length;M++)this._mesh._numFaces+=this._mesh._indices[M].length/3,this._mesh._numCoords+=this._mesh._positions[M].length/3}},fieldChanged:function(e){if("coord"==e||"normal"==e||"texCoord"==e||"color"==e){var t=this._cf.coord.node._vf.point;if(null===this._cf.normal.node||t.length>x3dom.Utils.maxIndexableCoords){if("coord"==e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];var A,i,o,s,n=!1,r=!1,a=!1,d=this._vf.colorPerVertex,h=this._vf.normalPerVertex,g=this._vf.index,l=this._cf.coord.node;x3dom.debug.assert(l),A=l._vf.point;var I=this._cf.normal.node;I?(n=!0,i=I._vf.vector):n=!1;var c="",f=2,u=this._cf.texCoord.node;x3dom.isa(u,x3dom.nodeTypes.MultiTextureCoordinate)&&u._cf.texCoord.nodes.length&&(u=u._cf.texCoord.nodes[0]),u?u._vf.point?(r=!0,o=u._vf.point,x3dom.isa(u,x3dom.nodeTypes.TextureCoordinate3D)&&(f=3)):u._vf.mode&&(c=u._vf.mode):r=!1,this._mesh._numTexComponents=f;var C=3,_=this._cf.color.node;_?(a=!0,s=_._vf.color,x3dom.isa(_,x3dom.nodeTypes.ColorRGBA)&&(C=4)):a=!1,this._mesh._numColComponents=C,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];var m,p,E,B,Q,x,v,y,F,D=0,S=0,w=!1;if(n||r||a){for(var N=1;N<g.length-2;++N)-1!=g[N+1]?(w?(m=g[N],p=g[N-1],E=g[N+1]):(m=g[N-1],p=g[N],E=g[N+1]),w=!w,h?(R=m,B=p,Q=E):R=B=Q=D,U=m,x=p,v=E,d?(b=m,y=p,F=E):b=y=F=D,this._mesh._indices[0].push(S++,S++,S++),this._mesh._positions[0].push(A[m].x),this._mesh._positions[0].push(A[m].y),this._mesh._positions[0].push(A[m].z),this._mesh._positions[0].push(A[p].x),this._mesh._positions[0].push(A[p].y),this._mesh._positions[0].push(A[p].z),this._mesh._positions[0].push(A[E].x),this._mesh._positions[0].push(A[E].y),this._mesh._positions[0].push(A[E].z),n&&(this._mesh._normals[0].push(i[R].x),this._mesh._normals[0].push(i[R].y),this._mesh._normals[0].push(i[R].z),this._mesh._normals[0].push(i[B].x),this._mesh._normals[0].push(i[B].y),this._mesh._normals[0].push(i[B].z),this._mesh._normals[0].push(i[Q].x),this._mesh._normals[0].push(i[Q].y),this._mesh._normals[0].push(i[Q].z)),a&&(this._mesh._colors[0].push(s[b].r),this._mesh._colors[0].push(s[b].g),this._mesh._colors[0].push(s[b].b),4===C&&this._mesh._colors[0].push(s[b].a),this._mesh._colors[0].push(s[y].r),this._mesh._colors[0].push(s[y].g),this._mesh._colors[0].push(s[y].b),4===C&&this._mesh._colors[0].push(s[y].a),this._mesh._colors[0].push(s[F].r),this._mesh._colors[0].push(s[F].g),this._mesh._colors[0].push(s[F].b),4===C&&this._mesh._colors[0].push(s[F].a)),r&&(this._mesh._texCoords[0].push(o[U].x),this._mesh._texCoords[0].push(o[U].y),3===f&&this._mesh._texCoords[0].push(o[U].z),this._mesh._texCoords[0].push(o[x].x),this._mesh._texCoords[0].push(o[x].y),3===f&&this._mesh._texCoords[0].push(o[x].z),this._mesh._texCoords[0].push(o[v].x),this._mesh._texCoords[0].push(o[v].y),3===f&&this._mesh._texCoords[0].push(o[v].z))):(N+=2,D++);n||this._mesh.calcNormals(Math.PI),r||this._mesh.calcTexCoords(c),this._mesh.splitMesh()}else{for(w=!1,N=1;N<g.length;++N)-1!=g[N+1]?(w?(this._mesh._indices[0].push(g[N]),this._mesh._indices[0].push(g[N-1]),this._mesh._indices[0].push(g[N+1])):(this._mesh._indices[0].push(g[N-1]),this._mesh._indices[0].push(g[N]),this._mesh._indices[0].push(g[N+1])),w=!w):N+=2;this._mesh._positions[0]=A.toGL(),this._mesh.calcNormals(Math.PI),this._mesh.calcTexCoords(c)}for(this.invalidateVolume(),this._mesh._numFaces=0,this._mesh._numCoords=0,N=0;N<this._mesh._indices.length;N++)this._mesh._numFaces+=this._mesh._indices[N].length/3,this._mesh._numCoords+=this._mesh._positions[N].length/3;this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()}))}else if("color"==e){var T=this._cf.color.node._vf.color,b=(D=0,y=F=0);C=3;x3dom.isa(this._cf.color.node,x3dom.nodeTypes.ColorRGBA)&&(C=4),this._mesh._colors[0]=[];g=this._vf.index,w=!1;for(N=1;N<g.length-2;++N)-1!=g[N+1]?(this._vf.colorPerVertex?(w?(b=g[N],y=g[N-1],F=g[N+1]):(b=g[N-1],y=g[N],F=g[N+1]),w=!w):this._vf.colorPerVertex||(b=y=F=D),this._mesh._colors[0].push(T[b].r),this._mesh._colors[0].push(T[b].g),this._mesh._colors[0].push(T[b].b),4===C&&this._mesh._colors[0].push(T[b].a),this._mesh._colors[0].push(T[y].r),this._mesh._colors[0].push(T[y].g),this._mesh._colors[0].push(T[y].b),4===C&&this._mesh._colors[0].push(T[y].a),this._mesh._colors[0].push(T[F].r),this._mesh._colors[0].push(T[F].g),this._mesh._colors[0].push(T[F].b),4===C&&this._mesh._colors[0].push(T[F].a)):(N+=2,D++);this._parentNodes.forEach((function(e){e._dirty.colors=!0}))}else if("normal"==e){var M=this._cf.normal.node._vf.vector,R=(D=0,B=Q=0);this._mesh._normals[0]=[];g=this._vf.index,w=!1;for(N=1;N<g.length-2;++N)-1!=g[N+1]?(this._vf.normalPerVertex?(w?(R=g[N],B=g[N-1],Q=g[N+1]):(R=g[N-1],B=g[N],Q=g[N+1]),w=!w):this._vf.normalPerVertex||(R=B=Q=D),this._mesh._normals[0].push(M[R].x),this._mesh._normals[0].push(M[R].y),this._mesh._normals[0].push(M[R].z),this._mesh._normals[0].push(M[B].x),this._mesh._normals[0].push(M[B].y),this._mesh._normals[0].push(M[B].z),this._mesh._normals[0].push(M[Q].x),this._mesh._normals[0].push(M[Q].y),this._mesh._normals[0].push(M[Q].z)):(N+=2,D++);this._parentNodes.forEach((function(e){e._dirty.normals=!0}))}else if("texCoord"==e){u=this._cf.texCoord.node;x3dom.isa(u,x3dom.nodeTypes.MultiTextureCoordinate)&&u._cf.texCoord.nodes.length&&(u=u._cf.texCoord.nodes[0]);var G=u._vf.point,U=x=v=0;f=2;x3dom.isa(u,x3dom.nodeTypes.TextureCoordinate3D)&&(f=3),this._mesh._texCoords[0]=[];g=this._vf.index,w=!1;for(N=1;N<g.length-2;++N)-1!=g[N+1]?(w?(U=g[N],x=g[N-1],v=g[N+1]):(U=g[N-1],x=g[N],v=g[N+1]),w=!w,this._mesh._texCoords[0].push(G[U].x),this._mesh._texCoords[0].push(G[U].y),3===f&&this._mesh._texCoords[0].push(G[U].z),this._mesh._texCoords[0].push(G[x].x),this._mesh._texCoords[0].push(G[x].y),3===f&&this._mesh._texCoords[0].push(G[x].z),this._mesh._texCoords[0].push(G[v].x),this._mesh._texCoords[0].push(G[v].y),3===f&&this._mesh._texCoords[0].push(G[v].z)):N+=2;this._parentNodes.forEach((function(e){e._dirty.texcoords=!0}))}}else if("coord"==e)this._mesh._positions[0]=t.toGL(),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}));else if("color"==e){if(t=this._cf.color.node._vf.color,this._vf.colorPerVertex)this._mesh._colors[0]=t.toGL();else if(!this._vf.colorPerVertex){D=0,C=3;x3dom.isa(this._cf.color.node,x3dom.nodeTypes.ColorRGBA)&&(C=4),this._mesh._colors[0]=[];g=this._vf.index;for(N=0;N<g.length;++N)-1!=g[N]?(this._mesh._colors[0].push(t[D].r),this._mesh._colors[0].push(t[D].g),this._mesh._colors[0].push(t[D].b),4===C&&this._mesh._colors[0].push(t[D].a)):D++}this._parentNodes.forEach((function(e){e._dirty.colors=!0}))}else if("normal"==e){if(t=this._cf.normal.node._vf.vector,this._vf.normalPerVertex)this._mesh._normals[0]=t.toGL();else if(!this._vf.normalPerVertex){g=this._vf.index;this._mesh._normals[0]=[];D=0;for(N=0;N<g.length;++N)-1!=g[N]?(this._mesh._normals[0].push(t[D].x),this._mesh._normals[0].push(t[D].y),this._mesh._normals[0].push(t[D].z)):D++}this._parentNodes.forEach((function(e){e._dirty.normals=!0}))}else if("texCoord"==e){u=this._cf.texCoord.node;x3dom.isa(u,x3dom.nodeTypes.MultiTextureCoordinate)&&u._cf.texCoord.nodes.length&&(u=u._cf.texCoord.nodes[0]),t=u._vf.point,this._mesh._texCoords[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.texcoords=!0}))}}else x3dom.debug.logWarning("IndexedTriangleStripSet: fieldChanged for "+e+" not yet implemented!")}})),x3dom.registerNodeType("TriangleSet","Rendering",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,(function(e){x3dom.nodeTypes.TriangleSet.superClass.call(this,e)}),{_buildGeometry:function(){var e,t,A,i,o=this._vf.colorPerVertex,s=this._vf.normalPerVertex,n=this._vf.ccw,r=!1,a=!1,d=!1,h=this._cf.coord.node;if(x3dom.debug.assert(h),!h||h._vf.point.length<3)this._vf.visible=!1;else{e=h._vf.point;var g=this._cf.normal.node;g?(r=!0,t=g._vf.vector):r=!1;var l="",I=2,c=this._cf.texCoord.node;x3dom.isa(c,x3dom.nodeTypes.MultiTextureCoordinate)&&c._cf.texCoord.nodes.length&&(c=c._cf.texCoord.nodes[0]),c?c._vf.point?(a=!0,A=c._vf.point,x3dom.isa(c,x3dom.nodeTypes.TextureCoordinate3D)&&(I=3)):c._vf.mode&&(l=c._vf.mode):a=!1;var f=3,u=this._cf.color.node;for(u?(d=!0,i=u._vf.color,x3dom.isa(u,x3dom.nodeTypes.ColorRGBA)&&(f=4)):d=!1;e.length%3>0;)e.pop();this._mesh._indices[0]=new Array(e.length),this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];var C,_=e.length/3,m=0;for(C=0;C<_;C++)this._mesh._indices[0][m]=m++,this._mesh._indices[0][m]=m++,this._mesh._indices[0][m]=m++,!s&&r&&(this._mesh._normals[0].push(t[C].x),this._mesh._normals[0].push(t[C].y),this._mesh._normals[0].push(t[C].z)),!o&&d&&(this._mesh._colors[0].push(i[C].r),this._mesh._colors[0].push(i[C].g),this._mesh._colors[0].push(i[C].b),4===f&&this._mesh._colors[0].push(i[C].a));this._mesh._positions[0]=e.toGL(),r?this._mesh._normals[0]=t.toGL():this._mesh.calcNormals(s?Math.PI:0,n),a?(this._mesh._texCoords[0]=A.toGL(),this._mesh._numTexComponents=I):this._mesh.calcTexCoords(l),d&&o&&(this._mesh._colors[0]=i.toGL(),this._mesh._numColComponents=f),this._mesh._numFaces=_,this._mesh._numCoords=e.length,this.invalidateVolume()}},nodeChanged:function(){this._buildGeometry()},fieldChanged:function(e){"coord"==e?(this._buildGeometry(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))):"color"==e?(this._buildGeometry(),this._parentNodes.forEach((function(e){e._dirty.colors=!0}))):"normal"==e?(this._buildGeometry(),this._parentNodes.forEach((function(e){e._dirty.normals=!0}))):"texCoord"==e&&(this._buildGeometry(),this._parentNodes.forEach((function(e){e._dirty.texcoords=!0})))}})),x3dom.registerNodeType("X3DGeometricPropertyNode","Rendering",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.X3DGeometricPropertyNode.superClass.call(this,e)}))),x3dom.registerNodeType("X3DCoordinateNode","Rendering",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,(function(e){x3dom.nodeTypes.X3DCoordinateNode.superClass.call(this,e)}),{fieldChanged:function(e){"coord"!==e&&"point"!==e||this._parentNodes.forEach((function(e){e.fieldChanged("coord")}))},parentAdded:function(e){e._mesh&&e._cf.coord&&e._cf.coord.node!==this&&e.fieldChanged("coord")}})),x3dom.registerNodeType("Coordinate","Rendering",defineClass(x3dom.nodeTypes.X3DCoordinateNode,(function(e){x3dom.nodeTypes.Coordinate.superClass.call(this,e),this.addField_MFVec3f(e,"point",[])}),{getPoints:function(){return this._vf.point}})),x3dom.registerNodeType("CoordinateDouble","Nurbs",defineClass(x3dom.nodeTypes.X3DCoordinateNode,(function(e){x3dom.nodeTypes.CoordinateDouble.superClass.call(this,e),this.addField_MFVec3d(e,"point",[])}),{getPoints:function(){return this._vf.point}})),x3dom.registerNodeType("Normal","Rendering",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,(function(e){x3dom.nodeTypes.Normal.superClass.call(this,e),this.addField_MFVec3f(e,"vector",[])}),{fieldChanged:function(e){"normal"!==e&&"vector"!==e||this._parentNodes.forEach((function(e){e.fieldChanged("normal")}))},parentAdded:function(e){e._mesh&&e._cf.normal.node!==this&&e.fieldChanged("normal")}})),x3dom.registerNodeType("X3DColorNode","Rendering",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,(function(e){x3dom.nodeTypes.X3DColorNode.superClass.call(this,e)}),{fieldChanged:function(e){"color"===e&&this._parentNodes.forEach((function(e){e.fieldChanged("color")}))},parentAdded:function(e){e._mesh&&e._cf.color.node!==this&&e.fieldChanged("color")}})),x3dom.registerNodeType("Color","Rendering",defineClass(x3dom.nodeTypes.X3DColorNode,(function(e){x3dom.nodeTypes.Color.superClass.call(this,e),this.addField_MFColor(e,"color",[])}))),x3dom.registerNodeType("ColorRGBA","Rendering",defineClass(x3dom.nodeTypes.X3DColorNode,(function(e){x3dom.nodeTypes.ColorRGBA.superClass.call(this,e),this.addField_MFColorRGBA(e,"color",[])}))),x3dom.registerNodeType("ParticleSet","Rendering",defineClass(x3dom.nodeTypes.PointSet,(function(e){x3dom.nodeTypes.ParticleSet.superClass.call(this,e),this.addField_SFString(e,"mode","ViewDirQuads"),this.addField_SFString(e,"drawOrder","Any"),this.addField_SFNode("normal",x3dom.nodeTypes.Normal),this.addField_MFVec3f(e,"size",[]),this.addField_MFInt32(e,"index",[]),this.addField_MFFloat(e,"textureZ",[]),this._mesh._primType="POINTS"}),{drawOrder:function(){return this._vf.drawOrder.toLowerCase()},nodeChanged:function(){var e=this._cf.coord.node;x3dom.debug.assert(e,"ParticleSet without coord node!");var t=e.getPoints(),A=3,i=this._cf.color.node,o=new x3dom.fields.MFColor;i&&(o=i._vf.color,x3dom.debug.assert(t.length==o.length,"Size of color and coord array differs!"),x3dom.isa(i,x3dom.nodeTypes.ColorRGBA)&&(A=4));var s=this._cf.normal.node,n=new x3dom.fields.MFVec3f;s&&(n=s._vf.vector);var r=[];if("any"!=this.drawOrder()&&0==(r=this._vf.index.toGL()).length){var a,d=t.length;for(r=new Array(d),a=0;a<d;a++)r[a]=a}this._mesh._numColComponents=A,this._mesh._lit=!1,this._mesh._indices[0]=r,this._mesh._positions[0]=t.toGL(),this._mesh._colors[0]=o.toGL(),this._mesh._normals[0]=n.toGL(),this._mesh._texCoords[0]=[],this.invalidateVolume(),this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){var t=null;if("index"==e)this._mesh._indices[0]=this._vf.index.toGL(),this._parentNodes.forEach((function(e){e._dirty.indexes=!0}));else if("size"==e)this._parentNodes.forEach((function(e){e._dirty.specialAttribs=!0}));else if("coord"==e){t=this._cf.coord.node.getPoints(),this._mesh._positions[0]=t.toGL();var A=[];if("any"!=this.drawOrder()&&0==(A=this._vf.index.toGL()).length){var i,o=t.length;for(A=new Array(o),i=0;i<o;i++)A[i]=i}this._mesh._indices[0]=A,this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e._dirty.indexes=!0,e.invalidateVolume()}))}else"color"==e&&(t=this._cf.color.node._vf.color,this._mesh._colors[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.colors=!0})))}})),x3dom.registerNodeType("ClipPlane","Rendering",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.ClipPlane.superClass.call(this,e),this.addField_SFBool(e,"enabled",!0),this.addField_SFVec4f(e,"plane",0,1,0,0),this.addField_SFFloat(e,"cappingStrength",0),this.addField_SFColor(e,"cappingColor",1,1,1),this.addField_SFBool(e,"on",!0)}),{fieldChanged:function(e){},nodeChanged:function(){x3dom.nodeTypes.ClipPlane.count++},onRemove:function(){x3dom.nodeTypes.ClipPlane.count--},parentAdded:function(e){},parentRemoved:function(e){}})),x3dom.nodeTypes.ClipPlane.count=0,x3dom.registerNodeType("X3DAppearanceNode","Shape",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.X3DAppearanceNode.superClass.call(this,e)}))),x3dom.registerNodeType("Appearance","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceNode,(function(e){x3dom.nodeTypes.Appearance.superClass.call(this,e),this.addField_SFNode("material",x3dom.nodeTypes.X3DMaterialNode),this.addField_SFNode("texture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("textureTransform",x3dom.nodeTypes.X3DTextureTransformNode),this.addField_SFNode("lineProperties",x3dom.nodeTypes.LineProperties),this.addField_SFNode("pointProperties",x3dom.nodeTypes.PointProperties),this.addField_SFNode("colorMaskMode",x3dom.nodeTypes.ColorMaskMode),this.addField_SFNode("blendMode",x3dom.nodeTypes.BlendMode),this.addField_SFNode("depthMode",x3dom.nodeTypes.DepthMode),this.addField_MFNode("shaders",x3dom.nodeTypes.X3DShaderNode),this.addField_SFString(e,"sortType","auto"),this.addField_SFInt32(e,"sortKey",0),this.addField_SFFloat(e,"alphaClipThreshold",.1),this._shader=null,this._origSortType=this._vf.sortType}),{fieldChanged:function(e){"alphaClipThreshold"==e&&this._parentNodes.forEach((function(e){e.setAppDirty()})),"sortType"==e&&(this._origSortType=this._vf.sortType,this.checkSortType())},nodeChanged:function(){this._cf.material.node,this._cf.shaders.nodes.length?this._shader=this._cf.shaders.nodes[0]:this._shader&&(this._shader=null),this._parentNodes.forEach((function(e){e.setAppDirty()})),this.checkSortType()},checkSortType:function(){if("auto"==this._origSortType)if(this._cf.material.node&&(this._cf.material.node._vf.transparency>0||this._cf.material.node._vf.backTransparency&&this._cf.material.node._vf.backTransparency>0))this._vf.sortType="transparent";else if(this._cf.texture.node&&this._cf.texture.node._vf.url.length)4==this._cf.texture.node._vf.origChannelCount||2==this._cf.texture.node._vf.origChannelCount?this._vf.sortType="transparent":this._vf.sortType="opaque";else if(x3dom.isa(this._cf.material.node,x3dom.nodeTypes.PhysicalMaterial)){var e=this._cf.material.node;"OPAQUE"==e._vf.alphaMode?this._vf.sortType="opaque":"BLEND"!=e._vf.alphaMode&&"MASK"!=e._vf.alphaMode||(this._vf.sortType="transparent");var t=e._cf.baseColorTexture.node;"opaque"==this._vf.sortType&&t&&t._vf.url.length&&t._vf.url[0].toLowerCase().indexOf(".png")>=0&&(this._vf.sortType="transparent")}else this._vf.sortType="opaque"},texTransformMatrix:function(){return null===this._cf.textureTransform.node?x3dom.fields.SFMatrix4f.identity():this._cf.textureTransform.node.texTransformMatrix()},parentAdded:function(e){this!=x3dom.nodeTypes.Appearance._defaultNode&&e.setAppDirty()}})),x3dom.nodeTypes.Appearance.defaultNode=function(){return x3dom.nodeTypes.Appearance._defaultNode||(x3dom.nodeTypes.Appearance._defaultNode=new x3dom.nodeTypes.Appearance,x3dom.nodeTypes.Appearance._defaultNode.nodeChanged()),x3dom.nodeTypes.Appearance._defaultNode},x3dom.registerNodeType("X3DAppearanceChildNode","Shape",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.X3DAppearanceChildNode.superClass.call(this,e)}))),x3dom.registerNodeType("BlendMode","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.BlendMode.superClass.call(this,e),this.addField_SFString(e,"srcFactor","src_alpha"),this.addField_SFString(e,"destFactor","one_minus_src_alpha"),this.addField_SFColor(e,"color",1,1,1),this.addField_SFFloat(e,"colorTransparency",0),this.addField_SFString(e,"alphaFunc","none"),this.addField_SFFloat(e,"alphaFuncValue",0),this.addField_SFString(e,"equation","none")}))),x3dom.registerNodeType("DepthMode","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.DepthMode.superClass.call(this,e),this.addField_SFBool(e,"enableDepthTest",!0),this.addField_SFString(e,"depthFunc","none"),this.addField_SFBool(e,"readOnly",!1),this.addField_SFFloat(e,"zNearRange",-1),this.addField_SFFloat(e,"zFarRange",-1)}))),x3dom.registerNodeType("ColorMaskMode","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.ColorMaskMode.superClass.call(this,e),this.addField_SFBool(e,"maskR",!0),this.addField_SFBool(e,"maskG",!0),this.addField_SFBool(e,"maskB",!0),this.addField_SFBool(e,"maskA",!0)}))),x3dom.registerNodeType("LineProperties","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.LineProperties.superClass.call(this,e),this.addField_SFBool(e,"applied",!0),this.addField_SFInt32(e,"linetype",1),this.addField_SFFloat(e,"linewidthScaleFactor",0)}))),x3dom.registerNodeType("PointProperties","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.PointProperties.superClass.call(this,e),this.addField_SFFloat(e,"pointSizeScaleFactor",1),this.addField_SFFloat(e,"pointSizeMinValue",1),this.addField_SFFloat(e,"pointSizeMaxValue",1),this.addField_SFVec3f(e,"attenuation",1,0,0)}),{nodeChanged:function(){this._vf.pointSizeMinValue>this._vf.pointSizeMaxValue&&(x3dom.debug.logWarning("pointSizeMinValue is larger than pointSizeMaxValue, will set to MaxValue"),this._vf.pointSizeMinValue=this._vf.pointSizeMaxValue)},fieldChanged:function(e){this._nodeChanged()}})),x3dom.registerNodeType("X3DMaterialNode","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.X3DMaterialNode.superClass.call(this,e)}),{_fieldChanged:function(e,t){t.indexOf(e)>-1&&this._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)&&(e._dirty.material=!0)})),x3dom.isa(e,x3dom.nodeTypes.X3DAppearanceNode)&&e.checkSortType()}))}})),x3dom.registerNodeType("Material","Shape",defineClass(x3dom.nodeTypes.X3DMaterialNode,(function(e){x3dom.nodeTypes.Material.superClass.call(this,e),this.addField_SFFloat(e,"ambientIntensity",.2),this.addField_SFColor(e,"diffuseColor",.8,.8,.8),this.addField_SFColor(e,"emissiveColor",0,0,0),this.addField_SFFloat(e,"shininess",.2),this.addField_SFColor(e,"specularColor",0,0,0),this.addField_SFFloat(e,"transparency",0)}),{fieldChanged:function(e){this._fieldChanged(e,["ambientIntensity","diffuseColor","emissiveColor","shininess","specularColor","transparency"])}})),x3dom.nodeTypes.Material.defaultNode=function(){return x3dom.nodeTypes.Material._defaultNode||(x3dom.nodeTypes.Material._defaultNode=new x3dom.nodeTypes.Material,x3dom.nodeTypes.Material._defaultNode.nodeChanged()),x3dom.nodeTypes.Material._defaultNode},x3dom.registerNodeType("TwoSidedMaterial","Shape",defineClass(x3dom.nodeTypes.Material,(function(e){x3dom.nodeTypes.TwoSidedMaterial.superClass.call(this,e),this.addField_SFFloat(e,"backAmbientIntensity",.2),this.addField_SFColor(e,"backDiffuseColor",.8,.8,.8),this.addField_SFColor(e,"backEmissiveColor",0,0,0),this.addField_SFFloat(e,"backShininess",.2),this.addField_SFColor(e,"backSpecularColor",0,0,0),this.addField_SFFloat(e,"backTransparency",0),this.addField_SFBool(e,"separateBackColor",!1)}),{fieldChanged:function(e){this._fieldChanged(e,["ambientIntensity","diffuseColor","emissiveColor","shininess","specularColor","transparency","backAmbientIntensity","backDiffuseColor","backEmissiveColor","backShininess","backSpecularColor","backTransparency","separateBackColor"])}})),x3dom.registerNodeType("PhysicalMaterial","Shape",defineClass(x3dom.nodeTypes.X3DMaterialNode,(function(e){x3dom.nodeTypes.X3DMaterialNode.superClass.call(this,e),this.addField_SFString(e,"model","roughnessMetallic"),this.addField_SFColorRGBA(e,"baseColorFactor",1,1,1,1),this.addField_SFFloat(e,"metallicFactor",0),this.addField_SFFloat(e,"roughnessFactor",.2),this.addField_SFColorRGBA(e,"diffuseFactor",1,1,1,1),this.addField_SFColor(e,"specularFactor",1,1,1),this.addField_SFFloat(e,"glossinessFactor",1),this.addField_SFColor(e,"emissiveFactor",0,0,0),this.addField_SFString(e,"normalSpace","TANGENT"),this.addField_SFString(e,"alphaMode","OPAQUE"),this.addField_SFFloat(e,"alphaCutoff",.5),this.addField_SFVec3f(e,"normalBias",-1,-1,1),this.addField_SFFloat(e,"normalScale",1),this.addField_SFBool(e,"unlit",!1),this.addField_SFNode("baseColorTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("emissiveTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("roughnessMetallicTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("specularGlossinessTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("occlusionRoughnessMetallicTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("normalTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("occlusionTexture",x3dom.nodeTypes.X3DTextureNode)}),{fieldChanged:function(e){this._fieldChanged(e,["baseColorFactor","metallicFactor","roughnessFactor","emissiveFactor"]),"alphaMode"==e&&this._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)&&(e._dirty.shader=!0)})),x3dom.isa(e,x3dom.nodeTypes.X3DAppearanceNode)&&e.checkSortType()}))},hasTextures:function(){return this._cf.baseColorTexture.node||this._cf.normalTexture.node||this._cf.occlusionTexture.node||this._cf.emissiveTexture.node||this._cf.roughnessMetallicTexture.node},getTextures:function(){var e=[];return this._cf.baseColorTexture.node&&(this._cf.baseColorTexture.node._type="diffuseMap",e.push(this._cf.baseColorTexture.node)),this._cf.normalTexture.node&&(this._cf.normalTexture.node._type="normalMap",e.push(this._cf.normalTexture.node)),this._cf.occlusionTexture.node&&(this._cf.occlusionTexture.node._type="occlusionMap",e.push(this._cf.occlusionTexture.node)),this._cf.emissiveTexture.node&&(this._cf.emissiveTexture.node._type="emissiveMap",e.push(this._cf.emissiveTexture.node)),this._cf.roughnessMetallicTexture.node&&(this._cf.roughnessMetallicTexture.node._type="roughnessMetallicMap",e.push(this._cf.roughnessMetallicTexture.node)),this._cf.specularGlossinessTexture.node&&(this._cf.specularGlossinessTexture.node._type="specularGlossinessMap",e.push(this._cf.specularGlossinessTexture.node)),this._cf.occlusionRoughnessMetallicTexture.node&&(this._cf.occlusionRoughnessMetallicTexture.node._type="occlusionRoughnessMetallicMap",e.push(this._cf.occlusionRoughnessMetallicTexture.node)),e}})),x3dom.registerNodeType("X3DShapeNode","Shape",defineClass(x3dom.nodeTypes.X3DBoundedObject,(function(e){x3dom.nodeTypes.X3DShapeNode.superClass.call(this,e),this.addField_SFBool(e,"isPickable",!0),this.addField_SFInt32(e,"idOffset",0),this.addField_SFNode("appearance",x3dom.nodeTypes.X3DAppearanceNode),this.addField_SFNode("geometry",x3dom.nodeTypes.X3DGeometryNode),this._objectID=0,this._shaderProperties=null,this._clipPlanes=[],this._cleanupGLObjects=null,this._dirty={positions:!0,normals:!0,texcoords:!0,colors:!0,tangents:!0,binormals:!0,specialAttribs:!0,indexes:!0,texture:!0,material:!0,text:!0,shader:!0,ids:!0},this._indexOffset=0,this._coordStrideOffset=[0,0],this._normalStrideOffset=[0,0],this._texCoordStrideOffset=[0,0],this._texCoord2StrideOffset=[0,0],this._colorStrideOffset=[0,0],this._idStrideOffset=[0,0],this._tangentStrideOffset=[0,0],this._binormalStrideOffset=[0,0],this._tessellationProperties=[]}),{collectDrawableObjects:function(e,t,A,i,o,s){var n=this.graphState();return A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),A&&!this._graph.globalMatrix&&(this._graph.globalMatrix=e),this._clipPlanes.length!=s.length&&(this._dirty.shader=!0),this._clipPlanes=s,this.collectBbox(e,t,A,i,o,s),!(!this._cf.geometry.node||t.cull(e,n,A,o)<=0)&&(t.addShape(this,e,n),!0)},getVolume:function(){var e=this._graph.volume;if(!this.volumeValid()&&(this._vf.bboxDisplay||this.renderFlag&&this.renderFlag())){var t=this._cf.geometry.node,A=t?t.getVolume():null;A&&A.isValid()&&e.extendBounds(A.min,A.max)}return e},getCenter:function(){var e=this._cf.geometry.node;return e?e.getCenter():new x3dom.fields.SFVec3f(0,0,0)},getDiameter:function(){var e=this._cf.geometry.node;return e?e.getDiameter():0},doIntersect:function(e){return this._cf.geometry.node.doIntersect(e)},forceUpdateCoverage:function(){var e=this._cf.geometry.node;return!!e&&e.forceUpdateCoverage()},tessellationProperties:function(){var e=this._cf.geometry.node;return e&&e._indexOffset?e._indexOffset:this._tessellationProperties},isLit:function(){return this._cf.geometry.node._vf.lit},isSolid:function(){var e=this._cf.appearance.node&&this._cf.appearance.node._cf.material.node&&x3dom.isa(this._cf.appearance.node._cf.material.node,x3dom.nodeTypes.TwoSidedMaterial);return this._cf.geometry.node._vf.solid&&!e},isCCW:function(){return this._cf.geometry.node._vf.ccw},parentRemoved:function(e){for(var t=0,A=this._childNodes.length;t<A;t++){var i=this._childNodes[t];i&&i.parentRemoved(this)}e&&e.invalidateVolume(),this._parentNodes.length>0&&this.invalidateVolume(),this._cleanupGLObjects&&this._cleanupGLObjects()},unsetDirty:function(){this._dirty.positions=!1,this._dirty.normals=!1,this._dirty.texcoords=!1,this._dirty.colors=!1,this._dirty.tangents=!1,this._dirty.binormals=!1,this._dirty.specialAttribs=!1,this._dirty.indexes=!1,this._dirty.texture=!1,this._dirty.material=!1,this._dirty.text=!1,this._dirty.shader=!1},unsetGeoDirty:function(){this._dirty.positions=!1,this._dirty.normals=!1,this._dirty.texcoords=!1,this._dirty.colors=!1,this._dirty.tangents=!1,this._dirty.binormals=!1,this._dirty.specialAttribs=!1,this._dirty.indexes=!1},setAllDirty:function(){this._dirty.positions=!0,this._dirty.normals=!0,this._dirty.texcoords=!0,this._dirty.colors=!0,this._dirty.tangents=!0,this._dirty.binormals=!0,this._dirty.specialAttribs=!0,this._dirty.indexes=!0,this._dirty.texture=!0,this._dirty.material=!0,this._dirty.text=!0,this._dirty.shader=!0,this.invalidateVolume()},setAppDirty:function(){this._dirty.texture=!0,this._dirty.material=!0,this._dirty.shader=!0},setGeoDirty:function(){this._dirty.positions=!0,this._dirty.normals=!0,this._dirty.texcoords=!0,this._dirty.colors=!0,this._dirty.tangents=!0,this._dirty.binormals=!0,this._dirty.specialAttribs=!0,this._dirty.indexes=!0,this.invalidateVolume()},getShaderProperties:function(e){return(null==this._shaderProperties||1==this._dirty.shader||x3dom.Utils.checkDirtyEnvironment(e,this._shaderProperties)||x3dom.Utils.checkDirtyPhysicalEnvironmentLight(e,this._shaderProperties)||void 0!==this._webgl&&this._webgl.dirtyLighting!=x3dom.Utils.checkDirtyLighting(e))&&(this._shaderProperties=x3dom.Utils.generateProperties(e,this),this._dirty.shader=!1,void 0!==this._webgl&&(this._webgl.dirtyLighting=x3dom.Utils.checkDirtyLighting(e))),this._shaderProperties},getTextures:function(){var e=[],t=this._cf.appearance.node;if(t){var A=t._cf.texture.node;A&&(x3dom.isa(A,x3dom.nodeTypes.MultiTexture)?e=e.concat(A.getTextures()):e.push(A));var i=t._cf.shaders.nodes[0];i&&x3dom.isa(i,x3dom.nodeTypes.CommonSurfaceShader)&&(e=e.concat(i.getTextures()));var o=t._cf.material.node;o&&x3dom.isa(o,x3dom.nodeTypes.PhysicalMaterial)&&(e=e.concat(o.getTextures()))}var s=this._cf.geometry.node;return s&&x3dom.isa(s,x3dom.nodeTypes.Text)&&(e=e.concat(s)),e}})),x3dom.registerNodeType("Shape","Shape",defineClass(x3dom.nodeTypes.X3DShapeNode,(function(e){x3dom.nodeTypes.Shape.superClass.call(this,e)}),{nodeChanged:function(){this._cf.appearance.node,this._cf.geometry.node?this._objectID||(this._objectID=++x3dom.nodeTypes.Shape.objectID,x3dom.nodeTypes.Shape.idMap.nodeID[this._objectID]=this):this._DEF&&x3dom.debug.logError("No geometry given in Shape/"+this._DEF),this.setAllDirty()}})),x3dom.nodeTypes.Shape.shaderPartID=0,x3dom.nodeTypes.Shape.objectID=0,x3dom.nodeTypes.Shape.idMap={nodeID:{},remove:function(e){for(var t in this.nodeID)if(this.nodeID.hasOwnProperty(t)){var A=this.nodeID[t];A._objectID&&e._objectID&&A._objectID===e._objectID&&(delete this.nodeID[t],x3dom.debug.logInfo("Unreg "+A._objectID))}}},x3dom.registerNodeType("X3DLightNode","Lighting",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DLightNode.superClass.call(this,e),e?e.doc._nodeBag.lights.push(this):x3dom.debug.logWarning("X3DLightNode: No runtime context found!"),this._lightID=0,this._dirty=!0,this.addField_SFFloat(e,"ambientIntensity",0),this.addField_SFColor(e,"color",1,1,1),this.addField_SFFloat(e,"intensity",1),this.addField_SFBool(e,"global",!1),this.addField_SFBool(e,"on",!0),this.addField_SFFloat(e,"shadowIntensity",0),this.addField_SFInt32(e,"shadowMapSize",1024),this.addField_SFInt32(e,"shadowFilterSize",0),this.addField_SFFloat(e,"shadowOffset",0),this.addField_SFFloat(e,"zNear",-1),this.addField_SFFloat(e,"zFar",-1)}),{getViewMatrix:function(e){return x3dom.fields.SFMatrix4f.identity},nodeChanged:function(){this._lightID||(this._lightID=++x3dom.nodeTypes.X3DLightNode.lightID)},fieldChanged:function(e){this._vf.hasOwnProperty(e)&&(this._dirty=!0,this.postMessage(e+"_changed",this._vf[e]))},parentRemoved:function(e){if(1===this._parentNodes.length&&this._parentNodes[0]==e){var t=this.findX3DDoc();if(t)for(var A=0,i=t._nodeBag.lights.length;A<i;A++)t._nodeBag.lights[A]===this&&t._nodeBag.lights.splice(A,1)}},onRemove:function(){}})),x3dom.nodeTypes.X3DLightNode.lightID=0,x3dom.registerNodeType("DirectionalLight","Lighting",defineClass(x3dom.nodeTypes.X3DLightNode,(function(e){x3dom.nodeTypes.DirectionalLight.superClass.call(this,e),this.addField_SFVec3f(e,"direction",0,0,-1),this.addField_SFInt32(e,"shadowCascades",1),this.addField_SFFloat(e,"shadowSplitFactor",1),this.addField_SFFloat(e,"shadowSplitOffset",.1)}),{getViewMatrix:function(e){var t=this.getCurrentTransform().multMatrixVec(this._vf.direction).normalize();return x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0,0,-1),t).toMatrix().transpose().mult(x3dom.fields.SFMatrix4f.translation(e.negate()))}})),x3dom.registerNodeType("PointLight","Lighting",defineClass(x3dom.nodeTypes.X3DLightNode,(function(e){x3dom.nodeTypes.PointLight.superClass.call(this,e),this.addField_SFVec3f(e,"attenuation",1,0,0),this.addField_SFVec3f(e,"location",0,0,0),this.addField_SFFloat(e,"radius",100),this._vf.global=!0}),{getViewMatrix:function(e){var t=this.getCurrentTransform().multMatrixPnt(this._vf.location);return x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0,0,-1),e).toMatrix().transpose().mult(x3dom.fields.SFMatrix4f.translation(t.negate()))}})),x3dom.registerNodeType("SpotLight","Lighting",defineClass(x3dom.nodeTypes.X3DLightNode,(function(e){x3dom.nodeTypes.SpotLight.superClass.call(this,e),this.addField_SFVec3f(e,"direction",0,0,-1),this.addField_SFVec3f(e,"attenuation",1,0,0),this.addField_SFVec3f(e,"location",0,0,0),this.addField_SFFloat(e,"radius",100),this.addField_SFFloat(e,"beamWidth",3*Math.PI/16),this.addField_SFFloat(e,"cutOffAngle",Math.PI/2),this.addField_SFInt32(e,"shadowCascades",1),this.addField_SFFloat(e,"shadowSplitFactor",1),this.addField_SFFloat(e,"shadowSplitOffset",.1),this._vf.global=!0}),{getViewMatrix:function(e){var t=this.getCurrentTransform().multMatrixPnt(this._vf.location),A=this.getCurrentTransform().multMatrixVec(this._vf.direction).normalize();return x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0,0,-1),A).toMatrix().transpose().mult(x3dom.fields.SFMatrix4f.translation(t.negate()))}})),x3dom.registerNodeType("PhysicalEnvironmentLight","Lighting",defineClass(x3dom.nodeTypes.X3DLightNode,(function(e){x3dom.nodeTypes.PhysicalEnvironmentLight.superClass.call(this,e),this.addField_SFVec3f(e,"direction",0,0,-1),this.addField_SFString(e,"diffuse","https://x3dom.org/download/assets/pbr/papermillDiffuse.dds"),this.addField_SFString(e,"specular","https://x3dom.org/download/assets/pbr/papermillSpecular.dds"),this.addField_SFInt32(e,"shadowCascades",1),this.addField_SFFloat(e,"shadowSplitFactor",1),this.addField_SFFloat(e,"shadowSplitOffset",.1)}),{fieldChanged:function(e){},getViewMatrix:function(e){var t=this.getCurrentTransform().multMatrixVec(this._vf.direction).normalize();return x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0,0,-1),t).toMatrix().transpose().mult(x3dom.fields.SFMatrix4f.translation(e.negate()))}})),x3dom.registerNodeType("X3DFollowerNode","Followers",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DFollowerNode.superClass.call(this,e),e?e.doc._nodeBag.followers.push(this):x3dom.debug.logWarning("X3DFollowerNode: No runtime context found!"),this.addField_SFBool(e,"isActive",!1),this._eps=x3dom.fields.Eps}),{parentRemoved:function(e){if(0===this._parentNodes.length){var t=this.findX3DDoc();if(t)for(var A=0,i=t._nodeBag.followers.length;A<i;A++)t._nodeBag.followers[A]===this&&t._nodeBag.followers.splice(A,1)}},tick:function(e){return!1},stepResponse:function(e){return e<=0?0:e>=this._vf.duration?1:this.stepResponseCore(e/this._vf.duration)},stepResponseCore:function(e){return.5-.5*Math.cos(e*Math.PI)}})),x3dom.registerNodeType("X3DChaserNode","Followers",defineClass(x3dom.nodeTypes.X3DFollowerNode,(function(e){x3dom.nodeTypes.X3DChaserNode.superClass.call(this,e),this.addField_SFTime(e,"duration",1),this._initDone=!1,this._stepTime=0,this._currTime=0,this._bufferEndTime=0,this._numSupports=60}))),x3dom.registerNodeType("X3DDamperNode","Followers",defineClass(x3dom.nodeTypes.X3DFollowerNode,(function(e){x3dom.nodeTypes.X3DDamperNode.superClass.call(this,e),this.addField_SFTime(e,"tau",.3),this.addField_SFFloat(e,"tolerance",-1),this.addField_SFInt32(e,"order",3),this._eps=this._vf.tolerance<0?this._eps:this._vf.tolerance,this._lastTick=0}))),x3dom.registerNodeType("ColorChaser","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,(function(e){x3dom.nodeTypes.ColorChaser.superClass.call(this,e),this.addField_SFColor(e,"initialDestination",.8,.8,.8),this.addField_SFColor(e,"initialValue",.8,.8,.8),this.addField_SFColor(e,"value",0,0,0),this.addField_SFColor(e,"destination",0,0,0),this._buffer=new x3dom.fields.MFColor,this._previousValue=new x3dom.fields.SFColor(0,0,0),this._value=new x3dom.fields.SFColor(0,0,0),this.initialize()}),{fieldChanged:function(e){if(e.indexOf("destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("value")>=0){this.initialize(),this._previousValue.setValues(this._vf.value);for(var t=1;t<this._buffer.length;t++)this._buffer[t].setValues(this._vf.value);this.postMessage("value",this._vf.value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.destination=this._vf.initialDestination,this._buffer.length=this._numSupports,this._buffer[0]=this._vf.initialDestination;for(var e=1;e<this._buffer.length;e++)this._buffer[e]=this._vf.initialValue;this._previousValue=this._vf.initialValue,this._stepTime=this._vf.duration/this._numSupports;var t=!this._buffer[0].equals(this._buffer[1],this._eps);this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=this._vf.initialValue,this.postMessage("value",this._value),!0;var t=this.updateBuffer(e),A=this._previousValue,i=this._buffer[this._buffer.length-1].subtract(this._previousValue),o=i.multiply(this.stepResponse((this._buffer.length-1+t)*this._stepTime));A=A.add(o);for(var s=this._buffer.length-2;s>=0;s--)o=(i=this._buffer[s].subtract(this._buffer[s+1])).multiply(this.stepResponse((s+t)*this._stepTime)),A=A.add(o);return A.equals(this._value,this._eps)?this.postMessage("isActive",!1):(this._value.setValues(A),this.postMessage("value",this._value)),this._vf.isActive},updateBuffer:function(e){var t,A,i,o=(e-this._bufferEndTime)/this._stepTime;if(o>=1){if(o-=A=Math.floor(o),A<this._buffer.length){for(this._previousValue=this._buffer[this._buffer.length-A],t=this._buffer.length-1;t>=A;t--)this._buffer[t]=this._buffer[t-A];for(t=0;t<A;t++)i=t/A,this._buffer[t]=this._buffer[A].multiply(i).add(this._vf.destination.multiply(1-i))}else for(this._previousValue=A==this._buffer.length?this._buffer[0]:this._vf.destination,t=0;t<this._buffer.length;t++)this._buffer[t]=this._vf.destination;this._bufferEndTime+=A*this._stepTime}return o}})),x3dom.registerNodeType("ColorDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,(function(e){x3dom.nodeTypes.ColorDamper.superClass.call(this,e),this.addField_SFColor(e,"initialDestination",.8,.8,.8),this.addField_SFColor(e,"initialValue",.8,.8,.8),this.addField_SFColor(e,"value",0,0,0),this.addField_SFColor(e,"destination",0,0,0),this._value0=new x3dom.fields.SFColor(0,0,0),this._value1=new x3dom.fields.SFColor(0,0,0),this._value2=new x3dom.fields.SFColor(0,0,0),this._value3=new x3dom.fields.SFColor(0,0,0),this._value4=new x3dom.fields.SFColor(0,0,0),this._value5=new x3dom.fields.SFColor(0,0,0),this.initialize()}),{fieldChanged:function(e){"tolerance"===e?this._eps=this._vf.tolerance<0?.001:this._vf.tolerance:e.indexOf("destination")>=0?this._value0.equals(this._vf.destination,this._eps)||(this._value0=this._vf.destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("value")>=0&&(this._value1.setValues(this._vf.value),this._value2.setValues(this._vf.value),this._value3.setValues(this._vf.value),this._value4.setValues(this._vf.value),this._value5.setValues(this._vf.value),this._lastTick=0,this.postMessage("value",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0.setValues(this._vf.initialDestination),this._value1.setValues(this._vf.initialValue),this._value2.setValues(this._vf.initialValue),this._value3.setValues(this._vf.initialValue),this._value4.setValues(this._vf.initialValue),this._value5.setValues(this._vf.initialValue),this._lastTick=0;var e=!this._value0.equals(this._value1,this._eps);this._vf.isActive!==e&&this.postMessage("isActive",e)},distance:function(e,t){var A=e.subtract(t);return Math.sqrt(A.r*A.r+A.g*A.g+A.b*A.b)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,A=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0.add(this._value1.subtract(this._value0).multiply(A)):new x3dom.fields.SFColor(this._value0.r,this._value0.g,this._value0.b),this._value2=this._vf.order>1&&this._vf.tau?this._value1.add(this._value2.subtract(this._value1).multiply(A)):new x3dom.fields.SFColor(this._value1.r,this._value1.g,this._value1.b),this._value3=this._vf.order>2&&this._vf.tau?this._value2.add(this._value3.subtract(this._value2).multiply(A)):new x3dom.fields.SFColor(this._value2.r,this._value2.g,this._value2.b),this._value4=this._vf.order>3&&this._vf.tau?this._value3.add(this._value4.subtract(this._value3).multiply(A)):new x3dom.fields.SFColor(this._value3.r,this._value3.g,this._value3.b),this._value5=this._vf.order>4&&this._vf.tau?this._value4.add(this._value5.subtract(this._value4).multiply(A)):new x3dom.fields.SFColor(this._value4.r,this._value4.g,this._value4.b);var i=this.distance(this._value1,this._value0);if(this._vf.order>1){var o=this.distance(this._value2,this._value1);o>i&&(i=o)}if(this._vf.order>2){var s=this.distance(this._value3,this._value2);s>i&&(i=s)}if(this._vf.order>3){var n=this.distance(this._value4,this._value3);n>i&&(i=n)}if(this._vf.order>4){var r=this.distance(this._value5,this._value4);r>i&&(i=r)}return i<=this._eps?(this._value1.setValues(this._value0),this._value2.setValues(this._value0),this._value3.setValues(this._value0),this._value4.setValues(this._value0),this._value5.setValues(this._value0),this.postMessage("value",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("OrientationChaser","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,(function(e){x3dom.nodeTypes.OrientationChaser.superClass.call(this,e),this.addField_SFRotation(e,"initialDestination",0,1,0,0),this.addField_SFRotation(e,"initialValue",0,1,0,0),this.addField_SFRotation(e,"value",0,1,0,0),this.addField_SFRotation(e,"destination",0,1,0,0),this._numSupports=30,this._buffer=new x3dom.fields.MFRotation,this._previousValue=new x3dom.fields.Quaternion(0,1,0,0),this._value=new x3dom.fields.Quaternion(0,1,0,0),this.initialize()}),{fieldChanged:function(e){if(e.indexOf("destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("value")>=0){this.initialize(),this._previousValue.setValues(this._vf.value);for(var t=1;t<this._buffer.length;t++)this._buffer[t].setValues(this._vf.value);this.postMessage("value",this._vf.value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.destination=x3dom.fields.Quaternion.copy(this._vf.initialDestination),this._buffer.length=this._numSupports,this._buffer[0]=x3dom.fields.Quaternion.copy(this._vf.initialDestination);for(var e=1;e<this._buffer.length;e++)this._buffer[e]=x3dom.fields.Quaternion.copy(this._vf.initialValue);this._previousValue=x3dom.fields.Quaternion.copy(this._vf.initialValue),this._stepTime=this._vf.duration/this._numSupports;var t=!this._buffer[0].equals(this._buffer[1],this._eps);this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=x3dom.fields.Quaternion.copy(this._vf.initialValue),this.postMessage("value",this._value),!0;var t=this.updateBuffer(e),A=x3dom.fields.Quaternion.copy(this._previousValue),i=this._previousValue.inverse().multiply(this._buffer[this._buffer.length-1]);A=A.slerp(A.multiply(i),this.stepResponse((this._buffer.length-1+t)*this._stepTime));for(var o=this._buffer.length-2;o>=0;o--)i=this._buffer[o+1].inverse().multiply(this._buffer[o]),A=A.slerp(A.multiply(i),this.stepResponse((o+t)*this._stepTime));return A.equals(this._value,this._eps)?this.postMessage("isActive",!1):(A=A.normalize(A),this._value.setValues(A),this.postMessage("value",this._value)),this._vf.isActive},updateBuffer:function(e){var t,A,i,o=(e-this._bufferEndTime)/this._stepTime;if(o>=1){if(o-=A=Math.floor(o),A<this._buffer.length){for(this._previousValue=x3dom.fields.Quaternion.copy(this._buffer[this._buffer.length-A]),t=this._buffer.length-1;t>=A;t--)this._buffer[t]=x3dom.fields.Quaternion.copy(this._buffer[t-A]);for(t=0;t<A;t++)i=t/A,this._buffer[t]=this._vf.destination.slerp(this._buffer[A],i)}else for(this._previousValue=x3dom.fields.Quaternion.copy(A==this._buffer.length?this._buffer[0]:this._vf.destination),t=0;t<this._buffer.length;t++)this._buffer[t]=x3dom.fields.Quaternion.copy(this._vf.destination);this._bufferEndTime+=A*this._stepTime}return o}})),x3dom.registerNodeType("OrientationDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,(function(e){x3dom.nodeTypes.OrientationDamper.superClass.call(this,e),this.addField_SFRotation(e,"initialDestination",0,1,0,0),this.addField_SFRotation(e,"initialValue",0,1,0,0),this.addField_SFRotation(e,"value",0,1,0,0),this.addField_SFRotation(e,"destination",0,1,0,0),this._value0=new x3dom.fields.Quaternion(0,1,0,0),this._value1=new x3dom.fields.Quaternion(0,1,0,0),this._value2=new x3dom.fields.Quaternion(0,1,0,0),this._value3=new x3dom.fields.Quaternion(0,1,0,0),this._value4=new x3dom.fields.Quaternion(0,1,0,0),this._value5=new x3dom.fields.Quaternion(0,1,0,0),this.initialize()}),{fieldChanged:function(e){"tolerance"===e?this._eps=this._vf.tolerance<0?.001:this._vf.tolerance:e.indexOf("destination")>=0?this._value0.equals(this._vf.destination,this._eps)||(this._value0=this._vf.destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("value")>=0&&(this._value1.setValues(this._vf.value),this._value2.setValues(this._vf.value),this._value3.setValues(this._vf.value),this._value4.setValues(this._vf.value),this._value5.setValues(this._vf.value),this._lastTick=0,this.postMessage("value",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0.setValues(this._vf.initialDestination),this._value1.setValues(this._vf.initialValue),this._value2.setValues(this._vf.initialValue),this._value3.setValues(this._vf.initialValue),this._value4.setValues(this._vf.initialValue),this._value5.setValues(this._vf.initialValue),this._lastTick=0;var e=!this._value0.equals(this._value1,this._eps);this._vf.isActive!==e&&this.postMessage("isActive",e)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,A=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0.slerp(this._value1,A):new x3dom.fields.Quaternion(this._value0.x,this._value0.y,this._value0.z,this._value0.w),this._value2=this._vf.order>1&&this._vf.tau?this._value1.slerp(this._value2,A):new x3dom.fields.Quaternion(this._value1.x,this._value1.y,this._value1.z,this._value1.w),this._value3=this._vf.order>2&&this._vf.tau?this._value2.slerp(this._value3,A):new x3dom.fields.Quaternion(this._value2.x,this._value2.y,this._value2.z,this._value2.w),this._value4=this._vf.order>3&&this._vf.tau?this._value3.slerp(this._value4,A):new x3dom.fields.Quaternion(this._value3.x,this._value3.y,this._value3.z,this._value3.w),this._value5=this._vf.order>4&&this._vf.tau?this._value4.slerp(this._value5,A):new x3dom.fields.Quaternion(this._value4.x,this._value4.y,this._value4.z,this._value4.w);var i=Math.abs(this._value1.inverse().multiply(this._value0).angle());if(this._vf.order>1){var o=Math.abs(this._value2.inverse().multiply(this._value1).angle());o>i&&(i=o)}if(this._vf.order>2){var s=Math.abs(this._value3.inverse().multiply(this._value2).angle());s>i&&(i=s)}if(this._vf.order>3){var n=Math.abs(this._value4.inverse().multiply(this._value3).angle());n>i&&(i=n)}if(this._vf.order>4){var r=Math.abs(this._value5.inverse().multiply(this._value4).angle());r>i&&(i=r)}return i<=this._eps?(this._value1.setValues(this._value0),this._value2.setValues(this._value0),this._value3.setValues(this._value0),this._value4.setValues(this._value0),this._value5.setValues(this._value0),this.postMessage("value",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("PositionChaser","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,(function(e){x3dom.nodeTypes.PositionChaser.superClass.call(this,e),this.addField_SFVec3f(e,"initialDestination",0,0,0),this.addField_SFVec3f(e,"initialValue",0,0,0),this.addField_SFVec3f(e,"value",0,0,0),this.addField_SFVec3f(e,"destination",0,0,0),this._buffer=new x3dom.fields.MFVec3f,this._previousValue=new x3dom.fields.SFVec3f(0,0,0),this._value=new x3dom.fields.SFVec3f(0,0,0),this.initialize()}),{fieldChanged:function(e){if(e.indexOf("destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("value")>=0){this.initialize(),this._previousValue.setValues(this._vf.value);for(var t=1;t<this._buffer.length;t++)this._buffer[t].setValues(this._vf.value);this.postMessage("value",this._vf.value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.destination=x3dom.fields.SFVec3f.copy(this._vf.initialDestination),this._buffer.length=this._numSupports,this._buffer[0]=x3dom.fields.SFVec3f.copy(this._vf.initialDestination);for(var e=1;e<this._buffer.length;e++)this._buffer[e]=x3dom.fields.SFVec3f.copy(this._vf.initialValue);this._previousValue=x3dom.fields.SFVec3f.copy(this._vf.initialValue),this._stepTime=this._vf.duration/this._numSupports;var t=!this._buffer[0].equals(this._buffer[1],this._eps);this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=x3dom.fields.SFVec3f.copy(this._vf.initialValue),this.postMessage("value",this._value),!0;var t=this.updateBuffer(e),A=x3dom.fields.SFVec3f.copy(this._previousValue),i=this._buffer[this._buffer.length-1].subtract(this._previousValue),o=i.multiply(this.stepResponse((this._buffer.length-1+t)*this._stepTime));A=A.add(o);for(var s=this._buffer.length-2;s>=0;s--)o=(i=this._buffer[s].subtract(this._buffer[s+1])).multiply(this.stepResponse((s+t)*this._stepTime)),A=A.add(o);return A.equals(this._value,this._eps)?this.postMessage("isActive",!1):(this._value.setValues(A),this.postMessage("value",this._value)),this._vf.isActive},updateBuffer:function(e){var t,A,i,o=(e-this._bufferEndTime)/this._stepTime;if(o>=1){if(o-=A=Math.floor(o),A<this._buffer.length){for(this._previousValue=x3dom.fields.SFVec3f.copy(this._buffer[this._buffer.length-A]),t=this._buffer.length-1;t>=A;t--)this._buffer[t]=x3dom.fields.SFVec3f.copy(this._buffer[t-A]);for(t=0;t<A;t++)i=t/A,this._buffer[t]=this._buffer[A].multiply(i).add(this._vf.destination.multiply(1-i))}else for(this._previousValue=x3dom.fields.SFVec3f.copy(A==this._buffer.length?this._buffer[0]:this._vf.destination),t=0;t<this._buffer.length;t++)this._buffer[t]=x3dom.fields.SFVec3f.copy(this._vf.destination);this._bufferEndTime+=A*this._stepTime}return o}})),x3dom.registerNodeType("PositionChaser2D","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,(function(e){x3dom.nodeTypes.PositionChaser2D.superClass.call(this,e),this.addField_SFVec2f(e,"initialDestination",0,0),this.addField_SFVec2f(e,"initialValue",0,0),this.addField_SFVec2f(e,"value",0,0),this.addField_SFVec2f(e,"destination",0,0),this._buffer=new x3dom.fields.MFVec2f,this._previousValue=new x3dom.fields.SFVec2f(0,0),this._value=new x3dom.fields.SFVec2f(0,0),this.initialize()}),{fieldChanged:function(e){if(e.indexOf("destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("value")>=0){this.initialize(),this._previousValue.setValues(this._vf.value);for(var t=1;t<this._buffer.length;t++)this._buffer[t].setValues(this._vf.value);this.postMessage("value",this._vf.value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.destination=x3dom.fields.SFVec2f.copy(this._vf.initialDestination),this._buffer.length=this._numSupports,this._buffer[0]=x3dom.fields.SFVec2f.copy(this._vf.initialDestination);for(var e=1;e<this._buffer.length;e++)this._buffer[e]=x3dom.fields.SFVec2f.copy(this._vf.initialValue);this._previousValue=x3dom.fields.SFVec2f.copy(this._vf.initialValue),this._stepTime=this._vf.duration/this._numSupports;var t=!this._buffer[0].equals(this._buffer[1],this._eps);this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=x3dom.fields.SFVec2f.copy(this._vf.initialValue),this.postMessage("value",this._value),!0;var t=this.updateBuffer(e),A=x3dom.fields.SFVec2f.copy(this._previousValue),i=this._buffer[this._buffer.length-1].subtract(this._previousValue),o=i.multiply(this.stepResponse((this._buffer.length-1+t)*this._stepTime));A=A.add(o);for(var s=this._buffer.length-2;s>=0;s--)o=(i=this._buffer[s].subtract(this._buffer[s+1])).multiply(this.stepResponse((s+t)*this._stepTime)),A=A.add(o);return A.equals(this._value,this._eps)?this.postMessage("isActive",!1):(this._value.setValues(A),this.postMessage("value",this._value)),this._vf.isActive},updateBuffer:function(e){var t,A,i,o=(e-this._bufferEndTime)/this._stepTime;if(o>=1){if(o-=A=Math.floor(o),A<this._buffer.length){for(this._previousValue=x3dom.fields.SFVec2f.copy(this._buffer[this._buffer.length-A]),t=this._buffer.length-1;t>=A;t--)this._buffer[t]=x3dom.fields.SFVec2f.copy(this._buffer[t-A]);for(t=0;t<A;t++)i=t/A,this._buffer[t]=this._buffer[A].multiply(i).add(this._vf.destination.multiply(1-i))}else for(this._previousValue=x3dom.fields.SFVec2f.copy(A==this._buffer.length?this._buffer[0]:this._vf.destination),t=0;t<this._buffer.length;t++)this._buffer[t]=x3dom.fields.SFVec2f.copy(this._vf.destination);this._bufferEndTime+=A*this._stepTime}return o}})),x3dom.registerNodeType("PositionDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,(function(e){x3dom.nodeTypes.PositionDamper.superClass.call(this,e),this.addField_SFVec3f(e,"initialDestination",0,0,0),this.addField_SFVec3f(e,"initialValue",0,0,0),this.addField_SFVec3f(e,"value",0,0,0),this.addField_SFVec3f(e,"destination",0,0,0),this._value0=new x3dom.fields.SFVec3f(0,0,0),this._value1=new x3dom.fields.SFVec3f(0,0,0),this._value2=new x3dom.fields.SFVec3f(0,0,0),this._value3=new x3dom.fields.SFVec3f(0,0,0),this._value4=new x3dom.fields.SFVec3f(0,0,0),this._value5=new x3dom.fields.SFVec3f(0,0,0),this.initialize()}),{fieldChanged:function(e){"tolerance"===e?this._eps=this._vf.tolerance<0?.001:this._vf.tolerance:e.indexOf("destination")>=0?this._value0.equals(this._vf.destination,this._eps)||(this._value0=this._vf.destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("value")>=0&&(this._value1.setValues(this._vf.value),this._value2.setValues(this._vf.value),this._value3.setValues(this._vf.value),this._value4.setValues(this._vf.value),this._value5.setValues(this._vf.value),this._lastTick=0,this.postMessage("value",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0.setValues(this._vf.initialDestination),this._value1.setValues(this._vf.initialValue),this._value2.setValues(this._vf.initialValue),this._value3.setValues(this._vf.initialValue),this._value4.setValues(this._vf.initialValue),this._value5.setValues(this._vf.initialValue),this._lastTick=0;var e=!this._value0.equals(this._value1,this._eps);this._vf.isActive!==e&&this.postMessage("isActive",e)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,A=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0.add(this._value1.subtract(this._value0).multiply(A)):new x3dom.fields.SFVec3f(this._value0.x,this._value0.y,this._value0.z),this._value2=this._vf.order>1&&this._vf.tau?this._value1.add(this._value2.subtract(this._value1).multiply(A)):new x3dom.fields.SFVec3f(this._value1.x,this._value1.y,this._value1.z),this._value3=this._vf.order>2&&this._vf.tau?this._value2.add(this._value3.subtract(this._value2).multiply(A)):new x3dom.fields.SFVec3f(this._value2.x,this._value2.y,this._value2.z),this._value4=this._vf.order>3&&this._vf.tau?this._value3.add(this._value4.subtract(this._value3).multiply(A)):new x3dom.fields.SFVec3f(this._value3.x,this._value3.y,this._value3.z),this._value5=this._vf.order>4&&this._vf.tau?this._value4.add(this._value5.subtract(this._value4).multiply(A)):new x3dom.fields.SFVec3f(this._value4.x,this._value4.y,this._value4.z);var i=this._value1.subtract(this._value0).length();if(this._vf.order>1){var o=this._value2.subtract(this._value1).length();o>i&&(i=o)}if(this._vf.order>2){var s=this._value3.subtract(this._value2).length();s>i&&(i=s)}if(this._vf.order>3){var n=this._value4.subtract(this._value3).length();n>i&&(i=n)}if(this._vf.order>4){var r=this._value5.subtract(this._value4).length();r>i&&(i=r)}return i<=this._eps?(this._value1.setValues(this._value0),this._value2.setValues(this._value0),this._value3.setValues(this._value0),this._value4.setValues(this._value0),this._value5.setValues(this._value0),this.postMessage("value",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("PositionDamper2D","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,(function(e){x3dom.nodeTypes.PositionDamper2D.superClass.call(this,e),this.addField_SFVec2f(e,"initialDestination",0,0),this.addField_SFVec2f(e,"initialValue",0,0),this.addField_SFVec2f(e,"value",0,0),this.addField_SFVec2f(e,"destination",0,0),this._value0=new x3dom.fields.SFVec2f(0,0),this._value1=new x3dom.fields.SFVec2f(0,0),this._value2=new x3dom.fields.SFVec2f(0,0),this._value3=new x3dom.fields.SFVec2f(0,0),this._value4=new x3dom.fields.SFVec2f(0,0),this._value5=new x3dom.fields.SFVec2f(0,0),this.initialize()}),{fieldChanged:function(e){"tolerance"===e?this._eps=this._vf.tolerance<0?.001:this._vf.tolerance:e.indexOf("destination")>=0?this._value0.equals(this._vf.destination,this._eps)||(this._value0=this._vf.destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("value")>=0&&(this._value1.setValues(this._vf.value),this._value2.setValues(this._vf.value),this._value3.setValues(this._vf.value),this._value4.setValues(this._vf.value),this._value5.setValues(this._vf.value),this._lastTick=0,this.postMessage("value",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0.setValues(this._vf.initialDestination),this._value1.setValues(this._vf.initialValue),this._value2.setValues(this._vf.initialValue),this._value3.setValues(this._vf.initialValue),this._value4.setValues(this._vf.initialValue),this._value5.setValues(this._vf.initialValue),this._lastTick=0;var e=!this._value0.equals(this._value1,this._eps);this._vf.isActive!==e&&this.postMessage("isActive",e)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,A=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0.add(this._value1.subtract(this._value0).multiply(A)):new x3dom.fields.SFVec2f(this._value0.x,this._value0.y,this._value0.z),this._value2=this._vf.order>1&&this._vf.tau?this._value1.add(this._value2.subtract(this._value1).multiply(A)):new x3dom.fields.SFVec2f(this._value1.x,this._value1.y,this._value1.z),this._value3=this._vf.order>2&&this._vf.tau?this._value2.add(this._value3.subtract(this._value2).multiply(A)):new x3dom.fields.SFVec2f(this._value2.x,this._value2.y,this._value2.z),this._value4=this._vf.order>3&&this._vf.tau?this._value3.add(this._value4.subtract(this._value3).multiply(A)):new x3dom.fields.SFVec2f(this._value3.x,this._value3.y,this._value3.z),this._value5=this._vf.order>4&&this._vf.tau?this._value4.add(this._value5.subtract(this._value4).multiply(A)):new x3dom.fields.SFVec2f(this._value4.x,this._value4.y,this._value4.z);var i=this._value1.subtract(this._value0).length();if(this._vf.order>1){var o=this._value2.subtract(this._value1).length();o>i&&(i=o)}if(this._vf.order>2){var s=this._value3.subtract(this._value2).length();s>i&&(i=s)}if(this._vf.order>3){var n=this._value4.subtract(this._value3).length();n>i&&(i=n)}if(this._vf.order>4){var r=this._value5.subtract(this._value4).length();r>i&&(i=r)}return i<=this._eps?(this._value1.setValues(this._value0),this._value2.setValues(this._value0),this._value3.setValues(this._value0),this._value4.setValues(this._value0),this._value5.setValues(this._value0),this.postMessage("value",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("ScalarChaser","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,(function(e){x3dom.nodeTypes.ScalarChaser.superClass.call(this,e),this.addField_SFFloat(e,"initialDestination",0),this.addField_SFFloat(e,"initialValue",0),this.addField_SFFloat(e,"value",0),this.addField_SFFloat(e,"destination",0),this._buffer=[],this._previousValue=0,this._value=0,this.initialize()}),{fieldChanged:function(e){if(e.indexOf("destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("value")>=0){this.initialize(),this._previousValue=this._vf.value;for(var t=1;t<this._buffer.length;t++)this._buffer[t]=this._vf.value;this.postMessage("value",this._vf.value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.destination=this._vf.initialDestination,this._buffer.length=this._numSupports,this._buffer[0]=this._vf.initialDestination;for(var e=1;e<this._buffer.length;e++)this._buffer[e]=this._vf.initialValue;this._previousValue=this._vf.initialValue,this._stepTime=this._vf.duration/this._numSupports;var t=Math.abs(this._buffer[0]-this._buffer[1])>this._eps;this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=this._vf.initialValue,this.postMessage("value",this._value),!0;var t=this.updateBuffer(e),A=this._previousValue,i=this._buffer[this._buffer.length-1]-this._previousValue,o=i*this.stepResponse((this._buffer.length-1+t)*this._stepTime);A+=o;for(var s=this._buffer.length-2;s>=0;s--)A+=o=(i=this._buffer[s]-this._buffer[s+1])*this.stepResponse((s+t)*this._stepTime);return Math.abs(A-this._value)>this._eps?(this._value=A,this.postMessage("value",this._value)):this.postMessage("isActive",!1),this._vf.isActive},updateBuffer:function(e){var t,A,i,o=(e-this._bufferEndTime)/this._stepTime;if(o>=1){if(o-=A=Math.floor(o),A<this._buffer.length){for(this._previousValue=this._buffer[this._buffer.length-A],t=this._buffer.length-1;t>=A;t--)this._buffer[t]=this._buffer[t-A];for(t=0;t<A;t++)i=t/A,this._buffer[t]=this._buffer[A]*i+this._vf.destination*(1-i)}else for(this._previousValue=A==this._buffer.length?this._buffer[0]:this._vf.destination,t=0;t<this._buffer.length;t++)this._buffer[t]=this._vf.destination;this._bufferEndTime+=A*this._stepTime}return o}})),x3dom.registerNodeType("ScalarDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,(function(e){x3dom.nodeTypes.ScalarDamper.superClass.call(this,e),this.addField_SFFloat(e,"initialDestination",0),this.addField_SFFloat(e,"initialValue",0),this.addField_SFFloat(e,"value",0),this.addField_SFFloat(e,"destination",0),this._value0=0,this._value1=0,this._value2=0,this._value3=0,this._value4=0,this._value5=0,this.initialize()}),{fieldChanged:function(e){"tolerance"===e?this._eps=this._vf.tolerance<0?.001:this._vf.tolerance:e.indexOf("destination")>=0?Math.abs(this._value0-this._vf.destination)>this._eps&&(this._value0=this._vf.destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("value")>=0&&(this._value1=this._vf.value,this._value2=this._vf.value,this._value3=this._vf.value,this._value4=this._vf.value,this._value5=this._vf.value,this._lastTick=0,this.postMessage("value",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0=this._vf.initialDestination,this._value1=this._vf.initialValue,this._value2=this._vf.initialValue,this._value3=this._vf.initialValue,this._value4=this._vf.initialValue,this._value5=this._vf.initialValue,this._lastTick=0;var e=Math.abs(this._value0-this._value1)>this._eps;this._vf.isActive!==e&&this.postMessage("isActive",e)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,A=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0+A*(this._value1-this._value0):this._value0,this._value2=this._vf.order>1&&this._vf.tau?this._value1+A*(this._value2-this._value1):this._value1,this._value3=this._vf.order>2&&this._vf.tau?this._value2+A*(this._value3-this._value2):this._value2,this._value4=this._vf.order>3&&this._vf.tau?this._value3+A*(this._value4-this._value3):this._value3,this._value5=this._vf.order>4&&this._vf.tau?this._value4+A*(this._value5-this._value4):this._value4;var i=Math.abs(this._value1-this._value0);if(this._vf.order>1){var o=Math.abs(this._value2-this._value1);o>i&&(i=o)}if(this._vf.order>2){var s=Math.abs(this._value3-this._value2);s>i&&(i=s)}if(this._vf.order>3){var n=Math.abs(this._value4-this._value3);n>i&&(i=n)}if(this._vf.order>4){var r=Math.abs(this._value5-this._value4);r>i&&(i=r)}return i<=this._eps?(this._value1=this._value0,this._value2=this._value0,this._value3=this._value0,this._value4=this._value0,this._value5=this._value0,this.postMessage("value",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("CoordinateDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,(function(e){x3dom.nodeTypes.CoordinateDamper.superClass.call(this,e),this.addField_MFVec3f(e,"initialDestination",[]),this.addField_MFVec3f(e,"initialValue",[]),this.addField_MFVec3f(e,"value",[]),this.addField_MFVec3f(e,"destination",[]),x3dom.debug.logWarning("CoordinateDamper NYI")}))),x3dom.registerNodeType("TexCoordDamper2D","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,(function(e){x3dom.nodeTypes.TexCoordDamper2D.superClass.call(this,e),this.addField_MFVec2f(e,"initialDestination",[]),this.addField_MFVec2f(e,"initialValue",[]),this.addField_MFVec2f(e,"value",[]),this.addField_MFVec2f(e,"destination",[]),x3dom.debug.logWarning("TexCoordDamper2D NYI")}))),x3dom.registerNodeType("X3DInterpolatorNode","Interpolation",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DInterpolatorNode.superClass.call(this,e),this.addField_MFFloat(e,"key",[]),this.addField_SFFloat(e,"set_fraction",0),this.addField_SFString(e,"buffer",""),this.addField_SFString(e,"interpolation","LINEAR"),this.addField_SFFloat(e,"duration",1),this.addField_MFNode("views",x3dom.nodeTypes.BufferView),this.addField_MFNode("accessors",x3dom.nodeTypes.BufferAccessor),this._lastValue=void 0,this.normalizeFromType={5120:function(e){return Math.max(e/127,-1)},5121:function(e){return e/255},5122:function(e){return Math.max(e/32767,-1)},5123:function(e){return e/65535},5125:function(e){return e/4294967295},5126:function(e){return e}}}),{nodeChanged:function(){this._vf.buffer&&x3dom.BinaryContainerLoader.setupBufferInterpolator(this)},linearInterp:function(e,t){var A=this._vf.key,i=this._vf.keyValue;if(0!=A.length){if(e<=A[0])return t(i[0],i[0],0);if(e>=A[A.length-1])return t(i[A.length-1],i[A.length-1],1);for(var o=0,s=A.length-1;o<s;++o)if(A[o]<e&&e<=A[o+1])return t(i[o],i[o+1],(e-A[o])/(A[o+1]-A[o]));return i[0]}},cubicSplineInterp:function(e,t){if(0!=this._vf.key.length){var A,i,o,s,n,r,a;if(e<=this._vf.key[0])return this._vf.keyValue[1];if(e>=this._vf.key[this._vf.key.length-1])return this._vf.keyValue[this._vf.keyValue.length-2];for(A=0,o=this._vf.key.length-1;A<o;++A)if(this._vf.key[A]<e&&e<=this._vf.key[A+1])return i=3*A,s=this._vf.key[A+1]-this._vf.key[A],r=(e-this._vf.key[A])/s,a=s*this._vf.duration,n=this.cubicSplineBasis(r,a),t(this._vf.keyValue[i+2],this._vf.keyValue[i+1],this._vf.keyValue[i+3],this._vf.keyValue[i+4],n.h00,n.h10,n.h01,n.h11);return this._vf.keyValue[0]}},cubicSplineBasis:function(e,t){var A=e*e,i=A*e,o=-2*i+3*A,s=i-A;return{h00:1-o,h10:t*(s-A+e),h01:o,h11:t*s}},keyValueFromArray:function(e){return e}})),x3dom.XHRCache={},x3dom.registerNodeType("OrientationInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){x3dom.nodeTypes.OrientationInterpolator.superClass.call(this,e),this.addField_MFRotation(e,"keyValue",[])}),{fieldChanged:function(e){var t;"set_fraction"===e&&(null!=(t="CUBICSPLINE"===this._vf.interpolation?this.cubicSplineInterp(this._vf.set_fraction,(function(e,t,A,i,o,s,n,r){function a(a){return o*t[a]+s*e[a]+n*i[a]+r*A[a]}var d=new x3dom.fields.Quaternion(0,0,0,0);d.x=a("x"),d.y=a("y"),d.z=a("z"),d.w=a("w");var h=Math.sqrt(1/d.dot(d));return d.x*=h,d.y*=h,d.z*=h,d.w*=h,d})):this.linearInterp(this._vf.set_fraction,(function(e,t,A){return e.slerp(t,A)})))&&t!=this._lastValue&&(this._lastValue=t,this.postMessage("value_changed",t)))},keyValueFromAccessor:function(e,t){var A=new x3dom.fields.MFRotation,i=this.normalizeFromType[t];return e.forEach((function(t,o){o%4==3&&A.push(new x3dom.fields.Quaternion(i(e[o-3]),i(e[o-2]),i(e[o-1]),i(t)))})),A}})),x3dom.registerNodeType("PositionInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){x3dom.nodeTypes.PositionInterpolator.superClass.call(this,e),this.addField_MFVec3f(e,"keyValue",[])}),{fieldChanged:function(e){var t;"set_fraction"===e&&(null!=(t="CUBICSPLINE"===this._vf.interpolation?this.cubicSplineInterp(this._vf.set_fraction,(function(e,t,A,i,o,s,n,r){function a(a){return o*t[a]+s*e[a]+n*i[a]+r*A[a]}var d=new x3dom.fields.SFVec3f;return d.x=a("x"),d.y=a("y"),d.z=a("z"),d})):this.linearInterp(this._vf.set_fraction,(function(e,t,A){var i=e.multiply(1-A);return i.x+=A*t.x,i.y+=A*t.y,i.z+=A*t.z,i})))&&t!=this._lastValue&&(this._lastValue=t,this.postMessage("value_changed",t)))},keyValueFromAccessor:function(e){var t=new x3dom.fields.MFVec3f;return e.forEach((function(A,i){i%3==2&&t.push(new x3dom.fields.SFVec3f(e[i-2],e[i-1],A))})),t}})),x3dom.registerNodeType("PositionInterpolator2D","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){x3dom.nodeTypes.PositionInterpolator2D.superClass.call(this,e),this.addField_MFVec2f(e,"keyValue",[])}),{fieldChanged:function(e){if("set_fraction"===e){var t=this.linearInterp(this._vf.set_fraction,(function(e,t,A){return e.multiply(1-A).add(t.multiply(A))}));this.postMessage("value_changed",t)}}})),x3dom.registerNodeType("NormalInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){if(x3dom.nodeTypes.NormalInterpolator.superClass.call(this,e),this.addField_MFVec3f(e,"keyValue",[]),e&&e.xmlNode.hasAttribute("keyValue")){this._vf.keyValue=[];for(var t=x3dom.fields.MFVec3f.parse(e.xmlNode.getAttribute("keyValue")),A=this._vf.key.length>0?this._vf.key.length:1,i=t.length/A,o=0;o<A;o++){for(var s=new x3dom.fields.MFVec3f,n=0;n<i;n++)s.push(t[o*i+n]);this._vf.keyValue.push(s)}}}),{fieldChanged:function(e){if("set_fraction"===e){var t=this.linearInterp(this._vf.set_fraction,(function(e,t,A){for(var i=new x3dom.fields.MFVec3f,o=0;o<e.length;o++)i.push(e[o].multiply(1-A).add(t[o].multiply(A)).normalize());return i}));null!=t&&t!=this._lastValue&&(this._lastValue=t,this.postMessage("value_changed",t))}},keyValueFromAccessor:function(e){var t=new x3dom.fields.MFVec3f;e.forEach((function(A,i){i%3==2&&t.push(new x3dom.fields.SFVec3f(e[i-2],e[i-1],A))}));for(var A=this._vf.key.length>0?this._vf.key.length:1,i=t.length/A,o=[],s=0;s<A;s++){for(var n=new x3dom.fields.MFVec3f,r=0;r<i;r++)n.push(t[s*i+r]);o.push(n)}return o}})),x3dom.registerNodeType("ColorInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){x3dom.nodeTypes.ColorInterpolator.superClass.call(this,e),this.addField_MFColor(e,"keyValue",[]),this.addField_SFBool(e,"RGB",!1),this._lastValue=new x3dom.fields.SFColor(-1,-1,-1),this.fieldChanged("keyValue")}),{fieldChanged:function(e){var t,A;"set_fraction"===e&&(this._vf.RGB?t=this.linearInterp(this._vf.set_fraction,(function(e,t,i){return A=e.multiply(1-i).add(t.multiply(i))})):(this._vf.keyValue=this._keyValueHSV,t=this.linearInterp(this._vf.set_fraction,(function(e,t,i){var o=e.copy(),s=t.copy();return s.r=s.r>o.r?s.r:s.r+360,s.r-o.r<180?A=o.multiply(1-i).add(s.multiply(i)):(o.r=o.r+360,A=o.multiply(1-i).add(s.multiply(i))),A.setHSV(A.r%360,A.g,A.b)})),this._vf.keyValue=this._keyValue),null==t||t.equals(this._lastValue,x3dom.fields.Eps)||(this._lastValue=t,this.postMessage("value_changed",t)));"keyValue"===e&&(this._keyValueHSV=this._vf.keyValue.map((function(e){var t=e.getHSV();return new x3dom.fields.SFColor(t[0],t[1],t[2])})),this._keyValue=this._vf.keyValue.copy())},keyValueFromAccessor:function(e){var t=new x3dom.fields.MFColor;return e.forEach((function(A,i){i%3==2&&t.push(new x3dom.fields.SFColor(e[i-2],e[i-1],A))})),this._vf.keyValue=t,this.fieldChanged("keyValue"),t}})),x3dom.registerNodeType("ScalarInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){x3dom.nodeTypes.ScalarInterpolator.superClass.call(this,e),this.addField_MFFloat(e,"keyValue",[])}),{fieldChanged:function(e){if("set_fraction"===e){var t;if("CUBICSPLINE"===this._vf.interpolation){t=this.cubicSplineInterp(this._vf.set_fraction,(function(e,t,A,i,o,s,n,r){return o*t+s*e+n*i+r*A}))}else t=this.linearInterp(this._vf.set_fraction,(function(e,t,A){return(1-A)*e+A*t}));null!=t&&t!=this._lastValue&&(this._lastValue=t,this.postMessage("value_changed",t))}},keyValueFromAccessor:function(e,t){var A=this.normalizeFromType[t];return e.map((function(e){return A(e)}))}})),x3dom.registerNodeType("CoordinateInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){if(x3dom.nodeTypes.CoordinateInterpolator.superClass.call(this,e),this.addField_MFVec3f(e,"keyValue",[]),e&&e.xmlNode.hasAttribute("keyValue")){this._vf.keyValue=[];for(var t=x3dom.fields.MFVec3f.parse(e.xmlNode.getAttribute("keyValue")),A=this._vf.key.length>0?this._vf.key.length:1,i=t.length/A,o=0;o<A;o++){for(var s=new x3dom.fields.MFVec3f,n=0;n<i;n++)s.push(t[o*i+n]);this._vf.keyValue.push(s)}}}),{fieldChanged:function(e){if("set_fraction"===e){var t=this.linearInterp(this._vf.set_fraction,(function(e,t,A){for(var i=new x3dom.fields.MFVec3f,o=0;o<e.length;o++)i.push(e[o].multiply(1-A).add(t[o].multiply(A)));return i}));null!=t&&t!=this._lastValue&&(this._lastValue=t,this.postMessage("value_changed",t))}},keyValueFromAccessor:function(e){var t=new x3dom.fields.MFVec3f;e.forEach((function(A,i){i%3==2&&t.push(new x3dom.fields.SFVec3f(e[i-2],e[i-1],A))}));for(var A=this._vf.key.length>0?this._vf.key.length:1,i=t.length/A,o=[],s=0;s<A;s++){for(var n=new x3dom.fields.MFVec3f,r=0;r<i;r++)n.push(t[s*i+r]);o.push(n)}return o}})),x3dom.registerNodeType("SplinePositionInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){x3dom.nodeTypes.SplinePositionInterpolator.superClass.call(this,e),this.addField_MFVec3f(e,"keyValue",[]),this.addField_MFVec3f(e,"keyVelocity",[]),this.addField_SFBool(e,"closed",!1),this.addField_SFBool(e,"normalizeVelocity",!1),this.dtot=0,this.T0=[],this.T1=[],this.checkSanity=function(){this._vf.key.length==this._vf.keyValue.length&&(this._vf.key.length==this._vf.keyVelocity.length||2==this._vf.keyVelocity.length&&this._vf.key.length>=2||0==this._vf.keyVelocity.length)||x3dom.debug.logWarning("SplinePositionInterpolator Node: 'key' , 'keyValue' and/or 'keyVelocity' fields have inappropriate sizes")},this.calcDtot=function(){this.dtot=0;for(var e=0;e<this._vf.key.length-1;e++)this.dtot+=Math.abs(this._vf.key[e]-this._vf.key[e+1])},this.calcAdjustedKeyVelocity=function(){var e,t,A,i,o=this._vf.key.length;if(this._vf.keyVelocity.length==o)for(e=0;e<o;e++)t=this._vf.keyVelocity[e],this._vf.normalizeVelocity&&(t=t.multiply(this.dtot/t.length())),A=0==e||e==o-1?1:2*(this._vf.key[e]-this._vf.key[e-1])/(this._vf.key[e+1]-this._vf.key[e-1]),i=0==e||e==o-1?1:2*(this._vf.key[e+1]-this._vf.key[e])/(this._vf.key[e+1]-this._vf.key[e-1]),this.T0[e]=t.multiply(A),this.T1[e]=t.multiply(i);else if(2==this._vf.keyVelocity.length&&o>2)for(e=0;e<o;e++)t=0==e?this._vf.keyVelocity[0]:e==o-1?this._vf.keyVelocity[1]:this._vf.keyValue[e+1].subtract(this._vf.keyValue[e-1]).multiply(.5),this._vf.normalizeVelocity&&(t=t.multiply(this.dtot/t.length())),A=0==e||e==o-1?1:2*(this._vf.key[e]-this._vf.key[e-1])/(this._vf.key[e+1]-this._vf.key[e-1]),i=0==e||e==o-1?1:2*(this._vf.key[e+1]-this._vf.key[e])/(this._vf.key[e+1]-this._vf.key[e-1]),this.T0[e]=t.multiply(A),this.T1[e]=t.multiply(i);else{var s=this._vf.closed&&this._vf.keyValue[0].equals(this._vf.keyValue[o-1],1e-5);for(e=0;e<o;e++)0!=e&&e!=o-1||s?(0!=e&&e!=o-1||!s?(t=this._vf.keyValue[e+1].subtract(this._vf.keyValue[e-1]).multiply(.5),A=2*(this._vf.key[e]-this._vf.key[e-1])/(this._vf.key[e+1]-this._vf.key[e-1]),i=2*(this._vf.key[e+1]-this._vf.key[e])/(this._vf.key[e+1]-this._vf.key[e-1])):(t=this._vf.keyValue[1].subtract(this._vf.keyValue[o-2]).multiply(.5),0==e?(A=2*(this._vf.key[0]-this._vf.key[o-2])/(this._vf.key[1]-this._vf.key[o-2]),i=2*(this._vf.key[1]-this._vf.key[0])/(this._vf.key[1]-this._vf.key[o-2])):(A=2*(this._vf.key[o-1]-this._vf.key[o-2])/(this._vf.key[1]-this._vf.key[o-2]),i=2*(this._vf.key[1]-this._vf.key[o-1])/(this._vf.key[1]-this._vf.key[o-2])),A=2*(this._vf.key[o-1]-this._vf.key[o-2])/(this._vf.key[o-2]-this._vf.key[1]),i=2*(this._vf.key[1]-this._vf.key[0])/(this._vf.key[o-2]-this._vf.key[1])),this.T0[e]=t.multiply(A),this.T1[e]=t.multiply(i)):(this.T0[e]=new x3dom.fields.SFVec3f(0,0,0),this.T1[e]=new x3dom.fields.SFVec3f(0,0,0))}},this.checkSanity(),this.calcDtot(),this.calcAdjustedKeyVelocity()}),{fieldChanged:function(e){switch(e){case"key":case"keyValue":case"keyVelocity":this.checkSanity(),this.calcDtot(),this.calcAdjustedKeyVelocity();break;case"closed":case"normalizeVelocity":this.calcAdjustedKeyVelocity();break;case"set_fraction":var t;this._vf.key.length>0&&(this._vf.set_fraction<=this._vf.key[0]?t=x3dom.fields.SFVec3f.copy(this._vf.keyValue[0]):this._vf.set_fraction>=this._vf.key[this._vf.key.length-1]&&(t=x3dom.fields.SFVec3f.copy(this._vf.keyValue[this._vf.key.length-1])));for(var A=0;A<this._vf.key.length-1;A++)if(this._vf.key[A]<this._vf.set_fraction&&this._vf.set_fraction<=this._vf.key[A+1]){var i=(this._vf.set_fraction-this._vf.key[A])/(this._vf.key[A+1]-this._vf.key[A]),o=new x3dom.fields.SFVec4f(2*i*i*i-3*i*i+1,-2*i*i*i+3*i*i,i*i*i-2*i*i+i,i*i*i-i*i);t=new x3dom.fields.SFVec3f(o.x*this._vf.keyValue[A].x+o.y*this._vf.keyValue[A+1].x+o.z*this.T0[A].x+o.w*this.T1[A+1].x,o.x*this._vf.keyValue[A].y+o.y*this._vf.keyValue[A+1].y+o.z*this.T0[A].y+o.w*this.T1[A+1].y,o.x*this._vf.keyValue[A].z+o.y*this._vf.keyValue[A+1].z+o.z*this.T0[A].z+o.w*this.T1[A+1].z);break}null!=t&&t!=this._lastValue&&(this._lastValue=t,this.postMessage("value_changed",t))}}})),x3dom.registerNodeType("TimeSensor","Time",defineClass(x3dom.nodeTypes.X3DSensorNode,(function(e){x3dom.nodeTypes.TimeSensor.superClass.call(this,e),e?e.doc._nodeBag.timer.push(this):x3dom.debug.logWarning("TimeSensor: No runtime context found!"),this.addField_SFTime(e,"cycleInterval",1),this.addField_SFBool(e,"loop",!1),this.addField_SFTime(e,"startTime",0),this.addField_SFTime(e,"stopTime",0),this.addField_SFTime(e,"pauseTime",0),this.addField_SFTime(e,"resumeTime",0),this.addField_SFTime(e,"cycleTime",0),this.addField_SFTime(e,"elapsedTime",0),this.addField_SFFloat(e,"fraction_changed",0),this.addField_SFBool(e,"isActive",!1),this.addField_SFBool(e,"isPaused",!1),this.addField_SFTime(e,"time",0),this.addField_SFBool(e,"first",!0),this.addField_SFFloat(e,"firstCycle",0),this._prevCycle=-1,this._lastTime=0,this._cycleStopTime=0,this._activatedTime=0,this._vf.startTime>0&&this._updateCycleStopTime(),this._backupStartTime=this._vf.startTime,this._backupStopTime=this._vf.stopTime,this._backupCycleInterval=this._vf.cycleInterval}),{tick:function(e){if(!this._vf.enabled)return this._lastTime=e,!1;var t=this._vf.cycleInterval>0&&e>=this._vf.startTime&&(e<this._vf.stopTime||this._vf.stopTime<=this._vf.startTime)&&(1==this._vf.loop||0==this._vf.loop&&e<this._cycleStopTime);if(t&&!this._vf.isActive&&(this.postMessage("isActive",!0),this._activatedTime=e),t||this._vf.isActive){this.postMessage("elapsedTime",e-this._activatedTime);var A=e>=this._vf.pauseTime&&this._vf.pauseTime>this._vf.resumeTime;if(A&&!this._vf.isPaused?(this.postMessage("isPaused",!0),this.postMessage("pauseTime",e)):!A&&this._vf.isPaused&&(this.postMessage("isPaused",!1),this.postMessage("resumeTime",e)),!A){var i=this._getCycleAt(e),o=Math.floor(i),s=this._vf.startTime+o*this._vf.cycleInterval,n=0;this._vf.stopTime>this._vf.startTime&&this._lastTime<this._vf.stopTime&&e>=this._vf.stopTime?n=this._vf.stopTime:this._lastTime<s&&e>=s&&(n=s),n>0&&(e=n,i=this._getCycleAt(e),o=Math.floor(i));var r=i-o;r<x3dom.fields.Eps&&(r=this._lastTime<this._vf.startTime?0:1,this.postMessage("cycleTime",e)),this._fraction=r,this.postMessage("fraction_changed",r),this.postMessage("time",e)}}return!t&&this._vf.isActive&&this.postMessage("isActive",!1),this._lastTime=e,!0},fieldChanged:function(e){if("enabled"==e)!this._vf.enabled&&this._vf.isActive&&this.postMessage("isActive",!1);else if("startTime"==e){if(this._vf.isActive)return void(this._vf.startTime=this._backupStartTime);this._backupStartTime=this._vf.startTime,this._updateCycleStopTime()}else if("stopTime"==e){if(this._vf.isActive&&this._vf.stopTime<=this._vf.startTime)return void(this._vf.stopTime=this._backupStopTime);this._backupStopTime=this._vf.stopTime}else if("cycleInterval"==e){if(this._vf.isActive)return void(this._vf.cycleInterval=this._backupCycleInterval);this._backupCycleInterval=this._vf.cycleInterval}else if("loop"==e)this._updateCycleStopTime();else if("resumeTime"==e){if(this._vf.resumeTime<this._vf.pauseTime||this._vf.resumeTime<this._vf.startTime||!this._vf.enabled)return;this._vf.startTime=this._vf.resumeTime-this._fraction*this._vf.cycleInterval,this._backupStartTime=this._vf.startTime,this._updateCycleStopTime()}},parentRemoved:function(e){if(0===this._parentNodes.length){var t=this.findX3DDoc();if(t)for(var A=0,i=t._nodeBag.timer.length;A<i;A++)t._nodeBag.timer[A]===this&&t._nodeBag.timer.splice(A,1)}},_getCycleAt:function(e){return Math.max(0,e-this._vf.startTime)/this._vf.cycleInterval},_updateCycleStopTime:function(){if(0==this._vf.loop){var e=(new Date).getTime()/1e3,t=Math.floor(this._getCycleAt(e))+1;this._cycleStopTime=this._vf.startTime+t*this._vf.cycleInterval}else this._cycleStopTime=0}})),x3dom.registerNodeType("X3DTimeDependentNode","Time",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DTimeDependentNode.superClass.call(this,e),this.addField_SFBool(e,"loop",!1),this.addField_SFString(e,"description","")}))),x3dom.registerNodeType("Anchor","Networking",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Anchor.superClass.call(this,e),this.addField_MFString(e,"url",[]),this.addField_MFString(e,"parameter",[]),this.addField_SFString(e,"description",""),this.urlIndex=0}),{nodeChanged:function(){this.updateUrlIndex()},fieldChanged:function(e){"url"==e&&this.updateUrlIndex()},updateUrlIndex:function(){this.urlIndex=0,that=this,function e(){var t=that._nameSpace.doc,A=that._vf.url[that.urlIndex]||"",i=A.lastIndexOf("."),o=A.substr(i).toLowerCase();if(A.startsWith("javascript")||!(o.includes("x3d")||o.includes("json")||o.includes("html")))return A;t.incrementDownloads(),fetch(that._nameSpace.getURL(A)).then((function(e){if(!e.ok)throw new Error("Network response was not OK: "+e.status);return e.text()})).then((function(e){return t.decrementDownloads(),e})).catch((function(i){if(x3dom.debug.logWarning(A+": Anchor fetch failed: "+i),t.decrementDownloads(),that.urlIndex++,!(that.urlIndex<that._vf.url.length))return x3dom.debug.logError("Anchor fetch failed for all x3d urls."),null;e()}))}()},doIntersect:function(e){for(var t=!1,A=0;A<this._childNodes.length;A++)this._childNodes[A]&&(t=this._childNodes[A].doIntersect(e)||t);return t},handleTouch:function(){var e=this._vf.url.length?this._vf.url[this.urlIndex]:"",t=e.search("#"),A="";t>=0&&(A=e.slice(t+1));var i=this._vf.parameter.length>this.urlIndex?this._vf.parameter[this.urlIndex]:"",o=i.search("target="),s="";(o>=0&&(s=i.slice(o+7)),x3dom.debug.logInfo("Anchor "+this._vf.description+" url="+e+", target="+s+", #viewpoint="+A),0!=this._vf.url.length)&&(A.length>0&&e=="#"+A?A in this._nameSpace.defMap?this._nameSpace.defMap[A]._xmlNode.setAttribute("bind","true"):x3dom.debug.logWarning("Anchor #viewpoint="+A+" not in DEF list."):e.includes(".x3d")||e.includes(".json")?this.getRuntime().loadURL(this._nameSpace.getURL(e)):0!=s.length||"_self"!=s?window.open(this._nameSpace.getURL(e),s):window.location=this._nameSpace.getURL(e))}})),x3dom.registerNodeType("Inline","Networking",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Inline.superClass.call(this,e),this.addField_MFString(e,"url",[]),this.addField_SFBool(e,"load",!0),this.addField_SFString(e,"description",""),this.addField_MFString(e,"nameSpaceName",[]),this.addField_SFString(e,"contentType",""),this.addField_SFBool(e,"mapDEFToID",!1),this.initDone=!1,this.urlIndex=0,this.count=0,this.numRetries=x3dom.nodeTypes.Inline.MaximumRetries,this.ContentType={X3D:"model/x3d+xml",GLTF:"model/gltf+json",GLB:"model/gltf-binary",X3DJ:"model/x3d+json"}}),{fieldChanged:function(e){if("url"==e||"load"==e){for(var t=0;t<this._childNodes.length;t++)this.removeChild(this._childNodes[t]);if(0!=this._vf.nameSpaceName.length){var A=this._xmlNode;if(A&&A.hasChildNodes())for(;A.childNodes.length>=1;)A.removeChild(A.firstChild)}this.urlIndex=0,this.loadInline()}else"render"==e&&this.invalidateVolume()},nodeChanged:function(){this.initDone||(this.initDone=!0,this.urlIndex=0,this.loadInline())},parentRemoved:function(){var e=x3dom.getGlobal();this._childNodes.length>0&&this._childNodes[0]&&this._childNodes[0]._nameSpace&&this._nameSpace.removeSpace(this._childNodes[0]._nameSpace);for(var t=0,A=this._childNodes.length;t<A;t++)this._childNodes[t]&&(this._childNodes[t].parentRemoved(this),e._remover=this.removeChild(this._childNodes[t]));delete e._remover},fireEvents:function(e){if(this._xmlNode&&(this._xmlNode["on"+e]||this._xmlNode.hasAttribute("on"+e)||this._listeners[e])){var t=this._xmlNode,A={target:t,type:e,error:"error"==e?"XMLHttpRequest Error":"",cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0}};try{var i=t["on"+e];if("function"==typeof i)i.call(t,A);else if(t.hasAttribute("on"+e)){var o=t.getAttribute("on"+e);new Function("event",o).call(t,A)}var s=this._listeners[e];if(s)for(var n=0;n<s.length;n++)s[n].call(t,A)}catch(e){x3dom.debug.logException(e)}}},isValidContentType:function(e){for(var t in this.ContentType)if(e===this.ContentType[t])return!0;return!1},getContentType:function(){if(""!=this._vf.contentType&&this.isValidContentType(this._vf.contentType))return this._vf.contentType;if(this._vf.url.length&&this._vf.url[this.urlIndex].length){var e=this._vf.url[this.urlIndex],t=e.lastIndexOf(".");if(-1!=t)switch(e.substr(t).toLowerCase()){case".x3d":return this.ContentType.X3D;case".gltf":return this.ContentType.GLTF;case".glb":return this.ContentType.GLB;case".json":return this.ContentType.X3DJ}}},loadX3D:function(e,t){if(this._vf.load){var A=this,i=null;if(e){if((i=t.setupTree(e))._nameSpace.superInlineNode=A,0!=A._vf.nameSpaceName.length)for(;e.children.length;){var o=e.children[0];setNamespace(A._vf.nameSpaceName,o,A._vf.mapDEFToID),A._xmlNode.appendChild(o)}}else x3dom.debug.logError("No Scene in resource");var s=x3dom.getGlobal();for(A._childNodes.length>0&&A._childNodes[0]&&A._childNodes[0]._nameSpace&&A._nameSpace.removeSpace(A._childNodes[0]._nameSpace);0!==A._childNodes.length;)s._remover=A.removeChild(A._childNodes[0]);if(delete s._remover,i){A.addChild(i),A.invalidateVolume();var n=A._nameSpace.doc._scene;n&&(n.invalidateVolume(),window.setTimeout((function(){A.invalidateVolume(),n.updateVolume(),A._nameSpace.doc.needRender=!0,A._nameSpace.doc.decrementDownloads(),A._nameSpace.doc.needRender=!0,x3dom.debug.logInfo("Inline: added "+A._vf.url[A.urlIndex]+" to scene.")}),1e3)),A._nameSpace.importNodes(i._nameSpace),A.fireEvents("load")}i=null,t=null,e=null}else x3dom.debug.logInfo("Inline: load field prevented loading of "+this._vf.url[this.urlIndex])},loadInline:function(){var e=this,t=this.getContentType(),A=!1,i=new window.XMLHttpRequest;if(i.onreadystatechange=function(){if(4==i.readyState)if(i.status===x3dom.nodeTypes.Inline.AwaitTranscoding)if(e.count<e.numRetries){e.count++;var o=+i.getResponseHeader("Refresh")||5;x3dom.debug.logInfo("XHR status: "+i.status+" - Await Transcoding ("+e.count+"/"+e.numRetries+"): Next request in "+o+" seconds"),window.setTimeout((function(){e._nameSpace.doc.decrementDownloads(),e.loadInline()}),1e3*o)}else x3dom.debug.logError("XHR status: "+i.status+" - Await Transcoding ("+e.count+"/"+e.numRetries+"): No Retries left"),e._nameSpace.doc.decrementDownloads(),e.count=0;else if(200==i.status||0==i.status){var s;x3dom.debug.logInfo("Inline: downloading "+e._vf.url[e.urlIndex]+" done."),null==t&&(t=i.getResponseHeader("Content-Type")),e.count=0;var n=e.addNameSpace();if(t==e.ContentType.GLTF||t==e.ContentType.GLB)if(i.response)s=new x3dom.glTF2Loader(n).load(i.response,A),e.loadX3D(s,n);else e.nextUrlOrError("Invalid XHR response for glTF");else if(t==e.ContentType.X3DJ)if(i.response){var r=x3dom.protoExpander.prototypeExpander(i.responseURL,i.response);null!=(a=(new x3dom.JSONParser).parseJavaScript(r))?(s=a.getElementsByTagName("Scene")[0]||a.getElementsByTagName("scene")[0],e.loadX3D(s,n)):e.nextUrlOrError("Invalid XML parsing of JSON")}else e.nextUrlOrError("Invalid XHR response for JSON");else if(t==e.ContentType.X3D){var a;null!=(a="Microsoft Internet Explorer"==navigator.appName?(new DOMParser).parseFromString(i.responseText,"text/xml"):i.responseXML)?(s=a.getElementsByTagName("Scene")[0]||a.getElementsByTagName("scene")[0],e.loadX3D(s,n)):e.nextUrlOrError("Invalid xml parsing for X3D")}}else e.nextUrlOrError(e._vf.url[e.urlIndex]+" status: "+i.status+" - XMLHttpRequest requires web server running!")},this._vf.url.length&&this._vf.url[this.urlIndex].length){var o=this._nameSpace.getURL(this._vf.url[this.urlIndex]);i.open("GET",o,!0),i.setRequestHeader("Accept","model/x3d+xml; q=1.0, model/gltf+json; q=0.5, model/gltf-binary; q=0.5"),i.overrideMimeType&&(t==this.ContentType.X3D&&i.overrideMimeType("text/xml"),t==this.ContentType.X3DJ?(i.overrideMimeType("application/json"),i.responseType="json"):t==this.ContentType.GLTF?(A=!1,i.responseType="json"):t==this.ContentType.GLB&&(A=!0,i.responseType="arraybuffer"));try{this._nameSpace.doc.incrementDownloads(),x3dom.RequestManager.addRequest(i)}catch(t){e.nextUrlOrError(this._vf.url[this.urlIndex]+": "+t)}}},nextUrlOrError:function(e){x3dom.debug.logWarning(e),this._nameSpace.doc.decrementDownloads(),this.urlIndex++,this.urlIndex<this._vf.url.length?this.loadInline():(this.fireEvents("error"),this.count=0)},addNameSpace:function(){var e=0!=this._vf.nameSpaceName.length?this._vf.nameSpaceName.toString().replace(" ",""):"",t=new x3dom.NodeNameSpace(e,this._nameSpace.doc),A=this._vf.url.length?this._vf.url[0]:"";return"/"===A[0]||A.indexOf(":")>=0?t.setBaseURL(A):t.setBaseURL(this._nameSpace.baseURL+A),this._nameSpace.addSpace(t),t}})),x3dom.nodeTypes.Inline.AwaitTranscoding=202,x3dom.nodeTypes.Inline.MaximumRetries=15,x3dom.registerNodeType("X3DBackgroundNode","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DBindableNode,(function(e){x3dom.nodeTypes.X3DBackgroundNode.superClass.call(this,e);var t=e&&e.autoGen?1:0;this.addField_SFString(e,"crossOrigin",""),this.addField_MFColor(e,"groundColor",[]),this.addField_MFFloat(e,"groundAngle",[]),this.addField_MFColor(e,"skyColor",[new x3dom.fields.SFColor(0,0,0)]),this.addField_MFFloat(e,"skyAngle",[]),this.addField_SFFloat(e,"transparency",t),this._dirty=!0}),{getSkyColor:function(){return new x3dom.fields.SFColor(0,0,0)},getTransparency:function(){return 0},getTexUrl:function(){return[]}})),x3dom.registerNodeType("X3DFogNode","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DBindableNode,(function(e){x3dom.nodeTypes.X3DFogNode.superClass.call(this,e),this.addField_SFColor(e,"color",1,1,1),this.addField_SFString(e,"fogType","LINEAR"),this.addField_SFFloat(e,"visibilityRange",0)}),{})),x3dom.registerNodeType("Fog","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DFogNode,(function(e){x3dom.nodeTypes.Fog.superClass.call(this,e)}),{})),x3dom.registerNodeType("Background","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DBackgroundNode,(function(e){x3dom.nodeTypes.Background.superClass.call(this,e),this.addField_MFString(e,"backUrl",[]),this.addField_MFString(e,"bottomUrl",[]),this.addField_MFString(e,"frontUrl",[]),this.addField_MFString(e,"leftUrl",[]),this.addField_MFString(e,"rightUrl",[]),this.addField_MFString(e,"topUrl",[]),this.addField_SFBool(e,"scaling",!1)}),{fieldChanged:function(e){e.indexOf("Url")>0||"transparency"==e||e.search("sky")>=0||e.search("ground")>=0?this._dirty=!0:e.indexOf("bind")>=0&&this.bind(this._vf.bind)},getSkyColor:function(){return this._vf.skyColor},getGroundColor:function(){return this._vf.groundColor},getTransparency:function(){return this._vf.transparency},getTexUrl:function(){return[this._nameSpace.getURL(this._vf.backUrl[0]),this._nameSpace.getURL(this._vf.frontUrl[0]),this._nameSpace.getURL(this._vf.bottomUrl[0]),this._nameSpace.getURL(this._vf.topUrl[0]),this._nameSpace.getURL(this._vf.leftUrl[0]),this._nameSpace.getURL(this._vf.rightUrl[0])]}})),x3dom.registerNodeType("X3DEnvironmentNode","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DBindableNode,(function(e){x3dom.nodeTypes.X3DEnvironmentNode.superClass.call(this,e)}))),x3dom.registerNodeType("Environment","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DEnvironmentNode,(function(e){x3dom.nodeTypes.Environment.superClass.call(this,e),this.addField_SFBool(e,"sortTrans",!0),this.addField_SFBool(e,"shadowExcludeTransparentObjects",!1),this.addField_SFString(e,"gammaCorrectionDefault","linear"),this.addField_SFString(e,"tonemapping","none"),this.addField_SFBool(e,"frustumCulling",!0),this.addField_SFBool(e,"smallFeatureCulling",!1),this.addField_SFFloat(e,"smallFeatureThreshold",1),this.addField_SFBool(e,"occlusionCulling",!1),this.addField_SFFloat(e,"occlusionVisibilityThreshold",0),this.addField_SFBool(e,"lowPriorityCulling",!1),this.addField_SFFloat(e,"lowPriorityThreshold",1),this.addField_SFBool(e,"tessellationDetailCulling",!1),this.addField_SFFloat(e,"tessellationErrorThreshold",0),this.addField_SFBool(e,"enableARC",!1),this.addField_SFFloat(e,"minFrameRate",1),this.addField_SFFloat(e,"maxFrameRate",62.5),this.addField_SFFloat(e,"userDataFactor",-1),this.addField_SFFloat(e,"smallFeatureFactor",-1),this.addField_SFFloat(e,"occlusionVisibilityFactor",-1),this.addField_SFFloat(e,"lowPriorityFactor",-1),this.addField_SFFloat(e,"tessellationErrorFactor",-1),this.addField_SFBool(e,"SSAO",!1),this.addField_SFFloat(e,"SSAOradius",.7),this.addField_SFFloat(e,"SSAOamount",.3),this.addField_SFInt32(e,"SSAOrandomTextureSize",4),this.addField_SFInt32(e,"SSAOblurDepthTreshold",1),this._validGammaCorrectionTypes=["none","fastlinear","linear"],this.checkSanity()}),{checkSanity:function(){var e=function(e,t,A,i){return e&&t==i?A:e||t==i?t:i};this._smallFeatureThreshold=e(this._vf.smallFeatureCulling,this._vf.smallFeatureThreshold,10,0),this._lowPriorityThreshold=e(this._vf.lowPriorityCulling,this._vf.lowPriorityThreshold,.5,1),this._occlusionVisibilityThreshold=e(this._vf.occlusionCulling,this._vf.occlusionVisibilityThreshold,1,0),this._tessellationErrorThreshold=e(this._vf.tessellationDetailCulling,this._vf.tessellationErrorThreshold,1,0);this._vf.gammaCorrectionDefault=function(e,t){return e=e.toLowerCase(),t._validGammaCorrectionTypes.indexOf(e)>-1?e:(x3dom.debug.logWarning(e+" gammaCorrectionDefault may only be linear (default), fastLinear, or none"),t._validGammaCorrectionTypes[0])}(this._vf.gammaCorrectionDefault,this)}})),x3dom.registerNodeType("X3DViewpointNode","Navigation",defineClass(x3dom.nodeTypes.X3DBindableNode,(function(e){if(x3dom.nodeTypes.X3DViewpointNode.superClass.call(this,e),this.addField_SFFloat(e,"nearClippingPlane",-1),this.addField_SFFloat(e,"farClippingPlane",-1),this.addField_SFBool(e,"viewAll",!1),this.addField_SFNode("navigationInfo",x3dom.nodeTypes.NavigationInfo),e&&e.xmlNode){var t=e.xmlNode;t.resetView||t.getFieldOfView||t.getNear||t.getFar||(t.resetView=function(){var e=this._x3domNode;e.resetView(),e._nameSpace.doc.needRender=!0},t.getFieldOfView=function(){return this._x3domNode.getFieldOfView()},t.getNear=function(){return this._x3domNode.getNear()},t.getFar=function(){return this._x3domNode.getFar()})}}),{activate:function(e){var t=this._nameSpace.doc._viewarea;e=e||this;var A=this;if(this._bindAnimation){if(this._vf.viewAll){var i=this._runtime.getSceneBBox();A=t.getFitViewMatrix(i.min,i.max,e,!0)}t.animateTo(A,e._autoGen?null:e)}t._needNavigationMatrixUpdate=!0,this._cf.navigationInfo.node&&this._cf.navigationInfo.node.bind(!0),x3dom.nodeTypes.X3DBindableNode.prototype.activate.call(this,e)},deactivate:function(e){x3dom.nodeTypes.X3DBindableNode.prototype.deactivate.call(this,e)},getTransformation:function(){return this.getCurrentTransform()},getCenterOfRotation:function(){return new x3dom.fields.SFVec3f(0,0,0)},setCenterOfRotation:function(e){this._vf.centerOfRotation.setValues(e)},getFieldOfView:function(){return Math.PI/2},setView:function(e){var t=this.getCurrentTransform();this._viewMatrix=e.mult(t)},setViewAbsolute:function(e){this._viewMatrix=e},setProjectionMatrix:function(e){},resetView:function(){},getNear:function(){return.1},getFar:function(){return 1e4},getImgPlaneHeightAtDistOne:function(){return 2},getViewMatrix:function(){return null},getProjectionMatrix:function(e){return null},setZoom:function(e){}})),x3dom.registerNodeType("Viewpoint","Navigation",defineClass(x3dom.nodeTypes.X3DViewpointNode,(function(e){x3dom.nodeTypes.Viewpoint.superClass.call(this,e),this.addField_SFFloat(e,"fieldOfView",.785398),this.addField_SFVec3f(e,"position",0,0,10),this.addField_SFRotation(e,"orientation",0,0,1,0),this.addField_SFVec3f(e,"centerOfRotation",0,0,0),this.addField_SFFloat(e,"zNear",-1),this.addField_SFFloat(e,"zFar",-1),this._viewMatrix=x3dom.fields.SFMatrix4f.translation(this._vf.position).mult(this._vf.orientation.toMatrix()).inverse(),this._projMatrix=null,this._lastAspect=1,this._vf.nearClippingPlane>-1&&(this._vf.zNear=this._vf.nearClippingPlane),this._vf.farClippingPlane>-1&&(this._vf.zFar=this._vf.farClippingPlane),this._zRatio=1e4,this._zNear=this._vf.zNear,this._zFar=this._vf.zFar,this._imgPlaneHeightAtDistOne=2*Math.tan(this._vf.fieldOfView/2)}),{fieldChanged:function(e){"nearClippingPlane"==e?(this._vf.zNear=this._vf.nearClippingPlane,e="zNear"):"farClippingPlane"==e&&(this._vf.zFar=this._vf.farClippingPlane,e="zFar"),"position"==e||"orientation"==e?this.resetView():"fieldOfView"==e||"zNear"==e||"zFar"==e?(this._projMatrix=null,this._zNear=this._vf.zNear,this._zFar=this._vf.zFar,this._imgPlaneHeightAtDistOne=2*Math.tan(this._vf.fieldOfView/2)):e.indexOf("bind")>=0?(this.bind(this._vf.bind),this._cf.navigationInfo.node&&this._cf.navigationInfo.node.bind(this._vf.bind)):"viewAll"==e&&this._vf.viewAll&&this._nameSpace.doc._x3dElem.runtime.fitAll()},setProjectionMatrix:function(e){this._projMatrix=e},getCenterOfRotation:function(){return this._vf.centerOfRotation},getViewMatrix:function(){return this._viewMatrix},getFieldOfView:function(){return this._vf.fieldOfView},resetView:function(){this._viewMatrix=x3dom.fields.SFMatrix4f.translation(this._vf.position).mult(this._vf.orientation.toMatrix()).inverse(),this._vf.isActive&&this._nameSpace&&this._nameSpace.doc._viewarea&&this._nameSpace.doc._viewarea.resetNavHelpers()},getNear:function(){return this._zNear},getFar:function(){return this._zFar},getImgPlaneHeightAtDistOne:function(){return this._imgPlaneHeightAtDistOne},getProjectionMatrix:function(e){var t=this._vf.fieldOfView,A=this._vf.zFar,i=this._vf.zNear;if(i<=0||A<=0){var o=.8,s=1.2,n=this._nameSpace.doc._viewarea,r=n._scene,a=x3dom.fields.SFVec3f.copy(r._lastMin),d=x3dom.fields.SFVec3f.copy(r._lastMax).subtract(a),h=d.length()/2,g=n.getViewMatrix().inverse(),l=g.e3(),I=new x3dom.fields.SFVec3f(0,0,0),c=new x3dom.fields.SFVec3f(1,1,1),f=new x3dom.fields.Quaternion(0,0,1,0),u=new x3dom.fields.Quaternion(0,0,1,0);g.getTransform(I,f,c,u);var C=c.x,_=c.x;_<c.y&&(_=c.y),C>c.y&&(C=c.y),_<c.z&&(_=c.z),C>c.z&&(C=c.z),_>1?o/=_:C>x3dom.fields.Eps&&C<1&&(s/=C);var m=a.add(d.multiply(.5)),p=l.subtract(m).length();h?(i=p>h?(p-h)*o:0,A=(p+h)*s):(i=.1,A=1e5);var E=A/this._zRatio;i=Math.max(i,Math.max(x3dom.fields.Eps,E)),A>this._vf.zNear&&this._vf.zNear>0&&(i=this._vf.zNear),this._vf.zFar>i&&(A=this._vf.zFar),A<=i&&(A=i+1)}if(null==this._projMatrix)this._projMatrix=x3dom.fields.SFMatrix4f.perspective(t,e,i,A);else if(this._zNear!=i||this._zFar!=A){var B=i-A;this._projMatrix._22=(i+A)/B,this._projMatrix._23=2*i*A/B}else this._lastAspect!=e&&(this._projMatrix._00=1/Math.tan(t/2)/e,this._lastAspect=e);return this._zNear=i,this._zFar=A,this._projMatrix}})),x3dom.registerNodeType("OrthoViewpoint","Navigation",defineClass(x3dom.nodeTypes.X3DViewpointNode,(function(e){x3dom.nodeTypes.OrthoViewpoint.superClass.call(this,e),this.addField_MFFloat(e,"fieldOfView",[-1,-1,1,1]),this.addField_SFVec3f(e,"position",0,0,10),this.addField_SFRotation(e,"orientation",0,0,0,1),this.addField_SFVec3f(e,"centerOfRotation",0,0,0),this.addField_SFFloat(e,"zNear",-1),this.addField_SFFloat(e,"zFar",-1),this._viewMatrix=null,this._projMatrix=null,this._lastAspect=1,this._vf.nearClippingPlane>-1&&(this._vf.zNear=this._vf.nearClippingPlane),this._vf.farClippingPlane>-1&&(this._vf.zFar=this._vf.farClippingPlane),this._zRatio=1e4,this._zNear=this._vf.zNear,this._zFar=this._vf.zFar,this._fieldOfView=this._vf.fieldOfView.slice(0),this.resetView()}),{fieldChanged:function(e){"nearClippingPlane"==e?(this._vf.zNear=this._vf.nearClippingPlane,e="zNear"):"farClippingPlane"==e&&(this._vf.zFar=this._vf.farClippingPlane,e="zFar"),"position"==e||"orientation"==e?this.resetView():"fieldOfView"==e?(this._fieldOfView=this._vf.fieldOfView,this._projMatrix=null):"zNear"==e||"zFar"==e?(this._projMatrix=null,this.resetView()):e.indexOf("bind")>=0?(this.bind(this._vf.bind),this._cf.navigationInfo.node&&this._cf.navigationInfo.node.bind(this._vf.bind)):"viewAll"==e&&this._vf.viewAll&&this._nameSpace.doc._x3dElem.runtime.fitAll()},getCenterOfRotation:function(){return this.getCurrentTransform().multMatrixPnt(this._vf.centerOfRotation)},getViewMatrix:function(){return this._viewMatrix},resetView:function(){x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f((this._vf.fieldOfView[0]+this._vf.fieldOfView[2])/2,(this._vf.fieldOfView[1]+this._vf.fieldOfView[3])/2,0));this._viewMatrix=x3dom.fields.SFMatrix4f.translation(this._vf.position).mult(this._vf.orientation.toMatrix()),this._viewMatrix=this._viewMatrix.inverse(),this._projMatrix=null,this._vf.isActive&&this._nameSpace&&this._nameSpace.doc._viewarea&&this._nameSpace.doc._viewarea.resetNavHelpers()},getNear:function(){return this._vf.zNear},getFar:function(){return this._vf.zFar},getFieldOfView:function(){return.785},setZoom:function(e){this._fieldOfView[0]=-e,this._fieldOfView[1]=-e,this._fieldOfView[2]=e,this._fieldOfView[3]=e,this._projMatrix=null},getZoom:function(e){return this._fieldOfView},getProjectionMatrix:function(e){var t=this.getFieldOfView(),A=this._vf.zFar,i=this._vf.zNear;if(i<=0||A<=0){var o=this._nameSpace.doc._viewarea._scene,s=x3dom.fields.SFVec3f.copy(o._lastMin),n=x3dom.fields.SFVec3f.copy(o._lastMax).subtract(s),r=Math.tan(t/2),a=n.y/2/r+n.z+this._fieldOfView[2],d=n.x/2/r+n.z+this._fieldOfView[2],h=a>d?a:d;A=4*h,i=1e-4,this._viewMatrix._23=-2*h}if(null==this._projMatrix||this._lastAspect!=e||this._zNear!=i||this._zFar!=A){var g=this._zNear=i,l=this._zFar=A,I=this._fieldOfView[0],c=this._fieldOfView[1],f=this._fieldOfView[2],u=this._fieldOfView[3];this._projMatrix=x3dom.fields.SFMatrix4f.ortho(I,f,c,u,g,l,e)}return this._lastAspect=e,this._projMatrix}})),x3dom.registerNodeType("Viewfrustum","Navigation",defineClass(x3dom.nodeTypes.X3DViewpointNode,(function(e){x3dom.nodeTypes.Viewfrustum.superClass.call(this,e),this.addField_SFMatrix4f(e,"modelview",1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.addField_SFMatrix4f(e,"projection",1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this._viewMatrix=this._vf.modelview.transpose().inverse(),this._projMatrix=this._vf.projection.transpose(),this._centerOfRotation=new x3dom.fields.SFVec3f(0,0,0)}),{fieldChanged:function(e){"modelview"==e?this.resetView():"projection"==e?this._projMatrix=this._vf.projection.transpose():e.indexOf("bind")>=0&&this.bind(this._vf.bind)},getCenterOfRotation:function(){return this.getCurrentTransform().multMatrixPnt(this._centerOfRotation)},setCenterOfRotation:function(e){this._centerOfRotation.setValues(e)},getViewMatrix:function(){return this._viewMatrix},getFieldOfView:function(){return 2*Math.atan(1/this._projMatrix._11)},getImgPlaneHeightAtDistOne:function(){return 2/this._projMatrix._11},resetView:function(){this._viewMatrix=this._vf.modelview.transpose().inverse(),this._centerOfRotation=new x3dom.fields.SFVec3f(0,0,0)},getProjectionMatrix:function(e){return this._projMatrix}})),x3dom.registerNodeType("X3DNavigationInfoNode","Navigation",defineClass(x3dom.nodeTypes.X3DBindableNode,(function(e){x3dom.nodeTypes.X3DNavigationInfoNode.superClass.call(this,e)}))),x3dom.registerNodeType("NavigationInfo","Navigation",defineClass(x3dom.nodeTypes.X3DNavigationInfoNode,(function(e){x3dom.nodeTypes.NavigationInfo.superClass.call(this,e),this.addField_SFBool(e,"headlight",!0),this.addField_SFBool(e,"reverseScroll",!1),this.addField_MFString(e,"type",["EXAMINE","ANY"]),this.addField_MFFloat(e,"typeParams",[-.4,60,.05,2.8]),this.addField_SFString(e,"explorationMode","all"),this.addField_MFFloat(e,"avatarSize",[.25,1.6,.75]),this.addField_SFFloat(e,"walkDamping",2),this.addField_SFFloat(e,"visibilityLimit",0),this.addField_SFFloat(e,"speed",1),this.addField_SFTime(e,"transitionTime",1),this.addField_MFString(e,"transitionType",["LINEAR"]),this._validTypes=["none","examine","turntable","fly","freefly","lookat","lookaround","walk","game","helicopter","any"],this._typeMapping={default:x3dom.DefaultNavigation,turntable:x3dom.TurntableNavigation,walk:x3dom.WalkNavigation},this._heliUpdated=!1;var t=this.setType(this.getType());x3dom.debug.logInfo("NavType: "+t)}),{fieldChanged:function(e){"typeParams"==e?this._heliUpdated=!1:"type"==e?this.setType(this.getType()):e.indexOf("bind")>=0&&this.bind(this._vf.bind)},setType:function(e,t){var A=this.checkType(e.toLowerCase());if(this.checkType(this.getType())!==A||null==this._impl){switch(null==this._typeMapping[A]?this._impl=new this._typeMapping.default(this):this._impl=new this._typeMapping[A](this),A){case"game":t?t.initMouseState():this._nameSpace.doc._viewarea&&this._nameSpace.doc._viewarea.initMouseState();break;case"helicopter":this._heliUpdated=!1;break;case"turntable":t?t.initMouseState():this._nameSpace.doc._viewarea&&this._nameSpace.doc._viewarea.initMouseState()}this._nameSpace.doc._viewarea&&this._impl.init(this._nameSpace.doc._viewarea,!1)}this._vf.type[0]=A,x3dom.debug.logInfo("Switch to "+A+" mode.")},getType:function(){var e=this._vf.type[0].toLowerCase();return e.length<=1?e="none":"any"==e&&(e="examine"),e},getTypeParams:function(){var e=this._vf.typeParams.length,t=[e>=1?this._vf.typeParams[0]:-.4,e>=2?this._vf.typeParams[1]:60,e>=3?this._vf.typeParams[2]:x3dom.fields.Eps,e>=4?this._vf.typeParams[3]:Math.PI-x3dom.fields.Eps];return e>=5&&(t=t.concat(this._vf.typeParams.slice(4))),t},setTypeParams:function(e){for(var t=0;t<e.length;t++)this._vf.typeParams[t]=e[t]},checkType:function(e){return this._validTypes.indexOf(e)>-1?e:(x3dom.debug.logWarning(e+" is no valid navigation type, use one of "+this._validTypes.toString()),"examine")},getExplorationMode:function(){switch(this._vf.explorationMode.toLowerCase()){case"all":return 7;case"rotate":return 1;case"zoom":return 2;case"pan":return 4;case"-rotate":return 6;case"-zoom":return 5;case"-pan":return 3;case"none":return 0;default:return 7}}})),x3dom.registerNodeType("Billboard","Navigation",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Billboard.superClass.call(this,e),this.addField_SFVec3f(e,"axisOfRotation",0,1,0),this._eye=new x3dom.fields.SFVec3f(0,0,0),this._eyeViewUp=new x3dom.fields.SFVec3f(0,0,0),this._eyeLook=new x3dom.fields.SFVec3f(0,0,0)}),{collectDrawableObjects:function(e,t,A,i,o,s){if(A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),this.collectBbox(e,t,A,i,o,s),!((o=t.cull(e,this.graphState(),A,o))<0)){A=!1;var n=this.getVolume(),r=x3dom.fields.SFVec3f.MAX(),a=x3dom.fields.SFVec3f.MIN();n.getBounds(r,a);var d=t.viewMatrix,h=new x3dom.fields.SFVec3f(0,0,0);h=d.inverse().multMatrixPnt(h);var g=d.mult(e);this._eye=e.inverse().multMatrixPnt(h),this._eyeViewUp=new x3dom.fields.SFVec3f(g._10,g._11,g._12),this._eyeLook=new x3dom.fields.SFVec3f(g._20,g._21,g._22);var l=x3dom.fields.SFMatrix4f.identity(),I=a.add(r).multiply(.5),c=this._eye.subtract(I);if(this._vf.axisOfRotation.equals(new x3dom.fields.SFVec3f(0,0,0),x3dom.fields.Eps)){var f=(l=x3dom.fields.Quaternion.rotateFromTo(c,new x3dom.fields.SFVec3f(0,0,1)).toMatrix().transpose()).multMatrixPnt(new x3dom.fields.SFVec3f(0,1,0)).normalize(),u=l.multMatrixPnt(new x3dom.fields.SFVec3f(0,0,1)).normalize();if(!this._eyeViewUp.equals(new x3dom.fields.SFVec3f(0,0,0),x3dom.fields.Eps)){var C=x3dom.fields.Quaternion.rotateFromTo(this._eyeLook,u),_=C.toMatrix().transpose().multMatrixVec(f),m=x3dom.fields.Quaternion.rotateFromTo(this._eyeViewUp,_);l=C.toMatrix().transpose().mult(l),l=m.toMatrix().transpose().mult(l)}}else{var p=this._vf.axisOfRotation.cross(c).normalize();this._eye.z<0&&(p=p.multiply(-1));var E=Math.asin(p.dot(new x3dom.fields.SFVec3f(0,0,1)));this._eye.z<0&&(E+=Math.PI),l=x3dom.fields.SFMatrix4f.parseRotation(this._vf.axisOfRotation.x+", "+this._vf.axisOfRotation.y+", "+this._vf.axisOfRotation.z+", "+-1*E)}for(var B=this.transformMatrix(e.mult(l)),Q=0,x=this._childNodes.length;Q<x;Q++){var v=this._childNodes[Q];v&&v.collectDrawableObjects(B,t,A,i,o,s)}}}})),x3dom.registerNodeType("Collision","Navigation",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Collision.superClass.call(this,e),this.addField_SFBool(e,"enabled",!0),this.addField_SFNode("proxy",x3dom.nodeTypes.X3DGroupingNode),this.addField_SFTime(e,"collideTime",0),this.addField_SFBool(e,"isActive",!0)}),{collectDrawableObjects:function(e,t,A,i,o,s){var n,r;if(A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),A?(this._graph.globalMatrix||(this._graph.globalMatrix=this.transformMatrix(e)),r=this._graph.globalMatrix):r=this.transformMatrix(e),this.collectBbox(r,t,A,i,o,s),!((o=t.cull(e,this.graphState(),A,o))<0))for(var a=0,d=this._childNodes.length;a<d;a++)(n=this._childNodes[a])&&n!==this._cf.proxy.node&&n.collectDrawableObjects(r,t,A,i,o,s)}})),x3dom.registerNodeType("X3DLODNode","Navigation",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.X3DLODNode.superClass.call(this,e),this.addField_SFBool(e,"forceTransitions",!1),this.addField_SFVec3f(e,"center",0,0,0),this._eye=new x3dom.fields.SFVec3f(0,0,0)}),{collectDrawableObjects:function(e,t,A,i,o,s){A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),this.collectBbox(e,t,A,i,o,s),(o=t.cull(e,this.graphState(),A,o))<0||(A=!1,this.visitChildren(e,t,A,i,o,s))},visitChildren:function(e,t,A,i,o,s){}})),x3dom.registerNodeType("LOD","Navigation",defineClass(x3dom.nodeTypes.X3DLODNode,(function(e){x3dom.nodeTypes.LOD.superClass.call(this,e),this.addField_MFFloat(e,"range",[]),this.addField_SFInt32(e,"level_changed",0),this._lastRangePos=-1}),{visitChildren:function(e,t,A,i,o,s){var n=0,r=this._childNodes.length,a=t.viewMatrix,d=new x3dom.fields.SFVec3f(0,0,0);d=a.inverse().multMatrixPnt(d),this._eye=e.inverse().multMatrixPnt(d);for(var h=this._vf.center.subtract(this._eye).length();n<this._vf.range.length&&h>this._vf.range[n];)n++;n&&n>=r&&(n=r-1),n!==this._lastRangePos&&this.postMessage("level_changed",n),this._lastRangePos=n;var g=this._childNodes[n];if(r&&g){var l=this.transformMatrix(e);g.collectDrawableObjects(l,t,A,i,o,s)}},getVolume:function(){var e,t,A=this._graph.volume;if(!this.volumeValid()&&(this._vf.bboxDisplay||this.renderFlag&&this.renderFlag()))if(this._lastRangePos>=0)(t=(e=this._childNodes[this._lastRangePos])&&(e._vf.bboxDisplay||e.renderFlag&&e.renderFlag())?e.getVolume():null)&&t.isValid()&&A.extendBounds(t.min,t.max);else for(var i=0,o=this._childNodes.length;i<o;i++)!(e=this._childNodes[i])||e.renderFlag&&!0!==e.renderFlag()&&!e._vf.bboxDisplay||(t=e.getVolume())&&t.isValid()&&A.extendBounds(t.min,t.max);return A},nodeChanged:function(){this.invalidateVolume()},fieldChanged:function(e){"render"!=e&&"center"!=e&&"range"!=e||this.invalidateVolume()}})),x3dom.registerNodeType("DynamicLOD","Navigation",defineClass(x3dom.nodeTypes.X3DLODNode,(function(e){x3dom.nodeTypes.DynamicLOD.superClass.call(this,e),this.addField_SFFloat(e,"subScale",.5),this.addField_SFVec2f(e,"size",2,2),this.addField_SFVec2f(e,"subdivision",1,1),this.addField_SFNode("root",x3dom.nodeTypes.X3DShapeNode),this.addField_SFString(e,"urlHead","http://r"),this.addField_SFString(e,"urlCenter",".ortho.tiles.virtualearth.net/tiles/h"),this.addField_SFString(e,"urlTail",".png?g=-1"),this.rootGeometry=new x3dom.nodeTypes.Plane(e),this.level=0,this.quadrant=4,this.cell=""}),{nodeChanged:function(){var e=this._cf.root.node;null!=e&&null==e._cf.geometry.node&&(this.rootGeometry._vf.size.setValues(this._vf.size),this.rootGeometry._vf.subdivision.setValues(this._vf.subdivision),this.rootGeometry._vf.center.setValues(this._vf.center),this.rootGeometry.fieldChanged("subdivision"),this._cf.root.node.addChild(this.rootGeometry),this.rootGeometry.nodeChanged(),this._cf.root.node.nodeChanged(),this._nameSpace.doc.needRender=!0)},visitChildren:function(e,t,A,i,o,s){var n=this._cf.root.node;if(null!=n){var r=t.viewMatrix,a=new x3dom.fields.SFVec3f(0,0,0);a=r.inverse().multMatrixPnt(a),this._eye=e.inverse().multMatrixPnt(a);var d,h=this._vf.center.subtract(this._eye).length();if(h>x3dom.fields.Eps&&h*this._vf.subScale<=this._vf.size.length())if(this._childNodes.length<=1){var g=new Array(new x3dom.fields.SFVec3f(-.25*this._vf.size.x,.25*this._vf.size.y,0),new x3dom.fields.SFVec3f(.25*this._vf.size.x,.25*this._vf.size.y,0),new x3dom.fields.SFVec3f(-.25*this._vf.size.x,-.25*this._vf.size.y,0),new x3dom.fields.SFVec3f(.25*this._vf.size.x,-.25*this._vf.size.y,0));for(d=0;d<4;d++){var l=new x3dom.nodeTypes.DynamicLOD;l._nameSpace=this._nameSpace,l._eye.setValues(this._eye),l.level=this.level+1,l.quadrant=d,l.cell=this.cell+d,l._vf.urlHead=this._vf.urlHead,l._vf.urlCenter=this._vf.urlCenter,l._vf.urlTail=this._vf.urlTail,l._vf.center=this._vf.center.add(g[d]),l._vf.size=this._vf.size.multiply(.5),l._vf.subdivision.setValues(this._vf.subdivision);var I=new x3dom.nodeTypes.Appearance,c=new x3dom.nodeTypes.ImageTexture;c._nameSpace=this._nameSpace,c._vf.url[0]=this._vf.urlHead+l.quadrant+this._vf.urlCenter+l.cell+this._vf.urlTail,I.addChild(c),c.nodeChanged();var f=new x3dom.nodeTypes.Shape;f._nameSpace=this._nameSpace,f.addChild(I),I.nodeChanged(),l.addChild(f,"root"),f.nodeChanged(),this.addChild(l),l.nodeChanged()}}else for(d=1;d<this._childNodes.length;d++)this._childNodes[d].collectDrawableObjects(e,t,A,i,o,s);else n.collectDrawableObjects(e,t,A,i,o,s)}},getVolume:function(){var e=this._graph.volume;return e.isValid()||(e.min.setValues(this._vf.center),e.min.x-=.5*this._vf.size.x,e.min.y-=.5*this._vf.size.y,e.min.z-=x3dom.fields.Eps,e.max.setValues(this._vf.center),e.max.x+=.5*this._vf.size.x,e.max.y+=.5*this._vf.size.y,e.max.z+=x3dom.fields.Eps),e}})),x3dom.DefaultNavigation=function(e){this.navi=e},x3dom.DefaultNavigation.prototype.onMousePress=function(e,t,A,i){},x3dom.DefaultNavigation.prototype.onMouseReleased=function(e,t,A,i,o){},x3dom.DefaultNavigation.prototype.init=function(e,t){},x3dom.DefaultNavigation.prototype.zoom=function(e,t){var A=this.navi,i=e._scene.getViewpoint(),o=e._scene._lastMax.subtract(e._scene._lastMin).length();o=((o=Math.min(o,i.getFar()))<x3dom.fields.Eps?1:o)*A._vf.speed;var s=new x3dom.fields.SFVec3f(0,0,o*t/e._height);if(x3dom.isa(i,x3dom.nodeTypes.OrthoViewpoint)&&i.setZoom(Math.abs(i._fieldOfView[0])-s.z),A._vf.typeParams.length>=6){var n=-A._vf.typeParams[5],r=A._vf.typeParams[4];e._movement.z=Math.min(Math.max(e._movement.z,n),r)}e._movement=e._movement.add(s);var a=e.getViewpointMatrix().mult(e._transMat);e._transMat=a.inverse().mult(x3dom.fields.SFMatrix4f.translation(e._movement)).mult(a)},x3dom.DefaultNavigation.prototype.moveForward=function(e){var t=this.navi;if("game"===t.getType()){var A=.25;t._vf.avatarSize.length>2&&(A=t._vf.avatarSize[0]);var i=5*e._deltaT*t._vf.speed,o=e._yaw/180*Math.PI,s=e._pitch/180*Math.PI,n=e._flyMat.inverse();e._scene._nameSpace.doc.ctx.pickValue(e,e._width/2,e._height/2,e._lastButton),e._pickingInfo.pickObj&&(e._pickingInfo.pickPos.subtract(n.e3()).length()<=2*A||(e._eyePos.x-=Math.sin(o)*i,e._eyePos.z+=Math.cos(o)*i,e._eyePos.y+=Math.sin(s)*i))}},x3dom.DefaultNavigation.prototype.moveBackwards=function(e){var t=this.navi;if("game"===t.getType()){var A=5*e._deltaT*t._vf.speed,i=e._yaw/180*Math.PI,o=e._pitch/180*Math.PI;e._eyePos.x+=Math.sin(i)*A,e._eyePos.z-=Math.cos(i)*A,e._eyePos.y-=Math.sin(o)*A}},x3dom.DefaultNavigation.prototype.strafeLeft=function(e){var t=this.navi;if("game"===t.getType()){var A=5*e._deltaT*t._vf.speed,i=e._yaw/180*Math.PI;e._eyePos.x+=Math.cos(i)*A,e._eyePos.z+=Math.sin(i)*A}},x3dom.DefaultNavigation.prototype.strafeRight=function(e){var t=this.navi;if("game"===t.getType()){var A=5*e._deltaT*t._vf.speed,i=e._yaw/180*Math.PI;e._eyePos.x-=Math.cos(i)*A,e._eyePos.z-=Math.sin(i)*A}},x3dom.DefaultNavigation.prototype.navigateTo=function(e,t){var A=this.navi,i=A.getType(),o=null,s=e._currentInputType==x3dom.InputTypes.NAVIGATION&&("game"===i||e._lastButton>0&&(i.indexOf("fly")>=0||"walk"===i||"helicopter"===i||"looka"===i.substr(0,5)));e._deltaT=t-e._lastTS;var n=function(e,t){return e>0?e<=t?0:e-t:e<=0?e>=-t?0:e+t:void 0},r=function(e,t){return(t<0?-1:1)*Math.pow(e*Math.abs(t),1.65)};if(s){null!==e._pickingInfo.pickObj&&(o={pickPos:e._pickingInfo.pickPos,pickNorm:e._pickingInfo.pickNorm,pickObj:e._pickingInfo.pickObj,firstObj:e._pickingInfo.firstObj,lastObj:e._pickingInfo.lastObj,lastClickObj:e._pickingInfo.lastClickObj,shadowObjectId:e._pickingInfo.shadowObjectId});var a=.25,d=1.6;A._vf.avatarSize.length>2&&(a=A._vf.avatarSize[0],d=A._vf.avatarSize[1],A._vf.avatarSize[2]);var h=e.getViewMatrix(),g=0,l=Math.min(e._width,e._height),I=n((e._pressX-e._lastX)/l,.01),c=n((e._pressY-e._lastY)/l,.01),f=r(1,I),u=r(1,c),C=2&e._lastButton?-1:1;C*=e._deltaT*A._vf.speed;e._deltaT,A._vf.speed;var _=e._deltaT*A._vf.speed*u,m=Math.PI*e._deltaT*f,p=Math.PI*e._deltaT*u;if(!0===e._needNavigationMatrixUpdate){e._needNavigationMatrixUpdate=!1,e._rotMat=x3dom.fields.SFMatrix4f.identity(),e._transMat=x3dom.fields.SFMatrix4f.identity(),e._movement=new x3dom.fields.SFVec3f(0,0,0);var E=0,B=Math.asin(h._02),Q=Math.cos(B);Math.abs(Q)>1e-4&&(E=Math.atan2(-h._12/Q,h._22/Q)),e._flyMat=h.inverse(),e._from=e._flyMat.e3(),e._at=e._from.subtract(e._flyMat.e2()),"helicopter"===i&&(e._at.y=e._from.y),e._up=e._flyMat.e1(),e._pitch=180*E/Math.PI,e._yaw=180*B/Math.PI,e._eyePos=e._from.negate()}var x,v,y,F,D,S=null,w=null,N=null;if("game"===i){e._pitch+=e._dy,e._yaw+=e._dx,e._pitch>=89&&(e._pitch=89),e._pitch<=-89&&(e._pitch=-89),e._yaw>=360&&(e._yaw-=360),e._yaw<0&&(e._yaw=360+e._yaw),e._dx=0,e._dy=0;var T=x3dom.fields.SFMatrix4f.rotationX(e._pitch/180*Math.PI),b=x3dom.fields.SFMatrix4f.rotationY(e._yaw/180*Math.PI),M=x3dom.fields.SFMatrix4f.translation(e._eyePos);e._flyMat=T.mult(b).mult(M);var R=e._flyMat.inverse(),G=R.e3();return w=new x3dom.fields.SFVec3f(0,-1,0),S=G.add(w),w=R.e0().cross(w).normalize(),N=(N=x3dom.fields.SFMatrix4f.lookAt(G,S,w)).inverse(),e._scene._nameSpace.doc.ctx.pickValue(e,e._width/2,e._height/2,e._lastButton,N,e.getProjectionMatrix().mult(N)),e._pickingInfo.pickObj&&(g=e._pickingInfo.pickPos.subtract(G).length(),G.y+=d-g,R.setTranslate(G),e._eyePos=R.e3().negate(),e._flyMat=R.inverse(),e._pickingInfo.pickObj=null),e._scene.getViewpoint().setView(e._flyMat),s}if("helicopter"===i){var U=A.getTypeParams();if(2&e._lastButton){var L=200*_;U[1]+=L,A.setTypeParams(U)}C=1&e._lastButton?300*_:0,p=U[0],e._from.y=U[1],e._at.y=e._from.y,x=x3dom.fields.Quaternion.axisAngle(e._up,m).toMatrix(),v=(v=x3dom.fields.SFMatrix4f.translation(e._from)).mult(x),x=x3dom.fields.SFMatrix4f.translation(e._from.negate()),v=v.mult(x),e._at=v.multMatrixPnt(e._at),D=(F=(y=e._at.subtract(e._from).normalize()).cross(e._up).normalize()).cross(y).normalize(),y=y.multiply(C),e._from=e._from.add(y),e._at=e._at.add(y),x=x3dom.fields.Quaternion.axisAngle(F,p).toMatrix(),v=(v=x3dom.fields.SFMatrix4f.translation(e._from)).mult(x),x=x3dom.fields.SFMatrix4f.translation(e._from.negate());var k=(v=v.mult(x)).multMatrixPnt(e._at);return e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,k,D),e._scene.getViewpoint().setView(e._flyMat.inverse()),s}if(x=x3dom.fields.Quaternion.axisAngle(e._up,m).toMatrix(),v=(v=x3dom.fields.SFMatrix4f.translation(e._from)).mult(x),x=x3dom.fields.SFMatrix4f.translation(e._from.negate()),v=v.mult(x),e._at=v.multMatrixPnt(e._at),D=(F=(y=e._at.subtract(e._from).normalize()).cross(e._up).normalize()).cross(y).normalize(),x=x3dom.fields.Quaternion.axisAngle(F,p).toMatrix(),v=(v=x3dom.fields.SFMatrix4f.translation(e._from)).mult(x),x=x3dom.fields.SFMatrix4f.translation(e._from.negate()),v=v.mult(x),e._at=v.multMatrixPnt(e._at),"looka"!==i.substr(0,5)){var V=e.getProjectionMatrix();"freefly"!==i&&(C<0?((N=new x3dom.fields.SFMatrix4f).setValue(e._last_mat_view.e0(),e._last_mat_view.e1(),e._last_mat_view.e2().negate(),e._last_mat_view.e3()),e._scene._nameSpace.doc.ctx.pickValue(e,e._width/2,e._height/2,e._lastButton,N,V.mult(N))):e._scene._nameSpace.doc.ctx.pickValue(e,e._width/2,e._height/2,e._lastButton),e._pickingInfo.pickObj&&(g=e._pickingInfo.pickPos.subtract(e._from).length())<=a+C&&(C=0)),y=e._at.subtract(e._from).normalize().multiply(C),e._at=e._at.add(y),e._from=e._from.add(y),"walk"===i&&(D.x=0,D.y=1,D.z=0,S=e._from.addScaled(D,-1),w=F.cross(D.negate()).normalize(),N=(N=x3dom.fields.SFMatrix4f.lookAt(e._from,S,w)).inverse(),e._scene._nameSpace.doc.ctx.pickValue(e,e._width/2,e._height/2,e._lastButton,N,V.mult(N)),e._pickingInfo.pickObj&&(g=(d-(g=e._pickingInfo.pickPos.subtract(e._from).length()))/A._vf.walkDamping,e._at=e._at.add(D.multiply(g)),e._from=e._from.add(D.multiply(g)))),e._pickingInfo.pickObj=null}e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,e._at,D),e._scene.getViewpoint().setView(e._flyMat.inverse()),null!==o&&(e._pickingInfo=o)}return s},x3dom.DefaultNavigation.prototype.animateTo=function(e,t,A,i){var o,s=this.navi;e._mixer._isVPtarget=x3dom.isa(t,x3dom.nodeTypes.X3DViewpointNode),e._mixer._isVPtarget&&(t=t.getViewMatrix().mult(t.getCurrentTransform().inverse())),"teleport"!==s._vf.transitionType[0].toLowerCase()&&0!=i&&"game"!==s.getType()&&A&&x3dom.isa(A,x3dom.nodeTypes.X3DViewpointNode)?(o=A.getViewMatrix().mult(A.getCurrentTransform().inverse()).mult(e._transMat).mult(e._rotMat),e._mixer.isActive()&&(A.setView(e._mixer.getEndMatrix()),e._mixer.reset()),e._mixer.beginTime=e._lastTS,arguments.length>=4&&null!=arguments[3]?e._mixer.endTime=e._lastTS+i:e._mixer.endTime=e._lastTS+s._vf.transitionTime,e._mixer.setBeginMatrix(o),e._mixer.setEndMatrix(t),e._scene.getViewpoint().setView(o)):e._scene.getViewpoint().setView(t),e._rotMat=x3dom.fields.SFMatrix4f.identity(),e._transMat=x3dom.fields.SFMatrix4f.identity(),e._movement=new x3dom.fields.SFVec3f(0,0,0),e._needNavigationMatrixUpdate=!0},x3dom.DefaultNavigation.prototype.orthoAnimateTo=function(e,t,A,i){var o=this.navi;i=i||o._vf.transitionTime,e._interpolator.beginValue=A,e._interpolator.endValue=t,e._interpolator.beginTime=e._lastTS,e._interpolator.endTime=e._lastTS+i},x3dom.DefaultNavigation.prototype.resetView=function(e){var t=this.navi;if("teleport"!==t._vf.transitionType[0].toLowerCase()&&"game"!==t.getType()){var A=e._scene.getViewpoint();e._mixer.beginTime=e._lastTS,e._mixer.endTime=e._lastTS+t._vf.transitionTime,e._mixer.setBeginMatrix(e.getViewMatrix()),x3dom.isa(A,x3dom.nodeTypes.OrthoViewpoint)&&this.orthoAnimateTo(e,Math.abs(A._vf.fieldOfView[0]),Math.abs(A._fieldOfView[0]));var i=e._scene.getViewpoint();i.resetView(),i=i.getViewMatrix().mult(i.getCurrentTransform().inverse()),e._mixer.setEndMatrix(i)}else e._scene.getViewpoint().resetView();e.resetNavHelpers(),t._heliUpdated=!1},x3dom.DefaultNavigation.prototype.onDrag=function(e,t,A,i){var o=this.navi,s=o.getType(),n=o.getExplorationMode();if("none"!==s&&0!=n){var r=e._scene.getViewpoint(),a=t-e._lastX,d=A-e._lastY;if(e._dx=a,e._dy=d,e._lastX=t,e._lastY=A,"examine"===s){var h,g,l,I,c=null;if(1&(i&=n)){l=2*d*Math.PI/e._width,I=2*a*Math.PI/e._height,c=e.getViewMatrix();var f=x3dom.fields.SFMatrix4f.rotationX(l),u=x3dom.fields.SFMatrix4f.rotationY(I),C=r.getCenterOfRotation();c.setTranslate(new x3dom.fields.SFVec3f(0,0,0)),e._rotMat=e._rotMat.mult(x3dom.fields.SFMatrix4f.translation(C)).mult(c.inverse()).mult(f).mult(u).mult(c).mult(x3dom.fields.SFMatrix4f.translation(C.negate()))}if(4&i&&(h=e._scene._lastMax.subtract(e._scene._lastMin).length(),h=((h=Math.min(h,r.getFar()))<x3dom.fields.Eps?1:h)*o._vf.speed,g=new x3dom.fields.SFVec3f(h*a/e._width,h*-d/e._height,0),e._movement=e._movement.add(g),c=e.getViewpointMatrix().mult(e._transMat),e._transMat=c.inverse().mult(x3dom.fields.SFMatrix4f.translation(e._movement)).mult(c)),2&i){if(h=e._scene._lastMax.subtract(e._scene._lastMin).length(),h=((h=Math.min(h,r.getFar()))<x3dom.fields.Eps?1:h)*o._vf.speed,g=new x3dom.fields.SFVec3f(0,0,h*(a+d)/e._height),x3dom.isa(r,x3dom.nodeTypes.OrthoViewpoint)&&r.setZoom(Math.abs(r._fieldOfView[0])-g.z),o._vf.typeParams.length>=6){var _=-o._vf.typeParams[5],m=o._vf.typeParams[4];e._movement.z=Math.min(Math.max(e._movement.z,_),m)}e._movement=e._movement.add(g),c=e.getViewpointMatrix().mult(e._transMat),e._transMat=c.inverse().mult(x3dom.fields.SFMatrix4f.translation(e._movement)).mult(c)}e._isMoving=!0}}},x3dom.DefaultNavigation.prototype.onTouchStart=function(e,t,A){},x3dom.DefaultNavigation.prototype.onTouchDrag=function(e,t,A,i,o){if(e._currentInputType==x3dom.InputTypes.NAVIGATION){var s=this.navi,n=e._scene.getViewpoint(),r=s.getExplorationMode();if("examine"===s.getType()&&0!==r){if(i&&4&r){var a=e._scene._lastMax.subtract(e._scene._lastMin).length();a=((a=Math.min(a,n.getFar()))<x3dom.fields.Eps?1:a)*s._vf.speed,i=i.multiply(a),x3dom.isa(n,x3dom.nodeTypes.OrthoViewpoint)&&(n.setZoom(Math.abs(n._fieldOfView[0])-i.z),i.z=0),e._movement=e._movement.add(i),e._transMat=n.getViewMatrix().inverse().mult(x3dom.fields.SFMatrix4f.translation(e._movement)).mult(n.getViewMatrix())}if(o&&1&r){var d=n.getCenterOfRotation(),h=e.getViewMatrix();h.setTranslate(new x3dom.fields.SFVec3f(0,0,0)),e._rotMat=e._rotMat.mult(x3dom.fields.SFMatrix4f.translation(d)).mult(h.inverse()).mult(o).mult(h).mult(x3dom.fields.SFMatrix4f.translation(d.negate()))}e._isMoving=!0}}},x3dom.DefaultNavigation.prototype.onTouchEnd=function(e,t){},x3dom.DefaultNavigation.prototype.onDoubleClick=function(e,t,A){if((!e._doc._x3dElem.hasAttribute("disableDoubleClick")||"true"!==e._doc._x3dElem.getAttribute("disableDoubleClick"))&&"none"!=e._scene.getNavigationInfo().getType()){var i=e._scene._vf.pickMode.toLowerCase();if("color"!=i&&"texcoord"!=i){var o=e._scene.getViewpoint();o.setCenterOfRotation(e._pick),x3dom.debug.logInfo("New center of Rotation:  "+e._pick);var s=e.getViewMatrix().inverse(),n=s.e3(),r=e._pick,a=s.e1(),d=s.e0().cross(a).normalize(),h=d.dot(e._pick.subtract(n));n=r.addScaled(d,-h),s=x3dom.fields.SFMatrix4f.lookAt(n,r,a),x3dom.debug.logInfo("New camera position:  "+n),e.animateTo(s.inverse(),o)}}},x3dom.TurntableNavigation=function(e){x3dom.DefaultNavigation.call(this,e),this.panAxisX=null,this.panAxisY=null,this.panEnabled=!0},x3dom.TurntableNavigation.prototype=Object.create(x3dom.DefaultNavigation.prototype),x3dom.TurntableNavigation.prototype.constructor=x3dom.TurntableNavigation,x3dom.TurntableNavigation.prototype.onDrag=function(e,t,A,i){var o=this.navi;e._flyMat||this.initTurnTable(e,!1);var s=o.getType(),n=o.getExplorationMode();if("none"!==s&&0!=n){var r,a,d=t-e._lastX,h=A-e._lastY,g=null;if(1&(i&=n))r=2*h*Math.PI/e._height,a=2*d*Math.PI/e._width,this.rotate(e,r,a);else if(2&i){var l=(g=((g=e._scene._lastMax.subtract(e._scene._lastMin).length())<x3dom.fields.Eps?1:g)*o._vf.speed)*(d+h)/e._height;this.zoom(e,l)}else if(4&i&&1==this.panEnabled){var I=-(g=((g=e._scene._lastMax.subtract(e._scene._lastMin).length())<x3dom.fields.Eps?1:g)*o._vf.speed*.75)*d/e._width,c=g*h/e._height;this.pan(e,I,c)}e._isMoving=!0,e._dx=d,e._dy=h,e._lastX=t,e._lastY=A}},x3dom.TurntableNavigation.prototype.pan=function(e,t,A){var i=e._scene.getViewpoint();if(null!=this.target){var o=this.target._x3domNode.getVolume();e._up=e._flyMat.e1(),e._from=e._flyMat.e3();var s=n=(n=e._at).addScaled(this.panAxisY,A);n.y>o.max.y||n.y<o.min.y?s=e._at:e._from=e._from.addScaled(this.panAxisY,A),(n=s.addScaled(this.panAxisX,t)).x>o.max.x||n.x<o.min.x?n=s:e._from=e._from.addScaled(this.panAxisX,t),e._at=n,e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,n,e._up),i.setViewAbsolute(e._flyMat.inverse())}else if(null!=this.panAxisX&&null!=this.panAxisY){e._up=e._flyMat.e1(),e._from=e._flyMat.e3();s=n=(n=e._at).addScaled(this.panAxisY,A);e._from=e._from.addScaled(this.panAxisY,A),n=s.addScaled(this.panAxisX,t),e._from=e._from.addScaled(this.panAxisX,t),e._at=n,e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,n,e._up),i.setViewAbsolute(e._flyMat.inverse())}else{e._up=e._flyMat.e1(),e._from=e._flyMat.e3();var n,r=e._up.cross(e._from).normalize(),a=e._from.cross(r).normalize();s=n=(n=e._at).addScaled(a,A);e._from=e._from.addScaled(a,A),n=s.addScaled(r,t),e._from=e._from.addScaled(r,t),e._at=n,e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,n,e._up),i.setViewAbsolute(e._flyMat.inverse())}},x3dom.TurntableNavigation.prototype.rotate=function(e,t,A){var i=e._scene.getViewpoint();e._flyMat=this.calcOrbit(e,t,A),i.setView(e._flyMat.inverse())},x3dom.TurntableNavigation.prototype.zoom=function(e,t){var A=this.navi,i=e._scene.getViewpoint();e._up=e._flyMat.e1(),e._from=e._flyMat.e3();var o=e._at,s=o.subtract(e._from),n=s.length();s=s.normalize();var r=t;A._vf.typeParams[6]&&(r=Math.min(t,n-A._vf.typeParams[6])),A._vf.typeParams[7]&&(r=Math.max(r,n-A._vf.typeParams[7])),e._from=e._from.addScaled(s,r),e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,o,e._up),i.setViewAbsolute(e._flyMat.inverse())},x3dom.TurntableNavigation.prototype.calcOrbit=function(e,t,A,i){var o=this.navi;e._up=e._flyMat.e1(),e._from=e._flyMat.e3();var s,n,r=e._from.subtract(e._at);1==i?(s=A,n=t):(s=Math.atan2(r.x,r.z),n=Math.atan2(Math.sqrt(r.x*r.x+r.z*r.z),r.y),s-=A,n-=t),n=Math.max(o._vf.typeParams[2],Math.min(o._vf.typeParams[3],n)),o._vf.typeParams[4]<=o._vf.typeParams[5]?s=Math.max(o._vf.typeParams[4],Math.min(o._vf.typeParams[5],s)):A>0&&s<o._vf.typeParams[4]&&s>o._vf.typeParams[5]?s=o._vf.typeParams[4]:A<0&&s>o._vf.typeParams[5]&&s<o._vf.typeParams[4]&&(s=o._vf.typeParams[5]);var a=r.length(),d=a*Math.sin(n);r.x=d*Math.sin(s),r.y=a*Math.cos(n),r.z=d*Math.cos(s),r=e._at.add(r),n-=Math.PI/2;var h=Math.sin(n),g=Math.cos(n),l=new x3dom.fields.SFVec3f(h*Math.sin(s),g,h*Math.cos(s));return l.y<0&&(l=l.negate()),x3dom.fields.SFMatrix4f.lookAt(r,e._at,l)},x3dom.TurntableNavigation.prototype.initTurnTable=function(e,t){var A=this.navi;t=null==t||t;var i=e.getViewMatrix();e._rotMat=x3dom.fields.SFMatrix4f.identity(),e._transMat=x3dom.fields.SFMatrix4f.identity();var o=e._scene.getViewpoint(),s=x3dom.fields.SFVec3f.copy(o.getCenterOfRotation());e._flyMat=i.inverse(),e._from=o._vf.position,e._at=s,e._up=new x3dom.fields.SFVec3f(0,1,0),e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,e._at,e._up);var n=i.inverse().e3().subtract(e._at),r=Math.atan2(n.x,n.z),a=Math.atan2(Math.sqrt(n.x*n.x+n.z*n.z),n.y);e._flyMat=this.calcOrbit(e,a,r,!0);var d=0;t&&(d=.2/A._vf.speed,this.animateTo(e,e._flyMat.inverse(),i,d)),e.resetNavHelpers()},x3dom.TurntableNavigation.prototype.onMousePress=function(e,t,A,i){e._flyMat||this.initTurnTable(e,!1)},x3dom.TurntableNavigation.prototype.init=function(e,t){this.initTurnTable(e,!0)},x3dom.TurntableNavigation.prototype.resetView=function(e){e._mixer.beginTime=e._lastTS,e._mixer.endTime=e._lastTS+this.navi._vf.transitionTime,e._mixer.setBeginMatrix(e.getViewMatrix());var t=e._scene.getViewpoint();t.resetView(),t=x3dom.fields.SFMatrix4f.lookAt(t._vf.position,t.getCenterOfRotation(),new x3dom.fields.SFVec3f(0,1,0)),e._mixer.setEndMatrix(t.inverse()),this.updateFlyMat(e)},x3dom.TurntableNavigation.prototype.updateFlyMat=function(e,t,A){e._flyMat||this.initTurnTable(e,!1);var i=e.getViewMatrix(),o=t;null!=o&&x3dom.isa(o,x3dom.nodeTypes.X3DViewpointNode)||(o=e._scene.getViewpoint());var s=x3dom.fields.SFVec3f.copy(o.getCenterOfRotation());e._flyMat=i.inverse(),e._from=A?A.inverse().e3():o._vf.position,e._at=s,e._up=new x3dom.fields.SFVec3f(0,1,0),e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,e._at,e._up);var n=i.inverse().e3().subtract(e._at),r=Math.atan2(n.x,n.z),a=Math.atan2(Math.sqrt(n.x*n.x+n.z*n.z),n.y);e._flyMat=this.calcOrbit(e,a,r,!0)},x3dom.TurntableNavigation.prototype.animateTo=function(e,t,A,i){var o,s=this.navi;o=x3dom.isa(t,x3dom.nodeTypes.X3DViewpointNode)?x3dom.fields.SFMatrix4f.lookAt(t._vf.position,t.getCenterOfRotation(),new x3dom.fields.SFVec3f(0,1,0)):t,"teleport"!==s._vf.transitionType[0].toLowerCase()&&0!=i&&"game"!==s.getType()?A&&x3dom.isa(A,x3dom.nodeTypes.X3DViewpointNode)?(A=A.getViewMatrix().mult(A.getCurrentTransform().inverse()).mult(e._transMat).mult(e._rotMat),e._mixer.beginTime=e._lastTS,arguments.length>=4&&null!=arguments[3]?e._mixer.endTime=e._lastTS+i:e._mixer.endTime=e._lastTS+s._vf.transitionTime,e._mixer.setBeginMatrix(A),e._mixer.setEndMatrix(o),e._scene.getViewpoint().setViewAbsolute(A)):A?(e._mixer.beginTime=e._lastTS,arguments.length>=4&&null!=arguments[3]?e._mixer.endTime=e._lastTS+i:e._mixer.endTime=e._lastTS+s._vf.transitionTime,e._mixer.setBeginMatrix(A),e._mixer.setEndMatrix(o),e._scene.getViewpoint().setViewAbsolute(A)):e._scene.getViewpoint().setViewAbsolute(o):e._scene.getViewpoint().setViewAbsolute(t),e._rotMat=x3dom.fields.SFMatrix4f.identity(),e._transMat=x3dom.fields.SFMatrix4f.identity(),e._movement=new x3dom.fields.SFVec3f(0,0,0),e._needNavigationMatrixUpdate=!0,this.updateFlyMat(e,t,o)},x3dom.TurntableNavigation.prototype.onTouchStart=function(e,t,A){e._numTouches=t.touches.length,e._lastX=t.touches[0].screenX,e._lastY=t.touches[0].screenY},x3dom.TurntableNavigation.prototype.onTouchDrag=function(e,t,A,i,o){if(e._currentInputType==x3dom.InputTypes.NAVIGATION)if(1==t.touches.length){var s=t.touches[0].screenX-e._lastX,n=2*(t.touches[0].screenY-e._lastY)*Math.PI/e._height,r=2*s*Math.PI/e._width;this.rotate(e,n,r),e._lastX=t.touches[0].screenX,e._lastY=t.touches[0].screenY}else t.touches.length>=2&&(1==this.panEnabled&&this.pan(e,4*-i.x,4*-i.y),this.zoom(e,4*i.z))},x3dom.TurntableNavigation.prototype.onTouchEnd=function(e,t,A){2==e._numTouches&&1==t.touches.length&&(e._lastX=t.touches[0].screenX,e._lastY=t.touches[0].screenY),e._numTouches=t.touches.length},x3dom.TurntableNavigation.prototype.setPanTarget=function(e){this.target=e},x3dom.TurntableNavigation.prototype.setPanAxis=function(e,t){this.panAxisX=e,this.panAxisY=t},x3dom.TurntableNavigation.prototype.setPanEnabled=function(e){this.panEnabled=e},x3dom.TurntableNavigation.prototype.onDoubleClick=function(e,t,A){if((!e._doc._x3dElem.hasAttribute("disableDoubleClick")||"true"!==e._doc._x3dElem.getAttribute("disableDoubleClick"))&&"none"!=e._scene.getNavigationInfo().getType()){var i=e._scene._vf.pickMode.toLowerCase();if("color"!=i&&"texcoord"!=i){e._scene.getViewpoint().setCenterOfRotation(e._pick),x3dom.debug.logInfo("New center of Rotation:  "+e._pick);var o=e.getViewMatrix().inverse();e._from=o.e3(),e._up=o.e1(),e._at=e._pick,e._flyMat=x3dom.fields.SFMatrix4f.lookAt(e._from,e._at,e._up);var s=e._from.subtract(e._at),n=Math.atan2(s.x,s.z),r=Math.atan2(Math.sqrt(s.x*s.x+s.z*s.z),s.y);e._flyMat=this.calcOrbit(e,r,n,!0),x3dom.debug.logInfo("New camera position:  "+e._from),this.animateTo(e,e._flyMat.inverse(),e.getViewMatrix())}}},x3dom.WalkNavigation=function(e){x3dom.DefaultNavigation.call(this,e)},x3dom.WalkNavigation.prototype=Object.create(x3dom.DefaultNavigation.prototype),x3dom.WalkNavigation.prototype.constructor=x3dom.WalkNavigation,x3dom.WalkNavigation.prototype.onDrag=function(e,t,A,i){var o=this.navi,s=o.getType();if(0!==o.getExplorationMode()){e._scene.getViewpoint();var n=t-e._lastX,r=A-e._lastY;e._dx=n,e._dy=r,e._lastX=t,e._lastY=A,"walk"!==s&&console.log("#### CHECK: in WalkNavigation but nav. type is not walk !")}},x3dom.registerNodeType("X3DFontStyleNode","Text",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.X3DFontStyleNode.superClass.call(this,e)}))),x3dom.registerNodeType("FontStyle","Text",defineClass(x3dom.nodeTypes.X3DFontStyleNode,(function(e){x3dom.nodeTypes.FontStyle.superClass.call(this,e),this.addField_MFString(e,"family",["SERIF"]),this.addField_SFBool(e,"horizontal",!0),this.addField_MFString(e,"justify",["BEGIN","FIRST"]),this.addField_SFString(e,"language",""),this.addField_SFBool(e,"leftToRight",!0),this.addField_SFFloat(e,"size",1),this.addField_SFFloat(e,"spacing",1),this.addField_SFString(e,"style","PLAIN"),this.addField_SFBool(e,"topToBottom",!0),this.addField_SFFloat(e,"quality",2)}),{fieldChanged:function(e){"family"!=e&&"horizontal"!=e&&"justify"!=e&&"language"!=e&&"leftToRight"!=e&&"size"!=e&&"spacing"!=e&&"style"!=e&&"topToBottom"!=e||this._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){e.setAllDirty()}))}))}})),x3dom.nodeTypes.FontStyle.defaultNode=function(){return x3dom.nodeTypes.FontStyle._defaultNode||(x3dom.nodeTypes.FontStyle._defaultNode=new x3dom.nodeTypes.FontStyle,x3dom.nodeTypes.FontStyle._defaultNode.nodeChanged()),x3dom.nodeTypes.FontStyle._defaultNode},x3dom.registerNodeType("Text","Text",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.Text.superClass.call(this,e),this.addField_MFString(e,"string",[]),this.addField_MFFloat(e,"length",[]),this.addField_SFFloat(e,"maxExtent",0),this.addField_SFNode("fontStyle",x3dom.nodeTypes.X3DFontStyleNode),this._mesh._positions[0]=[0,0,0,1,0,0,1,1,0,0,1,0],this._mesh._normals[0]=[0,0,1,0,0,1,0,0,1,0,0,1],this._mesh._texCoords[0]=[0,0,1,0,1,1,0,1],this._mesh._colors[0]=[],this._mesh._indices[0]=[0,1,2,2,3,0],this._mesh._invalidate=!0,this._mesh._numFaces=2,this._mesh._numCoords=4}),{nodeChanged:function(){this._cf.fontStyle.node||this.addChild(x3dom.nodeTypes.FontStyle.defaultNode()),this.invalidateVolume()},fieldChanged:function(e){"string"!=e&&"length"!=e&&"maxExtent"!=e||(this.invalidateVolume(),this._parentNodes.forEach((function(e){e.setAllDirty()})))},validateGLObject:function(){this._parentNodes.forEach((function(e){e._dirty.texture=!1})),this._nameSpace.doc.needRender=!0}})),x3dom.registerNodeType("X3DSoundNode","Sound",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DSoundNode.superClass.call(this,e)}))),x3dom.registerNodeType("Sound","Sound",defineClass(x3dom.nodeTypes.X3DSoundNode,(function(e){x3dom.nodeTypes.Sound.superClass.call(this,e),this.addField_SFNode("source",x3dom.nodeTypes.X3DSoundSourceNode)}),{nodeChanged:function(){if(!this._cf.source.node&&this._xmlNode){x3dom.debug.logInfo("No AudioClip child node given, searching for &lt;audio&gt; elements...");try{this._xmlNode.childNodes.forEach((function(e){if(1===e.nodeType&&(x3dom.debug.logInfo("### Found &lt;"+e.nodeName+"&gt; tag."),"audio"===e.localName.toLowerCase())){var t=e.getAttribute("loop");t=!!t&&"loop"===t.toLowerCase();var A=e.cloneNode(!1);e.parentNode.removeChild(e),e=null,"Microsoft Internet Explorer"!=navigator.appName&&document.body.appendChild(A);A.addEventListener("canplaythrough",(function(){A.play()}),!0),A.addEventListener("ended",(function(){t&&A.play()}),!0)}}))}catch(e){x3dom.debug.logException(e)}}}})),x3dom.registerNodeType("X3DSoundSourceNode","Sound",defineClass(x3dom.nodeTypes.X3DTimeDependentNode,(function(e){x3dom.nodeTypes.X3DSoundSourceNode.superClass.call(this,e)}))),x3dom.registerNodeType("AudioClip","Sound",defineClass(x3dom.nodeTypes.X3DSoundSourceNode,(function(e){x3dom.nodeTypes.AudioClip.superClass.call(this,e),this.addField_MFString(e,"url",[]),this.addField_SFBool(e,"enabled",!1),this.addField_SFBool(e,"loop",!1),this._audio=document.createElement("audio"),"Microsoft Internet Explorer"!=navigator.appName&&document.body.appendChild(this._audio),this._sources=[]}),{nodeChanged:function(){this._createSources=function(){this._sources=[];for(var e=0;e<this._vf.url.length;e++){var t=this._nameSpace.getURL(this._vf.url[e]);x3dom.debug.logInfo("Adding sound file: "+t);var A=document.createElement("source");A.setAttribute("src",t),this._sources.push(A),this._audio.appendChild(A)}};var e=this,t=0;this._startAudio=function(){!0===e._vf.enabled&&e._audio.play().then((function(e){clearTimeout(t)})).catch((function(A){x3dom.debug.logError(A),t=setTimeout(e._startAudio,100)}))},this._stopAudio=function(){e._audio.pause()},this._audioEnded=function(){!0===e._vf.enabled&&!0===e._vf.loop&&e._startAudio()};this._audio.addEventListener("canplaythrough",this._startAudio,!0),this._audio.addEventListener("ended",this._audioEnded,!0),this._audio.addEventListener("error",(function(e){x3dom.debug.logWarning("MediaEvent error:"+e)}),!0),this._audio.addEventListener("pause",this._audioEnded,!0),this._createSources()},fieldChanged:function(e){if("enabled"===e)!0===this._vf.enabled?this._startAudio():this._stopAudio();else if("loop"===e);else if("url"===e){for(this._stopAudio();this._audio.hasChildNodes();)this._audio.removeChild(this._audio.firstChild);for(var t=0;t<this._vf.url.length;t++){var A=this._nameSpace.getURL(this._vf.url[t]);x3dom.debug.logInfo("Adding sound file: "+A);var i=document.createElement("source");i.setAttribute("src",A),this._audio.appendChild(i)}this._audio.load()}},shutdown:function(){if(this._audio){for(this._audio.pause();this._audio.hasChildNodes();)this._audio.removeChild(this._audio.firstChild);document.body.removeChild(this._audio),this._audio=null}}})),x3dom.registerNodeType("X3DTextureTransformNode","Texturing",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.X3DTextureTransformNode.superClass.call(this,e)}),{texTransformMatrix:function(){return this._trafo}})),x3dom.registerNodeType("TextureTransform","Texturing",defineClass(x3dom.nodeTypes.X3DTextureTransformNode,(function(e){x3dom.nodeTypes.TextureTransform.superClass.call(this,e),this.addField_SFVec2f(e,"center",0,0),this.addField_SFFloat(e,"rotation",0),this.addField_SFVec2f(e,"scale",1,1),this.addField_SFVec2f(e,"translation",0,0),this._calcTrafo()}),{fieldChanged:function(e){"center"!=e&&"rotation"!=e&&"scale"!=e&&"translation"!=e||this._calcTrafo()},_calcTrafo:function(){var e=new x3dom.fields.SFVec3f(-this._vf.center.x,-this._vf.center.y,0),t=new x3dom.fields.SFVec3f(this._vf.center.x,this._vf.center.y,0),A=new x3dom.fields.SFVec3f(this._vf.translation.x,this._vf.translation.y,0),i=new x3dom.fields.SFVec3f(this._vf.scale.x,this._vf.scale.y,0);this._trafo=x3dom.fields.SFMatrix4f.translation(e).mult(x3dom.fields.SFMatrix4f.scale(i)).mult(x3dom.fields.SFMatrix4f.rotationZ(this._vf.rotation)).mult(x3dom.fields.SFMatrix4f.translation(t.add(A)))}})),x3dom.registerNodeType("MatrixTextureTransform","Texturing",defineClass(x3dom.nodeTypes.X3DTextureTransformNode,(function(e){x3dom.nodeTypes.MatrixTextureTransform.superClass.call(this,e),this.addField_SFMatrix4f(e,"matrix",1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this._trafo=this._vf.matrix.transpose()}),{fieldChanged:function(e){"matrix"==e&&(this._trafo=this._vf.matrix.transpose())}})),x3dom.registerNodeType("TextureProperties","Texturing",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.TextureProperties.superClass.call(this,e),this.addField_SFFloat(e,"anisotropicDegree",1),this.addField_SFColorRGBA(e,"borderColor",0,0,0,0),this.addField_SFInt32(e,"borderWidth",0),this.addField_SFString(e,"boundaryModeS","REPEAT"),this.addField_SFString(e,"boundaryModeT","REPEAT"),this.addField_SFString(e,"boundaryModeR","REPEAT"),this.addField_SFString(e,"magnificationFilter","FASTEST"),this.addField_SFString(e,"minificationFilter","FASTEST"),this.addField_SFString(e,"textureCompression","FASTEST"),this.addField_SFFloat(e,"texturePriority",0),this.addField_SFBool(e,"generateMipMaps",!1)}),{fieldChanged:function(e){this._vf.hasOwnProperty(e)&&(this._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){e._dirty.texture=!0}))}))})),this._nameSpace.doc.needRender=!0)}})),x3dom.registerNodeType("X3DTextureNode","Texturing",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.X3DTextureNode.superClass.call(this,e),this.addField_SFInt32(e,"origChannelCount",0),this.addField_MFString(e,"url",[]),this.addField_SFBool(e,"repeatS",!0),this.addField_SFBool(e,"repeatT",!0),this.addField_SFBool(e,"scale",!0),this.addField_SFString(e,"crossOrigin",""),this.addField_SFNode("textureProperties",x3dom.nodeTypes.TextureProperties),this.addField_SFBool(e,"flipY",!1),this.addField_SFInt32(e,"channel",0),this._needPerFrameUpdate=!1,this._isCanvas=!1,this._type="diffuseMap",this._blending=1==this._vf.origChannelCount||2==this._vf.origChannelCount}),{invalidateGLObject:function(){this._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)?e._dirty.texture=!0:e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)?e._dirty.texture=!0:e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)&&(e._dirty.texture=!0)}))}))}))})),this._nameSpace.doc.needRender=!0},validateGLObject:function(){this._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)?e._dirty.texture=!1:e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)?e._dirty.texture=!1:e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)&&(e._dirty.texture=!1)}))}))}))})),this._nameSpace.doc.needRender=!0},parentAdded:function(e){e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.Shape)?e._dirty.texture=!0:e._parentNodes.forEach((function(e){e._dirty.texture=!0}))}))},parentRemoved:function(e){e._parentNodes.forEach((function(e){x3dom.isa(e,x3dom.nodeTypes.X3DShapeNode)?e._dirty.texture=!0:e._parentNodes.forEach((function(e){e._dirty.texture=!0}))}))},fieldChanged:function(e){if("url"==e||"origChannelCount"==e||"repeatS"==e||"repeatT"==e||"scale"==e||"crossOrigin"==e||"image"==e){var t=this;t._blending=1==t._vf.origChannelCount||2==t._vf.origChannelCount,this._parentNodes.forEach((function(e){if(x3dom.isa(e,x3dom.nodeTypes.X3DAppearanceNode))e.nodeChanged();else if(x3dom.isa(e,x3dom.nodeTypes.MultiTexture))e._parentNodes.forEach((function(e){e.nodeChanged()}));else if(x3dom.isa(e,x3dom.nodeTypes.ComposedCubeMapTexture))e._parentNodes.forEach((function(e){e.nodeChanged()}));else if(x3dom.isa(e,x3dom.nodeTypes.PhysicalMaterial))e._parentNodes.forEach((function(e){e.nodeChanged()}));else if(void 0!==x3dom.nodeTypes.X3DVolumeDataNode)if(x3dom.isa(e,x3dom.nodeTypes.X3DVolumeRenderStyleNode)){if(t._xmlNode&&t._xmlNode.hasAttribute("containerField"))if(e._volumeDataParent)e._volumeDataParent._dirty.texture=!0;else{for(var A=e._parentNodes[0];!x3dom.isa(A,x3dom.nodeTypes.X3DVolumeDataNode)&&x3dom.isa(A,x3dom.nodeTypes.X3DNode);)A=A._parentNodes[0];x3dom.isa(A,x3dom.nodeTypes.X3DNode)&&(A._dirty.texture=!0)}}else x3dom.isa(e,x3dom.nodeTypes.X3DVolumeDataNode)&&t._xmlNode&&t._xmlNode.hasAttribute("containerField")&&(e._dirty.texture=!0)}))}},getTexture:function(e){return 0===e?this:null},size:function(){return 1},setOrigChannelCount:function(e){this._parentNodes.forEach(function(t){"auto"==t._origSortType&&0==this._vf.origChannelCount&&(2!=e&&4!=e||(t._vf.sortType="transparent"))}.bind(this)),this._vf.origChannelCount=e,this.fieldChanged("origChannelCount")},getOrigChannelCount:function(){return this._vf.origChannelCount}})),x3dom.registerNodeType("MultiTexture","Texturing",defineClass(x3dom.nodeTypes.X3DTextureNode,(function(e){x3dom.nodeTypes.MultiTexture.superClass.call(this,e),this.addField_MFNode("texture",x3dom.nodeTypes.X3DTextureNode)}),{getTexture:function(e){return e>=0&&e<this._cf.texture.nodes.length?this._cf.texture.nodes[e]:null},getTextures:function(){return this._cf.texture.nodes},size:function(){return this._cf.texture.nodes.length}})),x3dom.registerNodeType("Texture","Texturing",defineClass(x3dom.nodeTypes.X3DTextureNode,(function(e){x3dom.nodeTypes.Texture.superClass.call(this,e),this.addField_SFBool(e,"hideChildren",!0),this._video=null,this._intervalID=null,this._canvas=null}),{nodeChanged:function(){if(!(this._vf.url.length&&this._vf.url[0].length||!this._xmlNode)){x3dom.debug.logInfo("No Texture URL given, searching for &lt;img&gt; elements...");var e=this;try{this._xmlNode.childNodes.forEach((function(t){if(1===t.nodeType){var A=t.getAttribute("src");if(A){if(e._vf.url.push(A),x3dom.debug.logInfo(e._vf.url[e._vf.url.length-1]),"video"===t.localName.toLowerCase())e._needPerFrameUpdate=!0,e._video=document.createElement("video"),e._video.setAttribute("preload","auto"),e._video.setAttribute("muted","muted"),document.getElementsByTagName("body")[0].appendChild(e._video),e._video.style.display="none",e._video.style.visibility="hidden"}else"canvas"===t.localName.toLowerCase()&&(e._needPerFrameUpdate=!0,e._isCanvas=!0,e._canvas=t);t.style&&e._vf.hideChildren&&(t.style.display="none",t.style.visibility="hidden"),x3dom.debug.logInfo("### Found &lt;"+t.nodeName+"&gt; tag.")}}))}catch(e){x3dom.debug.logException(e)}}},shutdown:function(){if(this._video){for(this._video.pauseVideo();this._video.hasChildNodes();)this._video.removeChild(this._video.firstChild);this._video.startVideo&&(this._video.startVideo=null),this._video.pauseVideo&&(this._video.pauseVideo=null),this._video=null}}})),x3dom.registerNodeType("RenderedTexture","Texturing",defineClass(x3dom.nodeTypes.X3DTextureNode,(function(e){x3dom.nodeTypes.RenderedTexture.superClass.call(this,e),e?e.doc._nodeBag.renderTextures.push(this):x3dom.debug.logWarning("RenderedTexture: No runtime context found!"),this.addField_SFNode("viewpoint",x3dom.nodeTypes.X3DViewpointNode),this.addField_SFNode("background",x3dom.nodeTypes.X3DBackgroundNode),this.addField_SFNode("fog",x3dom.nodeTypes.X3DFogNode),this.addField_SFNode("scene",x3dom.nodeTypes.X3DNode),this.addField_MFNode("excludeNodes",x3dom.nodeTypes.X3DNode),this.addField_MFInt32(e,"dimensions",[128,128,4]),this.addField_SFString(e,"update","NONE"),this.addField_SFBool(e,"showNormals",!1),this.addField_SFString(e,"stereoMode","NONE"),this.addField_SFFloat(e,"interpupillaryDistance",.064),this.addField_SFFloat(e,"eyeToScreenDistance",.041),this.addField_SFFloat(e,"vScreenSize",.07074),this.addField_SFVec3f(e,"lensCenter",.15197,0,0),this.addField_SFBool(e,"depthMap",!1),this.addField_SFBool(e,"oculusRiftVersion",1),x3dom.debug.assert(this._vf.dimensions.length>=3,"RenderedTexture.dimensions requires at least 3 entries."),this._clearParents=!0,this._needRenderUpdate=!0,this.checkDepthTextureSupport=function(){this._vf.depthMap&&null===x3dom.caps.DEPTH_TEXTURE&&x3dom.debug.logWarning("RenderedTexture Node: depth texture extension not supported")},this.checkDepthTextureSupport()}),{nodeChanged:function(){this._clearParents=!0,this._needRenderUpdate=!0},fieldChanged:function(e){switch(e){case"excludeNodes":this._clearParents=!0;break;case"update":"NEXT_FRAME_ONLY"!=this._vf.update.toUpperCase()&&"ALWAYS"!=this._vf.update.toUpperCase()||(this._needRenderUpdate=!0);break;case"depthMap":this.checkDepthTextureSupport(),this._x3domTexture.updateTexture(),this._needRenderUpdate=!0}},getViewMatrix:function(){if(this._clearParents&&this._cf.excludeNodes.nodes.length){var e=this;this._cf.excludeNodes.nodes.forEach((function(t){for(var A=0,i=t._parentNodes.length;A<i;A++)t._parentNodes[A]===e&&(t._parentNodes.splice(A,1),t.parentRemoved(e))})),this._clearParents=!1}var t=this._cf.scene.node,A=this._nameSpace.doc._scene,i=A.getViewpoint(),o=this._cf.viewpoint.node,s=null;if(null===o||o===i)s=this._nameSpace.doc._viewarea.getViewMatrix();else if(t&&t!==A)s=o.getViewMatrix();else{var n=o.getCurrentTransform();s=o.getViewMatrix().mult(n.inverse())}var r=this._vf.stereoMode.toUpperCase();if("NONE"!=r){var a=this._vf.interpupillaryDistance/2;"RIGHT_EYE"==r&&(a=-a),s=new x3dom.fields.SFMatrix4f(1,0,0,a,0,1,0,0,0,0,1,0,0,0,0,1).mult(s)}return s},getProjectionMatrix:function(){var e,t=this._nameSpace.doc,A=t._scene.getViewpoint(),i=this._cf.viewpoint.node,o=null,s=this._vf.dimensions[0],n=this._vf.dimensions[1],r=this._vf.stereoMode.toUpperCase(),a="NONE"!=r;if(null===i||i===A?(o=x3dom.fields.SFMatrix4f.copy(t._viewarea.getProjectionMatrix()),a?(e=2*Math.atan(this._vf.vScreenSize/(2*this._vf.eyeToScreenDistance)),e=1/Math.tan(e/2)):e=1/Math.tan(A._vf.fieldOfView/2),o._00=e/(s/n),o._11=e):o=i.getProjectionMatrix(s/n),a){var d=this._vf.lensCenter.copy();"RIGHT_EYE"==r&&(d.x=-d.x),o=new x3dom.fields.SFMatrix4f(1,0,0,d.x,0,1,0,d.y,0,0,1,d.z,0,0,0,1).mult(o)}return o},getWCtoCCMatrix:function(){var e=this.getViewMatrix();return this.getProjectionMatrix().mult(e)},parentRemoved:function(e){if(0===this._parentNodes.length){var t=this.findX3DDoc();if(t)for(var A=0,i=t._nodeBag.renderTextures.length;A<i;A++)t._nodeBag.renderTextures[A]===this&&t._nodeBag.renderTextures.splice(A,1)}this._cf.scene.node&&this._cf.scene.node.parentRemoved(this)},requirePingPong:function(){return!1}})),x3dom.registerNodeType("RefinementTexture","Texturing",defineClass(x3dom.nodeTypes.RenderedTexture,(function(e){if(x3dom.nodeTypes.RefinementTexture.superClass.call(this,e),this.addField_SFString(e,"stamp0","gpuii/stamps/0.gif"),this.addField_SFString(e,"stamp1","gpuii/stamps/1.gif"),this.addField_SFBool(e,"autoRefinement",!0),this.addField_SFString(e,"format","jpg"),this.addField_SFInt32(e,"iterations",7),this.addField_SFInt32(e,"maxLevel",this._vf.iterations),this._vf.iterations%2==0){var t=this._vf.stamp0;this._vf.stamp0=this._vf.stamp1,this._vf.stamp1=t}this._vf.iterations=this._vf.iterations>11?11:this._vf.iterations,this._vf.iterations=this._vf.iterations<3?3:this._vf.iterations,this._vf.maxLevel=this._vf.maxLevel>11?11:this._vf.maxLevel,this._vf.maxLevel=this._vf.maxLevel<3?3:this._vf.maxLevel,this._vf.maxLevel=this._vf.maxLevel>this._vf.iterations?this._vf.iterations:this._vf.maxLevel;var A=[{x:4,y:8},{x:8,y:8},{x:8,y:16},{x:16,y:16},{x:16,y:32},{x:32,y:32},{x:32,y:64},{x:64,y:64},{x:64,y:128}];this._repeat=new x3dom.fields.SFVec2f(this._vf.dimensions[0]/A[this._vf.iterations-3].x,this._vf.dimensions[1]/A[this._vf.iterations-3].y),this._renderedImage=0,this._currLoadLevel=0,this._loadLevel=1}),{nextLevel:function(){this._loadLevel<this._vf.maxLevel&&(this._loadLevel++,this._nameSpace.doc.needRender=!0)},requirePingPong:function(){return this._currLoadLevel<=this._vf.maxLevel&&this._renderedImage<this._loadLevel}})),x3dom.registerNodeType("PixelTexture","Texturing",defineClass(x3dom.nodeTypes.X3DTextureNode,(function(e){x3dom.nodeTypes.PixelTexture.superClass.call(this,e),this.addField_SFImage(e,"image",0,0,0)}),{getWidth:function(){return this._vf.image.width},getHeight:function(){return this._vf.image.height},getComponents:function(){return this._vf.image.comp},setPixel:function(e,t,A,i){i=null==i||i,this._x3domTexture?(this._x3domTexture.setPixel(e,t,[255*A.r,255*A.g,255*A.b,255*A.a],i),this._vf.image.setPixel(e,t,A)):(this._vf.image.setPixel(e,t,A),i&&this.invalidateGLObject())},getPixel:function(e,t){return this._vf.image.getPixel(e,t)},setPixels:function(e,t){t=null==t||t,this._vf.image.setPixels(e),t&&this.invalidateGLObject()},getPixels:function(){return this._vf.image.getPixels()}})),x3dom.registerNodeType("ImageTexture","Texturing",defineClass(x3dom.nodeTypes.Texture,(function(e){x3dom.nodeTypes.ImageTexture.superClass.call(this,e)}))),x3dom.registerNodeType("MovieTexture","Texturing",defineClass(x3dom.nodeTypes.Texture,(function(e){x3dom.nodeTypes.MovieTexture.superClass.call(this,e),this.addField_SFBool(e,"loop",!1),this.addField_SFFloat(e,"speed",1),this.addField_SFTime(e,"pauseTime",0),this.addField_SFFloat(e,"pitch",1),this.addField_SFTime(e,"resumeTime",0),this.addField_SFTime(e,"startTime",0),this.addField_SFTime(e,"stopTime",0)}))),x3dom.registerNodeType("X3DTextureCoordinateNode","Texturing",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,(function(e){x3dom.nodeTypes.X3DTextureCoordinateNode.superClass.call(this,e)}),{fieldChanged:function(e){"texCoord"!==e&&"point"!==e&&"parameter"!==e&&"mode"!==e||this._parentNodes.forEach((function(e){e.fieldChanged("texCoord")}))},parentAdded:function(e){e._mesh&&e._cf.texCoord.node!==this&&e.fieldChanged("texCoord")}})),x3dom.registerNodeType("TextureCoordinate","Texturing",defineClass(x3dom.nodeTypes.X3DTextureCoordinateNode,(function(e){x3dom.nodeTypes.TextureCoordinate.superClass.call(this,e),this.addField_MFVec2f(e,"point",[])}))),x3dom.registerNodeType("TextureCoordinateGenerator","Texturing",defineClass(x3dom.nodeTypes.X3DTextureCoordinateNode,(function(e){x3dom.nodeTypes.TextureCoordinateGenerator.superClass.call(this,e),this.addField_SFString(e,"mode","SPHERE"),this.addField_MFFloat(e,"parameter",[])}))),x3dom.registerNodeType("MultiTextureCoordinate","Texturing",defineClass(x3dom.nodeTypes.X3DTextureCoordinateNode,(function(e){x3dom.nodeTypes.MultiTextureCoordinate.superClass.call(this,e),this.addField_MFNode("texCoord",x3dom.nodeTypes.X3DTextureCoordinateNode)}))),x3dom.registerNodeType("ImageTextureAtlas","Texturing",defineClass(x3dom.nodeTypes.Texture,(function(e){x3dom.nodeTypes.ImageTextureAtlas.superClass.call(this,e),this.addField_SFInt32(e,"numberOfSlices",0),this.addField_SFInt32(e,"slicesOverX",0),this.addField_SFInt32(e,"slicesOverY",0)}))),x3dom.registerNodeType("X3DEnvironmentTextureNode","CubeMapTexturing",defineClass(x3dom.nodeTypes.X3DTextureNode,(function(e){x3dom.nodeTypes.X3DEnvironmentTextureNode.superClass.call(this,e)}),{getTexUrl:function(){return[]},getTexSize:function(){return-1}})),x3dom.registerNodeType("ComposedCubeMapTexture","CubeMapTexturing",defineClass(x3dom.nodeTypes.X3DEnvironmentTextureNode,(function(e){x3dom.nodeTypes.ComposedCubeMapTexture.superClass.call(this,e),this.addField_SFNode("back",x3dom.nodeTypes.Texture),this.addField_SFNode("front",x3dom.nodeTypes.Texture),this.addField_SFNode("bottom",x3dom.nodeTypes.Texture),this.addField_SFNode("top",x3dom.nodeTypes.Texture),this.addField_SFNode("left",x3dom.nodeTypes.Texture),this.addField_SFNode("right",x3dom.nodeTypes.Texture),this._type="environmentMap"}),{getTexUrl:function(){return[this._nameSpace.getURL(this._cf.back.node._vf.url[0]),this._nameSpace.getURL(this._cf.front.node._vf.url[0]),this._nameSpace.getURL(this._cf.bottom.node._vf.url[0]),this._nameSpace.getURL(this._cf.top.node._vf.url[0]),this._nameSpace.getURL(this._cf.left.node._vf.url[0]),this._nameSpace.getURL(this._cf.right.node._vf.url[0])]}})),x3dom.registerNodeType("GeneratedCubeMapTexture","CubeMapTexturing",defineClass(x3dom.nodeTypes.X3DEnvironmentTextureNode,(function(e){x3dom.nodeTypes.GeneratedCubeMapTexture.superClass.call(this,e),this.addField_SFInt32(e,"size",128),this.addField_SFString(e,"update","NONE"),this._type="cubeMap",x3dom.debug.logWarning("GeneratedCubeMapTexture NYI")}),{getTexSize:function(){return this._vf.size}})),x3dom.registerNodeType("Uniform","Shaders",defineClass(x3dom.nodeTypes.Field,(function(e){x3dom.nodeTypes.Uniform.superClass.call(this,e)}))),x3dom.registerNodeType("SurfaceShaderTexture","Shaders",defineClass(x3dom.nodeTypes.X3DTextureNode,(function(e){x3dom.nodeTypes.SurfaceShaderTexture.superClass.call(this,e),this.addField_SFInt32(e,"textureCoordinatesId",0),this.addField_SFString(e,"channelMask","DEFAULT"),this.addField_SFBool(e,"isSRGB",!1),this.addField_SFNode("texture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("textureTransform",x3dom.nodeTypes.X3DTextureTransformNode)}))),x3dom.registerNodeType("X3DShaderNode","Shaders",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,(function(e){x3dom.nodeTypes.X3DShaderNode.superClass.call(this,e),this.addField_SFString(e,"language","")}))),x3dom.registerNodeType("CommonSurfaceShader","Shaders",defineClass(x3dom.nodeTypes.X3DShaderNode,(function(e){x3dom.nodeTypes.CommonSurfaceShader.superClass.call(this,e),this.addField_SFInt32(e,"tangentTextureCoordinatesId",-1),this.addField_SFInt32(e,"binormalTextureCoordinatesId",-1),this.addField_SFVec3f(e,"emissiveFactor",0,0,0),this.addField_SFInt32(e,"emissiveTextureId",-1),this.addField_SFInt32(e,"emissiveTextureCoordinatesId",0),this.addField_SFString(e,"emissiveTextureChannelMask","rgb"),this.addField_SFVec3f(e,"ambientFactor",.2,.2,.2),this.addField_SFInt32(e,"ambientTextureId",-1),this.addField_SFInt32(e,"ambientTextureCoordinatesId",0),this.addField_SFString(e,"ambientTextureChannelMask","rgb"),this.addField_SFVec3f(e,"diffuseFactor",.8,.8,.8),this.addField_SFInt32(e,"diffuseTextureId",-1),this.addField_SFInt32(e,"diffuseTextureCoordinatesId",0),this.addField_SFString(e,"diffuseTextureChannelMask","rgb"),this.addField_SFVec3f(e,"specularFactor",0,0,0),this.addField_SFInt32(e,"specularTextureId",-1),this.addField_SFInt32(e,"specularTextureCoordinatesId",0),this.addField_SFString(e,"specularTextureChannelMask","rgb"),this.addField_SFFloat(e,"shininessFactor",.2),this.addField_SFInt32(e,"shininessTextureId",-1),this.addField_SFInt32(e,"shininessTextureCoordinatesId",0),this.addField_SFString(e,"shininessTextureChannelMask","a"),this.addField_SFString(e,"normalFormat","UNORM"),this.addField_SFString(e,"normalSpace","TANGENT"),this.addField_SFInt32(e,"normalTextureId",-1),this.addField_SFInt32(e,"normalTextureCoordinatesId",0),this.addField_SFString(e,"normalTextureChannelMask","rgb"),this.addField_SFVec3f(e,"reflectionFactor",0,0,0),this.addField_SFInt32(e,"reflectionTextureId",-1),this.addField_SFInt32(e,"reflectionTextureCoordinatesId",0),this.addField_SFString(e,"reflectionTextureChannelMask","rgb"),this.addField_SFVec3f(e,"transmissionFactor",0,0,0),this.addField_SFInt32(e,"transmissionTextureId",-1),this.addField_SFInt32(e,"transmissionTextureCoordinatesId",0),this.addField_SFString(e,"transmissionTextureChannelMask","rgb"),this.addField_SFVec3f(e,"environmentFactor",1,1,1),this.addField_SFInt32(e,"environmentTextureId",-1),this.addField_SFInt32(e,"environmentTextureCoordinatesId",0),this.addField_SFString(e,"environmentTextureChannelMask","rgb"),this.addField_SFFloat(e,"relativeIndexOfRefraction",1),this.addField_SFFloat(e,"fresnelBlend",0),this.addField_SFString(e,"displacementAxis","y"),this.addField_SFFloat(e,"displacementFactor",255),this.addField_SFInt32(e,"displacementTextureId",-1),this.addField_SFInt32(e,"displacementTextureCoordinatesId",0),this.addField_SFNode("emissiveTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("ambientTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("diffuseTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("specularTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("shininessTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("normalTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("reflectionTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("transmissionTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("environmentTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("displacementTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("diffuseDisplacementTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFVec3f(e,"normalScale",2,2,2),this.addField_SFVec3f(e,"normalBias",-1,-1,1),this.addField_SFFloat(e,"alphaFactor",1),this.addField_SFBool(e,"invertAlphaTexture",!1),this.addField_SFInt32(e,"alphaTextureId",-1),this.addField_SFInt32(e,"alphaTextureCoordinatesId",0),this.addField_SFString(e,"alphaTextureChannelMask","a"),this.addField_SFNode("alphaTexture",x3dom.nodeTypes.X3DTextureNode),this._dirty={}}),{getDiffuseMap:function(){return this._cf.diffuseTexture.node?x3dom.isa(this._cf.diffuseTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.diffuseTexture.node._cf.texture.node._type="diffuseMap",this._cf.diffuseTexture.node._cf.texture.node):(this._cf.diffuseTexture.node._type="diffuseMap",this._cf.diffuseTexture.node):null},getEnvironmentMap:function(){return this._cf.environmentTexture.node?x3dom.isa(this._cf.environmentTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.environmentTexture.node._cf.texture.node._type="environmentMap",this._cf.environmentTexture.node._cf.texture.node):(this._cf.environmentTexture.node._type="environmentMap",this._cf.environmentTexture.node):null},getNormalMap:function(){return this._cf.normalTexture.node?x3dom.isa(this._cf.normalTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.normalTexture.node._cf.texture.node._type="normalMap",this._cf.normalTexture.node._cf.texture.node):(this._cf.normalTexture.node._type="normalMap",this._cf.normalTexture.node):null},getAmbientMap:function(){return this._cf.ambientTexture.node?x3dom.isa(this._cf.ambientTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.ambientTexture.node._cf.texture.node._type="ambientMap",this._cf.ambientTexture.node._cf.texture.node):(this._cf.ambientTexture.node._type="ambientMap",this._cf.ambientTexture.node):null},getSpecularMap:function(){return this._cf.specularTexture.node?x3dom.isa(this._cf.specularTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.specularTexture.node._cf.texture.node._type="specularMap",this._cf.specularTexture.node._cf.texture.node):(this._cf.specularTexture.node._type="specularMap",this._cf.specularTexture.node):null},getShininessMap:function(){return this._cf.shininessTexture.node?x3dom.isa(this._cf.shininessTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.shininessTexture.node._cf.texture.node._type="shininessMap",this._cf.shininessTexture.node._cf.texture.node):(this._cf.shininessTexture.node._type="shininessMap",this._cf.shininessTexture.node):null},getAlphaMap:function(){return this._cf.alphaTexture.node?x3dom.isa(this._cf.alphaTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.alphaTexture.node._cf.texture.node._type="alphaMap",this._cf.alphaTexture.node._cf.texture.node):(this._cf.alphaTexture.node._type="alphaMap",this._cf.alphaTexture.node):null},getDisplacementMap:function(){return this._cf.displacementTexture.node?x3dom.isa(this._cf.displacementTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.displacementTexture.node._cf.texture.node._type="displacementMap",this._cf.displacementTexture.node._cf.texture.node):(this._cf.displacementTexture.node._type="displacementMap",this._cf.displacementTexture.node):null},getDiffuseDisplacementMap:function(){return this._cf.diffuseDisplacementTexture.node?x3dom.isa(this._cf.diffuseDisplacementTexture.node,x3dom.nodeTypes.SurfaceShaderTexture)?(this._cf.diffuseDisplacementTexture.node._cf.texture.node._type="diffuseDisplacementMap",this._cf.diffuseDisplacementTexture.node._cf.texture.node):(this._cf.diffuseDisplacementTexture.node._type="diffuseDisplacementMap",this._cf.diffuseDisplacementTexture.node):null},getTextures:function(){var e=[],t=this.getDiffuseMap();t&&e.push(t);var A=this.getNormalMap();A&&e.push(A);var i=this.getSpecularMap();i&&e.push(i);var o=this.getShininessMap();o&&e.push(o);var s=this.getEnvironmentMap();s&&e.push(s);var n=this.getDisplacementMap();n&&e.push(n);var r=this.getDiffuseDisplacementMap();return r&&e.push(r),e},needTexcoords:function(){return!!(this.getDiffuseMap()||this.getNormalMap()||this.getSpecularMap()||this.getShininessMap()||this.getDisplacementMap()||this.getDiffuseDisplacementMap()||this.getEnvironmentMap())}})),x3dom.registerNodeType("ComposedShader","Shaders",defineClass(x3dom.nodeTypes.X3DShaderNode,(function(e){x3dom.nodeTypes.ComposedShader.superClass.call(this,e),this.addField_MFNode("fields",x3dom.nodeTypes.Field),this.addField_MFNode("parts",x3dom.nodeTypes.ShaderPart),this._vertex=null,this._fragment=null,this._id=null,x3dom.nodeTypes.ComposedShader.ShaderInfoMsgShown||(x3dom.debug.logInfo("Current ComposedShader node implementation limitations:\nVertex attributes (if given in the standard X3D fields 'coord', 'color', 'normal', 'texCoord'), matrices and texture are provided as follows...\n(see also <a href='http://x3dom.org/x3dom/doc/help/composedShader.html'>http://x3dom.org/x3dom/doc/help/composedShader.html</a>)\n    attribute vec3 position;\n    attribute vec3 normal;\n    attribute vec2 texcoord;\n    attribute vec3 color;\n    uniform mat4 modelViewProjectionMatrix;\n    uniform mat4 modelViewMatrix;\n    uniform mat4 normalMatrix;\n    uniform mat4 viewMatrix;\n    uniform sampler2D tex;\n"),x3dom.nodeTypes.ComposedShader.ShaderInfoMsgShown=!0)}),{nodeChanged:function(){var e,t=this._cf.parts.nodes.length;for(e=0;e<t;e++)"vertex"==this._cf.parts.nodes[e]._vf.type.toLowerCase()?(this._vertex=this._cf.parts.nodes[e],this._id=this._cf.parts.nodes[e]._id):"fragment"==this._cf.parts.nodes[e]._vf.type.toLowerCase()&&(this._fragment=this._cf.parts.nodes[e],this._id+=" - "+this._cf.parts.nodes[e]._id);var A={};for(t=this._cf.fields.nodes.length,e=0;e<t;e++){var i=this._cf.fields.nodes[e]._vf.name;A.xmlNode=this._cf.fields.nodes[e]._xmlNode;var o=!1;void 0!==A.xmlNode&&null!==A.xmlNode||(A.xmlNode=document.createElement("field"),o=!0),A.xmlNode.setAttribute(i,this._cf.fields.nodes[e]._vf.value),this["addField_"+this._cf.fields.nodes[e]._vf.type](A,i),o&&(A.xmlNode=null)}this._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){e._cleanupGLObjects&&e._cleanupGLObjects(),e.setAllDirty()}))}))},fieldChanged:function(e){var t,A=this._cf.fields.nodes.length;for(t=0;t<A;t++){var i=this._cf.fields.nodes[t]._vf.name;if(i===e){var o=this._cf.fields.nodes[t]._vf.value;try{this._vf[i].setValueByStr(o)}catch(e){try{switch((typeof this._vf[i]).toString()){case"number":this._vf[i]=+o;break;case"boolean":this._vf[i]="true"===o.toLowerCase();break;case"string":this._vf[i]=o}}catch(e){x3dom.debug.logError("setValueByStr() NYI for "+typeof this._vf[i])}}break}}if("url"===e){for(t=0;t<A;t++)"vertex"==this._cf.parts.nodes[t]._vf.type.toLowerCase()?(this._vertex=this._cf.parts.nodes[t],this._id=this._cf.parts.nodes[t]._id):"fragment"==this._cf.parts.nodes[t]._vf.type.toLowerCase()&&(this._fragment=this._cf.parts.nodes[t],this._id+=" - "+this._cf.parts.nodes[t]._id);this._parentNodes.forEach((function(e){e._parentNodes.forEach((function(e){e._cleanupGLObjects&&e._cleanupGLObjects(),e.setAllDirty()}))}))}},parentAdded:function(e){e.nodeChanged()}})),x3dom.nodeTypes.ComposedShader.ShaderInfoMsgShown=!1,x3dom.registerNodeType("ShaderPart","Shaders",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.ShaderPart.superClass.call(this,e),this.addField_MFString(e,"url",[]),this.addField_SFString(e,"type","VERTEX"),this._id=e&&e.xmlNode&&""!=e.xmlNode.id?e.xmlNode.id:++x3dom.nodeTypes.Shape.shaderPartID,x3dom.debug.assert("vertex"==this._vf.type.toLowerCase()||"fragment"==this._vf.type.toLowerCase(),"Unknown shader part type!")}),{nodeChanged:function(){var e={};if(e.xmlNode=this._xmlNode,void 0!==e.xmlNode&&null!==e.xmlNode){var t=this;if(t._vf.url.length&&-1==t._vf.url[0].indexOf("\n")){var A=new XMLHttpRequest,i=t._nameSpace.getURL(t._vf.url[0]),o=t._id;t._id="default",t._vf.url=new x3dom.fields.MFString([this._getDefaultShader()]),A.open("GET",i,!1),A.onload=function(){t._vf.url=new x3dom.fields.MFString([]),t._vf.url.push(A.response),t._id=o,t.fieldChanged("url")},A.onerror=function(){x3dom.debug.logError("Could not load file '"+t._vf.url[0]+"'.")},x3dom.RequestManager.addRequest(A)}else{t._vf.url.length&&(t._vf.url=new x3dom.fields.MFString([]));try{t._vf.url.push(e.xmlNode.childNodes[1].nodeValue),e.xmlNode.removeChild(e.xmlNode.childNodes[1])}catch(A){e.xmlNode.childNodes.forEach((function(e){3===e.nodeType?t._vf.url.push(e.nodeValue):4===e.nodeType&&t._vf.url.push(e.data),e.parentNode.removeChild(e)}))}}}this._parentNodes.forEach((function(e){e.nodeChanged()}))},fieldChanged:function(e){"url"===e&&this._parentNodes.forEach((function(e){e.fieldChanged("url")}))},parentAdded:function(e){e.nodeChanged()},_getDefaultShader:function(){return"vertex"==this._vf.type.toLowerCase()?"attribute vec3 position;\nuniform mat4 modelViewProjectionMatrix;\nvoid main(void) {\n    gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);\n}\n":"fragment"==this._vf.type.toLowerCase()?"precision highp float;\nvoid main(void) {\n    gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n}\n":void 0}})),x3dom.registerNodeType("X3DVertexAttributeNode","Shaders",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,(function(e){x3dom.nodeTypes.X3DVertexAttributeNode.superClass.call(this,e),this.addField_SFString(e,"name","")}))),x3dom.registerNodeType("FloatVertexAttribute","Shaders",defineClass(x3dom.nodeTypes.X3DVertexAttributeNode,(function(e){x3dom.nodeTypes.FloatVertexAttribute.superClass.call(this,e),this.addField_SFInt32(e,"numComponents",4),this.addField_MFFloat(e,"value",[])}))),x3dom.registerNodeType("X3DSpatialGeometryNode","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.X3DSpatialGeometryNode.superClass.call(this,e)}))),x3dom.registerNodeType("Plane","Geometry3D",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Plane.superClass.call(this,e),this.addField_SFVec2f(e,"size",2,2),this.addField_SFVec2f(e,"subdivision",1,1),this.addField_SFVec3f(e,"center",0,0,0),this.addField_MFString(e,"primType",["TRIANGLES"]),this._vf.primType.length&&(this._mesh._primType=this._vf.primType[0]);var t=this._vf.size.x,A=this._vf.size.y,i=this._vf.subdivision.x,o=this._vf.subdivision.y,s=this._vf.ccw,n=["Plane",t,A,i,o,this._vf.center.x,this._vf.center.y,this._vf.center.z,s].join("-");if(e&&this._vf.useGeoCache&&void 0!==x3dom.geoCache[n])this._mesh=x3dom.geoCache[n];else{var r=0,a=0,d=t/i,h=A/o,g=s?1:-1;for(t/=2,A/=2,a=0;a<=o;a++)for(r=0;r<=i;r++)this._mesh._positions[0].push(this._vf.center.x+r*d-t),this._mesh._positions[0].push(this._vf.center.y+a*h-A),this._mesh._positions[0].push(this._vf.center.z),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*g),this._mesh._texCoords[0].push(r/i),this._mesh._texCoords[0].push(a/o);for(a=1;a<=o;a++)for(r=0;r<i;r++)this._mesh._indices[0].push((a-1)*(i+1)+r),this._mesh._indices[0].push((a-1)*(i+1)+r+1),this._mesh._indices[0].push(a*(i+1)+r),this._mesh._indices[0].push(a*(i+1)+r),this._mesh._indices[0].push((a-1)*(i+1)+r+1),this._mesh._indices[0].push(a*(i+1)+r+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[n]=this._mesh}}),{fieldChanged:function(e){if("size"==e||"center"==e){this._mesh._positions[0]=[];var t=this._vf.size.x,A=this._vf.size.y,i=0,o=0,s=t/(r=this._vf.subdivision.x),n=A/(a=this._vf.subdivision.y);for(t/=2,A/=2,o=0;o<=a;o++)for(i=0;i<=r;i++)this._mesh._positions[0].push(this._vf.center.x+i*s-t),this._mesh._positions[0].push(this._vf.center.y+o*n-A),this._mesh._positions[0].push(this._vf.center.z);this.invalidateVolume(),this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))}else if("subdivision"==e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];t=this._vf.size.x,A=this._vf.size.y;var r=this._vf.subdivision.x,a=this._vf.subdivision.y,d=this._vf.ccw?1:-1;i=0,o=0,s=t/r,n=A/a;for(t/=2,A/=2,o=0;o<=a;o++)for(i=0;i<=r;i++)this._mesh._positions[0].push(this._vf.center.x+i*s-t),this._mesh._positions[0].push(this._vf.center.y+o*n-A),this._mesh._positions[0].push(this._vf.center.z),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*d),this._mesh._texCoords[0].push(i/r),this._mesh._texCoords[0].push(o/a);for(o=1;o<=a;o++)for(i=0;i<r;i++)this._mesh._indices[0].push((o-1)*(r+1)+i),this._mesh._indices[0].push((o-1)*(r+1)+i+1),this._mesh._indices[0].push(o*(r+1)+i),this._mesh._indices[0].push(o*(r+1)+i),this._mesh._indices[0].push((o-1)*(r+1)+i+1),this._mesh._indices[0].push(o*(r+1)+i+1);this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()}))}}})),x3dom.registerNodeType("Box","Geometry3D",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Box.superClass.call(this,e),this.addField_SFVec3f(e,"size",2,2,2),this.addField_SFBool(e,"hasHelperColors",!1);var t=this._vf.size.x,A=this._vf.size.y,i=this._vf.size.z,o=this._vf.ccw,s=["Box",t,A,i,o].join("-");this._vf.useGeoCache&&void 0!==x3dom.geoCache[s]?this._mesh=x3dom.geoCache[s]:(t/=2,A/=2,i/=2,this._mesh._positions[0]=[-t,-A,-i,-t,A,-i,t,A,-i,t,-A,-i,-t,-A,i,-t,A,i,t,A,i,t,-A,i,-t,-A,-i,-t,-A,i,-t,A,i,-t,A,-i,t,-A,-i,t,-A,i,t,A,i,t,A,-i,-t,A,-i,-t,A,i,t,A,i,t,A,-i,-t,-A,-i,-t,-A,i,t,-A,i,t,-A,-i],this._mesh._normals[0]=o?[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0]:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0],this._mesh._texCoords[0]=[1,0,1,1,0,1,0,0,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1,1,0,0,0,0,1,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,1,0],this._vf.hasHelperColors&&(this._mesh._colors[0]=[0,0,0,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,0,1,0,0,1,0,1,1,1,1,1,1,0,0,1,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,0,1,1,0,0]),this._mesh._indices[0]=[0,1,2,2,3,0,4,7,5,5,7,6,8,9,10,10,11,8,12,14,13,14,12,15,16,17,18,18,19,16,20,22,21,22,20,23],this._mesh._invalidate=!0,this._mesh._numFaces=12,this._mesh._numCoords=24,x3dom.geoCache[s]=this._mesh)}),{fieldChanged:function(e){if("size"===e){var t=this._vf.size.x/2,A=this._vf.size.y/2,i=this._vf.size.z/2;this._mesh._positions[0]=[-t,-A,-i,-t,A,-i,t,A,-i,t,-A,-i,-t,-A,i,-t,A,i,t,A,i,t,-A,i,-t,-A,-i,-t,-A,i,-t,A,i,-t,A,-i,t,-A,-i,t,-A,i,t,A,i,t,A,-i,-t,A,-i,-t,A,i,t,A,i,t,A,-i,-t,-A,-i,-t,-A,i,t,-A,i,t,-A,-i],this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))}else"hasHelperColors"===e&&(this._vf.hasHelperColors?this._mesh._colors[0]=[0,0,0,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,1,1,1,1,0,1,0,0,0,0,0,1,0,1,1,0,1,0,1,0,0,1,0,1,1,1,1,1,1,0,0,1,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,0,1,1,0,0]:this._mesh._colors[0]=[],this._parentNodes.forEach((function(e){e._dirty.colors=!0})))}})),x3dom.registerNodeType("Sphere","Geometry3D",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Sphere.superClass.call(this,e),this.addField_SFFloat(e,"radius",e?1:1e3),this.addField_SFVec2f(e,"subdivision",24,24),this._qfactors={low:.3,medium:.5,high:1},void 0===e&&this.nodeChanged()}),{nodeChanged:function(){var e=1;this._nameSpace&&(e=this._nameSpace.doc.properties.getProperty("PrimitiveQuality","Medium")),e=x3dom.Utils.isNumber(e)?parseFloat(e):this._qfactors[e.toLowerCase()]||.5,this._quality=e;var t=["Sphere",this._vf.radius,this._vf.subdivision.x,this._vf.subdivision.y,e,this._vf.ccw].join("-");this._vf.useGeoCache&&void 0!==x3dom.geoCache[t]?this._mesh=x3dom.geoCache[t]:(this._regenerateMesh(),this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[t]=this._mesh)},_regenerateMesh:function(){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];var e,t,A,i,o,s,n,r,a,d,h=this._vf.radius,g=this._vf.ccw?1:-1,l=this._vf.subdivision.x,I=this._vf.subdivision.y,c=Math.floor(l*this._quality),f=Math.floor(I*this._quality);for(e=0;e<=c;e++)for(A=e*Math.PI/c,i=Math.sin(A),o=Math.cos(A),t=0;t<=f;t++)s=this._calcXYZ(t,f,i,o),n=this._uFromlong(t,f),r=e/c,this._mesh._positions[0].push(h*s.x,h*s.y,h*s.z),this._mesh._normals[0].push(g*s.x,g*s.y,g*s.z),this._mesh._texCoords[0].push(n,r);for(e=0;e<c;e++)for(t=0;t<f;t++)d=(a=e*(f+1)+t)+f+1,this._mesh._indices[0].push(a,d,a+1),this._mesh._indices[0].push(d,d+1,a+1)},_calcXYZ:function(e,t,A,i){var o=.5*Math.PI+2*e*Math.PI/t;return{x:-Math.cos(o)*A,y:-i,z:-Math.sin(o)*A}},_uFromlong:function(e,t){return 1-e/t},fieldChanged:function(e){if("radius"===e){this._mesh._positions[0]=[];var t,A,i,o,s,n,r=this._vf.radius,a=this._vf.subdivision.x,d=this._vf.subdivision.y,h=this._quality,g=Math.floor(a*h),l=Math.floor(d*h);for(t=0;t<=g;t++)for(i=t*Math.PI/g,o=Math.sin(i),s=Math.cos(i),A=0;A<=l;A++)n=this._calcXYZ(A,l,o,s),this._mesh._positions[0].push(r*n.x,r*n.y,r*n.z);this.invalidateVolume(),this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))}else if("subdivision"===e){this._regenerateMesh(),this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3;var I="Sphere_"+(r=this._vf.radius)+"-"+(a=this._vf.subdivision.x)+"-"+(d=this._vf.subdivision.y);x3dom.geoCache[I]=this._mesh,this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()}))}}})),x3dom.registerNodeType("Torus","Geometry3D",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Torus.superClass.call(this,e);var t=2*Math.PI;this.addField_SFFloat(e,"innerRadius",.5),this.addField_SFFloat(e,"outerRadius",1),this.addField_SFFloat(e,"angle",t),this.addField_SFBool(e,"caps",!0),this.addField_SFVec2f(e,"subdivision",24,24),this.addField_SFBool(e,"insideOutsideRadius",!1),this._vf.angle<0?this._vf.angle=0:this._vf.angle>t&&(this._vf.angle=t),this._origCCW=this._vf.ccw;var A=this._vf.innerRadius,i=this._vf.outerRadius;if(1==this._vf.insideOutsideRadius){if(A>i){var o=A;A=i,i=o}var s=(i-A)/2;i=A+s,A=s,this._vf.ccw=!this._origCCW}var n=this._vf.subdivision.x,r=this._vf.subdivision.y,a=this._vf.ccw?1:-1;n=Math.max(3,Math.round(this._vf.angle/t*n));var d=["Torus_",A,i,this._vf.angle,this._vf.subdivision,this._vf.caps,a].join("_");if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[d])this._mesh=x3dom.geoCache[d];else{var h,g,l,I,c,f,u,C,_,m=this._vf.angle/n,p=t/r;for(h=0,l=0;h<=n;h++,l+=m)for(c=Math.cos(l),f=Math.sin(l),g=0,I=0;g<=r;g++,I+=p)u=Math.cos(I),C=Math.sin(I),_=i+A*u,this._vf.insideOutsideRadius?(this._mesh._positions[0].push(c*_,A*C,-f*_),this._mesh._normals[0].push(a*c*u,a*C,a*-f*u)):(this._mesh._positions[0].push(c*_,-f*_,A*C),this._mesh._normals[0].push(a*c*u,a*-f*u,a*C)),this._mesh._texCoords[0].push(-h/n,g/r);for(h=0;h<r;h++)for(g=0;g<n;g++)this._mesh._indices[0].push(g*(r+1)+h),this._mesh._indices[0].push(g*(r+1)+h+1),this._mesh._indices[0].push((g+1)*(r+1)+h),this._mesh._indices[0].push(g*(r+1)+h+1),this._mesh._indices[0].push((g+1)*(r+1)+h+1),this._mesh._indices[0].push((g+1)*(r+1)+h);if(this._vf.angle<t&&1==this._vf.caps){var E=this._mesh._positions[0].length/3;for(this._vf.insideOutsideRadius?(this._mesh._positions[0].push(i,0,0),this._mesh._normals[0].push(0,0,1*a)):(this._mesh._positions[0].push(i,0,0),this._mesh._normals[0].push(0,1*a,0)),this._mesh._texCoords[0].push(.5,.5),g=0,I=0;g<=r;g++,I+=p)u=Math.cos(I),C=Math.sin(I),_=i+A*u,this._vf.insideOutsideRadius?(this._mesh._positions[0].push(_,C*A,0),this._mesh._normals[0].push(0,0,1*a)):(this._mesh._positions[0].push(_,0,C*A),this._mesh._normals[0].push(0,1*a,0)),this._mesh._texCoords[0].push(.5*(1+u),.5*(1-C)),g>0&&(this._mesh._indices[0].push(E),this._mesh._indices[0].push(E+g),this._mesh._indices[0].push(E+g-1)),g==r&&(this._mesh._indices[0].push(E),this._mesh._indices[0].push(E+1),this._mesh._indices[0].push(E+g));c=Math.cos(this._vf.angle),f=Math.sin(this._vf.angle),E=this._mesh._positions[0].length/3;var B=-f,Q=-c;for(this._vf.insideOutsideRadius?(this._mesh._positions[0].push(c*i,0,-f*i),this._mesh._normals[0].push(a*B,0,a*Q)):(this._mesh._positions[0].push(c*i,-f*i,0),this._mesh._normals[0].push(a*B,a*Q,0)),this._mesh._texCoords[0].push(.5,.5),g=0,I=0;g<=r;g++,I+=p)u=Math.cos(I),C=Math.sin(I),_=i+A*u,this._vf.insideOutsideRadius?(this._mesh._positions[0].push(c*_,C*A,-f*_),this._mesh._normals[0].push(a*B,0,a*Q)):(this._mesh._positions[0].push(c*_,-f*_,C*A),this._mesh._normals[0].push(a*B,a*Q,0)),this._mesh._texCoords[0].push(1-.5*(1+u),.5*(1-C)),g>0&&(this._mesh._indices[0].push(E),this._mesh._indices[0].push(E+g-1),this._mesh._indices[0].push(E+g)),g==r&&(this._mesh._indices[0].push(E),this._mesh._indices[0].push(E+g),this._mesh._indices[0].push(E+1))}this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[d]=this._mesh}}),{fieldChanged:function(e){if("innerRadius"==e||"outerRadius"==e||"subdivision"==e||"angle"==e||"insideOutsideRadius"==e||"caps"==e){var t=2*Math.PI;this._vf.angle<0?this._vf.angle=0:this._vf.angle>t&&(this._vf.angle=t);var A=this._vf.innerRadius,i=this._vf.outerRadius;if(1==this._vf.insideOutsideRadius){if(A>i){var o=A;A=i,i=o}var s=(i-A)/2;i=A+s,A=s,this._vf.ccw=!this._origCCW}else this._vf.ccw=this._origCCW;var n=this._vf.subdivision.x,r=this._vf.subdivision.y,a=this._vf.ccw?1:-1;n=Math.max(3,Math.round(this._vf.angle/t*n));var d,h,g,l,I,c,f,u,C,_=this._vf.angle/n,m=t/r;for(this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._indices[0]=[],d=0,g=0;d<=n;d++,g+=_)for(I=Math.cos(g),c=Math.sin(g),h=0,l=0;h<=r;h++,l+=m)f=Math.cos(l),u=Math.sin(l),C=i+A*f,this._vf.insideOutsideRadius?(this._mesh._positions[0].push(I*C,A*u,-c*C),this._mesh._normals[0].push(a*I*f,a*u,a*-c*f)):(this._mesh._positions[0].push(I*C,-c*C,A*u),this._mesh._normals[0].push(a*I*f,a*-c*f,a*u)),this._mesh._texCoords[0].push(-d/n,h/r);for(d=0;d<r;d++)for(h=0;h<n;h++)this._mesh._indices[0].push(h*(r+1)+d),this._mesh._indices[0].push(h*(r+1)+d+1),this._mesh._indices[0].push((h+1)*(r+1)+d),this._mesh._indices[0].push(h*(r+1)+d+1),this._mesh._indices[0].push((h+1)*(r+1)+d+1),this._mesh._indices[0].push((h+1)*(r+1)+d);if(this._vf.angle<t&&1==this._vf.caps){var p=this._mesh._positions[0].length/3;for(this._vf.insideOutsideRadius?(this._mesh._positions[0].push(i,0,0),this._mesh._normals[0].push(0,0,1*a)):(this._mesh._positions[0].push(i,0,0),this._mesh._normals[0].push(0,1*a,0)),this._mesh._texCoords[0].push(.5,.5),h=0,l=0;h<=r;h++,l+=m)f=Math.cos(l),u=Math.sin(l),C=i+A*f,this._vf.insideOutsideRadius?(this._mesh._positions[0].push(C,u*A,0),this._mesh._normals[0].push(0,0,1*a)):(this._mesh._positions[0].push(C,0,u*A),this._mesh._normals[0].push(0,1*a,0)),this._mesh._texCoords[0].push(.5*(1+f),.5*(1-u)),h>0&&(this._mesh._indices[0].push(p),this._mesh._indices[0].push(p+h),this._mesh._indices[0].push(p+h-1)),h==r&&(this._mesh._indices[0].push(p),this._mesh._indices[0].push(p+1),this._mesh._indices[0].push(p+h));I=Math.cos(this._vf.angle),c=Math.sin(this._vf.angle),p=this._mesh._positions[0].length/3;var E=-c,B=-I;for(this._vf.insideOutsideRadius?(this._mesh._positions[0].push(I*i,0,-c*i),this._mesh._normals[0].push(a*E,0,a*B)):(this._mesh._positions[0].push(I*i,-c*i,0),this._mesh._normals[0].push(a*E,a*B,0)),this._mesh._texCoords[0].push(.5,.5),h=0,l=0;h<=r;h++,l+=m)f=Math.cos(l),u=Math.sin(l),C=i+A*f,this._vf.insideOutsideRadius?(this._mesh._positions[0].push(I*C,u*A,-c*C),this._mesh._normals[0].push(a*E,0,a*B)):(this._mesh._positions[0].push(I*C,-c*C,u*A),this._mesh._normals[0].push(a*E,a*B,0)),this._mesh._texCoords[0].push(1-.5*(1+f),.5*(1-u)),h>0&&(this._mesh._indices[0].push(p),this._mesh._indices[0].push(p+h-1),this._mesh._indices[0].push(p+h)),h==r&&(this._mesh._indices[0].push(p),this._mesh._indices[0].push(p+h),this._mesh._indices[0].push(p+1))}this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()}))}}})),x3dom.registerNodeType("Cone","Geometry3D",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Cone.superClass.call(this,e),this.addField_SFFloat(e,"bottomRadius",1),this.addField_SFFloat(e,"topRadius",0),this.addField_SFFloat(e,"height",2),this.addField_SFBool(e,"bottom",!0),this.addField_SFBool(e,"side",!0),this.addField_SFBool(e,"top",!0),this.addField_SFFloat(e,"subdivision",32);var t=["Cone",this._vf.bottomRadius,this._vf.height,this._vf.top,this._vf.bottom,this._vf.side,this._vf.topRadius,this._vf.subdivision,this._vf.ccw].join("_");this._vf.useGeoCache&&void 0!==x3dom.geoCache[t]?this._mesh=x3dom.geoCache[t]:(this._calcMesh(),this._mesh._invalidate=!0,x3dom.geoCache[t]=this._mesh)}),{_calcMesh:function(){var e,t,A,i,o,s=this._vf.bottomRadius,n=this._vf.height,r=this._vf.topRadius,a=this._vf.subdivision,d=this._vf.ccw?1:-1,h=2*Math.PI/a,g=(s-r)/n,l=1/Math.sqrt(1+g*g),I=0,c=0;if(this._vf.side&&n>0){var f=0,u=0;for(I=0,c=0;I<=a;I++)e=I*h,t=Math.sin(e),A=-Math.cos(e),r>x3dom.fields.Eps&&(f=t*r,u=A*r),this._mesh._positions[0].push(f,n/2,u),this._mesh._normals[0].push(d*t/l,d*g/l,d*A/l),this._mesh._texCoords[0].push(1-I/a,1),this._mesh._positions[0].push(t*s,-n/2,A*s),this._mesh._normals[0].push(d*t/l,d*g/l,d*A/l),this._mesh._texCoords[0].push(1-I/a,0),I>0&&(this._mesh._indices[0].push(c),this._mesh._indices[0].push(c+2),this._mesh._indices[0].push(c+1),this._mesh._indices[0].push(c+1),this._mesh._indices[0].push(c+2),this._mesh._indices[0].push(c+3),c+=2)}if(this._vf.bottom&&s>0){for(o=this._mesh._positions[0].length/3,I=a-1;I>=0;I--)e=I*h,t=s*Math.sin(e),A=-s*Math.cos(e),this._mesh._positions[0].push(t,-n/2,A),this._mesh._normals[0].push(0,-1*d,0),this._mesh._texCoords[0].push(t/s/2+.5,A/s/2+.5);for(i=o+1,I=2;I<a;I++)this._mesh._indices[0].push(i),this._mesh._indices[0].push(o),i=o+I,this._mesh._indices[0].push(i)}if(this._vf.top&&r>x3dom.fields.Eps){for(o=this._mesh._positions[0].length/3,I=a-1;I>=0;I--)e=I*h,t=r*Math.sin(e),A=-r*Math.cos(e),this._mesh._positions[0].push(t,n/2,A),this._mesh._normals[0].push(0,1*d,0),this._mesh._texCoords[0].push(t/r/2+.5,1-A/r/2+.5);for(i=o+1,I=2;I<a;I++)this._mesh._indices[0].push(o),this._mesh._indices[0].push(i),i=o+I,this._mesh._indices[0].push(i)}this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){"bottomRadius"!=e&&"topRadius"!=e&&"height"!=e&&"subdivision"!=e&&"bottom"!=e&&"top"!=e&&"side"!=e||(this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._calcMesh(),this.invalidateVolume(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("Cylinder","Geometry3D",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Cylinder.superClass.call(this,e),this.addField_SFFloat(e,"radius",1),this.addField_SFFloat(e,"height",2),this.addField_SFBool(e,"bottom",!0),this.addField_SFBool(e,"top",!0),this.addField_SFFloat(e,"subdivision",32),this.addField_SFBool(e,"side",!0);var t=this._vf.subdivision,A=this._vf.ccw,i=["Cylinder",this._vf.radius,this._vf.height,this._vf.bottom,this._vf.top,this._vf.side,t,A].join("_");this._vf.useGeoCache&&void 0!==x3dom.geoCache[i]?this._mesh=x3dom.geoCache[i]:(this._calcMesh(),this._mesh._invalidate=!0,x3dom.geoCache[i]=this._mesh)}),{_calcMesh:function(){var e,t,A,i,o=this._vf.radius,s=this._vf.height/2,n=this._vf.subdivision,r=this._vf.ccw?1:-1,a=2*Math.PI/n,d=0;if(this._vf.side)for(i=0,d=0;i<=n;i++)e=i*a,t=Math.sin(e),A=-Math.cos(e),this._mesh._positions[0].push(t*o,-s,A*o),this._mesh._normals[0].push(r*t,0,r*A),this._mesh._texCoords[0].push(1-i/n,0),this._mesh._positions[0].push(t*o,s,A*o),this._mesh._normals[0].push(r*t,0,r*A),this._mesh._texCoords[0].push(1-i/n,1),i>0&&(this._mesh._indices[0].push(d+0,d+1,d+2),this._mesh._indices[0].push(d+2,d+1,d+3),d+=2);if(o>0){var h,g=this._mesh._positions[0].length/3;if(this._vf.top){for(i=n-1;i>=0;i--)e=i*a,t=o*Math.sin(e),A=-o*Math.cos(e),this._mesh._positions[0].push(t,s,A),this._mesh._normals[0].push(0,1*r,0),this._mesh._texCoords[0].push(t/o/2+.5,-A/o/2+.5);for(h=g+1,i=2;i<n;i++)this._mesh._indices[0].push(g),this._mesh._indices[0].push(h),h=g+i,this._mesh._indices[0].push(h);g=this._mesh._positions[0].length/3}if(this._vf.bottom){for(i=n-1;i>=0;i--)e=i*a,t=o*Math.sin(e),A=-o*Math.cos(e),this._mesh._positions[0].push(t,-s,A),this._mesh._normals[0].push(0,-1*r,0),this._mesh._texCoords[0].push(t/o/2+.5,A/o/2+.5);for(h=g+1,i=2;i<n;i++)this._mesh._indices[0].push(h),this._mesh._indices[0].push(g),h=g+i,this._mesh._indices[0].push(h)}}this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){if("radius"===e||"height"===e){this._mesh._positions[0]=[];var t,A,i,o,s=this._vf.radius,n=this._vf.height/2,r=this._vf.subdivision,a=2*Math.PI/r;if(this._vf.side)for(o=0;o<=r;o++)t=o*a,A=Math.sin(t),i=-Math.cos(t),this._mesh._positions[0].push(A*s,-n,i*s),this._mesh._positions[0].push(A*s,n,i*s);if(s>0){this._mesh._positions[0].length;if(this._vf.top)for(o=r-1;o>=0;o--)t=o*a,A=s*Math.sin(t),i=-s*Math.cos(t),this._mesh._positions[0].push(A,n,i)}if(this._vf.bottom)for(o=r-1;o>=0;o--)t=o*a,A=s*Math.sin(t),i=-s*Math.cos(t),this._mesh._positions[0].push(A,-n,i);this.invalidateVolume(),this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))}else"subdivision"!==e&&"bottom"!==e&&"top"!==e&&"side"!==e||(this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._calcMesh(),this.invalidateVolume(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("X3DBinaryContainerGeometryNode","Geometry3D",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.X3DBinaryContainerGeometryNode.superClass.call(this,e),this.addField_SFVec3f(e,"position",0,0,0),this.addField_SFVec3f(e,"size",1,1,1),this.addField_MFInt32(e,"vertexCount",[0]),this.addField_MFString(e,"primType",["TRIANGLES"]),this._mesh._invalidate=!1,this._mesh._numCoords=0,this._mesh._numFaces=0,this._diameter=this._vf.size.length()}),{getMin:function(){var e=this._mesh._vol;return e.isValid()||e.setBoundsByCenterSize(this._vf.position,this._vf.size),e.min},getMax:function(){var e=this._mesh._vol;return e.isValid()||e.setBoundsByCenterSize(this._vf.position,this._vf.size),e.max},getVolume:function(){var e=this._mesh._vol;return e.isValid()||e.setBoundsByCenterSize(this._vf.position,this._vf.size),e},invalidateVolume:function(){},getCenter:function(){return this._vf.position},getDiameter:function(){return this._diameter},needLighting:function(){var e=this._vf.primType.length&&this._vf.primType[0].indexOf("TRIANGLE")>=0;return this._vf.lit&&e}})),x3dom.registerNodeType("BinaryGeometry","Geometry3D",defineClass(x3dom.nodeTypes.X3DBinaryContainerGeometryNode,(function(e){x3dom.nodeTypes.BinaryGeometry.superClass.call(this,e),this.addField_SFString(e,"index",""),this.addField_SFString(e,"coord",""),this.addField_SFString(e,"normal",""),this.addField_SFString(e,"texCoord",""),this.addField_SFString(e,"color",""),this.addField_SFString(e,"tangent",""),this.addField_SFString(e,"binormal",""),this.addField_SFString(e,"indexType","Uint16"),this.addField_SFString(e,"coordType","Float32"),this.addField_SFString(e,"normalType","Float32"),this.addField_SFString(e,"texCoordType","Float32"),this.addField_SFString(e,"colorType","Float32"),this.addField_SFString(e,"tangentType","Float32"),this.addField_SFString(e,"binormalType","Float32"),this.addField_SFBool(e,"normalAsSphericalCoordinates",!1),this.addField_SFBool(e,"rgbaColors",!1),this.addField_SFInt32(e,"numTexCoordComponents",2),this.addField_SFBool(e,"normalPerVertex",!0),this.addField_SFBool(e,"idsPerVertex",!1),this.addField_SFBool(e,"compressed",!1),this._hasStrideOffset=!1,this._mesh._numPosComponents=this._vf.normalAsSphericalCoordinates?4:3,this._mesh._numTexComponents=this._vf.numTexCoordComponents,this._mesh._numColComponents=this._vf.rgbaColors?4:3,this._mesh._numNormComponents=this._vf.normalAsSphericalCoordinates?2:3,this._vertexCountSum=0;for(var t=0;t<this._vf.vertexCount.length;++t)this._vertexCountSum+=this._vf.vertexCount[t]}),{parentAdded:function(e){var t,A,i,o;t=this._vf.coord.lastIndexOf("#"),A=this._vf.coord.lastIndexOf("+"),t>=0&&A>=0?(i=+this._vf.coord.substring(++t,A),o=+this._vf.coord.substring(A),e._coordStrideOffset=[o,i],this._hasStrideOffset=!0,i/8-Math.floor(i/8)==0&&(this._mesh._numPosComponents=4)):A>=0&&(o=+this._vf.coord.substring(A),e._coordStrideOffset=[o,0],o/8-Math.floor(o/8)==0&&(this._mesh._numPosComponents=4)),t=this._vf.normal.lastIndexOf("#"),A=this._vf.normal.lastIndexOf("+"),t>=0&&A>=0?(i=+this._vf.normal.substring(++t,A),o=+this._vf.normal.substring(A),e._normalStrideOffset=[o,i]):A>=0&&(o=+this._vf.normal.substring(A),e._normalStrideOffset=[o,0]),t=this._vf.texCoord.lastIndexOf("#"),A=this._vf.texCoord.lastIndexOf("+"),t>=0&&A>=0?(i=+this._vf.texCoord.substring(++t,A),o=+this._vf.texCoord.substring(A),e._texCoordStrideOffset=[o,i]):A>=0&&(o=+this._vf.texCoord.substring(A),e._texCoordStrideOffset=[o,0]),t=this._vf.color.lastIndexOf("#"),A=this._vf.color.lastIndexOf("+"),t>=0&&A>=0?(i=+this._vf.color.substring(++t,A),o=+this._vf.color.substring(A),e._colorStrideOffset=[o,i]):A>=0&&(o=+this._vf.color.substring(A),e._colorStrideOffset=[o,0]),"Uint16"==this._vf.indexType||x3dom.caps.INDEX_UINT||x3dom.debug.logWarning("Index type "+this._vf.indexType+" problematic")},doIntersect:function(e){var t=this.getMin(),A=this.getMax();return!!(e.intersect(t,A)&&e.enter<e.dist)&&(e.dist=e.enter,e.hitObject=this,e.hitPoint=e.pos.add(e.dir.multiply(e.enter)),!0)},getPrecisionMax:function(e){switch(this._vf[e]){case"Int8":return 127;case"Uint8":return 255;case"Int16":return 32767;case"Uint16":return 65535;case"Int32":return 2147483647;case"Uint32":return 4294967295;case"Float32":case"Float64":default:return 1}}})),x3dom.registerNodeType("PopGeometryLevel","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,(function(e){x3dom.nodeTypes.PopGeometryLevel.superClass.call(this,e),this.addField_SFString(e,"src",""),this.addField_SFInt32(e,"numIndices",0),this.addField_SFInt32(e,"vertexDataBufferOffset",0)}),{getSrc:function(){return this._vf.src},getNumIndices:function(){return this._vf.numIndices},getVertexDataBufferOffset:function(){return this._vf.vertexDataBufferOffset}})),x3dom.registerNodeType("PopGeometry","Geometry3D",defineClass(x3dom.nodeTypes.X3DBinaryContainerGeometryNode,(function(e){x3dom.nodeTypes.PopGeometry.superClass.call(this,e),this.addField_SFVec3f(e,"tightSize",1,1,1),this.addField_SFVec3f(e,"maxBBSize",1,1,1),this.addField_SFVec3f(e,"bbMinModF",0,0,0),this.addField_SFVec3f(e,"bbMaxModF",1,1,1),this.addField_SFVec3f(e,"bbMin",0,0,0),this.addField_SFVec3f(e,"bbShiftVec",0,0,0),this._vf.bbMinModF.x>this._vf.bbMaxModF.x&&(this._vf.bbShiftVec.x=1),this._vf.bbMinModF.y>this._vf.bbMaxModF.y&&(this._vf.bbShiftVec.y=1),this._vf.bbMinModF.z>this._vf.bbMaxModF.z&&(this._vf.bbShiftVec.z=1),this.addField_MFNode("levels",x3dom.nodeTypes.PopGeometryLevel),this.addField_SFInt32(e,"attributeStride",0),this.addField_SFInt32(e,"positionOffset",0),this.addField_SFInt32(e,"normalOffset",0),this.addField_SFInt32(e,"texcoordOffset",0),this.addField_SFInt32(e,"colorOffset",0),this.addField_SFInt32(e,"numAnchorVertices",0),this.addField_SFInt32(e,"positionPrecision",2),this.addField_SFInt32(e,"normalPrecision",1),this.addField_SFInt32(e,"texcoordPrecision",2),this.addField_SFInt32(e,"colorPrecision",1),this.addField_SFInt32(e,"minPrecisionLevel",-1),this.addField_SFInt32(e,"maxPrecisionLevel",-1),this.addField_SFFloat(e,"precisionFactor",1),this.addField_SFString(e,"coordType","Uint16"),this.addField_SFString(e,"normalType","Uint8"),this.addField_SFString(e,"texCoordType","Uint16"),this.addField_SFString(e,"colorType","Uint8"),this.addField_SFInt32(e,"vertexBufferSize",0),this.addField_SFBool(e,"indexedRendering",!0),this.addField_SFBool(e,"sphericalNormals",!1),this.addField_MFInt32(e,"originalVertexCount",[0]);for(var t=0;t<this._vf.vertexCount.length;++t)this._vf.originalVertexCount[t]=this._vf.vertexCount[t];this._vf.maxBBSize=x3dom.fields.SFVec3f.copy(this._vf.size),this._vf.size=this._vf.tightSize,this._diameter=this._vf.size.length(),this._bbMinBySize=[Math.floor(this._vf.bbMin.x/this._vf.maxBBSize.x),Math.floor(this._vf.bbMin.y/this._vf.maxBBSize.y),Math.floor(this._vf.bbMin.z/this._vf.maxBBSize.z)],this._volRadius=this._vf.size.length()/2,this._volLargestRadius=this._vf.maxBBSize.length()/2,this._mesh._numPosComponents=this._vf.sphericalNormals?4:3,this._mesh._numNormComponents=this._vf.sphericalNormals?2:3,this._mesh._numTexComponents=2,this._mesh._numColComponents=3,x3dom.nodeTypes.PopGeometry.numTotalVerts+=this.getVertexCount(),x3dom.nodeTypes.PopGeometry.numTotalTris+=(this.hasIndex()?this.getTotalNumberOfIndices():this.getVertexCount())/3}),{forceUpdateCoverage:function(){return!0},getBBoxShiftVec:function(){return this._vf.bbShiftVec},getBBoxSize:function(){return this._vf.size},hasIndex:function(){return this._vf.indexedRendering},getTotalNumberOfIndices:function(){if(this._vf.indexedRendering){for(var e=0,t=0;t<this._vf.originalVertexCount.length;++t)e+=this._vf.originalVertexCount[t];return e}return 0},getVertexCount:function(){for(var e=0,t=0;t<this._vf.originalVertexCount.length;++t)e+=this._vf.originalVertexCount[t];return e},adaptVertexCount:function(e){for(var t=0,A=0;A<this._vf.originalVertexCount.length;++A){if(!(this._vf.originalVertexCount[A]+t<=e)){this._vf.vertexCount[A]=e-t;break}this._vf.vertexCount[A]=this._vf.originalVertexCount[A],t+=this._vf.originalVertexCount[A]}},hasNormal:function(){return 0!=this._vf.normalOffset&&!this._vf.sphericalNormals},hasTexCoord:function(){return 0!=this._vf.texcoordOffset},hasColor:function(){return 0!=this._vf.colorOffset},getPositionPrecision:function(){return this._vf.positionPrecision},getNormalPrecision:function(){return this._vf.normalPrecision},getTexCoordPrecision:function(){return this._vf.texcoordPrecision},getColorPrecision:function(){return this._vf.colorPrecision},getAttributeStride:function(){return this._vf.attributeStride},getPositionOffset:function(){return this._vf.positionOffset},getNormalOffset:function(){return this._vf.normalOffset},getTexCoordOffset:function(){return this._vf.texcoordOffset},getColorOffset:function(){return this._vf.colorOffset},getBufferTypeStringFromByteCount:function(e){switch(e){case 1:return"Uint8";case 2:return"Uint16";default:return 0}},getDataURLs:function(){for(var e=[],t=0;t<this._cf.levels.nodes.length;++t)e.push(this._cf.levels.nodes[t].getSrc());return e},getNumIndicesByLevel:function(e){return this._cf.levels.nodes[e].getNumIndices()},getNumLevels:function(e){return this._cf.levels.nodes.length},getVertexDataBufferOffset:function(e){return this._cf.levels.nodes[e].getVertexDataBufferOffset()},getPrecisionMax:function(e){switch(this._vf[e]){case"Uint8":return 255;case"Uint16":return 65535;default:return 1}}})),x3dom.nodeTypes.PopGeometry.ErrorToleranceFactor=1,x3dom.nodeTypes.PopGeometry.PrecisionFactorOnMove=1,x3dom.nodeTypes.PopGeometry.numRenderedVerts=0,x3dom.nodeTypes.PopGeometry.numRenderedTris=0,x3dom.nodeTypes.PopGeometry.numTotalVerts=0,x3dom.nodeTypes.PopGeometry.numTotalTris=0,x3dom.nodeTypes.PopGeometry.powLUT=[32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1],x3dom.registerNodeType("IndexedFaceSet","Geometry3D",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,(function(e){x3dom.nodeTypes.IndexedFaceSet.superClass.call(this,e),this.addField_SFFloat(e,"creaseAngle",0),this.addField_SFBool(e,"convex",!0),this.addField_MFInt32(e,"coordIndex",[]),this.addField_MFInt32(e,"normalIndex",[]),this.addField_MFInt32(e,"colorIndex",[]),this.addField_MFInt32(e,"texCoordIndex",[])}),{nodeChanged:function(){(new Date).getTime();this.handleAttribs();var e=this._vf.coordIndex;e.length&&-1!=e[e.length-1]&&e.push(-1);var t,A,i,o,s=this._vf.normalIndex,n=this._vf.texCoordIndex,r=this._vf.colorIndex,a=!1,d=!1,h=!1,g=!1,l=!1,I=!1,c=this._vf.colorPerVertex,f=this._vf.normalPerVertex;s.length>0&&(d=!0),n.length>0&&(g=!0),r.length>0&&(I=!0);var u=this._cf.coord.node;x3dom.debug.assert(u),t=u.getPoints();var C=this._cf.normal.node;C?(a=!0,A=C._vf.vector):a=!1;var _="",m=2,p=this._cf.texCoord.node;if(x3dom.isa(p,x3dom.nodeTypes.MultiTextureCoordinate)&&p._cf.texCoord.nodes.length&&(p=p._cf.texCoord.nodes[0]),p)if(p._vf.point){h=!0,i=p._vf.point;var E=g?Math.max(...n)+1:t.length,B=i.length;for(Q=B;Q<E;Q++)x3dom.debug.logWarning("IFS "+(this._DEF||"")+": more tex. coords. required, guessing "+Q+"1th coord."),i.push(i[Q%B]);x3dom.isa(p,x3dom.nodeTypes.TextureCoordinate3D)&&(m=3)}else p._vf.mode&&(_=p._vf.mode);else h=!1;this._mesh._numTexComponents=m;var Q,x,v,y,F,D,S,w,N,T,b,M,R,G,U,L,k=3,V=this._cf.color.node;if(V?(l=!0,o=V._vf.color,x3dom.isa(V,x3dom.nodeTypes.ColorRGBA)&&(k=4)):l=!1,this._mesh._numColComponents=k,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[],this._vf.creaseAngle<=x3dom.fields.Eps||t.length>x3dom.Utils.maxIndexableCoords||a&&d||h&&g||l&&I){if(this._vf.creaseAngle<=x3dom.fields.Eps&&x3dom.debug.logWarning("Fallback to inefficient multi-index mode since creaseAngle=0."),this._vf.convex)for(v=0,0,y=0,this._mesh._multiIndIndices=[],this._mesh._posSize=t.length,Q=0;Q<e.length;++Q)if(-1!=e[Q])switch(d&&x3dom.debug.assert(-1!=s[Q]),g&&x3dom.debug.assert(-1!=n[Q]),I&&x3dom.debug.assert(-1!=r[Q]),v){case 0:F=+e[Q],w=d&&f?+s[Q]:d&&!f?+s[y]:f?F:y,b=g?+n[Q]:F,G=I&&c?+r[Q]:I&&!c?+r[y]:c?F:y,v=1;break;case 1:D=+e[Q],N=d&&f?+s[Q]:d&&!f?+s[y]:f?D:y,M=g?+n[Q]:D,U=I&&c?+r[Q]:I&&!c?+r[y]:c?D:y,v=2;break;case 2:S=+e[Q],T=d&&f?+s[Q]:d&&!f?+s[y]:f?S:y,R=g?+n[Q]:S,L=I&&c?+r[Q]:I&&!c?+r[y]:c?S:y,v=3,this._mesh._positions[0].push(t[F].x),this._mesh._positions[0].push(t[F].y),this._mesh._positions[0].push(t[F].z),this._mesh._positions[0].push(t[D].x),this._mesh._positions[0].push(t[D].y),this._mesh._positions[0].push(t[D].z),this._mesh._positions[0].push(t[S].x),this._mesh._positions[0].push(t[S].y),this._mesh._positions[0].push(t[S].z),a&&(this._mesh._normals[0].push(A[w].x),this._mesh._normals[0].push(A[w].y),this._mesh._normals[0].push(A[w].z),this._mesh._normals[0].push(A[N].x),this._mesh._normals[0].push(A[N].y),this._mesh._normals[0].push(A[N].z),this._mesh._normals[0].push(A[T].x),this._mesh._normals[0].push(A[T].y),this._mesh._normals[0].push(A[T].z)),this._mesh._multiIndIndices.push(F,D,S),l&&(this._mesh._colors[0].push(o[G].r),this._mesh._colors[0].push(o[G].g),this._mesh._colors[0].push(o[G].b),4===k&&this._mesh._colors[0].push(o[G].a),this._mesh._colors[0].push(o[U].r),this._mesh._colors[0].push(o[U].g),this._mesh._colors[0].push(o[U].b),4===k&&this._mesh._colors[0].push(o[U].a),this._mesh._colors[0].push(o[L].r),this._mesh._colors[0].push(o[L].g),this._mesh._colors[0].push(o[L].b),4===k&&this._mesh._colors[0].push(o[L].a)),h&&(this._mesh._texCoords[0].push(i[b].x),this._mesh._texCoords[0].push(i[b].y),3===m&&this._mesh._texCoords[0].push(i[b].z),this._mesh._texCoords[0].push(i[M].x),this._mesh._texCoords[0].push(i[M].y),3===m&&this._mesh._texCoords[0].push(i[M].z),this._mesh._texCoords[0].push(i[R].x),this._mesh._texCoords[0].push(i[R].y),3===m&&this._mesh._texCoords[0].push(i[R].z));break;case 3:D=S,M=R,f&&(N=T),c&&(U=L),S=+e[Q],d&&f?T=+s[Q]:d&&!f||(T=f?S:y),R=g?+n[Q]:S,I&&c?L=+r[Q]:I&&!c||(L=c?S:y),this._mesh._positions[0].push(t[F].x),this._mesh._positions[0].push(t[F].y),this._mesh._positions[0].push(t[F].z),this._mesh._positions[0].push(t[D].x),this._mesh._positions[0].push(t[D].y),this._mesh._positions[0].push(t[D].z),this._mesh._positions[0].push(t[S].x),this._mesh._positions[0].push(t[S].y),this._mesh._positions[0].push(t[S].z),a&&(this._mesh._normals[0].push(A[w].x),this._mesh._normals[0].push(A[w].y),this._mesh._normals[0].push(A[w].z),this._mesh._normals[0].push(A[N].x),this._mesh._normals[0].push(A[N].y),this._mesh._normals[0].push(A[N].z),this._mesh._normals[0].push(A[T].x),this._mesh._normals[0].push(A[T].y),this._mesh._normals[0].push(A[T].z)),this._mesh._multiIndIndices.push(F,D,S),l&&(this._mesh._colors[0].push(o[G].r),this._mesh._colors[0].push(o[G].g),this._mesh._colors[0].push(o[G].b),4===k&&this._mesh._colors[0].push(o[G].a),this._mesh._colors[0].push(o[U].r),this._mesh._colors[0].push(o[U].g),this._mesh._colors[0].push(o[U].b),4===k&&this._mesh._colors[0].push(o[U].a),this._mesh._colors[0].push(o[L].r),this._mesh._colors[0].push(o[L].g),this._mesh._colors[0].push(o[L].b),4===k&&this._mesh._colors[0].push(o[L].a)),h&&(this._mesh._texCoords[0].push(i[b].x),this._mesh._texCoords[0].push(i[b].y),3===m&&this._mesh._texCoords[0].push(i[b].z),this._mesh._texCoords[0].push(i[M].x),this._mesh._texCoords[0].push(i[M].y),3===m&&this._mesh._texCoords[0].push(i[M].z),this._mesh._texCoords[0].push(i[R].x),this._mesh._texCoords[0].push(i[R].y),3===m&&this._mesh._texCoords[0].push(i[R].z))}else v=0,y++;else{var P=new x3dom.DoublyLinkedList,O={};for(0,y=0,this._mesh._multiIndIndices=[],Q=0;Q<e.length;++Q)if(-1!=e[Q])a&&(O.normals=d&&f?A[s[Q]]:d&&!f?A[s[y]]:A[e[Q]]),l&&(O.colors=I&&c?o[r[Q]]:I&&!c?o[r[y]]:c?o[e[Q]]:o[y]),h&&(O.texCoords=g?i[n[Q]]:i[e[Q]]),P.appendNode(new x3dom.DoublyLinkedList.ListNode(t[e[Q]],e[Q],O.normals,O.colors,O.texCoords));else{var Y=x3dom.EarClipping.getMultiIndexes(P);for(x=0;x<Y.indices.length;x++)this._mesh._multiIndIndices.push(Y.indices[x]),this._mesh._positions[0].push(Y.point[x].x,Y.point[x].y,Y.point[x].z),a&&this._mesh._normals[0].push(Y.normals[x].x,Y.normals[x].y,Y.normals[x].z),l&&(this._mesh._colors[0].push(Y.colors[x].r,Y.colors[x].g,Y.colors[x].b),4===k&&this._mesh._colors[0].push(Y.colors[x].a)),h&&(this._mesh._texCoords[0].push(Y.texCoords[x].x,Y.texCoords[x].y),3===m&&this._mesh._texCoords[0].push(Y.texCoords[x].z));P=new x3dom.DoublyLinkedList,y++}this._mesh.splitMesh()}a||this._mesh.calcNormals(this._vf.creaseAngle,this._vf.ccw),h||this._mesh.calcTexCoords(_)}else{if(v=0,this._vf.convex)for(Q=0;Q<e.length;++Q)if(-1!=e[Q])switch(v){case 0:w=+e[Q],v=1;break;case 1:N=+e[Q],v=2;break;case 2:T=+e[Q],v=3,this._mesh._indices[0].push(w,N,T);break;case 3:N=T,T=+e[Q],this._mesh._indices[0].push(w,N,T)}else v=0;else for(P=new x3dom.DoublyLinkedList,Q=0;Q<e.length;++Q)if(-1!=e[Q])P.appendNode(new x3dom.DoublyLinkedList.ListNode(t[e[Q]],e[Q]));else{var J=x3dom.EarClipping.getIndexes(P);for(x=0;x<J.length;x++)this._mesh._indices[0].push(J[x]);P=new x3dom.DoublyLinkedList}this._mesh._positions[0]=t.toGL(),a?this._mesh._normals[0]=A.toGL():this._mesh.calcNormals(this._vf.creaseAngle,this._vf.ccw),h?(this._mesh._texCoords[0]=i.toGL(),this._mesh._numTexComponents=m):this._mesh.calcTexCoords(_),l&&(this._mesh._colors[0]=o.toGL(),this._mesh._numColComponents=k)}for(this.invalidateVolume(),this._mesh._numFaces=0,this._mesh._numCoords=0,Q=0;Q<this._mesh._positions.length;Q++){var K=this._mesh._indices[Q].length,X=this._mesh._positions[Q].length/3;this._mesh._numCoords+=X,this._mesh._numFaces+=K>0?K/3:X/3}},fieldChanged:function(e){if("coord"==e||"normal"==e||"texCoord"==e||"color"==e||"coordIndex"==e){var t=this._cf.coord.node._vf.point,A=t.length,i=this._cf.texCoord.node;if(x3dom.isa(i,x3dom.nodeTypes.MultiTextureCoordinate)&&i._cf.texCoord.nodes.length&&(i=i._cf.texCoord.nodes[0]),(this._vf.creaseAngle<=x3dom.fields.Eps||A>x3dom.Utils.maxIndexableCoords||this._vf.normalIndex.length>0&&this._cf.normal.node||this._vf.texCoordIndex.length>0&&i||this._vf.colorIndex.length>0&&this._cf.color.node)&&this._mesh._multiIndIndices){var o=!this._cf.normal.node&&"none"!=this._vf.normalUpdateMode.toLowerCase();if(A=this._mesh._multiIndIndices.length,this._mesh._positions[0]=[],this._mesh._indices[0]=[],"coord"==e&&A){for(b=0;b<A;b+=3){var s=this._mesh._multiIndIndices[b],n=this._mesh._multiIndIndices[b+1],r=this._mesh._multiIndIndices[b+2],a=t[s],d=t[n],h=t[r];this._mesh._positions[0].push(a.x,a.y,a.z),this._mesh._positions[0].push(d.x,d.y,d.z),this._mesh._positions[0].push(h.x,h.y,h.z)}return o&&this._mesh.calcNormals(this._vf.creaseAngle,this._vf.ccw),this.invalidateVolume(),void this._parentNodes.forEach((function(e){e._dirty.positions=!0,o&&(e._dirty.normals=!0)}))}this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];var g,l,I,c,f=this._vf.coordIndex,u=this._vf.normalIndex,C=this._vf.texCoordIndex,_=this._vf.colorIndex,m=!1,p=!1,E=!1,B=!1,Q=!1,x=!1,v=this._vf.colorPerVertex,y=this._vf.normalPerVertex;u.length>0&&(p=!0),C.length>0&&(B=!0),_.length>0&&(x=!0);var F=this._cf.coord.node;x3dom.debug.assert(F),g=F.getPoints();var D=this._cf.normal.node;D?(m=!0,l=D._vf.vector):m=!1;var S="",w=2;if(i=this._cf.texCoord.node,x3dom.isa(i,x3dom.nodeTypes.MultiTextureCoordinate)&&i._cf.texCoord.nodes.length&&(i=i._cf.texCoord.nodes[0]),i)if(i._vf.point){E=!0,I=i._vf.point;var N=B?Math.max(...C)+1:g.length,T=I.length;for(b=T;b<N;b++)I.push(I[b%T]);x3dom.isa(i,x3dom.nodeTypes.TextureCoordinate3D)&&(w=3)}else i._vf.mode&&(S=i._vf.mode);else E=!1;this._mesh._numTexComponents=w;var b,M,R,G,U,L,k,V,P,O,Y,J,K,X,H,z,q,W=3,j=this._cf.color.node;if(j?(Q=!0,c=j._vf.color,x3dom.isa(j,x3dom.nodeTypes.ColorRGBA)&&(W=4)):Q=!1,this._mesh._numColComponents=W,this._vf.convex)for(R=0,G=0,U=0,this._mesh._multiIndIndices=[],this._mesh._posSize=g.length,b=0;b<f.length;++b)if(-1!=f[b])switch(p&&x3dom.debug.assert(-1!=u[b]),B&&x3dom.debug.assert(-1!=C[b]),x&&x3dom.debug.assert(-1!=_[b]),R){case 0:L=+f[b],P=p&&y?+u[b]:p&&!y?+u[U]:y?L:U,J=B?+C[b]:L,H=x&&v?+_[b]:x&&!v?+_[U]:v?L:U,R=1;break;case 1:k=+f[b],O=p&&y?+u[b]:p&&!y?+u[U]:y?k:U,K=B?+C[b]:k,z=x&&v?+_[b]:x&&!v?+_[U]:v?k:U,R=2;break;case 2:V=+f[b],Y=p&&y?+u[b]:p&&!y?+u[U]:y?V:U,X=B?+C[b]:V,q=x&&v?+_[b]:x&&!v?+_[U]:v?V:U,R=3,this._mesh._positions[0].push(g[L].x),this._mesh._positions[0].push(g[L].y),this._mesh._positions[0].push(g[L].z),this._mesh._positions[0].push(g[k].x),this._mesh._positions[0].push(g[k].y),this._mesh._positions[0].push(g[k].z),this._mesh._positions[0].push(g[V].x),this._mesh._positions[0].push(g[V].y),this._mesh._positions[0].push(g[V].z),m&&(this._mesh._normals[0].push(l[P].x),this._mesh._normals[0].push(l[P].y),this._mesh._normals[0].push(l[P].z),this._mesh._normals[0].push(l[O].x),this._mesh._normals[0].push(l[O].y),this._mesh._normals[0].push(l[O].z),this._mesh._normals[0].push(l[Y].x),this._mesh._normals[0].push(l[Y].y),this._mesh._normals[0].push(l[Y].z)),this._mesh._multiIndIndices.push(L,k,V),Q&&(this._mesh._colors[0].push(c[H].r),this._mesh._colors[0].push(c[H].g),this._mesh._colors[0].push(c[H].b),4===W&&this._mesh._colors[0].push(c[H].a),this._mesh._colors[0].push(c[z].r),this._mesh._colors[0].push(c[z].g),this._mesh._colors[0].push(c[z].b),4===W&&this._mesh._colors[0].push(c[z].a),this._mesh._colors[0].push(c[q].r),this._mesh._colors[0].push(c[q].g),this._mesh._colors[0].push(c[q].b),4===W&&this._mesh._colors[0].push(c[q].a)),E&&(this._mesh._texCoords[0].push(I[J].x),this._mesh._texCoords[0].push(I[J].y),3===w&&this._mesh._texCoords[0].push(I[J].z),this._mesh._texCoords[0].push(I[K].x),this._mesh._texCoords[0].push(I[K].y),3===w&&this._mesh._texCoords[0].push(I[K].z),this._mesh._texCoords[0].push(I[X].x),this._mesh._texCoords[0].push(I[X].y),3===w&&this._mesh._texCoords[0].push(I[X].z));break;case 3:k=V,K=X,y&&(O=Y),v&&(z=q),V=+f[b],p&&y?Y=+u[b]:p&&!y||(Y=y?V:U),X=B?+C[b]:V,x&&v?q=+_[b]:x&&!v||(q=v?V:U),this._mesh._positions[0].push(g[L].x),this._mesh._positions[0].push(g[L].y),this._mesh._positions[0].push(g[L].z),this._mesh._positions[0].push(g[k].x),this._mesh._positions[0].push(g[k].y),this._mesh._positions[0].push(g[k].z),this._mesh._positions[0].push(g[V].x),this._mesh._positions[0].push(g[V].y),this._mesh._positions[0].push(g[V].z),m&&(this._mesh._normals[0].push(l[P].x),this._mesh._normals[0].push(l[P].y),this._mesh._normals[0].push(l[P].z),this._mesh._normals[0].push(l[O].x),this._mesh._normals[0].push(l[O].y),this._mesh._normals[0].push(l[O].z),this._mesh._normals[0].push(l[Y].x),this._mesh._normals[0].push(l[Y].y),this._mesh._normals[0].push(l[Y].z)),this._mesh._multiIndIndices.push(L,k,V),Q&&(this._mesh._colors[0].push(c[H].r),this._mesh._colors[0].push(c[H].g),this._mesh._colors[0].push(c[H].b),4===W&&this._mesh._colors[0].push(c[H].a),this._mesh._colors[0].push(c[z].r),this._mesh._colors[0].push(c[z].g),this._mesh._colors[0].push(c[z].b),4===W&&this._mesh._colors[0].push(c[z].a),this._mesh._colors[0].push(c[q].r),this._mesh._colors[0].push(c[q].g),this._mesh._colors[0].push(c[q].b),4===W&&this._mesh._colors[0].push(c[q].a)),E&&(this._mesh._texCoords[0].push(I[J].x),this._mesh._texCoords[0].push(I[J].y),3===w&&this._mesh._texCoords[0].push(I[J].z),this._mesh._texCoords[0].push(I[K].x),this._mesh._texCoords[0].push(I[K].y),3===w&&this._mesh._texCoords[0].push(I[K].z),this._mesh._texCoords[0].push(I[X].x),this._mesh._texCoords[0].push(I[X].y),3===w&&this._mesh._texCoords[0].push(I[X].z))}else R=0,U++;else{var Z=new x3dom.DoublyLinkedList,$={};for(G=0,U=0,b=0;b<f.length;++b)if(-1!=f[b])m&&($.normals=p&&y?l[u[b]]:p&&!y?l[u[U]]:l[f[b]]),Q&&($.colors=x&&v?c[_[b]]:x&&!v?c[_[U]]:c[f[b]]),E&&($.texCoords=B?I[C[b]]:I[f[b]]),Z.appendNode(new x3dom.DoublyLinkedList.ListNode(g[f[b]],f[b],$.normals,$.colors,$.texCoords));else{var ee=x3dom.EarClipping.getMultiIndexes(Z);for(M=0;M<ee.indices.length;M++)this._mesh._indices[0].push(G),G++,this._mesh._positions[0].push(ee.point[M].x,ee.point[M].y,ee.point[M].z),m&&this._mesh._normals[0].push(ee.normals[M].x,ee.normals[M].y,ee.normals[M].z),Q&&(this._mesh._colors[0].push(ee.colors[M].r,ee.colors[M].g,ee.colors[M].b),4===W&&this._mesh._colors[0].push(ee.colors[M].a)),E&&(this._mesh._texCoords[0].push(ee.texCoords[M].x,ee.texCoords[M].y),3===w&&this._mesh._texCoords[0].push(ee.texCoords[M].z));Z=new x3dom.DoublyLinkedList,U++}this._mesh.splitMesh()}for(m||this._mesh.calcNormals(this._vf.creaseAngle,this._vf.ccw),E||this._mesh.calcTexCoords(S),this.invalidateVolume(),this._mesh._numFaces=0,this._mesh._numCoords=0,b=0;b<this._mesh._positions.length;b++){var te=this._mesh._indices[b].length,Ae=this._mesh._positions[b].length/3;this._mesh._numCoords+=Ae,this._mesh._numFaces+=te>0?te/3:Ae/3}this._parentNodes.forEach((function(e){e.setGeoDirty()}))}else if("coord"==e){o=!this._cf.normal.node&&"none"!=this._vf.normalUpdateMode.toLowerCase();this._mesh._positions[0]=t.toGL(),o&&this._mesh.calcNormals(this._vf.creaseAngle,this._vf.ccw),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,o&&(e._dirty.normals=!0),e.invalidateVolume()}))}else if("color"==e)t=this._cf.color.node._vf.color,this._mesh._colors[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.colors=!0}));else if("normal"==e)t=this._cf.normal.node._vf.vector,this._mesh._normals[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.normals=!0}));else if("texCoord"==e)i=this._cf.texCoord.node,x3dom.isa(i,x3dom.nodeTypes.MultiTextureCoordinate)&&i._cf.texCoord.nodes.length&&(i=i._cf.texCoord.nodes[0]),t=i._vf.point,this._mesh._texCoords[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.texcoords=!0}));else if("coordIndex"==e){for(o=!this._cf.normal.node&&"none"!=this._vf.normalUpdateMode.toLowerCase(),R=0,A=(f=this._vf.coordIndex).length,this._mesh._indices[0]=[],b=0;b<A;++b)if(-1==f[b])R=0;else switch(R){case 0:L=+f[b],R=1;break;case 1:k=+f[b],R=2;break;case 2:V=+f[b],R=3,this._mesh._indices[0].push(L,k,V);break;case 3:k=V,V=+f[b],this._mesh._indices[0].push(L,k,V)}o&&this._mesh.calcNormals(this._vf.creaseAngle,this._vf.ccw),this._parentNodes.forEach((function(e){e._dirty.indexes=!0,o&&(e._dirty.normals=!0)}))}}else x3dom.debug.logWarning("IndexedFaceSet: fieldChanged for "+e+" not yet implemented!")}})),x3dom.registerNodeType("BufferGeometry","Geometry3D",defineClass(x3dom.nodeTypes.X3DBinaryContainerGeometryNode,(function(e){x3dom.nodeTypes.BufferGeometry.superClass.call(this,e),this.addField_SFString(e,"buffer",""),this.addField_SFBool(e,"draco",!1),this.addField_MFNode("views",x3dom.nodeTypes.BufferView),this.addField_MFNode("accessors",x3dom.nodeTypes.BufferAccessor),this._hasColor=!1,this._hasMultiTexCoord=!1,this._indexed=!1}),{parentAdded:function(e){},nodeChanged:function(){},doIntersect:function(e){var t=this.getMin(),A=this.getMax();return!!(e.intersect(t,A)&&e.enter<e.dist)&&(e.dist=e.enter,e.hitObject=this,e.hitPoint=e.pos.add(e.dir.multiply(e.enter)),!0)},hasColor:function(){return this._hasColor},hasMultiTexCoord:function(){return this._hasMultiTexCoord},getPrecisionMax:function(e){switch(this._vf[e]){case"Int8":return 127;case"Uint8":return 255;case"Int16":return 32767;case"Uint16":return 65535;case"Int32":return 2147483647;case"Uint32":return 4294967295;case"Float32":case"Float64":default:return 1}}})),x3dom.registerNodeType("BufferView","Geometry3D",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.BufferView.superClass.call(this,e),this.addField_SFInt32(e,"target",34962),this.addField_SFInt32(e,"byteOffset",0),this.addField_SFInt32(e,"byteStride",0),this.addField_SFInt32(e,"byteLength",0),this.addField_SFInt32(e,"idx",0),this.addField_SFInt32(e,"dracoId",0)}),{parentAdded:function(e){}})),x3dom.registerNodeType("BufferAccessor","Geometry3D",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.BufferAccessor.superClass.call(this,e),this.addField_SFString(e,"bufferType",""),this.addField_SFInt32(e,"view",0),this.addField_SFInt32(e,"byteOffset",0),this.addField_SFInt32(e,"byteStride",0),this.addField_SFInt32(e,"components",0),this.addField_SFInt32(e,"componentType",5126),this.addField_SFInt32(e,"count",0),this.addField_SFBool(e,"normalized",!1)}),{parentAdded:function(e){switch(this._vf.bufferType){case"COLOR_0":case"COLOR":e._hasColor=!0;break;case"INDEX":e._indexed=!0;break;case"TEXCOORD_1":e._hasMultiTexCoord=!0}}})),x3dom.registerNodeType("X3DTexture3DNode","Texturing3D",defineClass(x3dom.nodeTypes.X3DTextureNode,(function(e){x3dom.nodeTypes.X3DTexture3DNode.superClass.call(this,e)}))),x3dom.registerNodeType("ComposedTexture3D","Texturing3D",defineClass(x3dom.nodeTypes.X3DTexture3DNode,(function(e){x3dom.nodeTypes.ComposedTexture3D.superClass.call(this,e),this.addField_MFNode("texture",x3dom.nodeTypes.X3DTexture3DNode)}))),x3dom.registerNodeType("ImageTexture3D","Texturing3D",defineClass(x3dom.nodeTypes.X3DTexture3DNode,(function(e){x3dom.nodeTypes.ImageTexture3D.superClass.call(this,e)}))),x3dom.registerNodeType("PixelTexture3D","Texturing3D",defineClass(x3dom.nodeTypes.X3DTexture3DNode,(function(e){x3dom.nodeTypes.PixelTexture3D.superClass.call(this,e)}))),x3dom.registerNodeType("TextureCoordinate3D","Texturing3D",defineClass(x3dom.nodeTypes.X3DTextureCoordinateNode,(function(e){x3dom.nodeTypes.TextureCoordinate3D.superClass.call(this,e),this.addField_MFVec3f(e,"point",[])}))),x3dom.registerNodeType("TextureTransform3D","Texturing3D",defineClass(x3dom.nodeTypes.X3DTextureTransformNode,(function(e){x3dom.nodeTypes.TextureTransform3D.superClass.call(this,e),this.addField_SFVec3f(e,"center",0,0,0),this.addField_SFRotation(e,"rotation",0,0,1,0),this.addField_SFVec3f(e,"scale",1,1,1),this.addField_SFVec3f(e,"translation",0,0,0),this.addField_SFRotation(e,"scaleOrientation",0,0,1,0)}))),x3dom.registerNodeType("TextureTransformMatrix3D","Texturing3D",defineClass(x3dom.nodeTypes.X3DTextureTransformNode,(function(e){x3dom.nodeTypes.TextureTransformMatrix3D.superClass.call(this,e),this.addField_SFMatrix4f(e,"matrix",1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}))),x3dom.registerNodeType("X3DPointingDeviceSensorNode","PointingDeviceSensor",defineClass(x3dom.nodeTypes.X3DSensorNode,(function(e){x3dom.nodeTypes.X3DPointingDeviceSensorNode.superClass.call(this,e),this._isOver=!1}),{pointerPressedOverSibling:function(e){this._vf.enabled&&(this._vf.isActive=!0,this.postMessage("isActive",!0),this._isOver=!0)},pointerMoved:function(e){},pointerMovedOver:function(e){this._vf.enabled&&this.postMessage("isOver",!0)},pointerMovedOut:function(e){this._vf.enabled&&(this.postMessage("isOver",!1),this._isOver=!1)},pointerReleased:function(){this._vf.enabled&&(this._vf.isActive=!1,this.postMessage("isActive",!1),this._isOver&&this.postMessage("touchTime",Date.now()/1e3))}})),x3dom.registerNodeType("X3DDragSensorNode","PointingDeviceSensor",defineClass(x3dom.nodeTypes.X3DPointingDeviceSensorNode,(function(e){x3dom.nodeTypes.X3DDragSensorNode.superClass.call(this,e),this.addField_SFBool(e,"autoOffset",!0),this._lastX=-1,this._lastY=-1}),{pointerPressedOverSibling:function(e){x3dom.nodeTypes.X3DPointingDeviceSensorNode.prototype.pointerPressedOverSibling.call(this,e),this._lastX=e.layerX,this._lastY=e.layerY,this._startDragging(e.viewarea,e.layerX,e.layerX,e.worldX,e.worldY,e.worldZ)},pointerMoved:function(e){x3dom.nodeTypes.X3DPointingDeviceSensorNode.prototype.pointerMoved.call(this,e),this._vf.isActive&&this._vf.enabled&&this._process2DDrag(e.layerX,e.layerY,e.layerX-this._lastX,e.layerY-this._lastY)},pointerReleased:function(){x3dom.nodeTypes.X3DPointingDeviceSensorNode.prototype.pointerReleased.call(this),this._stopDragging()},_startDragging:function(e,t,A,i,o,s){},_process2DDrag:function(e,t,A,i){},_stopDragging:function(){}})),x3dom.registerNodeType("X3DTouchSensorNode","PointingDeviceSensor",defineClass(x3dom.nodeTypes.X3DPointingDeviceSensorNode,(function(e){x3dom.nodeTypes.X3DTouchSensorNode.superClass.call(this,e)}),{})),x3dom.registerNodeType("TouchSensor","PointingDeviceSensor",defineClass(x3dom.nodeTypes.X3DTouchSensorNode,(function(e){x3dom.nodeTypes.TouchSensor.superClass.call(this,e),this._hitPoint=new x3dom.fields.SFVec3f,this._hitNormal=new x3dom.fields.SFVec3f,this._hitRotation=new x3dom.fields.Quaternion,this._up=new x3dom.fields.SFVec3f(0,1,0)}),{pointerMoved:function(e){this._vf.enabled&&(this.postMessage("hitPoint_changed",this._hitPoint.fromArray(e.hitPnt)),this._hitNormal.set(e.normalX,e.normalY,e.normalZ),this.postMessage("hitNormal_changed",this._hitNormal),this.postMessage("hitRotation_changed",x3dom.fields.Quaternion.rotateFromTo(this._up,this._hitNormal)))}})),x3dom.registerNodeType("PlaneSensor","PointingDeviceSensor",defineClass(x3dom.nodeTypes.X3DDragSensorNode,(function(e){x3dom.nodeTypes.PlaneSensor.superClass.call(this,e),this.addField_SFRotation(e,"axisRotation",0,0,1,0),this.addField_SFVec2f(e,"minPosition",0,0),this.addField_SFVec2f(e,"maxPosition",-1,-1),this.addField_SFVec3f(e,"offset",0,0,0),this.addField_SFString(e,"planeOrientation","XY"),this._rotationMatrix=this._vf.axisRotation.toMatrix(),this._worldToLocalMatrix=null,this._initialPlaneIntersection=null,this._planeNormal=null,this._viewArea=null,this._currentTranslation=new x3dom.fields.SFVec3f(0,0,0),this._lineModeAxis=null,this._vf.minPosition.x==this._vf.maxPosition.x&&(this._lineModeAxis=new x3dom.fields.SFVec3f(0,1,0)),this._vf.minPosition.y==this._vf.maxPosition.y&&(this._lineModeAxis=new x3dom.fields.SFVec3f(1,0,0))}),{getCurrentTransform:function(){var e=x3dom.nodeTypes.X3DDragSensorNode.prototype.getCurrentTransform.call(this);return this._rotationMatrix.mult(e)},_startDragging:function(e,t,A,i,o,s){var n;if(x3dom.nodeTypes.X3DDragSensorNode.prototype._startDragging.call(this,e,t,A,i,o,s),this._viewArea=e,this._viewMat=this._viewArea.getViewMatrix(),this._viewMatInv=this._viewMat.inverse(),this._currentTranslation=new x3dom.fields.SFVec3f(0,0,0).add(this._vf.offset),this._localToWorldMatrix=this.getCurrentTransform(),this._worldToLocalMatrix=this._localToWorldMatrix.inverse(),this._initialPlaneIntersection=this._worldToLocalMatrix.multMatrixPnt(new x3dom.fields.SFVec3f(i,o,s)),this._planeNormal=new x3dom.fields.SFVec3f(0,0,1),"screen"==this._vf.planeOrientation)n=e.calcViewRay(e._width/2,e._height/2),this._planeNormal=this._worldToLocalMatrix.multMatrixVec(n.dir.normalize());else if(this._lineModeAxis){n=e.calcViewRay(t,A);var r=this._worldToLocalMatrix.multMatrixVec(n.dir.normalize()),a=this._lineModeAxis;this._planeNormal=a.cross(a.cross(r))}},_process2DDrag:function(e,t,A,i){x3dom.nodeTypes.X3DDragSensorNode.prototype._process2DDrag.call(this,e,t,A,i);var o,s,n=null;if(this._initialPlaneIntersection){var r=this._viewArea.calcViewRay(e,t);if(r.pos=this._worldToLocalMatrix.multMatrixPnt(r.pos),r.dir=this._worldToLocalMatrix.multMatrixVec(r.dir.normalize()),Math.abs(this._planeNormal.dot(r.dir))<.1)return;if((n=r.intersectPlane(this._initialPlaneIntersection,this._planeNormal))||(n=r.intersectPlane(this._initialPlaneIntersection,this._planeNormal.negate())),n){if(this._currentTranslation=n.subtract(this._initialPlaneIntersection),this._currentTranslation=this._currentTranslation.add(this._vf.offset),o=this._vf.minPosition,s=this._vf.maxPosition,"screen"==this._vf.planeOrientation){if(o.x<=s.x||o.y<=s.y){var a=this._localToWorldMatrix.multMatrixVec(this._currentTranslation);d(a=this._viewMat.multMatrixVec(a),o,s),a=this._viewMatInv.multMatrixVec(a),this._currentTranslation=this._worldToLocalMatrix.multMatrixVec(a)}}else d(this._currentTranslation,o,s),this._currentTranslation.z=0;this.postMessage("translation_changed",x3dom.fields.SFVec3f.copy(this._currentTranslation)),this.postMessage("trackPoint_changed",n)}}function d(e,t,A){t.x<=A.x&&(e.x=Math.min(e.x,A.x),e.x=Math.max(e.x,t.x)),t.y<=A.y&&(e.y=Math.min(e.y,A.y),e.y=Math.max(e.y,t.y))}},_stopDragging:function(){x3dom.nodeTypes.X3DDragSensorNode.prototype._stopDragging.call(this),this._vf.autoOffset&&(this._vf.offset=x3dom.fields.SFVec3f.copy(this._currentTranslation),this.postMessage("offset_changed",this._vf.offset))}})),x3dom.registerNodeType("SphereSensor","PointingDeviceSensor",defineClass(x3dom.nodeTypes.X3DDragSensorNode,(function(e){x3dom.nodeTypes.SphereSensor.superClass.call(this,e),this.addField_SFRotation(e,"offset",0,1,0,0),this._currentRotation=null,this._rotationMatrix=this._vf.offset.toMatrix()}),{getCurrentTransform:function(){return x3dom.nodeTypes.X3DDragSensorNode.prototype.getCurrentTransform.call(this).mult(this._rotationMatrix)},_startDragging:function(e,t,A,i,o,s){x3dom.nodeTypes.X3DDragSensorNode.prototype._startDragging.call(this,e,t,A,i,o,s),this._currentRotation=new x3dom.fields.Quaternion,this._viewArea=e,this._localOrigin=new x3dom.fields.SFVec3f(0,0,0),this._inverseToWorldMatrix=this.getCurrentTransform().inverse();var n=this._inverseToWorldMatrix.multMatrixPnt(new x3dom.fields.SFVec3f(i,o,s));this._initialSphereIntersectionVector=n.subtract(this._localOrigin),this._sphereRadius=this._initialSphereIntersectionVector.length(),this._initialSphereIntersectionVector=this._initialSphereIntersectionVector.normalize()},_process2DDrag:function(e,t,A,i){x3dom.nodeTypes.X3DDragSensorNode.prototype._process2DDrag.call(this,e,t,A,i);var o=this._viewArea.calcViewRay(e,t);o.pos=this._inverseToWorldMatrix.multMatrixPnt(o.pos),o.dir=this._inverseToWorldMatrix.multMatrixVec(o.dir);var s,n,r=o.dir.dot(o.dir),a=2*o.dir.dot(o.pos.subtract(this._localOrigin)),d=a*a-4*r*(o.pos.dot(o.pos)-2*this._localOrigin.dot(o.pos)+this._localOrigin.dot(this._localOrigin)-this._sphereRadius*this._sphereRadius);if(d>=0&&(s=(-a+Math.sqrt(d))/(2*r),n=(-a-Math.sqrt(d))/(2*r),(s=Math.min(s,n))>=1)){var h=o.pos.add(o.dir.multiply(s)).subtract(this._localOrigin).normalize();this._currentRotation=x3dom.fields.Quaternion.rotateFromTo(this._initialSphereIntersectionVector,h),this._currentRotation=this._currentRotation.multiply(this._vf.offset),this.postMessage("rotation_changed",this._currentRotation)}},_stopDragging:function(){x3dom.nodeTypes.X3DDragSensorNode.prototype._stopDragging.call(this),this._vf.autoOffset&&(this._vf.offset=this._currentRotation,this.postMessage("offset_changed",this._vf.offset)),this._currentRotation=new x3dom.fields.Quaternion}})),x3dom.registerNodeType("CylinderSensor","PointingDeviceSensor",defineClass(x3dom.nodeTypes.X3DDragSensorNode,(function(e){x3dom.nodeTypes.CylinderSensor.superClass.call(this,e),this.addField_SFFloat(e,"offset",0),this.addField_SFRotation(e,"axisRotation",0,1,0,0),this.addField_SFFloat(e,"diskAngle",.262),this.addField_SFFloat(e,"minAngle",0),this.addField_SFFloat(e,"maxAngle",-1),this._rotationMatrix=this._vf.axisRotation.toMatrix(),this._inverseToWorldMatrix=null,this._initialCylinderIntersectionVector=null,this._viewArea=null,this._cylinderRadius=0,this._yAxisLine=null,this._cylinderMode=!0,this._currentRotationAngle=0}),{getCurrentTransform:function(){return x3dom.nodeTypes.X3DDragSensorNode.prototype.getCurrentTransform.call(this).mult(this._rotationMatrix)},_startDragging:function(e,t,A,i,o,s){x3dom.nodeTypes.X3DDragSensorNode.prototype._startDragging.call(this,e,t,A,i,o,s),this._currentRotation=new x3dom.fields.Quaternion,this._viewArea=e,this._yAxisLine=new x3dom.fields.Line(new x3dom.fields.SFVec3f(0,0,0),new x3dom.fields.SFVec3f(0,1,0)),this._inverseToWorldMatrix=this.getCurrentTransform().inverse();var n=this._inverseToWorldMatrix.multMatrixPnt(new x3dom.fields.SFVec3f(i,o,s)),r=this._yAxisLine.closestPoint(n);this._initialCylinderIntersectionVector=n.subtract(r),this._cylinderRadius=this._initialCylinderIntersectionVector.length(),this._initialCylinderIntersectionVector=this._initialCylinderIntersectionVector.normalize()},_process2DDrag:function(e,t,A,i){if(x3dom.nodeTypes.X3DDragSensorNode.prototype._process2DDrag.call(this,e,t,A,i),this._cylinderMode){var o=this._viewArea.calcViewRay(e,t);o.pos=this._inverseToWorldMatrix.multMatrixPnt(o.pos),o.dir=this._inverseToWorldMatrix.multMatrixVec(o.dir);var s,n,r=o.dir.subtract(this._yAxisLine.dir.multiply(o.dir.dot(this._yAxisLine.dir))),a=o.pos.subtract(this._yAxisLine.pos).add(this._yAxisLine.dir.multiply(this._yAxisLine.dir.dot(this._yAxisLine.pos.subtract(o.pos)))),d=2*r.dot(a)/r.dot(r),h=d*d*.25-(a.dot(a)-this._cylinderRadius*this._cylinderRadius)/r.dot(r);if(h>=0&&(s=.5*-d+(h=Math.sqrt(h)),n=.5*-d-h,(s=Math.min(s,n))>0)){var g=o.pos.add(o.dir.multiply(s)),l=this._yAxisLine.closestPoint(g),I=g.subtract(l).normalize();this._currentRotation=x3dom.fields.Quaternion.rotateFromTo(this._initialCylinderIntersectionVector,I);var c=x3dom.fields.Quaternion.axisAngle(this._yAxisLine.dir,this._vf.offset);this._currentRotation=this._currentRotation.multiply(c),this.postMessage("rotation_changed",this._currentRotation)}}},_stopDragging:function(){x3dom.nodeTypes.X3DDragSensorNode.prototype._stopDragging.call(this),this._vf.autoOffset&&(this._vf.offset=this._currentRotation.angle(),this.postMessage("offset_changed",this._vf.offset))}})),x3dom.registerNodeType("X3DSequencerNode","EventUtilities",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DSequencerNode.superClass.call(this,e),this.addField_SFBool(e,"next",!1),this.addField_SFBool(e,"previous",!1),this.addField_MFFloat(e,"key",[]),this.addField_SFFloat(e,"set_fraction",0),this._keyIndex=-1,this._key_changed=!1,this._keyValue_changed=!1}),{findInterval:function(e){var t=this._vf.key.length-1;if(e<this._vf.key[0])return 0;if(e>=this._vf.key[t])return t;for(var A=0;A<t;++A)if(this._vf.key[A]<=e&&e<this._vf.key[A+1])return A;return 0},fieldChanged:function(e){if("set_fraction"!==e)return"next"===e&&this._vf.next?(this._keyIndex=(this._keyIndex+1)%this._vf.key.length,void this.postMessage("value_changed",this._vf.keyValue[this._keyIndex])):"previous"===e&&this._vf.previous?(this._keyIndex=(this._keyIndex-1+this._vf.key.length)%this._vf.key.length,void this.postMessage("value_changed",this._vf.keyValue[this._keyIndex])):"key"===e?this._key_changed?void(this._key_changed=!1):(this._key_changed=!0,void this.postMessage("key",this._vf.key)):"keyValue"===e?this._keyValue_changed?void(this._keyValue_changed=!1):(this._keyValue_changed=!0,void this.postMessage("keyValue",this._vf.keyValue)):void 0;var t=this.findInterval(this._vf.set_fraction);t!==this._keyIndex&&(this._keyIndex=t,this.postMessage("value_changed",this._vf.keyValue[t]))}})),x3dom.registerNodeType("X3DTriggerNode","EventUtilities",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.X3DTriggerNode.superClass.call(this,e)}))),x3dom.registerNodeType("BooleanFilter","EventUtilities",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.BooleanFilter.superClass.call(this,e),this.addField_SFBool(e,"set_boolean"),this.addField_SFBool(e,"inputFalse"),this.addField_SFBool(e,"inputTrue"),this.addField_SFBool(e,"inputNegate")}),{fieldChanged:function(e){if("set_boolean"===e){var t=this._vf.set_boolean;return this._vf.inputNegate=!t,this.postMessage("inputNegate",!t),t?(this._vf.inputTrue=!0,void this.postMessage("inputTrue",!0)):(this._vf.inputFalse=!1,void this.postMessage("inputFalse",!1))}}})),x3dom.registerNodeType("BooleanSequencer","EventUtilities",defineClass(x3dom.nodeTypes.X3DSequencerNode,(function(e){x3dom.nodeTypes.BooleanSequencer.superClass.call(this,e),this.addField_MFBoolean(e,"keyValue",[])}),{})),x3dom.registerNodeType("BooleanToggle","EventUtilities",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.BooleanToggle.superClass.call(this,e),this.addField_SFBool(e,"set_boolean"),this.addField_SFBool(e,"toggle",!1)}),{fieldChanged:function(e){if("set_boolean"!==e)"toggle"===e&&this.postMessage("toggle",this._vf.toggle);else if(this._vf.set_boolean){var t=!this._vf.toggle;this._vf.toggle=t,this.postMessage("toggle",t)}}})),x3dom.registerNodeType("BooleanTrigger","EventUtilities",defineClass(x3dom.nodeTypes.X3DTriggerNode,(function(e){x3dom.nodeTypes.BooleanTrigger.superClass.call(this,e),this.addField_SFTime(e,"set_triggerTime")}),{fieldChanged:function(e){"set_triggerTime"===e&&this.postMessage("triggerTrue",!0)}})),x3dom.registerNodeType("IntegerSequencer","EventUtilities",defineClass(x3dom.nodeTypes.X3DSequencerNode,(function(e){x3dom.nodeTypes.IntegerSequencer.superClass.call(this,e),this.addField_MFInt32(e,"keyValue",[])}),{})),x3dom.registerNodeType("IntegerTrigger","EventUtilities",defineClass(x3dom.nodeTypes.X3DTriggerNode,(function(e){x3dom.nodeTypes.IntegerTrigger.superClass.call(this,e),this.addField_SFBool(e,"set_boolean"),this.addField_SFInt32(e,"integerKey",-1)}),{fieldChanged:function(e){"set_boolean"===e&&this.postMessage("triggerValue",this._vf.integerKey)}})),x3dom.registerNodeType("TimeTrigger","EventUtilities",defineClass(x3dom.nodeTypes.X3DTriggerNode,(function(e){x3dom.nodeTypes.TimeTrigger.superClass.call(this,e),this.addField_SFBool(e,"set_boolean")}),{fieldChanged:function(e){"set_boolean"===e&&this.postMessage("triggerTime",Date.now()/1e3)}}));var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},$jscomp.arrayIterator=function(e){return{next:$jscomp.arrayIteratorImpl(e)}},$jscomp.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):$jscomp.arrayIterator(e)},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.ISOLATE_POLYFILLS=!1,$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,$jscomp.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var t=0;t<e.length;++t){var A=e[t];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")},$jscomp.global=$jscomp.getGlobal(this),$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,A){return e==Array.prototype||e==Object.prototype?e:(e[t]=A.value,e)},$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE,$jscomp.polyfills={},$jscomp.propertyToPolyfillSymbol={},$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(e,t){var A=$jscomp.propertyToPolyfillSymbol[t];return null==A?e[t]:void 0!==(A=e[A])?A:e[t]};$jscomp.polyfill=function(e,t,A,i){t&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(e,t,A,i):$jscomp.polyfillUnisolated(e,t,A,i))},$jscomp.polyfillUnisolated=function(e,t,A,i){for(A=$jscomp.global,e=e.split("."),i=0;i<e.length-1;i++){var o=e[i];if(!(o in A))return;A=A[o]}(t=t(i=A[e=e[e.length-1]]))!=i&&null!=t&&$jscomp.defineProperty(A,e,{configurable:!0,writable:!0,value:t})},$jscomp.polyfillIsolated=function(e,t,A,i){var o=e.split(".");e=1===o.length,i=o[0],i=!e&&i in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var s=0;s<o.length-1;s++){var n=o[s];if(!(n in i))return;i=i[n]}o=o[o.length-1],null!=(t=t(A=$jscomp.IS_SYMBOL_NATIVE&&"es6"===A?i[o]:null))&&(e?$jscomp.defineProperty($jscomp.polyfills,o,{configurable:!0,writable:!0,value:t}):t!==A&&(void 0===$jscomp.propertyToPolyfillSymbol[o]&&(A=1e9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[o]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(o):$jscomp.POLYFILL_PREFIX+A+"$"+o),$jscomp.defineProperty(i,$jscomp.propertyToPolyfillSymbol[o],{configurable:!0,writable:!0,value:t})))},$jscomp.polyfill("Promise",(function(e){function t(){this.batch_=null}function A(e){return e instanceof o?e:new o((function(t,A){t(e)}))}if(e&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&void 0===$jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return e;t.prototype.asyncExecute=function(e){if(null==this.batch_){this.batch_=[];var t=this;this.asyncExecuteFunction((function(){t.executeBatch_()}))}this.batch_.push(e)};var i=$jscomp.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){i(e,0)},t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var t=0;t<e.length;++t){var A=e[t];e[t]=null;try{A()}catch(e){this.asyncThrow_(e)}}}this.batch_=null},t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction((function(){throw e}))};var o=function(e){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[],this.isRejectionHandled_=!1;var t=this.createResolveAndReject_();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}};o.prototype.createResolveAndReject_=function(){function e(e){return function(i){A||(A=!0,e.call(t,i))}}var t=this,A=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}},o.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof o)this.settleSameAsPromise_(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}},o.prototype.resolveToNonPromiseObj_=function(e){var t=void 0;try{t=e.then}catch(e){return void this.reject_(e)}"function"==typeof t?this.settleSameAsThenable_(t,e):this.fulfill_(e)},o.prototype.reject_=function(e){this.settle_(2,e)},o.prototype.fulfill_=function(e){this.settle_(1,e)},o.prototype.settle_=function(e,t){if(0!=this.state_)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.state_);this.state_=e,this.result_=t,2===this.state_&&this.scheduleUnhandledRejectionCheck_(),this.executeOnSettledCallbacks_()},o.prototype.scheduleUnhandledRejectionCheck_=function(){var e=this;i((function(){if(e.notifyUnhandledRejection_()){var t=$jscomp.global.console;void 0!==t&&t.error(e.result_)}}),1)},o.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var e=$jscomp.global.CustomEvent,t=$jscomp.global.Event,A=$jscomp.global.dispatchEvent;return void 0===A||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=$jscomp.global.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.result_,A(e))},o.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=0;e<this.onSettledCallbacks_.length;++e)s.asyncExecute(this.onSettledCallbacks_[e]);this.onSettledCallbacks_=null}};var s=new t;return o.prototype.settleSameAsPromise_=function(e){var t=this.createResolveAndReject_();e.callWhenSettled_(t.resolve,t.reject)},o.prototype.settleSameAsThenable_=function(e,t){var A=this.createResolveAndReject_();try{e.call(t,A.resolve,A.reject)}catch(e){A.reject(e)}},o.prototype.then=function(e,t){function A(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){s(e)}}:t}var i,s,n=new o((function(e,t){i=e,s=t}));return this.callWhenSettled_(A(e,i),A(t,s)),n},o.prototype.catch=function(e){return this.then(void 0,e)},o.prototype.callWhenSettled_=function(e,t){function A(){switch(i.state_){case 1:e(i.result_);break;case 2:t(i.result_);break;default:throw Error("Unexpected state: "+i.state_)}}var i=this;null==this.onSettledCallbacks_?s.asyncExecute(A):this.onSettledCallbacks_.push(A),this.isRejectionHandled_=!0},o.resolve=A,o.reject=function(e){return new o((function(t,A){A(e)}))},o.race=function(e){return new o((function(t,i){for(var o=$jscomp.makeIterator(e),s=o.next();!s.done;s=o.next())A(s.value).callWhenSettled_(t,i)}))},o.all=function(e){var t=$jscomp.makeIterator(e),i=t.next();return i.done?A([]):new o((function(e,o){function s(t){return function(A){n[t]=A,0==--r&&e(n)}}var n=[],r=0;do{n.push(void 0),r++,A(i.value).callWhenSettled_(s(n.length-1),o),i=t.next()}while(!i.done)}))},o}),"es6","es3"),$jscomp.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(e,t){for(var A=1;A<arguments.length;A++){var i=arguments[A];if(i)for(var o in i)$jscomp.owns(i,o)&&(e[o]=i[o])}return e},$jscomp.polyfill("Object.assign",(function(e){return e||$jscomp.assign}),"es6","es3"),$jscomp.checkStringArgs=function(e,t,A){if(null==e)throw new TypeError("The 'this' value for String.prototype."+A+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+A+" must not be a regular expression");return e+""},$jscomp.polyfill("String.prototype.startsWith",(function(e){return e||function(e,t){var A=$jscomp.checkStringArgs(this,e,"startsWith");e+="";var i=A.length,o=e.length;t=Math.max(0,Math.min(0|t,A.length));for(var s=0;s<o&&t<i;)if(A[t++]!=e[s++])return!1;return s>=o}}),"es6","es3"),$jscomp.polyfill("Array.prototype.copyWithin",(function(e){function t(e){return 1/0===(e=Number(e))||-1/0===e?e:0|e}return e||function(e,A,i){var o=this.length;if(e=t(e),A=t(A),i=void 0===i?o:t(i),e=0>e?Math.max(o+e,0):Math.min(e,o),A=0>A?Math.max(o+A,0):Math.min(A,o),i=0>i?Math.max(o+i,0):Math.min(i,o),e<A)for(;A<i;)A in this?this[e++]=this[A++]:(delete this[e++],A++);else for(e+=(i=Math.min(i,o+A-e))-A;i>A;)--i in this?this[--e]=this[i]:delete this[--e];return this}}),"es6","es3"),$jscomp.typedArrayCopyWithin=function(e){return e||Array.prototype.copyWithin},$jscomp.polyfill("Int8Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5"),$jscomp.polyfill("Uint8Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5"),$jscomp.polyfill("Uint8ClampedArray.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5"),$jscomp.polyfill("Int16Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5"),$jscomp.polyfill("Uint16Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5"),$jscomp.polyfill("Int32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5"),$jscomp.polyfill("Uint32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5"),$jscomp.polyfill("Float32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5"),$jscomp.polyfill("Float64Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");var DracoDecoderModule=function(){var e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return"undefined"!=typeof __filename&&(e=e||__filename),function(t){function A(e,t){if(e){var A=ee,i=e+t;for(t=e;A[t]&&!(t>=i);)++t;if(16<t-e&&A.buffer&&se)A=se.decode(A.subarray(e,t));else{for(i="";e<t;){var o=A[e++];if(128&o){var s=63&A[e++];if(192==(224&o))i+=String.fromCharCode((31&o)<<6|s);else{var n=63&A[e++];65536>(o=224==(240&o)?(15&o)<<12|s<<6|n:(7&o)<<18|s<<12|n<<6|63&A[e++])?i+=String.fromCharCode(o):(o-=65536,i+=String.fromCharCode(55296|o>>10,56320|1023&o))}}else i+=String.fromCharCode(o)}A=i}}else A="";return A}function i(e){Z=e,G.HEAP8=$=new Int8Array(e),G.HEAP16=new Int16Array(e),G.HEAP32=te=new Int32Array(e),G.HEAPU8=ee=new Uint8Array(e),G.HEAPU16=new Uint16Array(e),G.HEAPU32=Ae=new Uint32Array(e),G.HEAPF32=new Float32Array(e),G.HEAPF64=new Float64Array(e)}function o(e){throw G.onAbort&&G.onAbort(e),W(e="Aborted("+e+")"),oe=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),R(e),e}function s(e){try{if(e==Ie&&q)return new Uint8Array(q);if(H)return H(e);throw"both async and sync fetching of the wasm failed"}catch(e){o(e)}}function n(e){for(;0<e.length;)e.shift()(G)}function r(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(e){Ae[this.ptr+4>>2]=e},this.get_type=function(){return Ae[this.ptr+4>>2]},this.set_destructor=function(e){Ae[this.ptr+8>>2]=e},this.get_destructor=function(){return Ae[this.ptr+8>>2]},this.set_refcount=function(e){te[this.ptr>>2]=e},this.set_caught=function(e){$[this.ptr+12>>0]=e?1:0},this.get_caught=function(){return 0!=$[this.ptr+12>>0]},this.set_rethrown=function(e){$[this.ptr+13>>0]=e?1:0},this.get_rethrown=function(){return 0!=$[this.ptr+13>>0]},this.init=function(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){te[this.ptr>>2]+=1},this.release_ref=function(){var e=te[this.ptr>>2];return te[this.ptr>>2]=e-1,1===e},this.set_adjusted_ptr=function(e){Ae[this.ptr+16>>2]=e},this.get_adjusted_ptr=function(){return Ae[this.ptr+16>>2]},this.get_exception_ptr=function(){if(ZA(this.get_type()))return Ae[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}function a(e){function t(){if(!jA&&(jA=!0,G.calledRun=!0,!oe)){if(de=!0,n(re),M(G),G.onRuntimeInitialized&&G.onRuntimeInitialized(),G.postRun)for("function"==typeof G.postRun&&(G.postRun=[G.postRun]);G.postRun.length;)ae.unshift(G.postRun.shift());n(ae)}}if(!(0<he)){if(G.preRun)for("function"==typeof G.preRun&&(G.preRun=[G.preRun]);G.preRun.length;)ne.unshift(G.preRun.shift());n(ne),0<he||(G.setStatus?(G.setStatus("Running..."),setTimeout((function(){setTimeout((function(){G.setStatus("")}),1),t()}),1)):t())}}function d(){}function h(e){return(e||d).__cache__}function g(e,t){var A=h(t),i=A[e];return i||((i=Object.create((t||d).prototype)).ptr=e,A[e]=i)}function l(e){if("string"==typeof e){for(var t=0,A=0;A<e.length;++A){var i=e.charCodeAt(A);127>=i?t++:2047>=i?t+=2:55296<=i&&57343>=i?(t+=4,++A):t+=3}if(A=0,0<(i=(t=Array(t+1)).length)){i=A+i-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(55296<=s&&57343>=s)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o);if(127>=s){if(A>=i)break;t[A++]=s}else{if(2047>=s){if(A+1>=i)break;t[A++]=192|s>>6}else{if(65535>=s){if(A+2>=i)break;t[A++]=224|s>>12}else{if(A+3>=i)break;t[A++]=240|s>>18,t[A++]=128|s>>12&63}t[A++]=128|s>>6&63}t[A++]=128|63&s}}t[A]=0}return e=$A.alloc(t,$),$A.copy(t,$,e),e}return e}function I(e){if("object"==typeof e){var t=$A.alloc(e,$);return $A.copy(e,$,t),t}return e}function c(){throw"cannot construct a VoidPtr, no constructor in IDL"}function f(){this.ptr=ue(),h(f)[this.ptr]=this}function u(){this.ptr=me(),h(u)[this.ptr]=this}function C(){this.ptr=Be(),h(C)[this.ptr]=this}function _(){this.ptr=xe(),h(_)[this.ptr]=this}function m(){this.ptr=Re(),h(m)[this.ptr]=this}function p(){this.ptr=Pe(),h(p)[this.ptr]=this}function E(){this.ptr=Ke(),h(E)[this.ptr]=this}function B(){this.ptr=qe(),h(B)[this.ptr]=this}function Q(){this.ptr=et(),h(Q)[this.ptr]=this}function x(){throw"cannot construct a Status, no constructor in IDL"}function v(){this.ptr=nt(),h(v)[this.ptr]=this}function y(){this.ptr=ht(),h(y)[this.ptr]=this}function F(){this.ptr=ct(),h(F)[this.ptr]=this}function D(){this.ptr=_t(),h(D)[this.ptr]=this}function S(){this.ptr=Bt(),h(S)[this.ptr]=this}function w(){this.ptr=yt(),h(w)[this.ptr]=this}function N(){this.ptr=wt(),h(N)[this.ptr]=this}function T(){this.ptr=Mt(),h(T)[this.ptr]=this}function b(){this.ptr=Yt(),h(b)[this.ptr]=this}var M,R,G=void 0!==(t=t||{})?t:{};G.ready=new Promise((function(e,t){M=e,R=t}));var U=!1,L=!1;G.onRuntimeInitialized=function(){U=!0,L&&"function"==typeof G.onModuleLoaded&&G.onModuleLoaded(G)},G.onModuleParsed=function(){L=!0,U&&"function"==typeof G.onModuleLoaded&&G.onModuleLoaded(G)},G.isVersionSupported=function(e){return"string"==typeof e&&(!(2>(e=e.split(".")).length||3<e.length)&&(1==e[0]&&0<=e[1]&&5>=e[1]||!(0!=e[0]||10<e[1])))};var k=Object.assign({},G),V="object"==typeof window,P="function"==typeof importScripts,O="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,Y="";if(O){if(Y=P?require("path").dirname(Y)+"/":__dirname+"/","function"==typeof require)var J=require("fs"),K=require("path");var X=function(e,t){return e=K.normalize(e),J.readFileSync(e,t?void 0:"utf8")},H=function(e){return(e=X(e,!0)).buffer||(e=new Uint8Array(e)),e},z=function(e,t,A){e=K.normalize(e),J.readFile(e,(function(e,i){e?A(e):t(i.buffer)}))};1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),G.inspect=function(){return"[Emscripten Module object]"}}else(V||P)&&(P?Y=self.location.href:"undefined"!=typeof document&&document.currentScript&&(Y=document.currentScript.src),e&&(Y=e),Y=0!==Y.indexOf("blob:")?Y.substr(0,Y.replace(/[?#].*/,"").lastIndexOf("/")+1):"",X=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},P&&(H=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),z=function(e,t,A){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){200==i.status||0==i.status&&i.response?t(i.response):A()},i.onerror=A,i.send(null)});G.print||console.log.bind(console);var q,W=G.printErr||console.warn.bind(console);Object.assign(G,k),k=null,G.wasmBinary&&(q=G.wasmBinary),"object"!=typeof WebAssembly&&o("no native wasm support detected");var j,Z,$,ee,te,Ae,ie,oe=!1,se="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,ne=[],re=[],ae=[],de=!1,he=0,ge=null,le=null,Ie="draco_decoder_gltf.wasm";Ie.startsWith("data:application/octet-stream;base64,")||(ie=Ie,Ie=G.locateFile?G.locateFile(ie,Y):Y+ie);var ce={c:function(e){return WA(e+24)+24},b:function(e,t,A){throw new r(e).init(t,A),e},a:function(){o("")},e:function(e,t,A){ee.copyWithin(e,t,t+A)},d:function(e){var t=ee.length;if(2147483648<(e>>>=0))return!1;for(var A=1;4>=A;A*=2){var o=t*(1+.2/A);o=Math.min(o,e+100663296);var s=Math;o=Math.max(e,o),s=s.min.call(s,2147483648,o+(65536-o%65536)%65536);e:{try{j.grow(s-Z.byteLength+65535>>>16),i(j.buffer);var n=1;break e}catch(e){}n=void 0}if(n)return!0}return!1}};!function(){function e(e,t){G.asm=e.exports,i((j=G.asm.f).buffer),re.unshift(G.asm.g),he--,G.monitorRunDependencies&&G.monitorRunDependencies(he),0==he&&(null!==ge&&(clearInterval(ge),ge=null),le&&(e=le,le=null,e()))}function t(t){e(t.instance)}function A(e){return function(){if(!q&&(V||P)){if("function"==typeof fetch&&!Ie.startsWith("file://"))return fetch(Ie,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Ie+"'";return e.arrayBuffer()})).catch((function(){return s(Ie)}));if(z)return new Promise((function(e,t){z(Ie,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return s(Ie)}))}().then((function(e){return WebAssembly.instantiate(e,n)})).then((function(e){return e})).then(e,(function(e){W("failed to asynchronously prepare wasm: "+e),o(e)}))}var n={a:ce};if(he++,G.monitorRunDependencies&&G.monitorRunDependencies(he),G.instantiateWasm)try{return G.instantiateWasm(n,e)}catch(e){W("Module.instantiateWasm callback failed with error: "+e),R(e)}(q||"function"!=typeof WebAssembly.instantiateStreaming||Ie.startsWith("data:application/octet-stream;base64,")||Ie.startsWith("file://")||O||"function"!=typeof fetch?A(t):fetch(Ie,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,n).then(t,(function(e){return W("wasm streaming compile failed: "+e),W("falling back to ArrayBuffer instantiation"),A(t)}))}))).catch(R)}(),G.___wasm_call_ctors=function(){return(G.___wasm_call_ctors=G.asm.g).apply(null,arguments)};var fe=G._emscripten_bind_VoidPtr___destroy___0=function(){return(fe=G._emscripten_bind_VoidPtr___destroy___0=G.asm.i).apply(null,arguments)},ue=G._emscripten_bind_DecoderBuffer_DecoderBuffer_0=function(){return(ue=G._emscripten_bind_DecoderBuffer_DecoderBuffer_0=G.asm.j).apply(null,arguments)},Ce=G._emscripten_bind_DecoderBuffer_Init_2=function(){return(Ce=G._emscripten_bind_DecoderBuffer_Init_2=G.asm.k).apply(null,arguments)},_e=G._emscripten_bind_DecoderBuffer___destroy___0=function(){return(_e=G._emscripten_bind_DecoderBuffer___destroy___0=G.asm.l).apply(null,arguments)},me=G._emscripten_bind_AttributeTransformData_AttributeTransformData_0=function(){return(me=G._emscripten_bind_AttributeTransformData_AttributeTransformData_0=G.asm.m).apply(null,arguments)},pe=G._emscripten_bind_AttributeTransformData_transform_type_0=function(){return(pe=G._emscripten_bind_AttributeTransformData_transform_type_0=G.asm.n).apply(null,arguments)},Ee=G._emscripten_bind_AttributeTransformData___destroy___0=function(){return(Ee=G._emscripten_bind_AttributeTransformData___destroy___0=G.asm.o).apply(null,arguments)},Be=G._emscripten_bind_GeometryAttribute_GeometryAttribute_0=function(){return(Be=G._emscripten_bind_GeometryAttribute_GeometryAttribute_0=G.asm.p).apply(null,arguments)},Qe=G._emscripten_bind_GeometryAttribute___destroy___0=function(){return(Qe=G._emscripten_bind_GeometryAttribute___destroy___0=G.asm.q).apply(null,arguments)},xe=G._emscripten_bind_PointAttribute_PointAttribute_0=function(){return(xe=G._emscripten_bind_PointAttribute_PointAttribute_0=G.asm.r).apply(null,arguments)},ve=G._emscripten_bind_PointAttribute_size_0=function(){return(ve=G._emscripten_bind_PointAttribute_size_0=G.asm.s).apply(null,arguments)},ye=G._emscripten_bind_PointAttribute_GetAttributeTransformData_0=function(){return(ye=G._emscripten_bind_PointAttribute_GetAttributeTransformData_0=G.asm.t).apply(null,arguments)},Fe=G._emscripten_bind_PointAttribute_attribute_type_0=function(){return(Fe=G._emscripten_bind_PointAttribute_attribute_type_0=G.asm.u).apply(null,arguments)},De=G._emscripten_bind_PointAttribute_data_type_0=function(){return(De=G._emscripten_bind_PointAttribute_data_type_0=G.asm.v).apply(null,arguments)},Se=G._emscripten_bind_PointAttribute_num_components_0=function(){return(Se=G._emscripten_bind_PointAttribute_num_components_0=G.asm.w).apply(null,arguments)},we=G._emscripten_bind_PointAttribute_normalized_0=function(){return(we=G._emscripten_bind_PointAttribute_normalized_0=G.asm.x).apply(null,arguments)},Ne=G._emscripten_bind_PointAttribute_byte_stride_0=function(){return(Ne=G._emscripten_bind_PointAttribute_byte_stride_0=G.asm.y).apply(null,arguments)},Te=G._emscripten_bind_PointAttribute_byte_offset_0=function(){return(Te=G._emscripten_bind_PointAttribute_byte_offset_0=G.asm.z).apply(null,arguments)},be=G._emscripten_bind_PointAttribute_unique_id_0=function(){return(be=G._emscripten_bind_PointAttribute_unique_id_0=G.asm.A).apply(null,arguments)},Me=G._emscripten_bind_PointAttribute___destroy___0=function(){return(Me=G._emscripten_bind_PointAttribute___destroy___0=G.asm.B).apply(null,arguments)},Re=G._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=function(){return(Re=G._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=G.asm.C).apply(null,arguments)},Ge=G._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=function(){return(Ge=G._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=G.asm.D).apply(null,arguments)},Ue=G._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=function(){return(Ue=G._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=G.asm.E).apply(null,arguments)},Le=G._emscripten_bind_AttributeQuantizationTransform_min_value_1=function(){return(Le=G._emscripten_bind_AttributeQuantizationTransform_min_value_1=G.asm.F).apply(null,arguments)},ke=G._emscripten_bind_AttributeQuantizationTransform_range_0=function(){return(ke=G._emscripten_bind_AttributeQuantizationTransform_range_0=G.asm.G).apply(null,arguments)},Ve=G._emscripten_bind_AttributeQuantizationTransform___destroy___0=function(){return(Ve=G._emscripten_bind_AttributeQuantizationTransform___destroy___0=G.asm.H).apply(null,arguments)},Pe=G._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=function(){return(Pe=G._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=G.asm.I).apply(null,arguments)},Oe=G._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=function(){return(Oe=G._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=G.asm.J).apply(null,arguments)},Ye=G._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=function(){return(Ye=G._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=G.asm.K).apply(null,arguments)},Je=G._emscripten_bind_AttributeOctahedronTransform___destroy___0=function(){return(Je=G._emscripten_bind_AttributeOctahedronTransform___destroy___0=G.asm.L).apply(null,arguments)},Ke=G._emscripten_bind_PointCloud_PointCloud_0=function(){return(Ke=G._emscripten_bind_PointCloud_PointCloud_0=G.asm.M).apply(null,arguments)},Xe=G._emscripten_bind_PointCloud_num_attributes_0=function(){return(Xe=G._emscripten_bind_PointCloud_num_attributes_0=G.asm.N).apply(null,arguments)},He=G._emscripten_bind_PointCloud_num_points_0=function(){return(He=G._emscripten_bind_PointCloud_num_points_0=G.asm.O).apply(null,arguments)},ze=G._emscripten_bind_PointCloud___destroy___0=function(){return(ze=G._emscripten_bind_PointCloud___destroy___0=G.asm.P).apply(null,arguments)},qe=G._emscripten_bind_Mesh_Mesh_0=function(){return(qe=G._emscripten_bind_Mesh_Mesh_0=G.asm.Q).apply(null,arguments)},We=G._emscripten_bind_Mesh_num_faces_0=function(){return(We=G._emscripten_bind_Mesh_num_faces_0=G.asm.R).apply(null,arguments)},je=G._emscripten_bind_Mesh_num_attributes_0=function(){return(je=G._emscripten_bind_Mesh_num_attributes_0=G.asm.S).apply(null,arguments)},Ze=G._emscripten_bind_Mesh_num_points_0=function(){return(Ze=G._emscripten_bind_Mesh_num_points_0=G.asm.T).apply(null,arguments)},$e=G._emscripten_bind_Mesh___destroy___0=function(){return($e=G._emscripten_bind_Mesh___destroy___0=G.asm.U).apply(null,arguments)},et=G._emscripten_bind_Metadata_Metadata_0=function(){return(et=G._emscripten_bind_Metadata_Metadata_0=G.asm.V).apply(null,arguments)},tt=G._emscripten_bind_Metadata___destroy___0=function(){return(tt=G._emscripten_bind_Metadata___destroy___0=G.asm.W).apply(null,arguments)},At=G._emscripten_bind_Status_code_0=function(){return(At=G._emscripten_bind_Status_code_0=G.asm.X).apply(null,arguments)},it=G._emscripten_bind_Status_ok_0=function(){return(it=G._emscripten_bind_Status_ok_0=G.asm.Y).apply(null,arguments)},ot=G._emscripten_bind_Status_error_msg_0=function(){return(ot=G._emscripten_bind_Status_error_msg_0=G.asm.Z).apply(null,arguments)},st=G._emscripten_bind_Status___destroy___0=function(){return(st=G._emscripten_bind_Status___destroy___0=G.asm._).apply(null,arguments)},nt=G._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=function(){return(nt=G._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=G.asm.$).apply(null,arguments)},rt=G._emscripten_bind_DracoFloat32Array_GetValue_1=function(){return(rt=G._emscripten_bind_DracoFloat32Array_GetValue_1=G.asm.aa).apply(null,arguments)},at=G._emscripten_bind_DracoFloat32Array_size_0=function(){return(at=G._emscripten_bind_DracoFloat32Array_size_0=G.asm.ba).apply(null,arguments)},dt=G._emscripten_bind_DracoFloat32Array___destroy___0=function(){return(dt=G._emscripten_bind_DracoFloat32Array___destroy___0=G.asm.ca).apply(null,arguments)},ht=G._emscripten_bind_DracoInt8Array_DracoInt8Array_0=function(){return(ht=G._emscripten_bind_DracoInt8Array_DracoInt8Array_0=G.asm.da).apply(null,arguments)},gt=G._emscripten_bind_DracoInt8Array_GetValue_1=function(){return(gt=G._emscripten_bind_DracoInt8Array_GetValue_1=G.asm.ea).apply(null,arguments)},lt=G._emscripten_bind_DracoInt8Array_size_0=function(){return(lt=G._emscripten_bind_DracoInt8Array_size_0=G.asm.fa).apply(null,arguments)},It=G._emscripten_bind_DracoInt8Array___destroy___0=function(){return(It=G._emscripten_bind_DracoInt8Array___destroy___0=G.asm.ga).apply(null,arguments)},ct=G._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=function(){return(ct=G._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=G.asm.ha).apply(null,arguments)},ft=G._emscripten_bind_DracoUInt8Array_GetValue_1=function(){return(ft=G._emscripten_bind_DracoUInt8Array_GetValue_1=G.asm.ia).apply(null,arguments)},ut=G._emscripten_bind_DracoUInt8Array_size_0=function(){return(ut=G._emscripten_bind_DracoUInt8Array_size_0=G.asm.ja).apply(null,arguments)},Ct=G._emscripten_bind_DracoUInt8Array___destroy___0=function(){return(Ct=G._emscripten_bind_DracoUInt8Array___destroy___0=G.asm.ka).apply(null,arguments)},_t=G._emscripten_bind_DracoInt16Array_DracoInt16Array_0=function(){return(_t=G._emscripten_bind_DracoInt16Array_DracoInt16Array_0=G.asm.la).apply(null,arguments)},mt=G._emscripten_bind_DracoInt16Array_GetValue_1=function(){return(mt=G._emscripten_bind_DracoInt16Array_GetValue_1=G.asm.ma).apply(null,arguments)},pt=G._emscripten_bind_DracoInt16Array_size_0=function(){return(pt=G._emscripten_bind_DracoInt16Array_size_0=G.asm.na).apply(null,arguments)},Et=G._emscripten_bind_DracoInt16Array___destroy___0=function(){return(Et=G._emscripten_bind_DracoInt16Array___destroy___0=G.asm.oa).apply(null,arguments)},Bt=G._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=function(){return(Bt=G._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=G.asm.pa).apply(null,arguments)},Qt=G._emscripten_bind_DracoUInt16Array_GetValue_1=function(){return(Qt=G._emscripten_bind_DracoUInt16Array_GetValue_1=G.asm.qa).apply(null,arguments)},xt=G._emscripten_bind_DracoUInt16Array_size_0=function(){return(xt=G._emscripten_bind_DracoUInt16Array_size_0=G.asm.ra).apply(null,arguments)},vt=G._emscripten_bind_DracoUInt16Array___destroy___0=function(){return(vt=G._emscripten_bind_DracoUInt16Array___destroy___0=G.asm.sa).apply(null,arguments)},yt=G._emscripten_bind_DracoInt32Array_DracoInt32Array_0=function(){return(yt=G._emscripten_bind_DracoInt32Array_DracoInt32Array_0=G.asm.ta).apply(null,arguments)},Ft=G._emscripten_bind_DracoInt32Array_GetValue_1=function(){return(Ft=G._emscripten_bind_DracoInt32Array_GetValue_1=G.asm.ua).apply(null,arguments)},Dt=G._emscripten_bind_DracoInt32Array_size_0=function(){return(Dt=G._emscripten_bind_DracoInt32Array_size_0=G.asm.va).apply(null,arguments)},St=G._emscripten_bind_DracoInt32Array___destroy___0=function(){return(St=G._emscripten_bind_DracoInt32Array___destroy___0=G.asm.wa).apply(null,arguments)},wt=G._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=function(){return(wt=G._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=G.asm.xa).apply(null,arguments)},Nt=G._emscripten_bind_DracoUInt32Array_GetValue_1=function(){return(Nt=G._emscripten_bind_DracoUInt32Array_GetValue_1=G.asm.ya).apply(null,arguments)},Tt=G._emscripten_bind_DracoUInt32Array_size_0=function(){return(Tt=G._emscripten_bind_DracoUInt32Array_size_0=G.asm.za).apply(null,arguments)},bt=G._emscripten_bind_DracoUInt32Array___destroy___0=function(){return(bt=G._emscripten_bind_DracoUInt32Array___destroy___0=G.asm.Aa).apply(null,arguments)},Mt=G._emscripten_bind_MetadataQuerier_MetadataQuerier_0=function(){return(Mt=G._emscripten_bind_MetadataQuerier_MetadataQuerier_0=G.asm.Ba).apply(null,arguments)},Rt=G._emscripten_bind_MetadataQuerier_HasEntry_2=function(){return(Rt=G._emscripten_bind_MetadataQuerier_HasEntry_2=G.asm.Ca).apply(null,arguments)},Gt=G._emscripten_bind_MetadataQuerier_GetIntEntry_2=function(){return(Gt=G._emscripten_bind_MetadataQuerier_GetIntEntry_2=G.asm.Da).apply(null,arguments)},Ut=G._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=function(){return(Ut=G._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=G.asm.Ea).apply(null,arguments)},Lt=G._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=function(){return(Lt=G._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=G.asm.Fa).apply(null,arguments)},kt=G._emscripten_bind_MetadataQuerier_GetStringEntry_2=function(){return(kt=G._emscripten_bind_MetadataQuerier_GetStringEntry_2=G.asm.Ga).apply(null,arguments)},Vt=G._emscripten_bind_MetadataQuerier_NumEntries_1=function(){return(Vt=G._emscripten_bind_MetadataQuerier_NumEntries_1=G.asm.Ha).apply(null,arguments)},Pt=G._emscripten_bind_MetadataQuerier_GetEntryName_2=function(){return(Pt=G._emscripten_bind_MetadataQuerier_GetEntryName_2=G.asm.Ia).apply(null,arguments)},Ot=G._emscripten_bind_MetadataQuerier___destroy___0=function(){return(Ot=G._emscripten_bind_MetadataQuerier___destroy___0=G.asm.Ja).apply(null,arguments)},Yt=G._emscripten_bind_Decoder_Decoder_0=function(){return(Yt=G._emscripten_bind_Decoder_Decoder_0=G.asm.Ka).apply(null,arguments)},Jt=G._emscripten_bind_Decoder_DecodeArrayToPointCloud_3=function(){return(Jt=G._emscripten_bind_Decoder_DecodeArrayToPointCloud_3=G.asm.La).apply(null,arguments)},Kt=G._emscripten_bind_Decoder_DecodeArrayToMesh_3=function(){return(Kt=G._emscripten_bind_Decoder_DecodeArrayToMesh_3=G.asm.Ma).apply(null,arguments)},Xt=G._emscripten_bind_Decoder_GetAttributeId_2=function(){return(Xt=G._emscripten_bind_Decoder_GetAttributeId_2=G.asm.Na).apply(null,arguments)},Ht=G._emscripten_bind_Decoder_GetAttributeIdByName_2=function(){return(Ht=G._emscripten_bind_Decoder_GetAttributeIdByName_2=G.asm.Oa).apply(null,arguments)},zt=G._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=function(){return(zt=G._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=G.asm.Pa).apply(null,arguments)},qt=G._emscripten_bind_Decoder_GetAttribute_2=function(){return(qt=G._emscripten_bind_Decoder_GetAttribute_2=G.asm.Qa).apply(null,arguments)},Wt=G._emscripten_bind_Decoder_GetAttributeByUniqueId_2=function(){return(Wt=G._emscripten_bind_Decoder_GetAttributeByUniqueId_2=G.asm.Ra).apply(null,arguments)},jt=G._emscripten_bind_Decoder_GetMetadata_1=function(){return(jt=G._emscripten_bind_Decoder_GetMetadata_1=G.asm.Sa).apply(null,arguments)},Zt=G._emscripten_bind_Decoder_GetAttributeMetadata_2=function(){return(Zt=G._emscripten_bind_Decoder_GetAttributeMetadata_2=G.asm.Ta).apply(null,arguments)},$t=G._emscripten_bind_Decoder_GetFaceFromMesh_3=function(){return($t=G._emscripten_bind_Decoder_GetFaceFromMesh_3=G.asm.Ua).apply(null,arguments)},eA=G._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=function(){return(eA=G._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=G.asm.Va).apply(null,arguments)},tA=G._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=function(){return(tA=G._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=G.asm.Wa).apply(null,arguments)},AA=G._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=function(){return(AA=G._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=G.asm.Xa).apply(null,arguments)},iA=G._emscripten_bind_Decoder_GetAttributeFloat_3=function(){return(iA=G._emscripten_bind_Decoder_GetAttributeFloat_3=G.asm.Ya).apply(null,arguments)},oA=G._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=function(){return(oA=G._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=G.asm.Za).apply(null,arguments)},sA=G._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=function(){return(sA=G._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=G.asm._a).apply(null,arguments)},nA=G._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=function(){return(nA=G._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=G.asm.$a).apply(null,arguments)},rA=G._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=function(){return(rA=G._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=G.asm.ab).apply(null,arguments)},aA=G._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=function(){return(aA=G._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=G.asm.bb).apply(null,arguments)},dA=G._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=function(){return(dA=G._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=G.asm.cb).apply(null,arguments)},hA=G._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=function(){return(hA=G._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=G.asm.db).apply(null,arguments)},gA=G._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=function(){return(gA=G._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=G.asm.eb).apply(null,arguments)},lA=G._emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5=function(){return(lA=G._emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5=G.asm.fb).apply(null,arguments)},IA=G._emscripten_bind_Decoder_SkipAttributeTransform_1=function(){return(IA=G._emscripten_bind_Decoder_SkipAttributeTransform_1=G.asm.gb).apply(null,arguments)},cA=G._emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1=function(){return(cA=G._emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1=G.asm.hb).apply(null,arguments)},fA=G._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=function(){return(fA=G._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=G.asm.ib).apply(null,arguments)},uA=G._emscripten_bind_Decoder_DecodeBufferToMesh_2=function(){return(uA=G._emscripten_bind_Decoder_DecodeBufferToMesh_2=G.asm.jb).apply(null,arguments)},CA=G._emscripten_bind_Decoder___destroy___0=function(){return(CA=G._emscripten_bind_Decoder___destroy___0=G.asm.kb).apply(null,arguments)},_A=G._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=function(){return(_A=G._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=G.asm.lb).apply(null,arguments)},mA=G._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=function(){return(mA=G._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=G.asm.mb).apply(null,arguments)},pA=G._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=function(){return(pA=G._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=G.asm.nb).apply(null,arguments)},EA=G._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=function(){return(EA=G._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=G.asm.ob).apply(null,arguments)},BA=G._emscripten_enum_draco_GeometryAttribute_Type_INVALID=function(){return(BA=G._emscripten_enum_draco_GeometryAttribute_Type_INVALID=G.asm.pb).apply(null,arguments)},QA=G._emscripten_enum_draco_GeometryAttribute_Type_POSITION=function(){return(QA=G._emscripten_enum_draco_GeometryAttribute_Type_POSITION=G.asm.qb).apply(null,arguments)},xA=G._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=function(){return(xA=G._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=G.asm.rb).apply(null,arguments)},vA=G._emscripten_enum_draco_GeometryAttribute_Type_COLOR=function(){return(vA=G._emscripten_enum_draco_GeometryAttribute_Type_COLOR=G.asm.sb).apply(null,arguments)},yA=G._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=function(){return(yA=G._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=G.asm.tb).apply(null,arguments)},FA=G._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=function(){return(FA=G._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=G.asm.ub).apply(null,arguments)},DA=G._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=function(){return(DA=G._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=G.asm.vb).apply(null,arguments)},SA=G._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=function(){return(SA=G._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=G.asm.wb).apply(null,arguments)},wA=G._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=function(){return(wA=G._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=G.asm.xb).apply(null,arguments)},NA=G._emscripten_enum_draco_DataType_DT_INVALID=function(){return(NA=G._emscripten_enum_draco_DataType_DT_INVALID=G.asm.yb).apply(null,arguments)},TA=G._emscripten_enum_draco_DataType_DT_INT8=function(){return(TA=G._emscripten_enum_draco_DataType_DT_INT8=G.asm.zb).apply(null,arguments)},bA=G._emscripten_enum_draco_DataType_DT_UINT8=function(){return(bA=G._emscripten_enum_draco_DataType_DT_UINT8=G.asm.Ab).apply(null,arguments)},MA=G._emscripten_enum_draco_DataType_DT_INT16=function(){return(MA=G._emscripten_enum_draco_DataType_DT_INT16=G.asm.Bb).apply(null,arguments)},RA=G._emscripten_enum_draco_DataType_DT_UINT16=function(){return(RA=G._emscripten_enum_draco_DataType_DT_UINT16=G.asm.Cb).apply(null,arguments)},GA=G._emscripten_enum_draco_DataType_DT_INT32=function(){return(GA=G._emscripten_enum_draco_DataType_DT_INT32=G.asm.Db).apply(null,arguments)},UA=G._emscripten_enum_draco_DataType_DT_UINT32=function(){return(UA=G._emscripten_enum_draco_DataType_DT_UINT32=G.asm.Eb).apply(null,arguments)},LA=G._emscripten_enum_draco_DataType_DT_INT64=function(){return(LA=G._emscripten_enum_draco_DataType_DT_INT64=G.asm.Fb).apply(null,arguments)},kA=G._emscripten_enum_draco_DataType_DT_UINT64=function(){return(kA=G._emscripten_enum_draco_DataType_DT_UINT64=G.asm.Gb).apply(null,arguments)},VA=G._emscripten_enum_draco_DataType_DT_FLOAT32=function(){return(VA=G._emscripten_enum_draco_DataType_DT_FLOAT32=G.asm.Hb).apply(null,arguments)},PA=G._emscripten_enum_draco_DataType_DT_FLOAT64=function(){return(PA=G._emscripten_enum_draco_DataType_DT_FLOAT64=G.asm.Ib).apply(null,arguments)},OA=G._emscripten_enum_draco_DataType_DT_BOOL=function(){return(OA=G._emscripten_enum_draco_DataType_DT_BOOL=G.asm.Jb).apply(null,arguments)},YA=G._emscripten_enum_draco_DataType_DT_TYPES_COUNT=function(){return(YA=G._emscripten_enum_draco_DataType_DT_TYPES_COUNT=G.asm.Kb).apply(null,arguments)},JA=G._emscripten_enum_draco_StatusCode_OK=function(){return(JA=G._emscripten_enum_draco_StatusCode_OK=G.asm.Lb).apply(null,arguments)},KA=G._emscripten_enum_draco_StatusCode_DRACO_ERROR=function(){return(KA=G._emscripten_enum_draco_StatusCode_DRACO_ERROR=G.asm.Mb).apply(null,arguments)},XA=G._emscripten_enum_draco_StatusCode_IO_ERROR=function(){return(XA=G._emscripten_enum_draco_StatusCode_IO_ERROR=G.asm.Nb).apply(null,arguments)},HA=G._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=function(){return(HA=G._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=G.asm.Ob).apply(null,arguments)},zA=G._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=function(){return(zA=G._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=G.asm.Pb).apply(null,arguments)},qA=G._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=function(){return(qA=G._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=G.asm.Qb).apply(null,arguments)},WA=G._malloc=function(){return(WA=G._malloc=G.asm.Rb).apply(null,arguments)};G._free=function(){return(G._free=G.asm.Sb).apply(null,arguments)};var jA,ZA=G.___cxa_is_pointer_type=function(){return(ZA=G.___cxa_is_pointer_type=G.asm.Tb).apply(null,arguments)};if(G.___start_em_js=11660,G.___stop_em_js=11758,le=function e(){jA||a(),jA||(le=e)},G.preInit)for("function"==typeof G.preInit&&(G.preInit=[G.preInit]);0<G.preInit.length;)G.preInit.pop()();a(),d.prototype=Object.create(d.prototype),d.prototype.constructor=d,d.prototype.__class__=d,d.__cache__={},G.WrapperObject=d,G.getCache=h,G.wrapPointer=g,G.castObject=function(e,t){return g(e.ptr,t)},G.NULL=g(0),G.destroy=function(e){if(!e.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";e.__destroy__(),delete h(e.__class__)[e.ptr]},G.compare=function(e,t){return e.ptr===t.ptr},G.getPointer=function(e){return e.ptr},G.getClass=function(e){return e.__class__};var $A={buffer:0,size:0,pos:0,temps:[],needed:0,prepare:function(){if($A.needed){for(var e=0;e<$A.temps.length;e++)G._free($A.temps[e]);$A.temps.length=0,G._free($A.buffer),$A.buffer=0,$A.size+=$A.needed,$A.needed=0}$A.buffer||($A.size+=128,$A.buffer=G._malloc($A.size),$A.buffer||o(void 0)),$A.pos=0},alloc:function(e,t){return $A.buffer||o(void 0),e=(e=e.length*t.BYTES_PER_ELEMENT)+7&-8,$A.pos+e>=$A.size?(0<e||o(void 0),$A.needed+=e,t=G._malloc(e),$A.temps.push(t)):(t=$A.buffer+$A.pos,$A.pos+=e),t},copy:function(e,t,A){switch(A>>>=0,t.BYTES_PER_ELEMENT){case 2:A>>>=1;break;case 4:A>>>=2;break;case 8:A>>>=3}for(var i=0;i<e.length;i++)t[A+i]=e[i]}};return c.prototype=Object.create(d.prototype),c.prototype.constructor=c,c.prototype.__class__=c,c.__cache__={},G.VoidPtr=c,c.prototype.__destroy__=c.prototype.__destroy__=function(){fe(this.ptr)},f.prototype=Object.create(d.prototype),f.prototype.constructor=f,f.prototype.__class__=f,f.__cache__={},G.DecoderBuffer=f,f.prototype.Init=f.prototype.Init=function(e,t){var A=this.ptr;$A.prepare(),"object"==typeof e&&(e=I(e)),t&&"object"==typeof t&&(t=t.ptr),Ce(A,e,t)},f.prototype.__destroy__=f.prototype.__destroy__=function(){_e(this.ptr)},u.prototype=Object.create(d.prototype),u.prototype.constructor=u,u.prototype.__class__=u,u.__cache__={},G.AttributeTransformData=u,u.prototype.transform_type=u.prototype.transform_type=function(){return pe(this.ptr)},u.prototype.__destroy__=u.prototype.__destroy__=function(){Ee(this.ptr)},C.prototype=Object.create(d.prototype),C.prototype.constructor=C,C.prototype.__class__=C,C.__cache__={},G.GeometryAttribute=C,C.prototype.__destroy__=C.prototype.__destroy__=function(){Qe(this.ptr)},_.prototype=Object.create(d.prototype),_.prototype.constructor=_,_.prototype.__class__=_,_.__cache__={},G.PointAttribute=_,_.prototype.size=_.prototype.size=function(){return ve(this.ptr)},_.prototype.GetAttributeTransformData=_.prototype.GetAttributeTransformData=function(){return g(ye(this.ptr),u)},_.prototype.attribute_type=_.prototype.attribute_type=function(){return Fe(this.ptr)},_.prototype.data_type=_.prototype.data_type=function(){return De(this.ptr)},_.prototype.num_components=_.prototype.num_components=function(){return Se(this.ptr)},_.prototype.normalized=_.prototype.normalized=function(){return!!we(this.ptr)},_.prototype.byte_stride=_.prototype.byte_stride=function(){return Ne(this.ptr)},_.prototype.byte_offset=_.prototype.byte_offset=function(){return Te(this.ptr)},_.prototype.unique_id=_.prototype.unique_id=function(){return be(this.ptr)},_.prototype.__destroy__=_.prototype.__destroy__=function(){Me(this.ptr)},m.prototype=Object.create(d.prototype),m.prototype.constructor=m,m.prototype.__class__=m,m.__cache__={},G.AttributeQuantizationTransform=m,m.prototype.InitFromAttribute=m.prototype.InitFromAttribute=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!Ge(t,e)},m.prototype.quantization_bits=m.prototype.quantization_bits=function(){return Ue(this.ptr)},m.prototype.min_value=m.prototype.min_value=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Le(t,e)},m.prototype.range=m.prototype.range=function(){return ke(this.ptr)},m.prototype.__destroy__=m.prototype.__destroy__=function(){Ve(this.ptr)},p.prototype=Object.create(d.prototype),p.prototype.constructor=p,p.prototype.__class__=p,p.__cache__={},G.AttributeOctahedronTransform=p,p.prototype.InitFromAttribute=p.prototype.InitFromAttribute=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!Oe(t,e)},p.prototype.quantization_bits=p.prototype.quantization_bits=function(){return Ye(this.ptr)},p.prototype.__destroy__=p.prototype.__destroy__=function(){Je(this.ptr)},E.prototype=Object.create(d.prototype),E.prototype.constructor=E,E.prototype.__class__=E,E.__cache__={},G.PointCloud=E,E.prototype.num_attributes=E.prototype.num_attributes=function(){return Xe(this.ptr)},E.prototype.num_points=E.prototype.num_points=function(){return He(this.ptr)},E.prototype.__destroy__=E.prototype.__destroy__=function(){ze(this.ptr)},B.prototype=Object.create(d.prototype),B.prototype.constructor=B,B.prototype.__class__=B,B.__cache__={},G.Mesh=B,B.prototype.num_faces=B.prototype.num_faces=function(){return We(this.ptr)},B.prototype.num_attributes=B.prototype.num_attributes=function(){return je(this.ptr)},B.prototype.num_points=B.prototype.num_points=function(){return Ze(this.ptr)},B.prototype.__destroy__=B.prototype.__destroy__=function(){$e(this.ptr)},Q.prototype=Object.create(d.prototype),Q.prototype.constructor=Q,Q.prototype.__class__=Q,Q.__cache__={},G.Metadata=Q,Q.prototype.__destroy__=Q.prototype.__destroy__=function(){tt(this.ptr)},x.prototype=Object.create(d.prototype),x.prototype.constructor=x,x.prototype.__class__=x,x.__cache__={},G.Status=x,x.prototype.code=x.prototype.code=function(){return At(this.ptr)},x.prototype.ok=x.prototype.ok=function(){return!!it(this.ptr)},x.prototype.error_msg=x.prototype.error_msg=function(){return A(ot(this.ptr))},x.prototype.__destroy__=x.prototype.__destroy__=function(){st(this.ptr)},v.prototype=Object.create(d.prototype),v.prototype.constructor=v,v.prototype.__class__=v,v.__cache__={},G.DracoFloat32Array=v,v.prototype.GetValue=v.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),rt(t,e)},v.prototype.size=v.prototype.size=function(){return at(this.ptr)},v.prototype.__destroy__=v.prototype.__destroy__=function(){dt(this.ptr)},y.prototype=Object.create(d.prototype),y.prototype.constructor=y,y.prototype.__class__=y,y.__cache__={},G.DracoInt8Array=y,y.prototype.GetValue=y.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),gt(t,e)},y.prototype.size=y.prototype.size=function(){return lt(this.ptr)},y.prototype.__destroy__=y.prototype.__destroy__=function(){It(this.ptr)},F.prototype=Object.create(d.prototype),F.prototype.constructor=F,F.prototype.__class__=F,F.__cache__={},G.DracoUInt8Array=F,F.prototype.GetValue=F.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),ft(t,e)},F.prototype.size=F.prototype.size=function(){return ut(this.ptr)},F.prototype.__destroy__=F.prototype.__destroy__=function(){Ct(this.ptr)},D.prototype=Object.create(d.prototype),D.prototype.constructor=D,D.prototype.__class__=D,D.__cache__={},G.DracoInt16Array=D,D.prototype.GetValue=D.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),mt(t,e)},D.prototype.size=D.prototype.size=function(){return pt(this.ptr)},D.prototype.__destroy__=D.prototype.__destroy__=function(){Et(this.ptr)},S.prototype=Object.create(d.prototype),S.prototype.constructor=S,S.prototype.__class__=S,S.__cache__={},G.DracoUInt16Array=S,S.prototype.GetValue=S.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Qt(t,e)},S.prototype.size=S.prototype.size=function(){return xt(this.ptr)},S.prototype.__destroy__=S.prototype.__destroy__=function(){vt(this.ptr)},w.prototype=Object.create(d.prototype),w.prototype.constructor=w,w.prototype.__class__=w,w.__cache__={},G.DracoInt32Array=w,w.prototype.GetValue=w.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Ft(t,e)},w.prototype.size=w.prototype.size=function(){return Dt(this.ptr)},w.prototype.__destroy__=w.prototype.__destroy__=function(){St(this.ptr)},N.prototype=Object.create(d.prototype),N.prototype.constructor=N,N.prototype.__class__=N,N.__cache__={},G.DracoUInt32Array=N,N.prototype.GetValue=N.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Nt(t,e)},N.prototype.size=N.prototype.size=function(){return Tt(this.ptr)},N.prototype.__destroy__=N.prototype.__destroy__=function(){bt(this.ptr)},T.prototype=Object.create(d.prototype),T.prototype.constructor=T,T.prototype.__class__=T,T.__cache__={},G.MetadataQuerier=T,T.prototype.HasEntry=T.prototype.HasEntry=function(e,t){var A=this.ptr;return $A.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:l(t),!!Rt(A,e,t)},T.prototype.GetIntEntry=T.prototype.GetIntEntry=function(e,t){var A=this.ptr;return $A.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:l(t),Gt(A,e,t)},T.prototype.GetIntEntryArray=T.prototype.GetIntEntryArray=function(e,t,A){var i=this.ptr;$A.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:l(t),A&&"object"==typeof A&&(A=A.ptr),Ut(i,e,t,A)},T.prototype.GetDoubleEntry=T.prototype.GetDoubleEntry=function(e,t){var A=this.ptr;return $A.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:l(t),Lt(A,e,t)},T.prototype.GetStringEntry=T.prototype.GetStringEntry=function(e,t){var i=this.ptr;return $A.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:l(t),A(kt(i,e,t))},T.prototype.NumEntries=T.prototype.NumEntries=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Vt(t,e)},T.prototype.GetEntryName=T.prototype.GetEntryName=function(e,t){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A(Pt(i,e,t))},T.prototype.__destroy__=T.prototype.__destroy__=function(){Ot(this.ptr)},b.prototype=Object.create(d.prototype),b.prototype.constructor=b,b.prototype.__class__=b,b.__cache__={},G.Decoder=b,b.prototype.DecodeArrayToPointCloud=b.prototype.DecodeArrayToPointCloud=function(e,t,A){var i=this.ptr;return $A.prepare(),"object"==typeof e&&(e=I(e)),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),g(Jt(i,e,t,A),x)},b.prototype.DecodeArrayToMesh=b.prototype.DecodeArrayToMesh=function(e,t,A){var i=this.ptr;return $A.prepare(),"object"==typeof e&&(e=I(e)),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),g(Kt(i,e,t,A),x)},b.prototype.GetAttributeId=b.prototype.GetAttributeId=function(e,t){var A=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Xt(A,e,t)},b.prototype.GetAttributeIdByName=b.prototype.GetAttributeIdByName=function(e,t){var A=this.ptr;return $A.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:l(t),Ht(A,e,t)},b.prototype.GetAttributeIdByMetadataEntry=b.prototype.GetAttributeIdByMetadataEntry=function(e,t,A){var i=this.ptr;return $A.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:l(t),A=A&&"object"==typeof A?A.ptr:l(A),zt(i,e,t,A)},b.prototype.GetAttribute=b.prototype.GetAttribute=function(e,t){var A=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),g(qt(A,e,t),_)},b.prototype.GetAttributeByUniqueId=b.prototype.GetAttributeByUniqueId=function(e,t){var A=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),g(Wt(A,e,t),_)},b.prototype.GetMetadata=b.prototype.GetMetadata=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),g(jt(t,e),Q)},b.prototype.GetAttributeMetadata=b.prototype.GetAttributeMetadata=function(e,t){var A=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),g(Zt(A,e,t),Q)},b.prototype.GetFaceFromMesh=b.prototype.GetFaceFromMesh=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!$t(i,e,t,A)},b.prototype.GetTriangleStripsFromMesh=b.prototype.GetTriangleStripsFromMesh=function(e,t){var A=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),eA(A,e,t)},b.prototype.GetTrianglesUInt16Array=b.prototype.GetTrianglesUInt16Array=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!tA(i,e,t,A)},b.prototype.GetTrianglesUInt32Array=b.prototype.GetTrianglesUInt32Array=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!AA(i,e,t,A)},b.prototype.GetAttributeFloat=b.prototype.GetAttributeFloat=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!iA(i,e,t,A)},b.prototype.GetAttributeFloatForAllPoints=b.prototype.GetAttributeFloatForAllPoints=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!oA(i,e,t,A)},b.prototype.GetAttributeIntForAllPoints=b.prototype.GetAttributeIntForAllPoints=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!sA(i,e,t,A)},b.prototype.GetAttributeInt8ForAllPoints=b.prototype.GetAttributeInt8ForAllPoints=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!nA(i,e,t,A)},b.prototype.GetAttributeUInt8ForAllPoints=b.prototype.GetAttributeUInt8ForAllPoints=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!rA(i,e,t,A)},b.prototype.GetAttributeInt16ForAllPoints=b.prototype.GetAttributeInt16ForAllPoints=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!aA(i,e,t,A)},b.prototype.GetAttributeUInt16ForAllPoints=b.prototype.GetAttributeUInt16ForAllPoints=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!dA(i,e,t,A)},b.prototype.GetAttributeInt32ForAllPoints=b.prototype.GetAttributeInt32ForAllPoints=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!hA(i,e,t,A)},b.prototype.GetAttributeUInt32ForAllPoints=b.prototype.GetAttributeUInt32ForAllPoints=function(e,t,A){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),!!gA(i,e,t,A)},b.prototype.GetAttributeDataArrayForAllPoints=b.prototype.GetAttributeDataArrayForAllPoints=function(e,t,A,i,o){var s=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),A&&"object"==typeof A&&(A=A.ptr),i&&"object"==typeof i&&(i=i.ptr),o&&"object"==typeof o&&(o=o.ptr),!!lA(s,e,t,A,i,o)},b.prototype.SkipAttributeTransform=b.prototype.SkipAttributeTransform=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),IA(t,e)},b.prototype.GetEncodedGeometryType_Deprecated=b.prototype.GetEncodedGeometryType_Deprecated=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),cA(t,e)},b.prototype.DecodeBufferToPointCloud=b.prototype.DecodeBufferToPointCloud=function(e,t){var A=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),g(fA(A,e,t),x)},b.prototype.DecodeBufferToMesh=b.prototype.DecodeBufferToMesh=function(e,t){var A=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),g(uA(A,e,t),x)},b.prototype.__destroy__=b.prototype.__destroy__=function(){CA(this.ptr)},function(){function e(){G.ATTRIBUTE_INVALID_TRANSFORM=_A(),G.ATTRIBUTE_NO_TRANSFORM=mA(),G.ATTRIBUTE_QUANTIZATION_TRANSFORM=pA(),G.ATTRIBUTE_OCTAHEDRON_TRANSFORM=EA(),G.INVALID=BA(),G.POSITION=QA(),G.NORMAL=xA(),G.COLOR=vA(),G.TEX_COORD=yA(),G.GENERIC=FA(),G.INVALID_GEOMETRY_TYPE=DA(),G.POINT_CLOUD=SA(),G.TRIANGULAR_MESH=wA(),G.DT_INVALID=NA(),G.DT_INT8=TA(),G.DT_UINT8=bA(),G.DT_INT16=MA(),G.DT_UINT16=RA(),G.DT_INT32=GA(),G.DT_UINT32=UA(),G.DT_INT64=LA(),G.DT_UINT64=kA(),G.DT_FLOAT32=VA(),G.DT_FLOAT64=PA(),G.DT_BOOL=OA(),G.DT_TYPES_COUNT=YA(),G.OK=JA(),G.DRACO_ERROR=KA(),G.IO_ERROR=XA(),G.INVALID_PARAMETER=HA(),G.UNSUPPORTED_VERSION=zA(),G.UNKNOWN_VERSION=qA()}de?e():re.unshift(e)}(),"function"==typeof G.onModuleParsed&&G.onModuleParsed(),G.Decoder.prototype.GetEncodedGeometryType=function(e){if(e.__class__&&e.__class__===G.DecoderBuffer)return G.Decoder.prototype.GetEncodedGeometryType_Deprecated(e);if(8>e.byteLength)return G.INVALID_GEOMETRY_TYPE;switch(e[7]){case 0:return G.POINT_CLOUD;case 1:return G.TRIANGULAR_MESH;default:return G.INVALID_GEOMETRY_TYPE}},t.ready}}();function DracoDecoderWASM_base64(){return"AGFzbQEAAAABhAEUYAF/AX9gAn9/AX9gAX8AYAN/f38Bf2ACf38AYAABf2AEf39/fwF/YAN/f38A\nYAZ/f39/f38Bf2AEf39/fwBgAABgBn9/f39/fwBgBX9/f39/AGACf38BfWACf34AYAZ/f39/f34A\nYAd/f39/f39/AGADf39+AX9gA39/fwF8YAF/AX0CHwUBYQFhAAoBYQFiAAcBYQFjAAABYQFkAAAB\nYQFlAAcDrgOsAwIAAwMKBAoHAwoABwIAAgAKAQQEAwcJAgEABwMEBAMAAwQCAwMAAAACBQECBAQA\nAAcDBwMEBQAGBAQACQcHAAUFAgYGBgYGBg4BCQIEBAkHAQcAAgQCBAAHAwcABQQBAQ8AAAIBAwIH\nBAQGAgoBAQAAAAIBAwIAAwEDAwEACQcBEAECCQADAAQHAQEAAwQDAQEEAAQDAQUFBgEAAAABAQAE\nAxEBAQMBAAIAAAMEAAEBAQQCAAcBAQEBAAMBAQIJAwIBAQADAQABAQACAAgBAgAIAQAAAQMDAQEC\nAAEAAQEBAQECAAMBAwMBAAAAAAALCwwBDAkJAwoBBAEAAgQHAgAFBQUFBQUFBQUFBQUDAgMDAQQI\nBgYGBgYGBgYGAwYDAQMDBgMDBgYFAgMBAxIJAwMFAQEBAQYNAgAAAgUABQMFBRMNBQAAAAAAAAAF\nBQIFBwUBAAAAAQICAQAAAQIAAAIAAQIAAAIAAgABAgAABwIAAQICAgAEBgAEAQEAAgAAAAABAAAB\nBAIAAQABAwMICAIAAQgAAgABAwEDAwgIAgAIAgAIAQIACAgCAAgBBAcBcAG0ArQCBQcBAYACgIAC\nBgkBfwFB8N/AAgsHnAaVAQFmAgABZwBxAWgBAAFpAGgBagDVAgFrANQCAWwAaAFtANMCAW4ApAEB\nbwDSAgFwANECAXEAaAFyANACAXMAZwF0AM8CAXUAzgIBdgA0AXcAzQIBeADMAgF5AMsCAXoAygIB\nQQDJAgFCABMBQwDIAgFEAKIBAUUAKwFGAMcCAUcAxgIBSABGAUkAxQIBSgCiAQFLACsBTABGAU0A\nxAIBTgChAQFPAGcBUABGAVEAwgIBUgDBAgFTAKEBAVQAZwFVAEYBVgDAAgFXAL8CAVgApAEBWQC+\nAgFaAL0CAV8AvAIBJAAuAmFhALsCAmJhAGYCY2EALQJkYQAuAmVhALkCAmZhAKABAmdhAC0CaGEA\nLgJpYQC4AgJqYQCgAQJrYQAtAmxhAC4CbWEAtwICbmEAnwECb2EALQJwYQAuAnFhALYCAnJhAJ8B\nAnNhAC0CdGEALgJ1YQCeAQJ2YQBmAndhAC0CeGEALgJ5YQCeAQJ6YQBmAkFhAC0CQmEAtQICQ2EA\ntAICRGEAswICRWEAsgICRmEAsQICR2EAsAICSGEArwICSWEArgICSmEArQICS2EArAICTGEAqwIC\nTWEAqgICTmEAqQICT2EAqAICUGEApwICUWEApgICUmEApQICU2EApAICVGEAowICVWEAogICVmEA\noQICV2EAoAICWGEAnwICWWEAngICWmEAnQICX2EAnQECJGEAnAICYWIAmwICYmIAmgICY2IAmQIC\nZGIAnQECZWIAmAICZmIAlwICZ2IAlgICaGIAlQICaWIAlAICamIAkwICa2IAkgICbGIARQJtYgA6\nAm5iAEQCb2IAYQJwYgBFAnFiADoCcmIARAJzYgBhAnRiAJwBAnViAJsBAnZiAEUCd2IAOgJ4YgBE\nAnliADoCemIARAJBYgBhAkJiAJwBAkNiAJsBAkRiAJACAkViAI8CAkZiAI4CAkdiAI0CAkhiAIwC\nAkliAIsCAkpiAIoCAktiAIkCAkxiADoCTWIARQJOYgCIAgJPYgCHAgJQYgCGAgJRYgCFAgJSYgCJ\nAQJTYgAFAlRiAPIBCfQDAQBBAQuzAoEBJBzLAbAD+gK6An7lAXnDAsoBmwMk4wLbAg+JA/0C+wKw\nAfUCqgHKAdYC/wEnkQKaAfwB9gHuATQd+wGAAQ/oAecBf+0B7AHrAYAB6gHpAd8B3gHmAeQB3QHj\nAeIB4QHgAXt6f9wB2wF82gHYAdkB1wFYDys/KngdKg/WAdUBJyfUAdMBdj/SAdEB0AHPAXV0Dx1z\ncq8DrgOtA1fOAQ8dzQHMAawDJBxVNFYnWA8/qwMnqgOpA3Y/qAOnA6YDpQN1dA8dc3KkA6MDogNX\nzgEPHc0BzAGhAyQcVTRUJ1gqD6ADe3qfA54DyQGcA8sBnQOaA5kDVyvIAQ8dxwEPmAPGAZcDJBxV\nNFaVA5QDV8gBDx3HAcYBkwMkHFU0VCQcKg8qeB2WA5IDjAOLA5EDkAPJAY8DjgONA4cDJw8PiAPY\nAtcCDyodHYIDgQOFA4YDgwOAA/8C/gKEA64B+AK9AbwBuwG6AfwCDyuvAawB9wK9AbwBuwG6AfkC\n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\naiACIARBA2xrQQJ0aigCACEIAkAgACgCDCgCBCIEKAIEIgMgBCgCCEcEQCADIAg2AgAgBCADQQRq\nNgIEDAELAkAgAyAEKAIAIgdrIgNBAnUiCUEBaiIFQYCAgIAESQRAQf////8DIANBAXUiBiAFIAUg\nBkkbIANB/P///wdPGyIFBH8gBUGAgICABE8NAiAFQQJ0EAYFQQALIgYgCUECdGoiCSAINgIAIANB\nAEoEQCAGIAcgAxAHGgsgBCAGIAVBAnRqNgIIIAQgCUEEajYCBCAEIAY2AgAgBwRAIAcQBQsMAgsQ\nCQALEAsACwJAAkACQCAAKAIEIgQoAgQiAyAEKAIIRwRAIAMgAjYCACAEIANBBGo2AgQMAQsgAyAE\nKAIAIgdrIgNBAnUiCEEBaiIFQYCAgIAETw0BQf////8DIANBAXUiBiAFIAUgBkkbIANB/P///wdP\nGyIFBH8gBUGAgICABE8NAyAFQQJ0EAYFQQALIgYgCEECdGoiCCACNgIAIANBAEoEQCAGIAcgAxAH\nGgsgBCAGIAVBAnRqNgIIIAQgCEEEajYCBCAEIAY2AgAgB0UNACAHEAULIAAoAgQiACgCDCABQQJ0\naiAAKAIYNgIAIAAgACgCGEEBajYCGA8LEAkACxALAAt0AQF/IAJFBEAgACgCBCABKAIERg8LIAAg\nAUYEQEEBDwsgASgCBCICLQAAIQECQCAAKAIEIgMtAAAiAEUNACAAIAFHDQADQCACLQABIQEgAy0A\nASIARQ0BIAJBAWohAiADQQFqIQMgACABRg0ACwsgACABRgvWAQEFfyAAKAIEIgIgACgCCEcEQCAC\nIAEoAgA2AgAgACACQQRqNgIEDwsCQCACIAAoAgAiBWsiAkECdSIGQQFqIgNBgICAgARJBEBB////\n/wMgAkEBdSIEIAMgAyAESRsgAkH8////B08bIgMEfyADQYCAgIAETw0CIANBAnQQBgVBAAsiBCAG\nQQJ0aiIGIAEoAgA2AgAgAkEASgRAIAQgBSACEAcaCyAAIAQgA0ECdGo2AgggACAGQQRqNgIEIAAg\nBDYCACAFBEAgBRAFCw8LEAkACxALAAv/AwEGfyMAQRBrIgMkAAJAAkAgASAAKAIEIgRLBEACQAJA\nIAAoAggiBkEFdCICIAEgBGsiBUkNACAEIAIgBWtLDQAgACABNgIEIARBH3EhAiAAKAIAIARBA3ZB\n/P///wFxaiEBDAELIANBADYCCCADQgA3AwAgAUEASA0DIAMgAkH+////A00EfyAGQQZ0IgIgAUEf\nakFgcSIBIAEgAkkbBUH/////BwsQMiADIAAoAgQiAiAFajYCBCAAKAIAIQQgAygCACEBAkAgAkEA\nTARAQQAhAgwBCyABIAQgAkEFdkECdCIGECUgBmohASACQR9xIgIEQCABIAEoAgBBf0EgIAJrdiIH\nQX9zcSAEIAZqKAIAIAdxcjYCAAsgACgCACEECyAAIAMoAgA2AgAgAyAENgIAIAAoAgQhBiAAIAMo\nAgQ2AgQgAyAGNgIEIAAoAgghBiAAIAMoAgg2AgggAyAGNgIIIARFDQAgBBAFCyAFRQ0BIAIEfyAB\nIAEoAgBBfyACdEF/QSAgAmsiACAAIAUgACAFSRsiAGt2cUF/c3E2AgAgBSAAayEFIAFBBGoFIAEL\nQQAgBUEFdkECdCIAEAghASAFIAVBYHFGDQEgACABaiIAIAAoAgBBf0EgIAVBH3FrdkF/c3E2AgAM\nAQsgACABNgIECyADQRBqJAAPCxAJAAtyAgN/AX4CQCAAQQVLDQAgAikDECIGIAIpAwhZDQAgAigC\nACAGp2otAAAhBCACIAZCAXw3AxAgASAEQRh0QRh1IgVBAEgEfyAAQQFqIAEgAhAjRQ0BIAVB/wBx\nIAEoAgBBB3RyBSAECzYCAEEBIQMLIAMLBAAgAAvoAgECfwJAIAAgAUYNACABIAAgAmoiBGtBACAC\nQQF0a00EQCAAIAEgAhAHDwsgACABc0EDcSEDAkACQCAAIAFJBEAgAwRAIAAhAwwDCyAAQQNxRQRA\nIAAhAwwCCyAAIQMDQCACRQ0EIAMgAS0AADoAACABQQFqIQEgAkEBayECIANBAWoiA0EDcQ0ACwwB\nCwJAIAMNACAEQQNxBEADQCACRQ0FIAAgAkEBayICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkED\nTQ0AA0AgACACQQRrIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkEBayICaiABIAJq\nLQAAOgAAIAINAAsMAgsgAkEDTQ0AA0AgAyABKAIANgIAIAFBBGohASADQQRqIQMgAkEEayICQQNL\nDQALCyACRQ0AA0AgAyABLQAAOgAAIANBAWohAyABQQFqIQEgAkEBayICDQALCyAAC+IBAQZ/IAAo\nAgAiACgCBCICIAAoAggiA0kEQCACIAEoAgA2AgAgACACQQRqNgIEDwsCQCACIAAoAgAiAmsiBkEC\ndSIFQQFqIgRBgICAgARJBEBB/////wMgAyACayIDQQF1IgcgBCAEIAdJGyADQfz///8HTxsiBAR/\nIARBgICAgARPDQIgBEECdBAGBUEACyIDIAVBAnRqIgUgASgCADYCACAGQQBKBEAgAyACIAYQBxoL\nIAAgAyAEQQJ0ajYCCCAAIAVBBGo2AgQgACADNgIAIAIEQCACEAULDwsQCQALEAsACwMAAAt3AgF+\nAn8CQCAAQQpLDQAgAikDECIDIAIpAwhZDQAgAigCACADp2osAAAhBSACIANCAXw3AxAgBa0hAyAB\nAn4gBUEASARAIABBAWogASACEChFDQIgA0L/AIMgASkDAEIHhoQMAQsgA0L/AYMLNwMAQQEhBAsg\nBAtyAgN/AX4CQCAAQQVLDQAgAikDECIGIAIpAwhZDQAgAigCACAGp2otAAAhBCACIAZCAXw3AxAg\nASAEQRh0QRh1IgVBAEgEfyAAQQFqIAEgAhApRQ0BIAVB/wBxIAEoAgBBB3RyBSAECzYCAEEBIQML\nIAMLBABBAAsHACAAKAIEC1IBAn9B9NoAKAIAIgEgAEEHakF4cSICaiEAAkAgAkEAIAAgAU0bDQAg\nAD8AQRB0SwRAIAAQA0UNAQtB9NoAIAA2AgAgAQ8LQfDbAEEwNgIAQX8LIgEBfyAABEAgACgCACIB\nBEAgACABNgIEIAEQBQsgABAFCwsYAQF/QQwQBiIAQgA3AgAgAEEANgIIIAALmgIBB38gAEEEaiEG\nAkACQCAAKAIEIgBFDQAgASgCACABIAEtAAsiA0EYdEEYdUEASCICGyEFIAEoAgQgAyACGyEDIAYh\nAQNAAkAgAyAAKAIUIAAtABsiAiACQRh0QRh1QQBIIgQbIgIgAiADSyIHGyIIBEAgACgCECAAQRBq\nIAQbIAUgCBANIgQNAQtBfyAHIAIgA0kbIQQLIAEgACAEQQBIIgIbIQEgAEEEaiAAIAIbKAIAIgAN\nAAsgASAGRg0AAkAgASgCFCABLQAbIgAgAEEYdEEYdUEASCICGyIAIAMgACADSRsiBARAIAUgASgC\nECABQRBqIAIbIAQQDSIFDQELIAAgA0sNAQwCCyAFQQBODQELIAYhAQsgAQuOAQEBfyAABEAgACgC\nTCIBBEAgACABNgJQIAEQBQsgAEFAaygCACIBBEAgACABNgJEIAEQBQsgACgCMCIBBEAgACABNgI0\nIAEQBQsgACgCGCIBBEAgACABNgIcIAEQBQsgACgCDCIBBEAgACABNgIQIAEQBQsgACgCACIBBEAg\nACABNgIEIAEQBQsgABAFCwvyAQEHfyABIAAoAggiBSAAKAIEIgJrQQN1TQRAIAAgAQR/IAJBACAB\nQQN0IgAQCCAAagUgAgs2AgQPCwJAIAIgACgCACIEayIGQQN1IgcgAWoiA0GAgICAAkkEQEEAIQJB\n/////wEgBSAEayIFQQJ1IgggAyADIAhJGyAFQfj///8HTxsiAwRAIANBgICAgAJPDQIgA0EDdBAG\nIQILIAdBA3QgAmpBACABQQN0IgEQCCABaiEBIAZBAEoEQCACIAQgBhAHGgsgACACIANBA3RqNgII\nIAAgATYCBCAAIAI2AgAgBARAIAQQBQsPCxAJAAsQCwALsgkBCX8jAEEgayIGJAACQAJAIAAoAghB\nBXQgAU8NACABQQBIDQEgAUEBa0EFdkEBaiIBQQJ0EAYhAiAGIAE2AhggBkEANgIUIAYgAjYCECAA\nKAIAIQEgBkEANgIMIAYgATYCCCAGIAAoAgQiAkEfcTYCBCAGIAEgAkEDdkH8////AXFqNgIAIwBB\nIGsiAiQAIAYgBigCBCIIIAYoAgwiBGsgBigCACIJIAYoAggiB2tBA3RqIgEgBigCFCIDaiIFNgIU\nIANBACAFQQFrIANBAWtzQSBJG0UEQCAGKAIQIAVBAWtBBXZBACAFQSFPG0ECdGpBADYCAAsgBigC\nECADQQN2Qfz///8BcWohBQJAIANBH3EiAyAERgRAIAFBAEwNASAEBH8gBSAFKAIAQX8gBHRBf0Eg\nIARrIgMgASADIAEgA0gbIgNrdnEiCEF/c3EgBygCACAIcXI2AgAgASADayEBIAdBBGohByAFIAMg\nBGpBA3ZB/P///wFxagUgBQsgByABQSBtIgVBAnQiBBAlIQMgASAFQQV0ayIBQQBMDQEgAyAEaiIF\nIAUoAgBBf0EgIAFrdiIBQX9zcSAEIAdqKAIAIAFxcjYCAAwBCyACIAQ2AhwgAiAHNgIYIAIgCDYC\nFCACIAk2AhAgAiADNgIMIAIgBTYCCAJAIAIoAhQgAigCHCIBayACKAIQIAIoAhgiBGtBA3RqIgdB\nAEwEQCACKAIMIQEMAQsCQCABRQRAIAIoAgwhAQwBCyACKAIIIgkgCSgCAEF/QSAgAigCDCIFayII\nIAggB0EgIAFrIgogByAKSBsiAyADIAhLGyIIa3ZBfyAFdHFBf3NxIAQoAgBBfyABdEF/IAogA2t2\ncXEiCiAFIAFrdCAKIAEgBWt2IAEgBUkbcjYCACACIAUgCGoiBEEfcSIBNgIMIAIgCSAEQQN2Qfz/\n//8BcWoiBTYCCCADIAhrIgRBAEoEQCAFIAUoAgBBf0EgIARrdkF/c3EgCiACKAIcIAhqdnI2AgAg\nAiAENgIMIAQhAQsgByADayEHIAIgAigCGEEEaiIENgIYC0F/IAF0IQhBICABayEFIAdBIE4EQCAI\nQX9zIQkDQCACKAIIIgMgAygCACAJcSAEKAIAIgQgAXRyNgIAIAIgA0EEajYCCCADIAMoAgQgCHEg\nBCAFdnI2AgQgAiACKAIYQQRqIgQ2AhggB0E/SyEDIAdBIGshByADDQALCyAHQQBMDQAgAigCCCID\nIAMoAgBBfyAFIAUgByAFIAdIGyIFa3YgCHFBf3NxIAQoAgBBf0EgIAdrdnEiCCABdHI2AgAgAiAB\nIAVqIgRBH3EiATYCDCACIAMgBEEDdkH8////AXFqIgM2AgggByAFayIEQQBMDQAgAyADKAIAQX9B\nICAEa3ZBf3NxIAggBXZyNgIAIAIgBDYCDCAEIQELIAIoAgghBCACIAE2AgQgAiAENgIACyACQSBq\nJAAgACgCACEBIAAgBigCEDYCACAGIAE2AhAgACgCBCECIAAgBigCFDYCBCAGIAI2AhQgACgCCCEC\nIAAgBigCGDYCCCAGIAI2AhggAUUNACABEAULIAZBIGokAA8LEAkAC+UBAQV/AkAgACgCCCICLQBU\nDQAgACgCECIBRQ0AIAEtAFRFDQAgAigCSCEDIAIoAkQhBCABQQA6AFQCQCADIARrQQJ1IgMgASgC\nSCABKAJEIgVrQQJ1IgRLBEAgAUHEAGogAyAEa0HUDxAQIAAoAgghAgwBCyADIARPDQAgASAFIANB\nAnRqNgJICyACLQBUDQAgAigCRCIDIAIoAkhGDQAgACgCECgCRCEEQQAhAQNAIAQgAUECdCIFaiAD\nIAVqKAIANgIAIAFBAWoiASACKAJIIAIoAkQiA2tBAnVJDQALCyAAKAIQCwcAIAAoAhwLEAAgAgRA\n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\nDGwQBgVBAAsiBiADQQxsaiIDIAEpAgA3AgAgAyABKAIINgIIIAMgBUF0bUEMbGohASAFQQBKBEAg\nASACIAUQBxoLIAAgBiAEQQxsajYCCCAAIANBDGo2AgQgACABNgIAIAIEQCACEAULDwsQCQALEAsA\nC5QEAQN/IAEgACABRiICOgAMAkAgAg0AA0AgASgCCCICLQAMDQECQCACIAIoAggiAygCACIERgRA\nAkAgAygCBCIERQ0AIAQtAAwNAAwCCwJAIAEgAigCAEYEQCACIQEMAQsgAiACKAIEIgEoAgAiADYC\nBCABIAAEfyAAIAI2AgggAigCCAUgAws2AgggAigCCCIAIAAoAgAgAkdBAnRqIAE2AgAgASACNgIA\nIAIgATYCCCABKAIIIgMoAgAhAgsgAUEBOgAMIANBADoADCADIAIoAgQiADYCACAABEAgACADNgII\nCyACIAMoAgg2AgggAygCCCIAIAAoAgAgA0dBAnRqIAI2AgAgAiADNgIEIAMgAjYCCA8LAkAgBEUN\nACAELQAMDQAMAQsCQCABIAIoAgBHBEAgAiEBDAELIAIgASgCBCIANgIAIAEgAAR/IAAgAjYCCCAC\nKAIIBSADCzYCCCACKAIIIgAgACgCACACR0ECdGogATYCACABIAI2AgQgAiABNgIIIAEoAgghAwsg\nAUEBOgAMIANBADoADCADIAMoAgQiACgCACIBNgIEIAEEQCABIAM2AggLIAAgAygCCDYCCCADKAII\nIgEgASgCACADR0ECdGogADYCACAAIAM2AgAgAyAANgIIDAILIARBDGohASACQQE6AAwgAyAAIANG\nOgAMIAFBAToAACADIgEgAEcNAAsLCysBAX8CQCAAKAIsRQ0AIAAoAjBFDQAgACgCNEUNACAAKAI4\nQQBHIQELIAEL/gUBB38gAyACayIJQQBMBEAPCwJAIAAoAggiBiAAKAIEIgdrIAlOBEAgByABayIG\nIAlOBEAgByEFIAMhCAwCCyAHIQUgAyACIAZqIghHBEAgCCEEA0AgBSAELQAAOgAAIAVBAWohBSAE\nQQFqIgQgA0cNAAsLIAAgBTYCBCAGQQBKDQEPCyAHIAAoAgAiBWsgCWoiBEEATgRAIAEgBWshCCAI\nQf////8HIAYgBWsiBkEBdCIKIAQgBCAKSRsgBkH/////A08bIgoEfyAKEAYFQQALIgZqIQQgAiAD\nRwRAIAQgAiAJEAcgCWohBAsgCEEASgRAIAYgBSAIEAcaCyABIAdHBEAgAUF/cyAHaiEDIAcgAWtB\nB3EiBQRAQQAhAgNAIAQgAS0AADoAACAEQQFqIQQgAUEBaiEBIAJBAWoiAiAFRw0ACwsgA0EHTwRA\nA0AgBCABLQAAOgAAIAQgAS0AAToAASAEIAEtAAI6AAIgBCABLQADOgADIAQgAS0ABDoABCAEIAEt\nAAU6AAUgBCABLQAGOgAGIAQgAS0ABzoAByAEQQhqIQQgAUEIaiIBIAdHDQALCyAAKAIAIQULIAAg\nBiAKajYCCCAAIAQ2AgQgACAGNgIAIAUEQCAFEAULDwsQCQALIAcgBSIEIAlrIgNLBEADQCAEIAMt\nAAA6AAAgBEEBaiEEIANBAWoiAyAHSQ0ACwsgACAENgIEIAEgCWoiACAFRwRAIAUgBSAAayIAayAB\nIAAQJRoLIAIgCEYEQA8LIAJBf3MgCGohAAJAIAggAmtBB3EiBUUEQCABIQQMAQtBACEDIAEhBANA\nIAQgAi0AADoAACAEQQFqIQQgAkEBaiECIANBAWoiAyAFRw0ACwsgAEEHSQRADwsDQCAEIAItAAA6\nAAAgBCACLQABOgABIAQgAi0AAjoAAiAEIAItAAM6AAMgBCACLQAEOgAEIAQgAi0ABToABSAEIAIt\nAAY6AAYgBCACLQAHOgAHIARBCGohBCACQQhqIgIgCEcNAAsLXQEBfyMAQRBrIgMkAAJAIAJBCk0E\nQCAAIAI6AAsgACABIAIQNSADQQA6AA8gACACaiADLQAPOgAADAELIABBCiACQQprIAAtAAsiACAA\nIAIgARCFAQsgA0EQaiQAC3YBAn8jAEEQayIEJAACQCACIAAoAghB/////wdxIgNJBEAgACgCACED\nIAAgAjYCBCADIAEgAhA1IARBADoADyACIANqIAQtAA86AAAMAQsgACADQQFrIAIgA2tBAWogACgC\nBCIAIAAgAiABEIUBCyAEQRBqJAAL4AEBA38gAEG80AA2AgAgACgCRCIBBEAgACABNgJIIAEQBQsg\nACgCOCIBBEAgACABNgI8IAEQBQsgACgCLCIBBEAgACABNgIwIAEQBQsgACgCICIBBEAgACABNgIk\nIAEQBQsgACgCFCIBBEAgACABNgIYIAEQBQsgACgCCCIDBEAgACgCDCICIAMiAUcEQANAIAJBBGsi\nAigCACEBIAJBADYCACABBEAgARATCyACIANHDQALIAAoAgghAQsgACADNgIMIAEQBQsgACgCBCEB\nIABBADYCBCABBEAgARBrCyAACwQAQQELBABBfwsUACAABEAgACAAKAIAKAIEEQIACwvPEQQFfwF8\nAX0BfgJAAkAgA0UNAAJAAkACQAJAAkACQAJAAkACQAJAAkAgACgCHEEBaw4LAAECAwQFBgcICQoL\nCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEgBCgC\nBCEIA0AgASAITw0MIAMgBkECdGogASwAADYCACABQQFqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkb\nSQ0ACwtBASEHIAQgBU8NCgwLCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMw\nIAApAyggAa1+fKdqIQEgBCgCBCEIA0AgASAITw0LIAMgBkECdGogAS0AADYCACABQQFqIQEgBkEB\naiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NCQwKCyAALQAYIgQgAkH/AXEiBSAEIAVJ\nGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEgBCgCBCEIA0AgASAITw0KIAMgBkECdGog\nAS4BADYCACABQQJqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NCAwJCyAA\nLQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEgBCgCBCEI\nA0AgASAITw0JIAMgBkECdGogAS8BADYCACABQQJqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0A\nCwtBASEHIAQgBU8NBwwICyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAAp\nAyggAa1+fKdqIQEgBCgCBCEIA0AgASAITw0IIAMgBkECdGogASgCADYCACABQQRqIQEgBkEBaiIG\nIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NBgwHCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRA\nIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEgBCgCBCEIA0AgASAITw0HIAMgBkECdGogASgC\nADYCACABQQRqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NBQwGCyAALQAY\nIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEgBCgCBCEIA0Ag\nASAITw0GIAEpAwAiC0L/////D1YNBiADIAZBAnRqIAs+AgAgAUEIaiEBIAZBAWoiBiAALQAYIgQg\nBSAEIAVJG0kNAAsLQQEhByAEIAVPDQQMBQsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQo\nAgAgACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NBSABKQMAIgtC/////w9WDQUgAyAG\nQQJ0aiALPgIAIAFBCGohASAGQQFqIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0DDAQL\nAkACQCAALQAYIgQgAkH/AXEiAiACIARLG0UNACAAKAIAIgQoAgAiByAAKQMwIAApAyggAa1+fKci\nAWohBiAEKAIEIgUgB2shBCAALQAgRQRAQQAhByABIARODQJBACEBA0AgBioCACIKQwAAAABdDQMg\nCiAKXA0DIAqLQwAAgH9bDQMgCkMAAIBPYA0DIAMgAUECdGoCfyAKQwAAgE9dIApDAAAAAGBxBEAg\nCqkMAQtBAAs2AgAgAUEBaiIBIAAtABgiBCACIAIgBEsbTw0CIAZBBGoiBiAFSQ0ACwwCC0EAIQcg\nASAETg0BQQAhAQNAIAYqAgAiCkMAAAAAXQ0CIAogClwNAiAKi0MAAIB/Ww0CIApDAACAT2ANAiAK\nQwAAgD9eDQIgAyABQQJ0agJ/IAq7RAAA4P///+9BokQAAAAAAADgP6CcIglEAAAAAAAA8EFjIAlE\nAAAAAAAAAABmcQRAIAmrDAELQQALNgIAIAFBAWoiASAALQAYIgQgAiACIARLG08NASAGQQRqIgYg\nBUkNAAsMAQtBASEHIAIgBE0NACADIARBAnRqQQAgAiAEa0ECdBAIGgsgBw8LAkACQCAALQAYIgQg\nAkH/AXEiAiACIARLG0UNACAAKAIAIgQoAgAiByAAKQMwIAApAyggAa1+fKciAWohBiAEKAIEIgUg\nB2shBCAALQAgRQRAQQAhByABIARODQJBACEBA0AgBisDACIJRAAAAAAAAAAAYw0DIAkgCWINAyAJ\nmUQAAAAAAADwf2ENAyAJRAAA4P///+9BZg0DIAMgAUECdGoCfyAJRAAAAAAAAPBBYyAJRAAAAAAA\nAAAAZnEEQCAJqwwBC0EACzYCACABQQFqIgEgAC0AGCIEIAIgAiAESxtPDQIgBkEIaiIGIAVJDQAL\nDAILQQAhByABIARODQFBACEBA0AgBisDACIJRAAAAAAAAAAAYw0CIAkgCWINAiAJmUQAAAAAAADw\nf2ENAiAJRAAA4P///+9BZg0CIAlEAAAAAAAA8D9kDQIgAyABQQJ0agJ/IAlEAADg////70GiRAAA\nAAAAAOA/oJwiCUQAAAAAAADwQWMgCUQAAAAAAAAAAGZxBEAgCasMAQtBAAs2AgAgAUEBaiIBIAAt\nABgiBCACIAIgBEsbTw0BIAZBCGoiBiAFSQ0ACwwBC0EBIQcgAiAETQ0AIAMgBEECdGpBACACIARr\nQQJ0EAgaCyAHDwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGt\nfnynaiEBIAQoAgQhCANAIAEgCE8NAiADIAZBAnRqIAEtAAA2AgAgAUEBaiEBIAZBAWoiBiAALQAY\nIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQAgAyAEQQJ0akEAIAJB/wFxIARrQQJ0EAgaCyAHDwsg\nAyAEQQJ0akEAIAJB/wFxIARrQQJ0EAgaQQEL5REEBX8CfAJ9AX4CQAJAIANFDQACQAJAAkACQAJA\nAkACQAJAAkACQAJAIAAoAhxBAWsOCwABAgMEBQYHCAkKCwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsE\nQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NDCADIAZBAnRqIAEs\nAAA2AgAgAUEBaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQoMCwsgAC0A\nGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANA\nIAEgCE8NCyADIAZBAnRqIAEtAAA2AgAgAUEBaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsL\nQQEhByAEIAVPDQkMCgsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAgACkDMCAAKQMo\nIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NCiADIAZBAnRqIAEuAQA2AgAgAUECaiEBIAZBAWoiBiAA\nLQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQgMCQsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAA\nKAIAIgQoAgAgACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NCSADIAZBAnRqIAEvAQA2\nAgAgAUECaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQcMCAsgAC0AGCIE\nIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEg\nCE8NCCADIAZBAnRqIAEoAgA2AgAgAUEEaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEh\nByAEIAVPDQYMBwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGt\nfnynaiEBIAQoAgQhCANAIAEgCE8EQEEADwsgASgCACIEQQBIDQcgAyAGQQJ0aiAENgIAIAFBBGoh\nASAGQQFqIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0FDAYLIAAtABgiBCACQf8BcSIF\nIAQgBUkbBEAgACgCACIEKAIAIAApAzAgACkDKCABrX58p2ohASAEKAIEIQgDQCABIAhPDQYgASkD\nACINQoCAgIAIfUKAgICAcFQNBiADIAZBAnRqIA0+AgAgAUEIaiEBIAZBAWoiBiAALQAYIgQgBSAE\nIAVJG0kNAAsLQQEhByAEIAVPDQQMBQsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAg\nACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NBSABKQMAIg1C/////wdWDQUgAyAGQQJ0\naiANPgIAIAFBCGohASAGQQFqIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0DDAQLAkAC\nQCAALQAYIgQgAkH/AXEiAiACIARLG0UNACAAKAIAIgQoAgAiByAAKQMwIAApAyggAa1+fKciAWoh\nBiAEKAIEIgUgB2shBCAALQAgRQRAQQAhByABIARODQJBACEBA0AgBioCACILiyEMIAtDAAAAz10N\nAyALIAtcDQMgDEMAAIB/Ww0DIAtDAAAAT2ANAyADIAFBAnRqAn8gDEMAAABPXQRAIAuoDAELQYCA\ngIB4CzYCACABQQFqIgEgAC0AGCIEIAIgAiAESxtPDQIgBkEEaiIGIAVJDQALDAILQQAhByABIARO\nDQFBACEBA0AgBioCACILQwAAAM9dDQIgCyALXA0CIAuLQwAAgH9bDQIgC0MAAABPYA0CIAtDAACA\nP14NAiALQwAAAABdDQIgAyABQQJ0agJ/IAu7RAAAwP///99BokQAAAAAAADgP6CcIgmZRAAAAAAA\nAOBBYwRAIAmqDAELQYCAgIB4CzYCACABQQFqIgEgAC0AGCIEIAIgAiAESxtPDQEgBkEEaiIGIAVJ\nDQALDAELQQEhByACIARNDQAgAyAEQQJ0akEAIAIgBGtBAnQQCBoLIAcPCwJAAkAgAC0AGCIEIAJB\n/wFxIgIgAiAESxtFDQAgACgCACIEKAIAIgcgACkDMCAAKQMoIAGtfnynIgFqIQYgBCgCBCIFIAdr\nIQQgAC0AIEUEQEEAIQcgASAETg0CQQAhAQNAIAYrAwAiCZkhCiAJRAAAAAAAAODBYw0DIAkgCWIN\nAyAKRAAAAAAAAPB/YQ0DIAlEAADA////30FmDQMgAyABQQJ0agJ/IApEAAAAAAAA4EFjBEAgCaoM\nAQtBgICAgHgLNgIAIAFBAWoiASAALQAYIgQgAiACIARLG08NAiAGQQhqIgYgBUkNAAsMAgtBACEH\nIAEgBE4NAUEAIQEDQCAGKwMAIglEAAAAAAAA4MFjDQIgCSAJYg0CIAmZRAAAAAAAAPB/YQ0CIAlE\nAADA////30FmDQIgCUQAAAAAAADwP2QNAiAJRAAAAAAAAAAAYw0CIAMgAUECdGoCfyAJRAAAwP//\n/99BokQAAAAAAADgP6CcIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACABQQFqIgEgAC0A\nGCIEIAIgAiAESxtPDQEgBkEIaiIGIAVJDQALDAELQQEhByACIARNDQAgAyAEQQJ0akEAIAIgBGtB\nAnQQCBoLIAcPCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+\nfKdqIQEgBCgCBCEIA0AgASAITw0CIAMgBkECdGogAS0AADYCACABQQFqIQEgBkEBaiIGIAAtABgi\nBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NACADIARBAnRqQQAgAkH/AXEgBGtBAnQQCBoLIAcPCyAD\nIARBAnRqQQAgAkH/AXEgBGtBAnQQCBpBAQv/EQQFfwF8AX0BfgJAAkAgA0UNAAJAAkACQAJAAkAC\nQAJAAkACQAJAAkAgACgCHEEBaw4LAAECAwQFBgcICQoLCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRA\nIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEgBCgCBCEIA0AgASAITwRAQQAPCyABLAAAIgRB\nAEgNDCADIAZBAXRqIARB/wFxOwEAIAFBAWohASAGQQFqIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EB\nIQcgBCAFTw0KDAsLIAAtABgiBCACQf8BcSIFIAQgBUkbBEAgACgCACIEKAIAIAApAzAgACkDKCAB\nrX58p2ohASAEKAIEIQgDQCABIAhPDQsgAyAGQQF0aiABLQAAOwEAIAFBAWohASAGQQFqIgYgAC0A\nGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0JDAoLIAAtABgiBCACQf8BcSIFIAQgBUkbBEAgACgC\nACIEKAIAIAApAzAgACkDKCABrX58p2ohASAEKAIEIQgDQCABIAhPBEBBAA8LIAEuAQAiBEEASA0K\nIAMgBkEBdGogBDsBACABQQJqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8N\nCAwJCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEg\nBCgCBCEIA0AgASAITw0JIAMgBkEBdGogAS8BADsBACABQQJqIQEgBkEBaiIGIAAtABgiBCAFIAQg\nBUkbSQ0ACwtBASEHIAQgBU8NBwwICyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAA\nKQMwIAApAyggAa1+fKdqIQEgBCgCBCEIA0AgASAITw0IIAEoAgAiBEH//wNLDQggAyAGQQF0aiAE\nOwEAIAFBBGohASAGQQFqIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0GDAcLIAAtABgi\nBCACQf8BcSIFIAQgBUkbBEAgACgCACIEKAIAIAApAzAgACkDKCABrX58p2ohASAEKAIEIQgDQCAB\nIAhPDQcgASgCACIEQf//A0sNByADIAZBAXRqIAQ7AQAgAUEEaiEBIAZBAWoiBiAALQAYIgQgBSAE\nIAVJG0kNAAsLQQEhByAEIAVPDQUMBgsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAg\nACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NBiABKQMAIgtC//8DVg0GIAMgBkEBdGog\nCz0BACABQQhqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NBAwFCyAALQAY\nIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEgBCgCBCEIA0Ag\nASAITw0FIAEpAwAiC0L//wNWDQUgAyAGQQF0aiALPQEAIAFBCGohASAGQQFqIgYgAC0AGCIEIAUg\nBCAFSRtJDQALC0EBIQcgBCAFTw0DDAQLAkACQCAALQAYIgQgAkH/AXEiAiACIARLG0UNACAAKAIA\nIgQoAgAiByAAKQMwIAApAyggAa1+fKciAWohBiAEKAIEIgUgB2shBCAALQAgRQRAQQAhByABIARO\nDQJBACEBA0AgBioCACIKQwAAAABdDQMgCiAKXA0DIAqLQwAAgH9bDQMgCkMA/39HYA0DIAMgAUEB\ndGoCfyAKQwAAgE9dIApDAAAAAGBxBEAgCqkMAQtBAAs7AQAgAUEBaiIBIAAtABgiBCACIAIgBEsb\nTw0CIAZBBGoiBiAFSQ0ACwwCC0EAIQcgASAETg0BQQAhAQNAIAYqAgAiCkMAAAAAXQ0CIAogClwN\nAiAKi0MAAIB/Ww0CIApDAP9/R2ANAiAKQwAAgD9eDQIgAyABQQF0agJ/IAq7RAAAAADg/+9AokQA\nAAAAAADgP6CcIglEAAAAAAAA8EFjIAlEAAAAAAAAAABmcQRAIAmrDAELQQALOwEAIAFBAWoiASAA\nLQAYIgQgAiACIARLG08NASAGQQRqIgYgBUkNAAsMAQtBASEHIAIgBE0NACADIARBAXRqQQAgAiAE\na0EBdBAIGgsgBw8LAkACQCAALQAYIgQgAkH/AXEiAiACIARLG0UNACAAKAIAIgQoAgAiByAAKQMw\nIAApAyggAa1+fKciAWohBiAEKAIEIgUgB2shBCAALQAgRQRAQQAhByABIARODQJBACEBA0AgBisD\nACIJRAAAAAAAAAAAYw0DIAkgCWINAyAJmUQAAAAAAADwf2ENAyAJRAAAAADg/+9AZg0DIAMgAUEB\ndGoCfyAJRAAAAAAAAPBBYyAJRAAAAAAAAAAAZnEEQCAJqwwBC0EACzsBACABQQFqIgEgAC0AGCIE\nIAIgAiAESxtPDQIgBkEIaiIGIAVJDQALDAILQQAhByABIARODQFBACEBA0AgBisDACIJRAAAAAAA\nAAAAYw0CIAkgCWINAiAJmUQAAAAAAADwf2ENAiAJRAAAAADg/+9AZg0CIAlEAAAAAAAA8D9kDQIg\nAyABQQF0agJ/IAlEAAAAAOD/70CiRAAAAAAAAOA/oJwiCUQAAAAAAADwQWMgCUQAAAAAAAAAAGZx\nBEAgCasMAQtBAAs7AQAgAUEBaiIBIAAtABgiBCACIAIgBEsbTw0BIAZBCGoiBiAFSQ0ACwwBC0EB\nIQcgAiAETQ0AIAMgBEEBdGpBACACIARrQQF0EAgaCyAHDwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsE\nQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NAiADIAZBAXRqIAEt\nAAA7AQAgAUEBaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQAgAyAEQQF0\nakEAIAJB/wFxIARrQQF0EAgaCyAHDwsgAyAEQQF0akEAIAJB/wFxIARrQQF0EAgaQQEL+hEEBX8C\nfAJ9AX4CQAJAIANFDQACQAJAAkACQAJAAkACQAJAAkACQAJAIAAoAhxBAWsOCwABAgMEBQYHCAkK\nCwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGtfnynaiEBIAQo\nAgQhCANAIAEgCE8NDCADIAZBAXRqIAEsAAA7AQAgAUEBaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJ\nG0kNAAsLQQEhByAEIAVPDQoMCwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAgACkD\nMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NCyADIAZBAXRqIAEtAAA7AQAgAUEBaiEBIAZB\nAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQkMCgsgAC0AGCIEIAJB/wFxIgUgBCAF\nSRsEQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGtfnynaiEBIAQoAgQhCANAIAEgCE8NCiADIAZBAXRq\nIAEvAQA7AQAgAUECaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQgMCQsg\nAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAIgQoAgAgACkDMCAAKQMoIAGtfnynaiEBIAQoAgQh\nCANAIAEgCE8EQEEADwsgAS4BACIEQQBIDQkgAyAGQQF0aiAEOwEAIAFBAmohASAGQQFqIgYgAC0A\nGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0HDAgLIAAtABgiBCACQf8BcSIFIAQgBUkbBEAgACgC\nACIEKAIAIAApAzAgACkDKCABrX58p2ohASAEKAIEIQgDQCABIAhPDQggASgCACIEQYCAAmtBgIB8\nSQ0IIAMgBkEBdGogBDsBACABQQRqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQg\nBU8NBgwHCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdq\nIQEgBCgCBCEIA0AgASAITw0HIAEoAgAiBEH//wFLDQcgAyAGQQF0aiAEOwEAIAFBBGohASAGQQFq\nIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0FDAYLIAAtABgiBCACQf8BcSIFIAQgBUkb\nBEAgACgCACIEKAIAIAApAzAgACkDKCABrX58p2ohASAEKAIEIQgDQCABIAhPDQYgASkDACINQoCA\nAn1CgIB8VA0GIAMgBkEBdGogDT0BACABQQhqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtB\nASEHIAQgBU8NBAwFCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAygg\nAa1+fKdqIQEgBCgCBCEIA0AgASAITw0FIAEpAwAiDUL//wFWDQUgAyAGQQF0aiANPQEAIAFBCGoh\nASAGQQFqIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0DDAQLAkACQCAALQAYIgQgAkH/\nAXEiAiACIARLG0UNACAAKAIAIgQoAgAiByAAKQMwIAApAyggAa1+fKciAWohBiAEKAIEIgUgB2sh\nBCAALQAgRQRAQQAhByABIARODQJBACEBA0AgBioCACILiyEMIAtDAAAAx10NAyALIAtcDQMgDEMA\nAIB/Ww0DIAtDAP7/RmANAyADIAFBAXRqAn8gDEMAAABPXQRAIAuoDAELQYCAgIB4CzsBACABQQFq\nIgEgAC0AGCIEIAIgAiAESxtPDQIgBkEEaiIGIAVJDQALDAILQQAhByABIARODQFBACEBA0AgBioC\nACILQwAAAMddDQIgCyALXA0CIAuLQwAAgH9bDQIgC0MA/v9GYA0CIAtDAACAP14NAiALQwAAAABd\nDQIgAyABQQF0agJ/IAu7RAAAAADA/99AokQAAAAAAADgP6CcIgmZRAAAAAAAAOBBYwRAIAmqDAEL\nQYCAgIB4CzsBACABQQFqIgEgAC0AGCIEIAIgAiAESxtPDQEgBkEEaiIGIAVJDQALDAELQQEhByAC\nIARNDQAgAyAEQQF0akEAIAIgBGtBAXQQCBoLIAcPCwJAAkAgAC0AGCIEIAJB/wFxIgIgAiAESxtF\nDQAgACgCACIEKAIAIgcgACkDMCAAKQMoIAGtfnynIgFqIQYgBCgCBCIFIAdrIQQgAC0AIEUEQEEA\nIQcgASAETg0CQQAhAQNAIAYrAwAiCZkhCiAJRAAAAAAAAODAYw0DIAkgCWINAyAKRAAAAAAAAPB/\nYQ0DIAlEAAAAAMD/30BmDQMgAyABQQF0agJ/IApEAAAAAAAA4EFjBEAgCaoMAQtBgICAgHgLOwEA\nIAFBAWoiASAALQAYIgQgAiACIARLG08NAiAGQQhqIgYgBUkNAAsMAgtBACEHIAEgBE4NAUEAIQED\nQCAGKwMAIglEAAAAAAAA4MBjDQIgCSAJYg0CIAmZRAAAAAAAAPB/YQ0CIAlEAAAAAMD/30BmDQIg\nCUQAAAAAAADwP2QNAiAJRAAAAAAAAAAAYw0CIAMgAUEBdGoCfyAJRAAAAADA/99AokQAAAAAAADg\nP6CcIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzsBACABQQFqIgEgAC0AGCIEIAIgAiAESxtP\nDQEgBkEIaiIGIAVJDQALDAELQQEhByACIARNDQAgAyAEQQF0akEAIAIgBGtBAXQQCBoLIAcPCyAA\nLQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAiBCgCACAAKQMwIAApAyggAa1+fKdqIQEgBCgCBCEI\nA0AgASAITw0CIAMgBkEBdGogAS0AADsBACABQQFqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0A\nCwtBASEHIAQgBU8NACADIARBAXRqQQAgAkH/AXEgBGtBAXQQCBoLIAcPCyADIARBAXRqQQAgAkH/\nAXEgBGtBAXQQCBpBAQvJDgQEfwF8AX0BfgJAAkAgA0UNAAJAAkACQAJAAkACQAJAAkACQAJAAkAg\nACgCHEEBaw4LAAECAwQFBgcICQoLCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAoAgAgACkD\nMCAAKQMoIAGtfnynaiEBA0AgASAAKAIAKAIETwRAQQAPCyABLAAAIgRBAEgNDCADIAZqIAQ6AAAg\nAUEBaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQoMCwsgAC0AGCIEIAJB\n/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAgACkDKCABrX58p2ohAQNAIAAoAgAoAgQgAU0NCyAD\nIAZqIAEtAAA6AAAgAUEBaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQkM\nCgsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAgACkDKCABrX58p2ohAQNAIAAo\nAgAoAgQgAU0NCiABLwEAIgRB/wFLDQogAyAGaiAEOgAAIAFBAmohASAGQQFqIgYgAC0AGCIEIAUg\nBCAFSRtJDQALC0EBIQcgBCAFTw0IDAkLIAAtABgiBCACQf8BcSIFIAQgBUkbBEAgACgCACgCACAA\nKQMwIAApAyggAa1+fKdqIQEDQCAAKAIAKAIEIAFNDQkgAS8BACIEQf8BSw0JIAMgBmogBDoAACAB\nQQJqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NBwwICyAALQAYIgQgAkH/\nAXEiBSAEIAVJGwRAIAAoAgAoAgAgACkDMCAAKQMoIAGtfnynaiEBA0AgACgCACgCBCABTQ0IIAEo\nAgAiBEH/AUsNCCADIAZqIAQ6AAAgAUEEaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEh\nByAEIAVPDQYMBwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAgACkDKCABrX58\np2ohAQNAIAAoAgAoAgQgAU0NByABKAIAIgRB/wFLDQcgAyAGaiAEOgAAIAFBBGohASAGQQFqIgYg\nAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0FDAYLIAAtABgiBCACQf8BcSIFIAQgBUkbBEAg\nACgCACgCACAAKQMwIAApAyggAa1+fKdqIQEDQCAAKAIAKAIEIAFNDQYgASkDACIKQv8BVg0GIAMg\nBmogCjwAACABQQhqIQEgBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NBAwFCyAA\nLQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAoAgAgACkDMCAAKQMoIAGtfnynaiEBA0AgACgCACgC\nBCABTQ0FIAEpAwAiCkL/AVYNBSADIAZqIAo8AAAgAUEIaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJ\nG0kNAAsLQQEhByAEIAVPDQMMBAsCQCAALQAYIgQgAkH/AXEiAiACIARLGwRAIAAoAgAoAgAgACkD\nMCAAKQMoIAGtfnynaiEBA0AgACgCACgCBCABTQ0CIAEqAgAiCUMAAAAAXQ0CIAkgCVwNAiAJi0MA\nAIB/Ww0CIAlDAAB/Q2ANAiADIAZqAn8CQCAALQAgBEAgCUMAAIA/Xg0FIAm7RAAAAAAA4G9AokQA\nAAAAAADgP6CcIghEAAAAAAAA8EFjIAhEAAAAAAAAAABmcUUNASAIqwwCCyAJQwAAgE9dIAlDAAAA\nAGBxRQ0AIAmpDAELQQALOgAAIAFBBGohASAGQQFqIgYgAC0AGCIEIAIgAiAESxtJDQALC0EBIQcg\nAiAETQ0AIAMgBGpBACACIARrEAgaCyAHDwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIA\nIAApAzAgACkDKCABrX58p2ohAQNAIAAoAgAoAgQgAU0NAyABKwMAIghEAAAAAAAAAABjDQMgCCAI\nYg0DIAiZRAAAAAAAAPB/YQ0DIAhEAAAAAADgb0BmDQMgAyAGagJ/IAAtACAEQCAIRAAAAAAAAPA/\nZA0FIAhEAAAAAADgb0CiRAAAAAAAAOA/oJwhCAsgCEQAAAAAAADwQWMgCEQAAAAAAAAAAGZxBEAg\nCKsMAQtBAAs6AAAgAUEIaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQEM\nAgsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAgACkDKCABrX58p2ohAQNAIAAo\nAgAoAgQgAU0NAiADIAZqIAEtAAA6AAAgAUEBaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsL\nQQEhByAEIAVPDQAgAyAEakEAIAJB/wFxIARrEAgaCyAHDwsgAyAEakEAIAJB/wFxIARrEAgaQQEL\n8Q4EBH8BfAJ9AX4CQAJAIANFDQACQAJAAkACQAJAAkACQAJAAkACQAJAIAAoAhxBAWsOCwABAgME\nBQYHCAkKCwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAgACkDKCABrX58p2oh\nAQNAIAAoAgAoAgQgAU0NDCADIAZqIAEtAAA6AAAgAUEBaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJ\nG0kNAAsLQQEhByAEIAVPDQoMCwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAg\nACkDKCABrX58p2ohAQNAIAEgACgCACgCBE8EQEEADwsgASwAACIEQQBIDQsgAyAGaiAEOgAAIAFB\nAWohASAGQQFqIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0JDAoLIAAtABgiBCACQf8B\ncSIFIAQgBUkbBEAgACgCACgCACAAKQMwIAApAyggAa1+fKdqIQEDQCAAKAIAKAIEIAFNDQogAS8B\nACIEQYABa0H//wNxQYD+A0kNCiADIAZqIAQ6AAAgAUECaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJ\nG0kNAAsLQQEhByAEIAVPDQgMCQsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAg\nACkDKCABrX58p2ohAQNAIAAoAgAoAgQgAU0NCSABLwEAIgRB/wBLDQkgAyAGaiAEOgAAIAFBAmoh\nASAGQQFqIgYgAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0HDAgLIAAtABgiBCACQf8BcSIF\nIAQgBUkbBEAgACgCACgCACAAKQMwIAApAyggAa1+fKdqIQEDQCAAKAIAKAIEIAFNDQggASgCACIE\nQYABa0GAfkkNCCADIAZqIAQ6AAAgAUEEaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEh\nByAEIAVPDQYMBwsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAgACkDKCABrX58\np2ohAQNAIAAoAgAoAgQgAU0NByABKAIAIgRB/wBLDQcgAyAGaiAEOgAAIAFBBGohASAGQQFqIgYg\nAC0AGCIEIAUgBCAFSRtJDQALC0EBIQcgBCAFTw0FDAYLIAAtABgiBCACQf8BcSIFIAQgBUkbBEAg\nACgCACgCACAAKQMwIAApAyggAa1+fKdqIQEDQCAAKAIAKAIEIAFNDQYgASkDACILQoABfUKAflQN\nBiADIAZqIAs8AAAgAUEIaiEBIAZBAWoiBiAALQAYIgQgBSAEIAVJG0kNAAsLQQEhByAEIAVPDQQM\nBQsgAC0AGCIEIAJB/wFxIgUgBCAFSRsEQCAAKAIAKAIAIAApAzAgACkDKCABrX58p2ohAQNAIAAo\nAgAoAgQgAU0NBSABKQMAIgtC/wBWDQUgAyAGaiALPAAAIAFBCGohASAGQQFqIgYgAC0AGCIEIAUg\nBCAFSRtJDQALC0EBIQcgBCAFTw0DDAQLAkAgAC0AGCIEIAJB/wFxIgIgAiAESxsEQCAAKAIAKAIA\nIAApAzAgACkDKCABrX58p2ohAQNAIAAoAgAoAgQgAU0NAiABKgIAIgmLIQogCUMAAADDXQ0CIAkg\nCVwNAiAKQwAAgH9bDQIgCUMAAP5CYA0CIAMgBmoCfwJAIAAtACAEQCAJQwAAgD9eDQUgCUMAAAAA\nXQ0FIAm7RAAAAAAAwF9AokQAAAAAAADgP6CcIgiZRAAAAAAAAOBBY0UNASAIqgwCCyAKQwAAAE9d\nRQ0AIAmoDAELQYCAgIB4CzoAACABQQRqIQEgBkEBaiIGIAAtABgiBCACIAIgBEsbSQ0ACwtBASEH\nIAIgBE0NACADIARqQQAgAiAEaxAIGgsgBw8LAkAgAC0AGCIEIAJB/wFxIgIgAiAESxsEQCAAKAIA\nKAIAIAApAzAgACkDKCABrX58p2ohAQNAIAAoAgAoAgQgAU0NAiABKwMAIghEAAAAAAAAYMBjDQIg\nCCAIYg0CIAiZRAAAAAAAAPB/YQ0CIAhEAAAAAADAX0BmDQIgAyAGagJ/IAAtACAEQCAIRAAAAAAA\nAPA/ZA0EIAhEAAAAAAAAAABjDQQgCEQAAAAAAMBfQKJEAAAAAAAA4D+gnCEICyAImUQAAAAAAADg\nQWMEQCAIqgwBC0GAgICAeAs6AAAgAUEIaiEBIAZBAWoiBiAALQAYIgQgAiACIARLG0kNAAsLQQEh\nByACIARNDQAgAyAEakEAIAIgBGsQCBoLIAcPCyAALQAYIgQgAkH/AXEiBSAEIAVJGwRAIAAoAgAo\nAgAgACkDMCAAKQMoIAGtfnynaiEBA0AgACgCACgCBCABTQ0CIAMgBmogAS0AADoAACABQQFqIQEg\nBkEBaiIGIAAtABgiBCAFIAQgBUkbSQ0ACwtBASEHIAQgBU8NACADIARqQQAgAkH/AXEgBGsQCBoL\nIAcPCyADIARqQQAgAkH/AXEgBGsQCBpBAQvfAQEGfwJAAkAgACgCBCICIAAoAgAiBGsiBSABpyID\nSQRAIAMgBWsiByAAKAIIIgYgAmtNBEAgACACQQAgBxAIIAdqNgIEDAILIANBAEgNAkH/////ByAG\nIARrIgJBAXQiBiADIAMgBkkbIAJB/////wNPGyIGEAYiAiAFakEAIAcQCBogBUEASgRAIAIgBCAF\nEAcaCyAAIAIgBmo2AgggACACIANqNgIEIAAgAjYCACAERQ0BIAQQBQwBCyADIAVPDQAgACADIARq\nNgIECyAAIAApAxhCAXw3AxgPCxAJAAtzAQN/IAEQFCICQXBJBEACQAJAIAJBC08EQCACQQ9yQQFq\nIgQQBiEDIAAgBEGAgICAeHI2AgggACADNgIAIAAgAjYCBAwBCyAAIAI6AAsgACEDIAJFDQELIAMg\nASACEAcaCyACIANqQQA6AAAgAA8LEBUAC8ILAgh/An0gAigCACEIIAACfwJAIAEoAgQiBEUNAAJA\nIARpIgZBAk8EQCAIIgUgBE8EQCAIIARwIQULIAEoAgAgBUECdGooAgAiAkUNAiAGQQFNDQEDQCAC\nKAIAIgJFDQMgCCACKAIEIgZHBEAgBCAGTQR/IAYgBHAFIAYLIAVHDQQLIAIoAgggCEcNAAtBAAwD\nCyABKAIAIARBAWsgCHEiBUECdGooAgAiAkUNAQsgBEEBayEGA0AgAigCACICRQ0BIAggAigCBCIH\nRyAGIAdxIAVHcQ0BIAIoAgggCEcNAAtBAAwBC0EQEAYhAiADKAIAKAIAIQMgAkEANgIMIAIgAzYC\nCCACIAg2AgQgAkEANgIAAkBBACAEIAEoAgxBAWqzIgwgASoCECINIASzlF4bDQBBAiEFAkAgBCAE\nQQFrcUEARyAEQQNJciAEQQF0ciIDAn8gDCANlY0iDEMAAIBPXSAMQwAAAABgcQRAIAypDAELQQAL\nIgYgAyAGSxsiA0EBRg0AIAMgA0EBa3FFBEAgAyEFDAELIAMQiwEhBSABKAIEIQQLAkAgBCAFTwRA\nIAQgBU0NASAEQQNJIQYCfyABKAIMsyABKgIQlY0iDEMAAIBPXSAMQwAAAABgcQRAIAypDAELQQAL\nIQMgBQJ/AkAgBg0AIARpQQFLDQAgA0EBQSAgA0EBa2drdCADQQJJGwwBCyADEIsBCyIDIAMgBUkb\nIgUgBE8NAQtBACEEAkACQAJAAkAgBSIHBEAgB0GAgICABE8NASAHQQJ0EAYhBSABKAIAIQMgASAF\nNgIAIAMEQCADEAULIAEgBzYCBEEAIQUgB0EETwRAIAdBfHEhBgNAIAVBAnQiAyABKAIAakEANgIA\nIAEoAgAgA0EEcmpBADYCACABKAIAIANBCHJqQQA2AgAgASgCACADQQxyakEANgIAIAVBBGohBSAE\nQQRqIgQgBkcNAAsLIAdBA3EiAwRAA0AgASgCACAFQQJ0akEANgIAIAVBAWohBSAJQQFqIgkgA0cN\nAAsLIAEoAggiBEUNBCABQQhqIQMgBCgCBCEGIAdpIgVBAkkNAiAGIAdPBEAgBiAHcCEGCyABKAIA\nIAZBAnRqIAM2AgAgBCgCACIDRQ0EIAVBAU0NAwNAIAcgAygCBCIJTQRAIAkgB3AhCQsCQCAGIAlG\nBEAgAyEEDAELIAMhBSAJQQJ0IgogASgCAGoiCygCAEUEQCALIAQ2AgAgAyEEIAkhBgwBCwNAIAUi\nCSgCACIFBEAgAygCCCAFKAIIRg0BCwsgBCAFNgIAIAkgASgCACAKaigCACgCADYCACABKAIAIApq\nKAIAIAM2AgALIAQoAgAiAw0ACwwECyABKAIAIQMgAUEANgIAIAMEQCADEAULIAFBADYCBAwDCxAL\nAAsgASgCACAGIAdBAWtxIgZBAnRqIAM2AgAgBCgCACIDRQ0BCyAHQQFrIQoDQAJAIAYgAygCBCAK\ncSIHRgRAIAMhBAwBCyADIQUgB0ECdCIJIAEoAgBqIgsoAgAEQANAIAUiBygCACIFBEAgAygCCCAF\nKAIIRg0BCwsgBCAFNgIAIAcgASgCACAJaigCACgCADYCACABKAIAIAlqKAIAIAM2AgAMAQsgCyAE\nNgIAIAMhBCAHIQYLIAQoAgAiAw0ACwsLIAEoAgQiBCAEQQFrIgNxRQRAIAMgCHEhBQwBCyAEIAhL\nBEAgCCEFDAELIAggBHAhBQsCQAJAIAEoAgAgBUECdGoiBSgCACIDRQRAIAIgAUEIaiIDKAIANgIA\nIAEgAjYCCCAFIAM2AgAgAigCACIDRQ0CIAMoAgQhAwJAIAQgBEEBayIFcUUEQCADIAVxIQMMAQsg\nAyAESQ0AIAMgBHAhAwsgASgCACADQQJ0aiEDDAELIAIgAygCADYCAAsgAyACNgIACyABIAEoAgxB\nAWo2AgxBAQs6AAQgACACNgIAC4kBAQF/IAAoAlQiAQRAIAAgATYCWCABEAULIAAoAkgiAQRAIAAg\nATYCTCABEAULIAAoAjQiAQRAIAAgATYCOCABEAULIAAoAigiAQRAIAAgATYCLCABEAULIAAoAhwi\nAQRAIAAgATYCICABEAULIAAoAgwiAQRAIAEQBQsgACgCACIABEAgABAFCwu9AQEEfwJAIAEgACgC\nECAAKAIMIgNrQQJ1IgJLBEAgAEEMaiABIAJrEAoMAQsgASACTw0AIAAgAyABQQJ0ajYCEAsCQAJA\nIAAoAgggACgCACICa0ECdSABTw0AIAFBgICAgARPDQEgACgCBCEDIAFBAnQiBBAGIgEgBGohBCAB\nIAMgAmsiA2ohBSADQQBKBEAgASACIAMQBxoLIAAgBDYCCCAAIAU2AgQgACABNgIAIAJFDQAgAhAF\nCw8LEAkAC4ABAQR/AkACQCAAKAIIIAAoAgAiAmtBAnUgAU8NACABQYCAgIAETw0BIAAoAgQhAyAB\nQQJ0IgQQBiIBIARqIQQgASADIAJrIgNqIQUgA0EASgRAIAEgAiADEAcaCyAAIAQ2AgggACAFNgIE\nIAAgATYCACACRQ0AIAIQBQsPCxAJAAudBgEJfyACIAIoAgQgASgCECIKayIHrUIghiACKAIAIApr\nIgSthDcCAAJAIAEoAhAiCyAHIAdBH3UiBXMgBWsgBCAEQR91IgVzIAVrak8iDARAIAchBQwBCwJA\nAkAgBEEATgRAQQEhBkEBIQggB0EATg0CQQEhCUF/IQZBfyEIIAQNAQwCC0F/IQlBfyEGQX8hCCAH\nQQBMDQELQX9BASAHQQBMGyEGIAkhCAsgAiAGIAtsIglBACAEQQF0IAggC2wiBGsiBWsgBSAGIAhs\nQQBOIgYbakECbSIFNgIEIAIgBEEAIAdBAXQgCWsiBGsgBCAGG2pBAm0iBDYCAAsCQAJ/AkACQAJA\nAkACQCAEBEAgBEEASA0BIAVBAE4NAgwFCyAFDQJBASEIQQAhBkEAIQVBACEJDAYLQQEhCCAFQQBK\nDQJB/QFBACAFQQBKGyEJIAUhBiAEIQUMBQtBACAFayEGQQAgBGshBUH+AQwDCyAFQQBMDQELQQAg\nBWshBSAEIQZB/QEMAQtBACAEayEGQf8BCyEJIAIgBa0gBq1CIIaENwIAQQAhCAsCQCABKAIQIgcg\nAygCACAFaiIESARAIAQgASgCBGshBAwBCyAEQQAgB2tODQAgASgCBCAEaiEECwJAIAMoAgQgBmoi\nAiAHSgRAIAIgASgCBGshAgwBCyACQQAgB2tODQAgASgCBCACaiECCwJAIAgEQCACIQEMAQsgAiEB\nAkACQAJAIAlBA3FBAWsOAwABAgMLQQAgBGshASACIQQMAgtBACACayEBQQAgBGshBAwBCyAEIQFB\nACACayEECwJAIAwEQCABIQIMAQsCQAJAIARBAE4EQEEBIQJBASEFIAFBAE4NAkEBIQNBfyECQX8h\nBSAEDQEMAgtBfyEDQX8hAkF/IQUgAUEATA0BC0F/QQEgAUEATBshAiADIQULIAIgB2wiBkEAIARB\nAXQgBSAHbCIEayIDayADIAIgBWxBAE4iAxtqQQJtIQJBACABQQF0IAZrIgFrIAEgAxsgBGpBAm0h\nBAsgACAEIApqrSACIApqrUIghoQ3AgAL/gcCBn8IfiMAQeAAayIDJAAgACgCECEFIANBAToAXCAD\nIAE2AlggAyABNgJUIAMgBTYCUAJAIAFBf0YEQCAAKAIUIQUMAQsgBSgCACABQQJ0aigCACIEIAAo\nAhQiBSgCBCAFKAIAIgZrQQJ1Tw0AIAAoAgggBiAEQQJ0aigCAEECdGooAgAhBSAAKAIEIgQtAFRF\nBEAgBCgCRCAFQQJ0aigCACEFCyADQgA3A0ggA0FAa0IANwMAIANCADcDOCAEIAUgBCwAGCADQThq\nEBsgAUEBaiIFIAFBAmsgBUEDcBshBkF/QQIgAUEDcBsgAWohBwJAAkADQCAGIQQCfyAHIAAoAhxF\nDQAaIAFBAWoiBSABQQJrIAVBA3AbIQQgAUEBayABQQNwDQAaIAFBAmoLIQUgBEF/RgRAIAAoAhQh\nAQwDCyAAKAIQKAIAIARBAnRqKAIAIgQgACgCFCIBKAIEIAEoAgAiCGtBAnVPDQIgACgCCCAIIARB\nAnRqKAIAQQJ0aigCACEEIAAoAgQiAS0AVEUEQCABKAJEIARBAnRqKAIAIQQLIANCADcDMCADQgA3\nAyggA0IANwMgIAEgBCABLAAYIANBIGoQGyAFQX9GBEAgACgCFCEBDAILIAAoAhAoAgAgBUECdGoo\nAgAiBSAAKAIUIgEoAgQgASgCACIEa0ECdU8NASAAKAIIIAQgBUECdGooAgBBAnRqKAIAIQQgACgC\nBCIBLQBURQRAIAEoAkQgBEECdGooAgAhBAsgA0IANwMYIANCADcDECADQgA3AwggASAEIAEsABgg\nA0EIahAbIAogAykDCCADKQM4Igp9IgkgAykDKCADKQNAIgt9Igx+fSADKQMQIAt9IgsgAykDICAK\nfSIPfnwhCiANIAkgAykDMCADKQNIIg19IhB+fCADKQMYIA19IgkgD359IQ0gDiALIBB+fSAJIAx+\nfCEOIANB0ABqEHAgAygCWCIBQX9HDQALIA4gDkI/hyIJhSAJfSEJQv///////////wAhCyANIA1C\nP4ciDIUgDH0iDEL///////////8AhSEPAkAgCgJ+IAAoAhxFBEAgCSAPVg0CQoCAgIBwIAkgDHwi\nCSAKIApCP4ciC4UgC30iC3xCIIYgCSALQv///////////wCFVhsiCUKBgICAgICAgCBTDQIgCUI9\niAwBCwJAIAkgD1YNACAJIAx8IgkgCiAKQj+HIgyFIAx9IgxC////////////AIVWDQAgCSAMfCIL\nQoGAgIACVA0CCyALQh2ICyIJfyEKIA0gCX8hDSAOIAl/IQ4LIAIgCj4CCCACIA0+AgQgAiAOPgIA\nIANB4ABqJAAPCxAOAAsQDgALEA4ACxYAIAFBAU0EQCAAIAE2AhwLIAFBAkkLlQsCBX8JfiMAQeAA\nayIEJAAgACgCECEDIARBAToAXCAEIAE2AlggBCABNgJUIAQgAzYCUAJAAkAgAygCHCABQQJ0aigC\nACIDIAAoAhQiBSgCBCAFKAIAIgVrQQJ1SQRAIAAoAgggBSADQQJ0aigCAEECdGooAgAhAyAAKAIE\nIgUtAFRFBEAgBSgCRCADQQJ0aigCACEDCyAEQgA3A0ggBEFAa0IANwMAIARCADcDOCAFIAMgBSwA\nGCAEQThqEBsgAUF/RwRAIAFBAWoiAyABQQJrIANBA3AbIQVBf0ECIAFBA3AbIAFqIQcDQCAFIQMC\nfyAHIAAoAhxFDQAaIAFBAWoiAyABQQJrIANBA3AbIQMgAUEBayABQQNwDQAaIAFBAmoLIQYgACgC\nECgCHCADQQJ0aigCACIBIAAoAhQiAygCBCADKAIAIgNrQQJ1Tw0DIAAoAgggAyABQQJ0aigCAEEC\ndGooAgAhAyAAKAIEIgEtAFRFBEAgASgCRCADQQJ0aigCACEDCyAEQgA3AzAgBEIANwMoIARCADcD\nICABIAMgASwAGCAEQSBqEBsgACgCECgCHCAGQQJ0aigCACIBIAAoAhQiAygCBCADKAIAIgNrQQJ1\nTw0EIAAoAgggAyABQQJ0aigCAEECdGooAgAhAyAAKAIEIgEtAFRFBEAgASgCRCADQQJ0aigCACED\nCyAEQgA3AxggBEIANwMQIARCADcDCCABIAMgASwAGCAEQQhqEBsgCSAEKQMIIAQpAzgiCX0iCCAE\nKQMoIAQpA0AiCn0iC359IAQpAxAgCn0iCiAEKQMgIAl9Ig5+fCEJIAwgCCAEKQMwIAQpA0giD30i\nEH58IAQpAxggD30iCCAOfn0hDCANIAogEH59IAggC358IQ0gBCgCWCEBIAQoAlAhAwJAIAQtAFwE\nQAJAAkACQAJAIAFBf0YNACABQQFqIgYgAUECayAGQQNwGyIBQX9GDQAgAygCACABQQN2Qfz///8B\ncWooAgAgAXZBAXENACADKAJAKAIMIAFBAnRqKAIAIgFBf0cNAQsgBEF/NgJYDAELIAQgAUEBaiIG\nIAFBAmsgBkEDcBsiATYCWCABQX9HDQELAn9BfyAEKAJUIgFBf0YNABoCQCABQQNwBEAgAUEBayEB\nDAELQX8gAUECaiIBQX9GDQEaC0F/IAMoAgAgAUEDdkH8////AXFqKAIAIAF2QQFxDQAaQX8gAygC\nQCgCDCABQQJ0aigCACIBQX9GDQAaIAFBAWsgAUEDcA0AGiABQQJqCyEBIARBADoAXCAEIAE2AlgM\nAgsgASAEKAJURw0BIARBfzYCWAwBCyAEAn9BfyABQX9GDQAaAkAgAUEDcARAIAFBAWshAQwBC0F/\nIAFBAmoiAUF/Rg0BGgtBfyADKAIAIAFBA3ZB/P///wFxaigCACABdkEBcQ0AGkF/IAMoAkAoAgwg\nAUECdGooAgAiAUF/Rg0AGiABQQFrIAFBA3ANABogAUECags2AlgLIAQoAlgiAUF/Rw0ACwsgDSAN\nQj+HIgiFIAh9IQhC////////////ACEKIAwgDEI/hyILhSALfSILQv///////////wCFIQ4CQCAJ\nAn4gACgCHEUEQCAIIA5WDQJCgICAgHAgCCALfCIIIAkgCUI/hyIKhSAKfSIKfEIghiAIIApC////\n////////AIVWGyIIQoGAgICAgICAIFMNAiAIQj2IDAELAkAgCCAOVg0AIAggC3wiCCAJIAlCP4ci\nC4UgC30iC0L///////////8AhVYNACAIIAt8IgpCgYCAgAJUDQILIApCHYgLIgh/IQkgDCAIfyEM\nIA0gCH8hDQsgAiAJPgIIIAIgDD4CBCACIA0+AgAgBEHgAGokAA8LEA4ACxAOAAsQDgALBABBBgsl\nAQF/IABBkBc2AgAgACgCICIBBEAgACABNgIkIAEQBQsgABAFC/MCAQd/IAEgACgCCCIEIAAoAgQi\nAmtBAnVNBEAgACABBH8gAkEAIAFBAnQiABAIIABqBSACCzYCBA8LAkACQAJAIAIgACgCACIGa0EC\ndSIFIAFqIgNBgICAgARJBEBB/////wMgBCAGayIEQQF1IgcgAyADIAdJGyAEQfz///8HTxsiAwRA\nIANBgICAgARPDQIgA0ECdBAGIQgLIAggBUECdGoiBEEAIAFBAnQiARAIIgcgAWohBSAIIANBAnRq\nIQEgAiAGRg0CA0AgAkEEayICKAIAIQMgAkEANgIAIARBBGsiBCADNgIAIAIgBkcNAAsgACABNgII\nIAAoAgQhASAAIAU2AgQgACgCACECIAAgBDYCACABIAJGDQMDQCABQQRrIgEoAgAhACABQQA2AgAg\nAARAIAAgACgCACgCBBECAAsgASACRw0ACwwDCxAJAAsQCwALIAAgATYCCCAAIAU2AgQgACAHNgIA\nCyACBEAgAhAFCwsMACAAEIEBGiAAEAULjAEBAn8gAQJ/IAAtAAtBB3YEQCAAKAIEDAELIAAtAAsL\nIgJLBEAgACABIAJrEP0BDwsCfyAALQALQQd2BEAgACgCAAwBCyAACyEDIwBBEGsiAiQAAkAgAC0A\nC0EHdgRAIAAgATYCBAwBCyAAIAE6AAsLIAJBADoADyABIANqIAItAA86AAAgAkEQaiQACz0AAn8g\n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\nIgUgCEEEakcEQAJAIAUoAgQiAkUEQCAFIQIDQCACKAIIIgMoAgAgAkchBCADIQIgBA0ACwwBCwNA\nIAIiAygCACICDQALCyAFIAgoAgBGBEAgCCADNgIACyAIIAgoAghBAWs2AgggCCgCBCEEAn8CQCAF\nIgciAygCACIFBEAgBygCBCICRQ0BA0AgAiIDKAIAIgINAAsLIAMoAgQiBQ0AQQAhBUEBDAELIAUg\nAygCCDYCCEEACyEPAkAgAyADKAIIIgooAgAiAkYEQCAKIAU2AgAgAyAERgRAQQAhAiAFIQQMAgsg\nCigCBCECDAELIAogBTYCBAsgAy0ADCERIAMgB0cEQCADIAcoAggiCjYCCCAKIAcoAggoAgAgB0dB\nAnRqIAM2AgAgAyAHKAIAIgo2AgAgCiADNgIIIAMgBygCBCIKNgIEIAoEQCAKIAM2AggLIAMgBy0A\nDDoADCADIAQgBCAHRhshBAsCQCARRQ0AIARFDQAgDwRAA0AgAi0ADCEFAkAgAiACKAIIIgMoAgBH\nBEAgBUUEQCACQQE6AAwgA0EAOgAMIAMgAygCBCIFKAIAIgo2AgQgCgRAIAogAzYCCAsgBSADKAII\nNgIIIAMoAggiCiAKKAIAIANHQQJ0aiAFNgIAIAUgAzYCACADIAU2AgggAiAEIAQgAigCACICRhsh\nBCACKAIEIQILAkACQAJAAkAgAigCACIDBEAgAy0ADEUNAQsgAigCBCIFBEAgBS0ADEUNAgsgAkEA\nOgAMAkAgBCACKAIIIgJGBEAgBCECDAELIAItAAwNBgsgAkEBOgAMDAgLIAIoAgQiBUUNAQsgBS0A\nDA0AIAIhAwwBCyADQQE6AAwgAkEAOgAMIAIgAygCBCIENgIAIAQEQCAEIAI2AggLIAMgAigCCDYC\nCCACKAIIIgQgBCgCACACR0ECdGogAzYCACADIAI2AgQgAiADNgIIIAIhBQsgAyADKAIIIgItAAw6\nAAwgAkEBOgAMIAVBAToADCACIAIoAgQiAygCACIENgIEIAQEQCAEIAI2AggLIAMgAigCCDYCCCAC\nKAIIIgQgBCgCACACR0ECdGogAzYCACADIAI2AgAgAiADNgIIDAQLIAVFBEAgAkEBOgAMIANBADoA\nDCADIAIoAgQiBTYCACAFBEAgBSADNgIICyACIAMoAgg2AgggAygCCCIFIAUoAgAgA0dBAnRqIAI2\nAgAgAiADNgIEIAMgAjYCCCACIAQgAyAERhshBCADKAIAIQILAkACQCACKAIAIgVFDQAgBS0ADA0A\nIAIhAwwBCwJAIAIoAgQiAwRAIAMtAAxFDQELIAJBADoADCACKAIIIgItAAxBACACIARHGw0CIAJB\nAToADAwFCyAFBEAgBS0ADEUEQCACIQMMAgsgAigCBCEDCyADQQE6AAwgAkEAOgAMIAIgAygCACIE\nNgIEIAQEQCAEIAI2AggLIAMgAigCCDYCCCACKAIIIgQgBCgCACACR0ECdGogAzYCACADIAI2AgAg\nAiADNgIIIAIhBQsgAyADKAIIIgItAAw6AAwgAkEBOgAMIAVBAToADCACIAIoAgAiAygCBCIENgIA\nIAQEQCAEIAI2AggLIAMgAigCCDYCCCACKAIIIgQgBCgCACACR0ECdGogAzYCACADIAI2AgQgAiAD\nNgIIDAMLIAIoAggiAyADKAIAIAJGQQJ0aigCACECDAALAAsgBUEBOgAMCyAHKAIcIgIEQCAHIAI2\nAiAgAhAFCyAHLAAbQQBIBEAgBygCEBAFCyAHEAULIAlBADYCCCAJQgA3AwAgBigCBCICIAYoAgAi\nA2shBEEAIQUCQAJAIAIgA0cEQCAEQQBIDQEgCSAEEAYiBUEAIAQQCCICIARqIgc2AgggCSAHNgIE\nIAkgAjYCACADIQILIAUgAiAEEAcaAkAgBiwAG0EATgRAIAkgBigCGDYCGCAJIAYpAhA3AxAMAQsg\nCUEQaiAGKAIQIAYoAhQQDAsgCUEcaiAJEJIBIAlBEGoiBCECIAkCfwJAAkAgCCgCBCIDRQRAIAhB\nBGoiBSECDAELIAIoAgAgAiACLQALIgVBGHRBGHVBAEgiBxshCiACKAIEIAUgBxshBwNAAkACQAJA\nAkACQCADIgIoAhQgAi0AGyIDIANBGHRBGHVBAEgiDxsiAyAHIAMgB0kiERsiBQRAIAogAigCECAC\nQRBqIA8bIg8gBRANIhVFBEAgAyAHSw0CDAMLIBVBAE4NAgwBCyADIAdNDQILIAIhBSACKAIAIgMN\nBAwFCyAPIAogBRANIgMNAQsgEQ0BDAQLIANBAE4NAwsgAigCBCIDDQALIAJBBGohBQtBKBAGIgMg\nBCgCCDYCGCADIAQpAgA3AhAgBEIANwIAIARBADYCCCADQRxqIARBDGoQkgEgAyACNgIIIANCADcC\nACAFIAM2AgAgAyECIAgoAgAoAgAiBARAIAggBDYCACAFKAIAIQILIAgoAgQgAhA+IAggCCgCCEEB\najYCCEEBDAELIAIhA0EACzoALCAJIAM2AiggCSgCHCICBEAgCSACNgIgIAIQBQsgCSwAG0EASARA\nIAkoAhAQBQsgCSgCACICBEAgCSACNgIEIAIQBQsgCUEwaiQADAELEAkACyAGKAIAIgINAEEBIQIM\nAQsgBiACNgIEIAIQBSAXIBlZIQILIAYsABtBAEgEQCAGKAIQEAULIAZBIGokACACDAELEAkAC0UN\nBiAOQQFqIg4gEEcNAAsLIAtBADYCDEEBIAtBDGogACgCABA2RQ0DIAsoAgwiDa0gACgCACICKQMI\nIAIpAxB9VQ0DIA0EQEEAIQ4gFCATQQBHaiEFA0ACQCABIBJJBEAgASAFNgIIIAFBADYCBCABIAg2\nAgAgAUEMaiEBIAsoAgwhDQwBCyABIAxrIgNBDG0iAkEBaiIBQdaq1aoBTw0EQdWq1aoBIBIgDGtB\nDG0iBEEBdCIHIAEgASAHSRsgBEGq1arVAE8bIgQEfyAEQdaq1aoBTw0GIARBDGwQBgVBAAsiByAC\nQQxsaiIBIAU2AgggAUEANgIEIAEgCDYCACABIANBdG1BDGxqIQIgA0EASgRAIAIgDCADEAcaCyAE\nQQxsIAdqIRIgAUEMaiEBIAwEQCAMEAULIAIhDAsgDkEBaiIOIA1JDQALCyABIAxHDQALQQEhDQwD\nCxAJAAsQCwALQQAhDQsgDARAIAwQBQsgC0EgaiQAIA0L2wIBBH9BfyEDQX8hBEF/IQICfwJAIAFB\nf0YNACAAKAIEKAIMIAFBAnRqKAIAIQRBfyEFIAFBAWoiAiABQQJrIAJBA3AbIgJBAE4EQCAAKAIA\nKAJgIAJBA24iBUEMbGogAiAFQQNsa0ECdGooAgAhBQsCQCAEQX9GDQBBf0ECIARBA3AbIARqIgJB\nAEgNACAAKAIAKAJgIAJBA24iA0EMbGogAiADQQNsa0ECdGooAgAhAwtBfyADIAVHDQEaQX8hAgJA\nQX9BAiABQQNwGyABaiIBQQBOBEAgACgCACgCYCABQQNuIgNBDGxqIAEgA0EDbGtBAnRqKAIAIQMg\nBEF/Rg0CDAELQX8hAyAEQX9HDQAMAQsgBEEBaiIBIARBAmsgAUEDcBsiAUEASA0AIAAoAgAoAmAg\nAUEDbiIAQQxsaiABIABBA2xrQQJ0aigCACECC0F/IAQgAiADRxsLC+4DAQZ/IAAoAgAiBiABQQN2\nQfz///8BcWoiAiACKAIAQQEgAXRyNgIAIAAoAkAhBQJ/QX8gAUF/RiIEDQAaQX8gAUEBaiIDIAFB\nAmsgA0EDcBsiA0F/Rg0AGiAFKAIAIANBAnRqKAIACyECIAAoAgwiAyACQQN2Qfz///8BcWoiByAH\nKAIAQQEgAnRyNgIAAkACfyAERQRAIAMCfwJAIAFBA3AEQCABQQFrIQQMAQtBfyABQQJqIgRBf0YN\nARoLIAUoAgAgBEECdGooAgALIgJBA3ZB/P///wFxaiIEIAQoAgBBASACdHI2AgBBfyECIAUoAgwg\nAUECdGooAgAiAUF/Rg0CIABBADoAGCAGIAFBA3ZB/P///wFxaiIAIAAoAgBBASABdHI2AgAgAUEB\naiIAIAFBAmsgAEEDcBsiAEF/RwRAIAUoAgAgAEECdGooAgAhAgsgAyACQQN2Qfz///8BcWoiACAA\nKAIAQQEgAnRyNgIAQQECfwJAIAFBA3AEQCABQQFrIQEMAQtBfyABQQJqIgFBf0YNARoLIAUoAgAg\nAUECdGooAgALIgB0IQEgAyAAQQN2Qfz///8BcWoiACgCAAwBCyADQfz///8BaiEAIAMoAvz///8B\nIQFBgICAgHgLIQIgACABIAJyNgIACwvBCwEKfyAAIAAoAjQ2AjggACAAKAIoNgIsIAAoAkAiAygC\nHCADKAIYIgJGBEBBAQ8LAkACQAJAA0AgASEEAkAgAiAJQQJ0aigCACICQX9GDQACQCAAKAI4IgEg\nACgCPEcEQCABIAQ2AgAgACABQQRqNgI4DAELIAEgACgCNCIHayIBQQJ1IgZBAWoiA0GAgICABE8N\nA0H/////AyABQQF1IgUgAyADIAVJGyABQfz///8HTxsiAwR/IANBgICAgARPDQUgA0ECdBAGBUEA\nCyIFIAZBAnRqIgYgBDYCACABQQBKBEAgBSAHIAEQBxoLIAAgBSADQQJ0ajYCPCAAIAZBBGo2Ajgg\nACAFNgI0IAdFDQAgBxAFCwJAAkAgACgCDCAJQQN2Qfz///8BcWooAgAgCXZBAXFFDQAgAkEBaiIB\nIAJBAmsgAUEDcBsiAUF/Rg0AIAAoAgAgAUEDdkH8////AXFqKAIAIAF2QQFxDQAgACgCQCgCDCAB\nQQJ0aigCACIBQX9GDQAgAUEBaiIHIAFBAmsgB0EDcBsiA0F/Rg0AIAAoAkAhBSAAKAIAIQYDQCAD\nIQdBfyEDAkAgB0EBaiIBIAdBAmsgAUEDcBsiAUF/Rg0AIAYgAUEDdkH8////AXFqKAIAIAF2QQFx\nDQAgBSgCDCABQQJ0aigCACIBQX9GDQAgAUEBaiIDIAFBAmsgA0EDcBshAwsgAiADRwRAIANBf0YN\nAwwBCwtBAA8LIAIhBwsgACgCHCAHQQJ0aiAENgIAAkAgACgCLCIBIAAoAjBHBEAgASAHNgIAIAAg\nAUEEajYCLAwBCyABIAAoAigiA2siAUECdSIGQQFqIgJBgICAgARPDQVB/////wMgAUEBdSIFIAIg\nAiAFSRsgAUH8////B08bIgIEfyACQYCAgIAETw0FIAJBAnQQBgVBAAsiBSAGQQJ0aiIGIAc2AgAg\nAUEASgRAIAUgAyABEAcaCyAAIAUgAkECdGo2AjAgACAGQQRqNgIsIAAgBTYCKCADRQ0AIAMQBQsg\nBEEBaiEBIAAoAkAhAwJAIAdBA3AEQCAHQQFrIQIMAQsgB0ECaiICQX9GDQELIAMoAgwgAkECdGoo\nAgAiAkF/Rg0AIAJBf0ECIAJBA3AbaiICQX9GDQAgAiAHRg0AA0AgACgCACACQQFqIgMgAkECayAD\nQQNwGyIDQQN2Qfz///8BcWooAgAgA3ZBAXEEQAJAIAAoAjgiBCAAKAI8RwRAIAQgATYCACAAIARB\nBGo2AjgMAQsgBCAAKAI0IgNrIgRBAnUiCEEBaiIFQYCAgIAETw0FQf////8DIARBAXUiBiAFIAUg\nBkkbIARB/P///wdPGyIFBH8gBUGAgICABE8NByAFQQJ0EAYFQQALIgYgCEECdGoiCCABNgIAIARB\nAEoEQCAGIAMgBBAHGgsgACAGIAVBAnRqNgI8IAAgCEEEajYCOCAAIAY2AjQgA0UNACADEAULIAFB\nAWohAwJAIAAoAiwiBCAAKAIwRwRAIAQgAjYCACAAIARBBGo2AiwMAQsgBCAAKAIoIgVrIgRBAnUi\nCkEBaiIGQYCAgIAETw0HQf////8DIARBAXUiCCAGIAYgCEkbIARB/P///wdPGyIGBH8gBkGAgICA\nBE8NByAGQQJ0EAYFQQALIgggCkECdGoiCiACNgIAIARBAEoEQCAIIAUgBBAHGgsgACAIIAZBAnRq\nNgIwIAAgCkEEajYCLCAAIAg2AiggBUUNACAFEAULIAEhBCADIQELIAAoAhwgAkECdGogBDYCACAA\nKAJAIQMCQCACQQNwBEAgAkEBayECDAELIAJBAmoiAkF/Rg0CCyADKAIMIAJBAnRqKAIAIgJBf0YN\nASACQX9BAiACQQNwG2oiAkF/Rg0BIAIgB0cNAAsLIAlBAWoiCSADKAIcIAMoAhgiAmtBAnVJDQAL\nQQEPCxAJAAsQCwALEAkAC9YDAQZ/IwBBEGsiBiQAAkACQCABBEAgAEIANwJYIAAoAlQhAiAAQQA2\nAlQgAgRAIAIQBQsgAEIANwJMIAAoAkghAiAAQQA2AkggAgRAIAIQBQsgASgCACECIAEoAgQhAyAG\nQQA6AA8gACADIAJrQQJ1IAZBD2oQGiABKAIcIQIgASgCGCEDIAZBADoADiAAQQxqIAIgA2tBAnUg\nBkEOahAaIABBHGogASgCBCABKAIAa0ECdUGs0AAQXwJAIAEoAhwgASgCGGsiA0ECdSIEIAAoAjwg\nACgCNCICa0ECdU0NACADQQBIDQIgACgCOCEFIAMQBiIDIARBAnRqIQcgAyAFIAJrIgRqIQUgBEEA\nSgRAIAMgAiAEEAcaCyAAIAc2AjwgACAFNgI4IAAgAzYCNCACRQ0AIAIQBQsCQCABKAIcIAEoAhhr\nIgNBAnUiBCAAKAIwIAAoAigiAmtBAnVNDQAgA0EASA0DIAAoAiwhBSADEAYiAyAEQQJ0aiEHIAMg\nBSACayIEaiEFIARBAEoEQCADIAIgBBAHGgsgACAHNgIwIAAgBTYCLCAAIAM2AiggAkUNACACEAUL\nIABBAToAGCAAIAE2AkALIAZBEGokAA8LEAkACxAJAAuCAgEEfwJAIAEgAnJBAE4EfwJAIAFB1arV\nqgVLDQAgACABQQNsIgNB8M8AEF8gAEEMaiADQfTPABBfAkAgACgCICAAKAIYIgNrQQJ1IAJPDQAg\nAkGAgICABE8NAyAAKAIcIQQgAkECdCIFEAYiAiAFaiEFIAIgBCADayIEaiEGIARBAEoEQCACIAMg\nBBAHGgsgACAFNgIgIAAgBjYCHCAAIAI2AhggA0UNACADEAULIABCADcCUCAAKAJMIQIgAEEANgJM\nIAIEQCACEAULIABCADcCRCAAQUBrIgIoAgAhACACQQA2AgAgAEUNACAAEAULIAFB1qrVqgVJBUEA\nCw8LEAkAC+kEAgt/A34jAEHQAGsiAyQAAkBBASADQcwAaiABEF5FDQAgAygCTCIGRQ0AIAatIAEp\nAwggASkDEH1CBX5VDQACQCAAKAIIIAAoAgQiBGtBAnUiAiAGSQRAIABBBGogBiACaxAKDAELIAIg\nBk0NACAAIAQgBkECdGo2AggLIABBEGohDCAAKAIgIQRBASEJA0ACQCABKQMIIg8gASkDECIOVw0A\nIAEoAgAiAiAOp2otAAAhBSABIA5CAXwiDTcDECANIA9ZDQAgAiANp2otAAAhCyABIA5CAnwiDTcD\nECANIA9ZDQAgAiANp2otAAAhCCABIA5CA3wiDTcDECANIA9ZDQAgAiANp2otAAAhAiABIA5CBHw3\nAxAgBUEESw0AIAtBDGtB/wFxQfUBSQ0AIAhFDQAgA0EIahA7IgogBSAIIAsgAkEARyALQQFrIgJB\nCk0EfyACQQJ0QaTPAGooAgAFQX8LIAhsrBBlQQEgA0EEaiABEF5FDQAgAyADKAIEIgU2AkRB4AAQ\nBiAKEGQhAiAEIAQoAgwgBCgCCGtBAnUgAiAEKAIAKAIIEQcAIAQoAgwgBCgCCGtBAnVBAWsiCEEC\ndCICIAQoAghqKAIAIAU2AjwgACgCBCAHQQJ0aiAINgIAAkAgCCAAKAIUIAAoAhAiCWtBAnUiCkgN\nACADQX82AgAgCiAIQQFqIgVJBEAgDCAFIAprIAMQECAMKAIAIQkMAQsgBSAKTw0AIAAgCSAFQQJ0\najYCFAsgAiAJaiAHNgIAIAdBAWoiByAGSSEJIAYgB0cNAQsLIAlFIQcLIANB0ABqJAAgB0EBcQsE\nAEEECwQAQQMLlwUBDH8jAEEQayIKJAAgASgCUCIBIAItABgiBGwhAAJAAkACQAJAAkAgAigCHCIH\nQQVHIAdBBkdxDQAgAi0AVEUNACACKAIwIQEgAigCACgCACECIApBADYCCCAKQgA3AwAgAARAIABB\nAEgNAiAAQQJ0IgAQBiIFIAEgAmogABAHIABqIQYLIAMoAgAiAARAIAMgADYCBCAAEAULIAMgBjYC\nCCADIAY2AgQgAyAFNgIAQQEhAAwECyAEBEAgBEECdCIHEAYiBUEAIAcQCBoLAkAgAygCBCADKAIA\nIglrQQJ1IgcgAEkEQCADIAAgB2sQCgwBCyAAIAdPDQAgAyAJIABBAnRqNgIECyABRQ0BIARFBEBB\nACEAQQEhCANAIAIgAi0AVAR/IAAFIAIoAkQgAEECdGooAgALIAIsABggBRBIRQ0DIABBAWoiACAB\nSSEIIAAgAUcNAAsMAgsgBEH8AXEhDiAEQQNxIQsgBEEESSEPQQEhCEEAIQQDQCACIAItAFQEfyAE\nBSACKAJEIARBAnRqKAIACyACLAAYIAUQSEUNAiADKAIAIQxBACENQQAhAEEAIQggD0UEQANAIAwg\nBkECdGoiByAFIABBAnQiCWooAgA2AgAgByAFIAlBBHJqKAIANgIEIAcgBSAJQQhyaigCADYCCCAH\nIAUgCUEMcmooAgA2AgwgAEEEaiEAIAZBBGohBiAIQQRqIgggDkcNAAsLIAsEQANAIAwgBkECdGog\nBSAAQQJ0aigCADYCACAAQQFqIQAgBkEBaiEGIA1BAWoiDSALRw0ACwsgBEEBaiIEIAFJIQggASAE\nRw0ACyABIARNIQAMAgsQCQALIAhFIQAgBUUNAQsgBRAFCyAKQRBqJAAgAEEBcQsQACAAKAIAIAFB\nAnRqKAIACxAAIAAoAgQgACgCAGtBAXULDQAgACgCBCAAKAIAawsQACAAKAIMIAAoAghrQQJ1CxEA\nIAAgASAAKAIAKAIMEQEAC20BAn9BKBAGIgJBfzYCACACQQhqIgNCADcDECADQQA2AgggA0IANwMA\nIANCADcDGCAAIAIgACgCACgCEBEEACABKAJYIQAgASACNgJYIAAEQCAAKAIIIgEEQCAAIAE2Agwg\nARAFCyAAEAULQQELBwAgACgCAAvlAQEGfyABIAAoAggiBCAAKAIEIgJrQQF1TQRAIAAgAQR/IAJB\nACABQQF0IgAQCCAAagUgAgs2AgQPCwJAIAIgACgCACIFayIGQQF1IgcgAWoiA0EATgRAQQAhAkH/\n////ByAEIAVrIgQgAyADIARJGyAEQf7///8HTxsiAwRAIANBAEgNAiADQQF0EAYhAgsgAiAHQQF0\nakEAIAFBAXQiARAIIAFqIQEgBkEASgRAIAIgBSAGEAcaCyAAIAIgA0EBdGo2AgggACABNgIEIAAg\nAjYCACAFBEAgBRAFCw8LEAkACxALAAt4AgF+An8CQCAAQQpLDQAgAikDECIDIAIpAwhZDQAgAigC\nACADp2osAAAhBSACIANCAXw3AxAgBa0hAyABAn4gBUEASARAIABBAWogASACEKYBRQ0CIANC/wCD\nIAEpAwBCB4aEDAELIANC/wGDCzcDAEEBIQQLIAQL5AMBBn8CfwJAAkAgAUUEQEEAIAJCAFMNAxog\nACgCBCIDIAAoAgAiBGsiBiACpyIBSQRAIAEgBmsiBSAAKAIIIgcgA2tNBEAgACADQQAgBRAIIAVq\nNgIEDAMLIAFBAEgNA0H/////ByAHIARrIgNBAXQiByABIAEgB0kbIANB/////wNPGyIHEAYiAyAG\nakEAIAUQCBogBkEASgRAIAMgBCAGEAcaCyAAIAMgB2o2AgggACABIANqNgIEIAAgAzYCACAERQ0C\nIAQQBQwCCyABIAZPDQEgACABIARqNgIEDAELQQAgAkIAUw0CGgJAIAAoAgQiBSAAKAIAIgNrIgat\nIAJZDQAgAqciBCAGSwRAIAQgBmsiByAAKAIIIgggBWtNBEAgACAFQQAgBxAIIAdqNgIEDAILIARB\nAEgNA0H/////ByAIIANrIgVBAXQiCCAEIAQgCEkbIAVB/////wNPGyIIEAYiBSAGakEAIAcQCBog\nBkEASgRAIAUgAyAGEAcaCyAAIAUgCGo2AgggACAEIAVqNgIEIAAgBTYCACADRQ0BIAMQBQwBCyAE\nIAZPDQAgACADIARqNgIECyACpyIERQ0AIAAoAgAgASAEECUaCyAAIAApAxhCAXw3AxhBAQwBCxAJ\nAAsLsgsBCX8gAUF/RgRAQQEPCyAAKAIYIAFBA24iAkEDdkH8////AHFqKAIAIAJ2QQFxRQRAIAAg\nACgCMCIDNgI0AkAgACgCOCADRwRAIAMgATYCACAAIANBBGo2AjQMAQtBBBAGIgQgATYCACAAIARB\nBGoiBTYCOCAAIAU2AjQgACAENgIwIANFDQAgAxAFCyAAKAIEKAIcIgQgAUEBaiIDIAFBAmsgA0ED\ncBsiBUECdGooAgAiA0F/RgRAQQAPCyAEQX9BAiABIAJBA2xrGyABaiICQQJ0aigCACIBQX9GBEBB\nAA8LIAAoAiQiBCADQQN2Qfz///8BcWoiBigCACIHQQEgA3QiCHEEfyAEBSAGIAcgCHI2AgAgAEEI\naiADIAUQHyAAKAIkCyABQQN2Qfz///8BcWoiAygCACIEQQEgAXQiBXFFBEAgAyAEIAVyNgIAIABB\nCGogASACEB8LIAAoAjQiAiAAKAIwRgRAQQEPCyAAQQhqIQkDQAJAAkAgAkEEayICKAIAIgFBf0YN\nACAAKAIYIAFBA24iA0EDdkH8////AHFqIgQoAgAiBUEBIAN0IgNxDQAgBCADIAVyNgIAIAAoAgQi\nBCgCHCABQQJ0aigCACIDQX9GBEBBAA8LA0AgASECAkACQCAAKAIkIANBA3ZB/P///wFxaiIFKAIA\nIgZBASADdCIHcQ0AAkACQCAEKAIoIANBAnRqKAIAIgFBf0YNACABQQFqIgggAUECayAIQQNwGyIB\nQX9GDQAgBCgCACABQQN2Qfz///8BcWooAgAgAXZBAXENACAEKAJAKAIMIAFBAnRqKAIAIgFBf0cN\nAQsgBSAGIAdyNgIAIAkgAyACEB8MAQsgBSAGIAdyNgIAIAkgAyACEB8gAUEBaiIDIAFBAmsgA0ED\ncBtBf0YNAEF/IQEgACgCBCEEAkAgAkF/Rg0AIAJBAWoiAyACQQJrIANBA3AbIgNBf0YNACAEKAIA\nIANBA3ZB/P///wFxaigCACADdkEBcQ0AIAQoAkAoAgwgA0ECdGooAgAhAQtBASABQQNuIgN0IQYg\nACgCGCICIANBBXYiB0ECdGooAgAhCAwBCwJAAkAgAkF/Rg0AIAAoAgQhBEF/IQMCQCACQQFqIgEg\nAkECayABQQNwGyIBQX9GDQAgBCgCACABQQN2Qfz///8BcWooAgAgAXZBAXENACAEKAJAKAIMIAFB\nAnRqKAIAIQMLQX8CfwJAIAJBA3AEQCACQQFrIQIMAQtBfyACQQJqIgJBf0YNARoLQX8gBCgCACAC\nQQN2Qfz///8BcWooAgAgAnZBAXENABogBCgCQCgCDCACQQJ0aigCAAsiAUEDbiABQX9GIgobIQUg\nA0F/RwRAIAAoAhgiAiADQQNuIgZBBXYiB0ECdGooAgAiCEEBIAZ0IgZxRQ0CCyAKDQAgACgCGCIC\nIAVBBXYiB0ECdGooAgAiCEEBIAV0IgZxRQ0CCyAAIAAoAjRBBGsiAjYCNAwECyAKBEAgAyEBDAEL\nIAIgBUEDdkH8////AXFqKAIAIAV2QQFxBEAgAyEBDAELIAAoAjQiAkEEayABNgIAIAAoAjggAkcE\nQCACIAM2AgAgAkEEaiECDAMLAkAgAiAAKAIwIgRrIgFBAnUiB0EBaiICQYCAgIAESQRAQf////8D\nIAFBAXUiBSACIAIgBUkbIAFB/P///wdPGyIFBH8gBUGAgICABE8NAiAFQQJ0EAYFQQALIgYgB0EC\ndGoiAiADNgIAIAJBBGohAiABQQBKBEAgBiAEIAEQBxoLIAAgBiAFQQJ0ajYCOCAAIAI2AjQgACAG\nNgIwIARFDQUgBBAFIAAoAjQhAgwFCxAJAAsQCwALIAIgB0ECdGogBiAIcjYCACAEKAIcIAFBAnRq\nKAIAIgNBf0cNAAtBAA8LIAAgAjYCNAsgACgCMCACRw0ACwtBAQu/CgEIfyABQX9GBEBBAQ8LIAAo\nAhggAUEDbiIFQQN2Qfz///8AcWooAgAgBXZBAXFFBEAgACAAKAIwIgI2AjQCQCAAKAI4IAJHBEAg\nAiABNgIAIAAgAkEEajYCNAwBC0EEEAYiAyABNgIAIAAgA0EEaiIENgI4IAAgBDYCNCAAIAM2AjAg\nAkUNACACEAULQX8hAyAAKAIEIQQgAUEBaiICIAFBAmsgAkEDcBsiBkF/RwRAIAQoAgAgBkECdGoo\nAgAhAwsCQCABIAVBA2xrIgUEQCABQQFrIQIMAQsgAUECaiICQX9HDQBBAA8LIANBf0YEQEEADwsg\nBCgCACACQQJ0aigCACICQX9GBEBBAA8LIAAoAiQiBCADQQN2Qfz///8BcWoiBygCACIJQQEgA3Qi\nCHEEfyAEBSAHIAggCXI2AgAgAEEIaiADIAYQHyAAKAIkCyACQQN2Qfz///8BcWoiAygCACIEQQEg\nAnQiBnFFBEAgAyAEIAZyNgIAIABBCGogAkF/QQIgBRsgAWoQHwsgACgCNCICIAAoAjBGBEBBAQ8L\nIABBCGohCQNAAkACQCACQQRrIgIoAgAiAUF/Rg0AIAAoAhggAUEDbiIDQQN2Qfz///8AcWoiBSgC\nACIEQQEgA3QiA3ENACAFIAMgBHI2AgADQCAAKAIEIgMoAgAgAUECdGooAgAiAkF/RgRAQQAPCwJA\nAkAgACgCJCACQQN2Qfz///8BcWoiBSgCACIEQQEgAnQiBnENAAJAAkAgAygCGCACQQJ0aigCACIH\nQX9GDQAgB0EBaiIIIAdBAmsgCEEDcBsiB0F/Rg0AIAMoAgwgB0ECdGooAgAiA0F/Rw0BCyAFIAQg\nBnI2AgAgCSACIAEQHwwBCyAFIAQgBnI2AgAgCSACIAEQHyADQQFqIgIgA0ECayACQQNwG0F/Rg0A\nIAFBAmshAyABQQFqIQJBfyEBIAIgAyACQQNwGyICQX9HBEAgACgCBCgCDCACQQJ0aigCACEBC0EB\nIAFBA24iAnQhBCAAKAIYIgMgAkEFdiIGQQJ0aigCACEHDAELQX8hAiAAKAIEIQUgAUEBaiIDIAFB\nAmsgA0EDcBsiA0F/RwRAIAUoAgwgA0ECdGooAgAhAgtBfwJ/AkAgAUEDcARAIAFBAWshAwwBC0F/\nIAFBAmoiA0F/Rg0BGgsgBSgCDCADQQJ0aigCAAsiAUEDbiABQX9GIggbIQUCQCACQX9HBEAgACgC\nGCIDIAJBA24iBEEFdiIGQQJ0aigCACIHQQEgBHQiBHFFDQELIAhFBEAgACgCGCIDIAVBBXYiBkEC\ndGooAgAiB0EBIAV0IgRxRQ0CCyAAIAAoAjRBBGsiAjYCNAwECyAIBEAgAiEBDAELIAMgBUEDdkH8\n////AXFqKAIAIAV2QQFxBEAgAiEBDAELIAAoAjQiA0EEayABNgIAIAAoAjggA0cEQCADIAI2AgAg\nA0EEaiECDAMLAkAgAyAAKAIwIgNrIgFBAnUiBkEBaiIFQYCAgIAESQRAQf////8DIAFBAXUiBCAF\nIAQgBUsbIAFB/P///wdPGyIFBH8gBUGAgICABE8NAiAFQQJ0EAYFQQALIgQgBkECdGoiBiACNgIA\nIAZBBGohAiABQQBKBEAgBCADIAEQBxoLIAAgBCAFQQJ0ajYCOCAAIAI2AjQgACAENgIwIANFDQUg\nAxAFIAAoAjQhAgwFCxAJAAsQCwALIAMgBkECdGogBCAHcjYCACABQX9HDQALQQAPCyAAIAI2AjQL\nIAAoAjAgAkcNAAsLQQELggICA38CfgJAIAAoAgwiBCAAKAIIIgNrQQJ1IgUgAS0AGCIBSQRAIABB\nCGogASAFaxAKIAAoAgghAyAAKAIMIQQMAQsgASAFTw0AIAAgAyABQQJ0aiIENgIMC0EAIQECQCAC\nKQMIIAIpAxAiBiAEIANrIgStIgd8Uw0AIAMgAigCACAGp2ogBBAHGiACIAIpAxAgB3wiBjcDECAC\nKQMIIAZCBHxTDQAgACACKAIAIAanaigAADYCFCACIAIpAxAiB0IEfCIGNwMQIAIpAwggBlcNACAC\nKAIAIAanai0AACEDIAIgB0IFfDcDECADQQFrQR1LDQAgACADNgIEQQEhAQsgAQuMEgEJfwJAAkAC\nQAJAAkAgACgCXCAAKAJYRg0AAkAgACgCNCIEIAAoAjhHBEAgBCABNgIAIAAgBEEEajYCNAwBCyAE\nIAAoAjAiAmsiBEECdSIFQQFqIgNBgICAgARPDQVB/////wMgBEEBdSIGIAMgAyAGSRsgBEH8////\nB08bIgMEfyADQYCAgIAETw0DIANBAnQQBgVBAAsiBiAFQQJ0aiIFIAE2AgAgBEEASgRAIAYgAiAE\nEAcaCyAAIAYgA0ECdGo2AjggACAFQQRqNgI0IAAgBjYCMCACRQ0AIAIQBQsgAEEANgJUQX8hBAJ/\nQX8gAUF/Rg0AGiAAKAIEIQIgAUEBaiIDIAFBAmsgA0EDcBsiA0F/RwRAIAIoAgAgA0ECdGooAgAh\nBAsCQCABQQNwBEAgAUEBayEDDAELQX8gAUECaiIDQX9GDQEaCyACKAIAIANBAnRqKAIACyICQQN2\nQfz///8BcSAAKAIkIgMgBEEDdkH8////AXFqIgYoAgAiBUEBIAR0IgdxBH8gAwUgBiAFIAdyNgIA\nIABBCGogBCABQX9HBH8gAUEBaiIEIAFBAmsgBEEDcBsFQX8LEB8gACgCJAtqIgQoAgAiA0EBIAJ0\nIgZxRQRAIAQgAyAGcjYCACAAQQhqIAICf0F/IAFBf0YNABogAUEBayABQQNwDQAaIAFBAmoLEB8L\nQX8hBCABQX9HBEAgACgCBCgCACABQQJ0aigCACEECyAAKAIkIARBA3ZB/P///wFxaiICKAIAIgNB\nASAEdCIGcUUEQCACIAMgBnI2AgAgAEEIaiAEIAEQHwsgACgCVCIDQQJKDQADQCAAIANBDGxqIgQo\nAjAgBCgCNCIBRgRAIANBAWoiA0EDRw0BDAILIAFBBGsiAigCACEBIAQgAjYCNCAAIAM2AlQgAUF/\nRg0BAkAgACgCGCIEIAFBA24iAkEDdkH8////AHFqKAIAIAJ2QQFxDQACQANAIAQgAUEDbiIGQQN2\nQfz///8AcWoiBCAEKAIAQQEgBnRyNgIAQX8hBAJAAkACfyABQX9HBEAgACgCBCgCACABQQJ0aigC\nACEECwJAAkACQAJAAkAgACgCJCAEQQN2Qfz///8BcWoiAigCACIDQQEgBHQiBXFFBEAgAiADIAVy\nNgIAIAAoAhAoAmAgBkEMbGogAUEDcEECdGooAgAhCQJAIAAoAhQoAgQiAigCBCIDIAIoAghHBEAg\nAyAJNgIAIAIgA0EEajYCBAwBCyADIAIoAgAiBWsiA0ECdSIKQQFqIgdBgICAgARPDQJB/////wMg\nA0EBdSIIIAcgByAISRsgA0H8////B08bIgcEfyAHQYCAgIAETw0QIAdBAnQQBgVBAAsiCCAKQQJ0\naiIKIAk2AgAgA0EASgRAIAggBSADEAcaCyACIAggB0ECdGo2AgggAiAKQQRqNgIEIAIgCDYCACAF\nRQ0AIAUQBQsCQCAAKAIMIgIoAgQiAyACKAIIRwRAIAMgATYCACACIANBBGo2AgQMAQsgAyACKAIA\nIgVrIgNBAnUiCUEBaiIHQYCAgIAETw0DQf////8DIANBAXUiCCAHIAcgCEkbIANB/P///wdPGyIH\nBH8gB0GAgICABE8NECAHQQJ0EAYFQQALIgggCUECdGoiCSABNgIAIANBAEoEQCAIIAUgAxAHGgsg\nAiAIIAdBAnRqNgIIIAIgCUEEajYCBCACIAg2AgAgBUUNACAFEAULIAAoAgwiAigCDCAEQQJ0aiAC\nKAIYNgIAIAIgAigCGEEBajYCGAsgAUF/Rg0JIAAoAgQhBUF/IQQgAUEBaiICIAFBAmsgAkEDcBsi\nAkF/RwRAIAUoAgwgAkECdGooAgAhBAsCfwJAIAZBA2wgAUcEQCABQQFrIQIMAQtBfyABQQJqIgJB\nf0YNARoLIAUoAgwgAkECdGooAgALIgFBf0YhAiABQQNuIQYgBEF/RwRAIAAoAhggBEEDbiIDQQN2\nQfz///8AcWooAgBBASADdHEhAyACDQMgA0EARyEDDAQLQQEhAyACRQ0DDAkLEAkACxAJAAsgA0UN\nAQwGCwJAIAAoAhhBfyAGIAIbIgJBA3ZB/P///wFxaigCACACdkEBcQ0AQQAhAiAAKAIkIAUoAgAg\nAUECdGooAgAiBkEDdkH8////AXFqKAIAIAZ2QQFxRQRAIAAoAlggBkECdGoiAiACKAIAIgJBAWo2\nAgBBAkEBIAJBAEwbIQILIAMEQCACIAAoAlRMDQQLAkAgACACQQxsaiIGKAI0IgUgBigCOEcEQCAF\nIAE2AgAgBiAFQQRqNgI0DAELIAUgBigCMCIHayIFQQJ1IgpBAWoiCEGAgICABE8NDEH/////AyAF\nQQF1IgkgCCAIIAlJGyAFQfz///8HTxsiCAR/IAhBgICAgARPDQwgCEECdBAGBUEACyIJIApBAnRq\nIgogATYCACAFQQBKBEAgCSAHIAUQBxoLIAYgCTYCMCAGIApBBGo2AjQgBiAJIAhBAnRqNgI4IAdF\nDQAgBxAFCyAAKAJUIAJMDQAgACACNgJUCyADDQVBfyAEQX9GDQEaCyAAKAIEKAIAIARBAnRqKAIA\nCyEBQQAhAiAAKAIkIAFBA3ZB/P///wFxaigCACABdkEBcUUEQCAAKAJYIAFBAnRqIgEgASgCACIB\nQQFqNgIAQQJBASABQQBMGyECCyACIAAoAlRKDQEgBCEBCyAAKAIYIQQMAQsLAkAgACACQQxsaiIB\nKAI0IgMgASgCOEcEQCADIAQ2AgAgASADQQRqNgI0DAELIAMgASgCMCIGayIDQQJ1IghBAWoiBUGA\ngICABE8NB0H/////AyADQQF1IgcgBSAFIAdJGyADQfz///8HTxsiBQR/IAVBgICAgARPDQYgBUEC\ndBAGBUEACyIHIAhBAnRqIgggBDYCACADQQBKBEAgByAGIAMQBxoLIAEgBzYCMCABIAhBBGo2AjQg\nASAHIAVBAnRqNgI4IAZFDQAgBhAFCyAAKAJUIgMgAkwNASAAIAI2AlQgAiEDDAELIAAoAlQhAwsg\nA0EDSA0ACwtBAQ8LEAsACxAJAAsQCQALEAkAC7EEAQV/IABBkMEANgIAIABB6AFqIgMoAsQBIgEE\nQCADIAE2AsgBIAEQBQsgAygCuAEiAgRAIAMoArwBIgQgAiIBRwRAA0AgBEEMayIBKAIAIgUEQCAE\nQQhrIAU2AgAgBRAFCyABIgQgAkcNAAsgAygCuAEhAQsgAyACNgK8ASABEAULIAMoApwBIgEEQCAD\nIAE2AqABIAEQBQsgAygCiAEhAiADQQA2AogBIAIEQCACQQRrIgQoAgAiAQRAIAIgAUEEdGohAQNA\nIAFBEGsiASACRw0ACwsgBBAFCyAAQdgBahCtASAAKALEASIBBEAgACABNgLIASABEAULIAAoArgB\nIgEEQCAAIAE2ArwBIAEQBQsgACgCrAEiAQRAIAAgATYCsAEgARAFCyAAKAKgASIBBEAgACABNgKk\nASABEAULIAAoApABIgEEQANAIAEoAgAhAiABEAUgAiIBDQALCyAAKAKIASEBIABBADYCiAEgAQRA\nIAEQBQsgACgCeCIBBEAgARAFCyAAKAJsIgEEQCABEAULIAAoAmAiAQRAIAEQBQsgACgCSCIBBEAg\nACABNgJMIAEQBQsgACgCPCIBBEAgARAFCyAAKAIwIgEEQCAAIAE2AjQgARAFCyAAKAIkIgEEQCAA\nIAE2AiggARAFCyAAKAIYIgEEQCAAIAE2AhwgARAFCyAAKAIMIgEEQCAAIAE2AhAgARAFCyAAKAII\nIQEgAEEANgIIIAEEQCABEDALIAALmgEBBH8gACgCACIEBEAgBCEDIAQgACgCBCIBRwRAA0AgAUGQ\nAWsiAygChAEiAgRAIAFBCGsgAjYCACACEAULIAFBHGsoAgAiAgRAIAFBGGsgAjYCACACEAULIAFB\nKGsoAgAiAgRAIAFBJGsgAjYCACACEAULIAFBjAFrEFAgAyIBIARHDQALIAAoAgAhAwsgACAENgIE\nIAMQBQsLpQMBBH8gAEHcwAA2AgAgACgC8AIhAyAAQQA2AvACIAMEQCADQQRrIgQoAgAiAQRAIAMg\nAUEEdGohAgNAIAJBEGsiAiADRw0ACwsgBBAFCyAAQdgBahCtASAAKALEASIBBEAgACABNgLIASAB\nEAULIAAoArgBIgEEQCAAIAE2ArwBIAEQBQsgACgCrAEiAQRAIAAgATYCsAEgARAFCyAAKAKgASIB\nBEAgACABNgKkASABEAULIAAoApABIgIEQANAIAIoAgAhASACEAUgASICDQALCyAAKAKIASEBIABB\nADYCiAEgAQRAIAEQBQsgACgCeCIBBEAgARAFCyAAKAJsIgEEQCABEAULIAAoAmAiAQRAIAEQBQsg\nACgCSCIBBEAgACABNgJMIAEQBQsgACgCPCIBBEAgARAFCyAAKAIwIgEEQCAAIAE2AjQgARAFCyAA\nKAIkIgEEQCAAIAE2AiggARAFCyAAKAIYIgEEQCAAIAE2AhwgARAFCyAAKAIMIgEEQCAAIAE2AhAg\nARAFCyAAKAIIIQEgAEEANgIIIAEEQCABEDALIAALBwAgACgCCAv7AwIRfwF9IwBBEGsiCiQAIAIo\nAhxBCUYEQCAAKAIEIQMgAi0AGCIGQQJ0IgUQBiEEIApBCGoiC0GAgID8AzYCACAAKgIUIRRBfyAD\ndEF/cyIDQQBKBEAgCyAUIAOylTgCAAsCQCADQQBKIg9FDQAgAigCUCIHRQ0AIAYEQCABKAIAKAIA\nIAEoAjBqIQwgBkH+AXEhECAGQQFxIRFBACEBA0AgACgCCCEJIAsqAgAhFEEAIQNBACENIAZBAUcE\nQANAIAQgA0ECdCIIaiAUIAwgAUECdGoiEigCALKUIAggCWoqAgCSOAIAIAQgCEEEciIIaiAUIBIo\nAgSylCAIIAlqKgIAkjgCACADQQJqIQMgAUECaiEBIA1BAmoiDSAQRw0ACwsgEQRAIAQgA0ECdCID\naiAUIAwgAUECdGooAgCylCADIAlqKgIAkjgCACABQQFqIQELIAIoAkAoAgAgDmogBCAFEAcaIAUg\nDmohDiATQQFqIhMgB0cNAAsMAQtBACEBIAdBAUcEQCAHQX5xIQBBACEDA0AgAigCQCgCACABaiAE\nIAUQBxogASAFaiIBIAIoAkAoAgBqIAQgBRAHGiABIAVqIQEgA0ECaiIDIABHDQALCyAHQQFxRQ0A\nIAIoAkAoAgAgAWogBCAFEAcaCyAEEAULIApBEGokACAPC7IBAQN/AkAgACgCBCICIAAoAggiBEEF\ndEYEQCACQQFqQQBIDQFB/////wchAyAAIAJB/v///wNNBH8gBEEGdCIDIAJBYHFBIGoiAiACIANJ\nGwVB/////wcLEDIgACgCBCECCyAAIAJBAWo2AgRBASACdCEDIAAoAgAgAkEDdkH8////AXFqIQAg\nAS0AAARAIAAgACgCACADcjYCAA8LIAAgACgCACADQX9zcTYCAA8LEAkAC94BAQV/QQEhBQJAIAAo\nAowBIgJBAEwNAEF/IAJBBHQiAUEEciACQf////8ASxsQBiIDIAI2AgAgA0EEaiIDIAFqIQIgAyEB\nA0AgAUIANwIAIAFCADcABSABQRBqIgEgAkcNAAsgACgCiAEhBCAAIAM2AogBIAQEQCAEQQRrIgIo\nAgAiAwRAIAQgA0EEdGohAQNAIAFBEGsiASAERw0ACwsgAhAFC0EAIQEgACgCjAFBAEwNAANAIAAo\nAogBIAFBBHRqIAAQFiIFRQ0BIAFBAWoiASAAKAKMAUgNAAsLIAUL2RQCEX8BfiMAQSBrIgckACAA\nKAIEKAIsIQogACgCCCICKAIAIQYgAigCBCECIAdBADYCGCAHQgA3AxACQCACIAZrQQJ1QQNuIgQg\nCigCZCAKKAJgIgJrQQxtIgZLBEAgBCAGayIJIAooAmgiBCAKKAJkIgZrQQxtTQRAAkAgCUUNACAJ\nQQxsIgIhAwJAIAJBDGsiCEEMbkEBakEDcSIERQRAIAYhAgwBCyAGIQIDQCACIAcpAhA3AgAgAiAH\nKAIYNgIIIAJBDGohAiAFQQFqIgUgBEcNAAsLIAMgBmohBiAIQSRJDQADQCACIAcpAhA3AgAgAiAH\nKAIYNgIIIAIgBygCGDYCFCACIAcpAhA3AgwgAiAHKAIYNgIgIAIgBykCEDcCGCACIAcpAhA3AiQg\nAiAHKAIYNgIsIAJBMGoiAiAGRw0ACwsgCiAGNgJkDAILAkAgBiAKKAJgIgJrQQxtIgggCWoiA0HW\nqtWqAUkEQEHVqtWqASAEIAJrQQxtIgRBAXQiAiADIAIgA0sbIARBqtWq1QBPGyILBEAgC0HWqtWq\nAU8NAiALQQxsEAYhDQsgDSAIQQxsaiIEIQIgCUEMbCIJQQxrIgNBDG5BAWpBA3EiCARAIAQhAgNA\nIAIgBykCEDcCACACIAcoAhg2AgggAkEMaiECIAVBAWoiBSAIRw0ACwsgBCAJaiEFIANBJE8EQANA\nIAIgBykCEDcCACACIAcoAhg2AgggAiAHKAIYNgIUIAIgBykCEDcCDCACIAcoAhg2AiAgAiAHKQIQ\nNwIYIAIgBykCEDcCJCACIAcoAhg2AiwgAkEwaiICIAVHDQALCyAEIAYgCigCYCIIayIGQXRtQQxs\naiECIAZBAEoEQCACIAggBhAHGgsgCiANIAtBDGxqNgJoIAogBTYCZCAKIAI2AmAgCARAIAgQBQsM\nAwsQCQALEAsACyAEIAZPDQAgCiACIARBDGxqNgJkCwJAIAAoAtgBIAAoAtwBRgRAIAAoAgQiBCgC\nLCIGKAJkIgIgBigCYCIJRwRAQQEgAiAJa0EMbSICIAJBAU0bIQZBACEDA0AgACgCCCEKIAkgA0EM\nbGoiCAJ/AkAgA0EDbCILQX9GBEAgCigCACALQQJ0aigCBCEFQX8hDEEBIQIMAQtBfyEFIAooAgAg\nC0ECdGooAgAhDCALQQFqIgJBf0YEQEEAIQIMAQsgCigCACACQQJ0aigCACEFQX8gC0ECaiICQX9G\nDQEaCyAKKAIAIAJBAnRqKAIACzYCCCAIIAU2AgQgCCAMNgIAIANBAWoiAyAGRw0ACwsgBCgCBCAB\nNgJQQQEhAwwBC0EAIQYgB0EANgIYIAdCADcDECAAKAIIIg0oAgAhBCANKAIEIQIgB0EANgIIIAdC\nADcDAEEAIQECfwJAAkACQAJAAkAgAiAERwRAIAIgBGsiAkEASA0BIAcgAhAGIgE2AgAgByABIAJB\nfHFqNgIIIAcgAUEAIAIQCCACajYCBAsgDSgCHCANKAIYIgNrQQBMDQRBACECA0ACQCADIA9BAnRq\nKAIAIghBf0YNAAJAIAAoAnggD0EDdkH8////AXFqKAIAIA92QQFxDQAgACgC3AEiBCAAKALYASIS\nRg0AIAhBAWsgCEECaiIDIAhBA3AiBRshEEEBIAQgEmtBkAFtIgQgBEEBTRshCkEAIREgBUEARyAD\nQX9HciELA0ACQCASIBFBkAFsaiIDKAIQIAhBAnQiBSADKAJEKAIAaigCACIEQQN2Qfz///8BcWoo\nAgAgBHZBAXFFDQAgAygCICIJIAVqKAIAIQQgCAJ/QX8gC0UNABpBfyANKAIMIBBBAnRqKAIAIgVB\nf0YNABogBUEBayAFQQNwDQAaIAVBAmoLIgNGDQADQEEAIANBf0YNCxogBCAJIANBAnRqKAIARwRA\nIAMhCAwECyAIAn8CQCADQQNwBEAgA0EBayEFDAELQX8gA0ECaiIFQX9GDQEaC0F/IA0oAgwgBUEC\ndGooAgAiBUF/Rg0AGiAFQQFrIAVBA3ANABogBUECagsiA0cNAAsLIBFBAWoiESAKRw0ACwsgASAI\nQQJ0aiAMIAJrIglBAnUiAzYCAAJAIAwgDkkEQCAMIAg2AgAgByAMQQRqIgw2AhQMAQsgA0EBaiIF\nQYCAgIAETw0EQf////8DIA4gAmsiBEEBdSIGIAUgBSAGSRsgBEH8////B08bIgUEfyAFQYCAgIAE\nTw0GIAVBAnQQBgVBAAsiBiADQQJ0aiIEIAg2AgAgBiAFQQJ0aiEOIARBBGohDCAJQQBKBEAgBiAC\nIAkQBxoLIAcgDjYCGCAHIAw2AhQgByAGNgIQIAIEQCACEAUgACgCCCENCyAGIQILIAhBf0YNAAJA\nIAhBA3AEQCAIQQFrIQMMAQsgCEECaiIDQX9GDQELIA0oAgwgA0ECdGooAgAiBEF/Rg0AIARBf0EC\nIARBA3AbaiIDQX9GDQAgCCIFIANGDQADQCADIQQCQAJAIAAoAtwBIgMgACgC2AEiEEYNAEEBIAMg\nEGtBkAFtIgMgA0EBTRshCkEAIQMDQCAQIANBkAFsaigCICILIARBAnQiCWooAgAgCyAFQQJ0aigC\nAEYEQCAKIANBAWoiA0cNAQwCCwsgASAJaiAMIAZrIgtBAnUiCTYCACAMIA5JBEAgDCAENgIAIAcg\nDEEEaiIMNgIUIAYhAgwCCyAJQQFqIgNBgICAgARPDQhB/////wMgDiAGayIFQQF1IgIgAyACIANL\nGyAFQfz///8HTxsiAwR/IANBgICAgARPDQggA0ECdBAGBUEACyICIAlBAnRqIgUgBDYCACACIANB\nAnRqIQ4gBUEEaiEMIAtBAEoEQCACIAYgCxAHGgsgByAONgIYIAcgDDYCFCAHIAI2AhAgBkUEQCAC\nIQYMAgsgBhAFIAAoAgghDSACIQYMAQsgASAEQQJ0aiABIAVBAnRqKAIANgIACyAEQX9GDQECQCAE\nQQNwBEAgBEEBayEDDAELIARBAmoiA0F/Rg0CCyANKAIMIANBAnRqKAIAIgVBf0YNASAFQX9BAiAF\nQQNwG2oiA0F/Rg0BIAQhBSADIAhHDQALCyAPQQFqIg8gDSgCHCANKAIYIgNrQQJ1SA0ACwwECxAJ\nAAsQCQALEAsACxAJAAsCQCAAKAIEIgkoAiwiAigCZCIAIAIoAmAiC0YNAEEBIAAgC2tBDG0iAiAC\nQQFNGyIAQQFxIQhBACEDIAJBAk8EQCAAQX5xIQVBACECA0AgASADQQxsIgBqIgQpAgAhEyAAIAtq\nIgAgBCgCCDYCCCAAIBM3AgAgASADQQFyQQxsIgBqIgQpAgAhEyAAIAtqIgAgBCgCCDYCCCAAIBM3\nAgAgA0ECaiEDIAJBAmoiAiAFRw0ACwsgCEUNACABIANBDGwiAGoiAikCACETIAAgC2oiACACKAII\nNgIIIAAgEzcCAAsgCSgCBCAMIAZrQQJ1NgJQQQELIQMgAQRAIAEQBQsgBkUNACAHIAY2AhQgBhAF\nCyAHQSBqJAAgAwuLBgEMfyMAQRBrIggkACAIIAE2AgBBfyEDAkAgAUF/RgRAIAhBfzYCBAwBCyAI\nIAFBAWoiAyABQQJrIANBA3AbNgIEIAFBA3AEQCABQQFrIQMMAQsgAUECaiEDCyAIIAM2AgggAUED\nbiENAkACQAJAA0ACQAJAIAggDEECdGooAgAiCUF/RwRAIAAoAggoAgwgCUECdGooAgAiA0F/Rw0B\nC0EAIQMgACgC2AEiBCAAKALcAUYNAQNAAkAgBCADQZABbGoiBCgCiAEiAiAEKAKMASIFSQRAIAIg\nCTYCACAEIAJBBGo2AogBDAELIAIgBCgChAEiAmsiCkECdSIHQQFqIgZBgICAgARPDQVB/////wMg\nBSACayIFQQF1IgsgBiAGIAtJGyAFQfz///8HTxsiBgR/IAZBgICAgARPDQcgBkECdBAGBUEACyIF\nIAdBAnRqIgcgCTYCACAKQQBKBEAgBSACIAoQBxoLIAQgBTYChAEgBCAHQQRqNgKIASAEIAUgBkEC\ndGo2AowBIAJFDQAgAhAFCyADQQFqIgMgACgC3AEgACgC2AEiBGtBkAFtSQ0ACwwBCyABQX9GDQAg\nA0EDbiANSQ0AQQAhAyAAKALcASAAKALYAUYNAANAAkAgACgC8AIgA0EEdGoQEkUNACAAKALYASAD\nQZABbGoiBCgCiAEiAiAEKAKMASIFSQRAIAIgCTYCACAEIAJBBGo2AogBDAELIAIgBCgChAEiAmsi\nCkECdSIHQQFqIgZBgICAgARPDQZB/////wMgBSACayIFQQF1IgsgBiAGIAtJGyAFQfz///8HTxsi\nBgR/IAZBgICAgARPDQYgBkECdBAGBUEACyIFIAdBAnRqIgcgCTYCACAKQQBKBEAgBSACIAoQBxoL\nIAQgBTYChAEgBCAHQQRqNgKIASAEIAUgBkECdGo2AowBIAJFDQAgAhAFCyADQQFqIgMgACgC3AEg\nACgC2AFrQZABbUkNAAsLIAxBAWoiDEEDRw0ACyAIQRBqJABBAQ8LEAkACxALAAsQCQALwQUBC38j\nAEEQayIGJABBfyEMAkACQAJAQQEgBkEMaiABEBlFDQAgBigCDCIJBEAgCSAAKAIIIgIoAgQgAigC\nAGtBAnVBA25LDQEDQEEBIAZBCGogARAZRQ0CIAYoAgghAkEBIAZBCGogARAZRQ0CIAIgB2oiByAG\nKAIIIgJJDQIgByACayEDAkAgACgCKCICIAAoAixHBEAgAiAHNgIEIAIgAzYCACAAIAJBDGo2Aigg\nBigCDCEJDAELIAIgACgCJCICayIEQQxtIgVBAWoiCEHWqtWqAU8NBEHVqtWqASAFQQF0IgsgCCAI\nIAtJGyAFQarVqtUATxsiCAR/IAhB1qrVqgFPDQYgCEEMbBAGBUEACyILIAVBDGxqIgUgBzYCBCAF\nIAM2AgAgBSAEQXRtQQxsaiEDIARBAEoEQCADIAIgBBAHGgsgACALIAhBDGxqNgIsIAAgBUEMajYC\nKCAAIAM2AiQgAkUNACACEAULIApBAWoiCiAJSQ0AC0EAIQcgAUEAQQAQahogCQRAA0AgAS0AJCEC\nAkACQCAAKAIELwEkIgRBCHQgBEEIdnJB//8DcUGBBE0EQCACRQ0CQQAhAwJAIAEoAhgiBSABKAIg\nIgRBA3YiCmoiAiABKAIcIghPBEAgBCECDAELIAItAAAhAyABIARBAWoiAjYCICACQQN2IQogAyAE\nQQdxdkEBcSEDCyAFIApqIAhJDQEMAgsgAkUNAUEAIQMgASgCGCABKAIgIgJBA3ZqIgQgASgCHE8N\nASAELQAAIAJBB3F2QQFxIQMLIAEgAkEBajYCIAsgACgCJCAHQQxsaiICIAItAAhB/gFxIANBAXFy\nOgAIIAdBAWoiByAJRw0ACwsgAUEAOgAkIAEgASkDECABNQIgQgd8QgOIfDcDEAsgASgCECEMCyAG\nQRBqJAAgDA8LEAkACxALAAvwCwEGfyABIAAoAgQiAyAAKAIAIgRrQZABbSICSwRAAkAgASACayIE\nIAAiAigCCCIBIAAoAgQiA2tBkAFtTQRAAkAgBEUNACADIQAgBEEHcSIFBEBBACEBA0AgABARIABB\nkAFqIQAgAUEBaiIBIAVHDQALCyAEQZABbCADaiEDIARBAWtB/////wBxQQdJDQADQCAAEBEgAEGQ\nAWoQESAAQaACahARIABBsANqEBEgAEHABGoQESAAQdAFahARIABB4AZqEBEgAEHwB2oQESAAQYAJ\naiIAIANHDQALCyACIAM2AgQMAQsCQAJAAkAgAyACKAIAIgVrQZABbSIGIARqIgBB8ricDkkEQEEA\nIQNB8bicDiABIAVrQZABbSIBQQF0IgUgACAAIAVJGyABQbicjgdPGyIFBEAgBUHyuJwOTw0CIAVB\nkAFsEAYhBwsgByAGQZABbGoiASEAIARBB3EiBgRAIAEhAANAIAAQESAAQZABaiEAIANBAWoiAyAG\nRw0ACwsgBEGQAWwgAWohBiAEQQFrQf////8AcUEHTwRAA0AgABARIABBkAFqEBEgAEGgAmoQESAA\nQbADahARIABBwARqEBEgAEHQBWoQESAAQeAGahARIABB8AdqEBEgAEGACWoiACAGRw0ACwsgByAF\nQZABbGohBCACKAIEIgAgAigCACIDRg0CA0AgAUGQAWsiASAAQZABayIAKAIANgIAIAEgACgCBDYC\nBCABIAAoAgg2AgggASAAKAIMNgIMIABBADYCDCAAQgA3AgQgASAAKAIQNgIQIAEgACgCFDYCFCAB\nIAAoAhg2AhggAEEANgIYIABCADcCECAALQAcIQUgAUEANgIoIAFCADcCICABIAU6ABwgASAAKAIg\nNgIgIAEgACgCJDYCJCABIAAoAig2AiggAEEANgIoIABCADcCICABQQA2AjQgAUIANwIsIAEgACgC\nLDYCLCABIAAoAjA2AjAgASAAKAI0NgI0IABBADYCNCAAQgA3AiwgAUFAayIFQQA2AgAgAUIANwI4\nIAEgACgCODYCOCABIAAoAjw2AjwgBSAAQUBrIgUoAgA2AgAgBUEANgIAIABCADcCOCABIAAoAkQ2\nAkQgACgCSCEFIAFBADYCVCABQgA3AkwgASAFNgJIIAEgACgCTDYCTCABIAAoAlA2AlAgASAAKAJU\nNgJUIABBADYCVCAAQgA3AkwgAUEANgJgIAFCADcCWCABIAAoAlg2AlggASAAKAJcNgJcIAEgACgC\nYDYCYCAAQQA2AmAgAEIANwJYIAAtAGQhBSABQQA2AnAgAUIANwJoIAEgBToAZCABIAAoAmg2Amgg\nASAAKAJsNgJsIAEgACgCcDYCcCAAQQA2AnAgAEIANwJoIAFBADYCfCABQgA3AnQgASAAKAJ0NgJ0\nIAEgACgCeDYCeCABIAAoAnw2AnwgAEEANgJ8IABCADcCdCAAKAKAASEFIAFBADYCjAEgAUIANwKE\nASABIAU2AoABIAEgACgChAE2AoQBIAEgACgCiAE2AogBIAEgACgCjAE2AowBIABBADYCjAEgAEIA\nNwKEASAAIANHDQALIAIgBDYCCCACKAIEIQAgAiAGNgIEIAIoAgAhAyACIAE2AgAgACADRg0DA0Ag\nAEGQAWsiASgChAEiAgRAIABBCGsgAjYCACACEAULIABBHGsoAgAiAgRAIABBGGsgAjYCACACEAUL\nIABBKGsoAgAiAgRAIABBJGsgAjYCACACEAULIABBjAFrEFAgASIAIANHDQALDAMLEAkACxALAAsg\nAiAENgIIIAIgBjYCBCACIAE2AgALIAMEQCADEAULCw8LIAEgAkkEQCAEIAFBkAFsaiICIANHBEAD\nQCADQZABayIBKAKEASIEBEAgA0EIayAENgIAIAQQBQsgA0EcaygCACIEBEAgA0EYayAENgIAIAQQ\nBQsgA0EoaygCACIEBEAgA0EkayAENgIAIAQQBQsgA0GMAWsQUCABIgMgAkcNAAsLIAAgAjYCBAsL\nhgEBBH8gACgCBCIBIAAoAgAiA0cEQANAIAFBkAFrIgQoAoQBIgIEQCABQQhrIAI2AgAgAhAFCyAB\nQRxrKAIAIgIEQCABQRhrIAI2AgAgAhAFCyABQShrKAIAIgIEQCABQSRrIAI2AgAgAhAFCyABQYwB\naxBQIAQiASADRw0ACwsgACADNgIEC0kBAX8gAEGwwwA2AgAgACgCMCIBBEAgACABNgI0IAEQBQsg\nAEGsxQA2AgAgACgCJCIBBEAgARAFCyAAKAIYIgEEQCABEAULIAALjgEBAn8jAEEQayIDJAAgACAB\nNgIEIAEoAkAiASgCACEEIAEoAgQhASADQQA6AA8gAEEYaiABIARrQQJ1QQNuIANBD2oQGiAAKAIE\nIgEoAjghBCABKAI0IQEgA0EAOgAOIABBJGogBCABa0ECdSADQQ5qEBogACACKQIINwIQIAAgAikC\nADcCCCADQRBqJAALiBICC38DfiMAQeAAayIIJAACQCAAKAIEIgUoAiAiAikDCCIPIAIpAxAiDlcN\nACACKAIAIgcgDqdqLQAAIQMgAiAOQgF8Ig03AxAgDSAPWQ0AIAcgDadqLQAAIQogAiAOQgJ8Ig03\nAxACQCADQRh0QRh1IgRBAE4EQCAAKALcASAAKALYASIGa0GQAW0gA00NAiAGIANBkAFsaiIGKAIA\nQQBIDQEMAgsgACgC1AFBAE4NASAAQdQBaiEGCyAGIAE2AgACQAJ/AkACQAJAAkACfyAFLwEkIgZB\nCHQgBkEIdnJB//8DcUGCAk8EQCANIA9ZDQggByANp2otAAAhByACIA5CA3w3AxAgB0EBSyICDQhB\nACAHIAIbIgIgCkUNARogAkUNAgwICyAKDQJBAAshAiAEQQBIBH8gAEG4AWoFIAAoAtgBIANBkAFs\naiIDQQA6AGQgA0HoAGoLIQQgAkEBRw0DIwBB8ABrIgMkACAAKAIEKAIsIQdB+AAQBiICQdzFADYC\nACACQQA2AgQgAkEANgJ0IAIgBDYCcCACIAc2AmwgAkIANwIMIAJCADcCFCACQgA3AhwgAkIANwIk\nIAJCADcCLCACQQA2AjQgAkIANwI4IAJBsMcANgIIIAJBQGtCADcCACACQgA3AkggAkIANwJQIAJB\nADYCWCACQQA2AmggAkIANwJgIAAoAgghBSADQgA3AzAgA0IANwMoIANBIGoiCkIANwMAIANCADcD\nGCADQUBrQgA3AwAgA0IANwNIIANCADcDUCADQQA2AlggA0EANgJoIANCADcDECADQgA3AzggA0Gw\nxwA2AgggA0IANwNgIAMgBTYCDCAFKAIAIQYgBSgCBCEJIANBADoAbyAKIAkgBmtBAnVBA24gA0Hv\nAGoiChAaIAMoAgwiBigCHCEJIAYoAhghBiADQQA6AG8gA0EsaiAJIAZrQQJ1IAoQGiADIAI2Ahwg\nAyAHNgIYIAMgBDYCFCADIAU2AhAgAkEIaiIFIANBCGoiBBBuAkAgBCAFRgRAIAIgBCgCVDYCXAwB\nCyACQThqIAQoAjAgBCgCNBA3IAJBxABqIAQoAjwgBEFAaygCABA3IAJB0ABqIAQoAkggBCgCTBA3\nIAIgBCgCVDYCXAJAIAQoAlwiCiAEKAJYIgRrIgZBAnUiByACKAJoIgkgAigCYCIFa0ECdU0EQCAE\nIAIoAmQgBWsiBmogCiAHIAZBAnUiC0sbIgYgBGshCSAEIAZHBEAgBSAEIAkQJRoLIAcgC0sEQCAC\nKAJkIQQgAiAKIAZrIgVBAEoEfyAEIAYgBRAHIAVqBSAECzYCZAwCCyACIAUgCWo2AmQMAQsgBQRA\nIAIgBTYCZCAFEAUgAkEANgJoIAJCADcCYEEAIQkLAkAgBkEASA0AQf////8DIAlBAXUiBSAHIAUg\nB0sbIAlB/P///wdPGyIFQYCAgIAETw0AIAIgBUECdCIHEAYiBTYCYCACIAU2AmQgAiAFIAdqNgJo\nIAIgBCAKRwR/IAUgBCAGEAcgBmoFIAULNgJkDAELEAkACwsgA0GwxwA2AgggAygCYCIEBEAgAyAE\nNgJkIAQQBQsgAygCUCIEBEAgAyAENgJUIAQQBQsgAygCRCIEBEAgAyAENgJIIAQQBQsgAygCOCIE\nBEAgAyAENgI8IAQQBQsgA0GcyQA2AgggAygCLCIEBEAgBBAFCyADKAIgIgQEQCAEEAULIANB8ABq\nJAAgAgwECyAEQQBODQEMBQsgBEEASA0ECyAAKALYASEHIAUoAiwhBEHQABAGIgJB1MsANgIAIAJB\nADYCBCACQQA2AkwgAiAENgJEIAJBsMMANgIIIAJCADcCDCACQgA3AhQgAkIANwIcIAJCADcCJCAC\nQgA3AiwgAkEANgI0IAIgByADQZABbGoiA0HoAGoiBTYCSCACQUBrQQA2AgAgAkIANwI4IAggBDYC\nGCAIQgA3AkQgCEIANwI8IAhCADcCNCAIQgA3AiwgCEIANwJUIAhCADcCTCAIIAI2AhwgCCAIKQMY\n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\nIAUgAzYCLCMAQSBrIgYkACAFIAI2AiAgBSABNgIoIAUgAzYCBCAAIAIgBkEQahBsAkAgACgCAA0A\nIAAsAA9BAEgEQCAAKAIEEAULIAYtABciASAFIAUoAgAoAggRAABHBEBBwAAQBiIBQQA6ADIgAUGY\nCi8AADsAMCABQZAKKQAANwAoIAFBiAopAAA3ACAgAUGACikAADcAGCABQfgJKQAANwAQIAFB8Akp\nAAA3AAggAUHoCSkAADcAACAAQX82AgAgAEEEaiABQTIQDCABEAUMAQsgBSAGLQAVIgI6ACQgBSAG\nLQAWIgM6ACUgAkECRwRAQSAQBiIBQQA6ABogAUGTCy8AADsAGCABQYsLKQAANwAQIAFBgwspAAA3\nAAggAUH7CikAADcAACAAQXs2AgAgAEEEaiABQRoQDCABEAUMAQsgA0ECQQMgARsiAUcEQEEgEAYi\nAUEAOgAaIAFB+AovAAA7ABggAUHwCikAADcAECABQegKKQAANwAIIAFB4AopAAA3AAAgAEF7NgIA\nIABBBGogAUEaEAwgARAFDAELIAUoAiAgAUGABHI7ASYCQCAGLgEaQQBODQAjAEEQayIDJABBJBAG\nIgFCADcCBCABQgA3AhggAUEQaiICQgA3AgAgASABQQRqNgIAIAFBADYCICABIAI2AgwgA0EANgIA\nIAUoAiAhAiMAQRBrIgokAAJ/QQAgAUUNABogAyACNgIAIApBADYCDEEAQQEgCkEMaiACEDZFDQAa\nIAooAgwiDgRAA0ACQEEBIApBCGogAygCABA2BEBBHBAGIgJCADcCBCACQRBqIghCADcCACACIAJB\nBGo2AgAgAiAINgIMIAIgCigCCDYCGCADIAIQlAENASACQQxqIAIoAhAQGCACIAIoAgQQFyACEAUL\nQQAMAwsjAEEQayIIJAAgCCACNgIIAkAgAkUNAAJAIAEoAhwiByABKAIgSQRAIAhBADYCCCAHIAI2\nAgAgASAHQQRqNgIcDAELQQAhAgJAAkACQCABKAIcIAEoAhgiCWtBAnUiDEEBaiIHQYCAgIAESQRA\nQf////8DIAEoAiAgCWsiCUEBdSILIAcgByALSRsgCUH8////B08bIgcEQCAHQYCAgIAETw0CIAdB\nAnQQBiECCyAIKAIIIQsgCEEANgIIIAIgDEECdGoiCSALNgIAIAIgB0ECdGohDCAJQQRqIQsgASgC\nHCICIAEoAhgiB0YNAgNAIAJBBGsiAigCACEPIAJBADYCACAJQQRrIgkgDzYCACACIAdHDQALIAEg\nDDYCICABKAIcIQIgASALNgIcIAEoAhghByABIAk2AhggAiAHRg0DA0AgAkEEayICKAIAIQkgAkEA\nNgIAIAkEQCAJQQxqIAkoAhAQGCAJIAkoAgQQFyAJEAULIAIgB0cNAAsMAwsQCQALEAsACyABIAw2\nAiAgASALNgIcIAEgCTYCGAsgBwRAIAcQBQsLIAgoAgghAiAIQQA2AgggAkUNACACQQxqIAIoAhAQ\nGCACIAIoAgQQFyACEAULIAhBEGokACANQQFqIg0gDkcNAAsLIAMgARCUAQshAiAKQRBqJAACQCAC\nBEAgBSgCBCIIKAIEIQIgCCABNgIEIAIEQCACEGsLIABCADcCACAAQgA3AggMAQtBIBAGIgJBADoA\nGiACQY0MLwAAOwAYIAJBhQwpAAA3ABAgAkH9CykAADcACCACQfULKQAANwAAIABBfzYCACAAQQRq\nIAJBGhAMIAIQBSADQQA2AgggARBrCyADQRBqJAAgACgCAA0BIAAsAA9BAE4NACAAKAIEEAULIAUg\nBSgCACgCDBEAAEUEQEEwEAYiAUEAOgAhIAFB3gotAAA6ACAgAUHWCikAADcAGCABQc4KKQAANwAQ\nIAFBxgopAAA3AAggAUG+CikAADcAACAAQX82AgAgAEEEaiABQSEQDCABEAUMAQsgBSAFKAIAKAIU\nEQAARQRAIAZBkAwQTiEBIABBfzYCACAAQQRqIQIgASwAC0EATgRAIAIgASkCADcCACACIAEoAgg2\nAggMAgsgAiABKAIAIAEoAgQQDCABLAALQQBODQEgASgCABAFDAELIAUgBSgCACgCGBEAAEUEQCAG\nQZsKEE4hASAAQX82AgAgAEEEaiECIAEsAAtBAE4EQCACIAEpAgA3AgAgAiABKAIINgIIDAILIAIg\nASgCACABKAIEEAwgASwAC0EATg0BIAEoAgAQBQwBCyAAQgA3AgAgAEIANwIICyAGQSBqJAAgACgC\nAEUEQCAALAAPQQBIBEAgACgCBBAFCyAAQgA3AgAgAEIANwIICyAFIAUoAgAoAgQRAgALIAQoAhAh\nACAEQQA2AhAgAARAIAAgACgCACgCBBECAAsgBCwAD0EATg0AIAQoAgQQBQsgBEHQAGokAAtzAgN/\nAX4CQCAAQQVLDQAgAikDECIGIAIpAwhZDQAgAigCACAGp2otAAAhBCACIAZCAXw3AxAgASAEQRh0\nQRh1IgVBAEgEfyAAQQFqIAEgAhDEAUUNASAFQf8AcSABKAIAQQd0cgUgBAs2AgBBASEDCyADCx8A\nQQgQAiAAEIYBIgBB/NkANgIAIABBnNoAQQEQAQALqgECAn8DfgJAIAEpAwgiBSABKQMQIgRCBHwi\nBlMNACABKAIAIASnaigAACECIAEgBjcDECAFIARCCHwiBFMNACABIAQ3AxAgAkEBcUUNACACZ0Ef\ncyICQR5rQWNJDQAgACACQQFqNgIIIABBfiACdCICQX5zIgM2AhAgACACQX9zNgIMIAAgA0ECbTYC\nGCAAQwAAAEAgA7KVOAIUIABB4ABqIAEQFiEDCyADCyUBAX8CQCABKAI4DQAgAS0AGEEDRw0AIAAg\nATYCMEEBIQILIAILQwEBfwJAIAAoAjBFDQAgACgCNEUNACAAKAIcRQ0AIAAoAiBFDQAgACgCJEUN\nACAAKAIoRQ0AIAAoAkxBf0chAQsgAQsKACAAIAEgAhB8CwQAQQYLBABBAgu/AQIDfwN+AkAgASkD\nCCIHIAEpAxAiBUIEfCIGUw0AIAEoAgAiAiAFp2ooAAAhAyABIAY3AxAgByAFQgh8IgVTDQAgAiAG\np2ooAAAhAiABIAU3AxAgAiADSA0AIAAgAjYCECAAIAM2AgwgAqwgA6x9IgVC/v///wdWDQAgACAF\np0EBaiIDNgIUIAAgA0EBdiICNgIYIABBACACazYCHCADQQFxRQRAIAAgAkEBazYCGAsgAEHwAGog\nARAWIQQLIAQLKAEBfwJAIAEoAjgNACABLQAYQQNHDQAgAEFAayABNgIAQQEhAgsgAgtGAQF/AkAg\nAEFAaygCAEUNACAAKAJERQ0AIAAoAixFDQAgACgCMEUNACAAKAI0RQ0AIAAoAjhFDQAgACgCXEF/\nRyEBCyABCzsBAX8gAEHAGTYCACAAKAJMIgEEQCABEAULIABBkBc2AgAgACgCICIBBEAgACABNgIk\nIAEQBQsgABAFCzkBAX8gAEHAGTYCACAAKAJMIgEEQCABEAULIABBkBc2AgAgACgCICIBBEAgACAB\nNgIkIAEQBQsgAAuWFwEhfyMAQUBqIgckACAAIAQ2AggCfwJAIAQgACgCJCAAQSBqIhcoAgAiBWtB\nAnUiA0sEQCAXIAQgA2sQCiAHQgA3AzggB0IANwMwIAdCADcDKCAHQgA3AyAgB0IANwMYIAdCADcD\nECAHQQA2AgAMAQsgAyAESwRAIAAgBSAEQQJ0ajYCJAsgB0IANwM4IAdCADcDMCAHQgA3AyggB0IA\nNwMgIAdCADcDGCAHQgA3AxAgB0EANgIAQQAgBEUNARoLIAdBEGogBCAHEBAgBygCHCEGIAcoAiAL\nIQMgB0EANgIAAkAgBCADIAZrQQJ1IgNNBEAgAyAETQ0BIAcgBiAEQQJ0ajYCIAwBCyAHQRBqQQxy\nIAQgA2sgBxAQCyAHQQA2AgACQCAEIAcoAiwgBygCKCIFa0ECdSIDTQRAIAMgBE0NASAHIAUgBEEC\ndGo2AiwMAQsgB0EoaiAEIANrIAcQEAsgB0EANgIAAkAgBCAHKAI4IAcoAjQiBWtBAnUiA00EQCAD\nIARNDQEgByAFIARBAnRqNgI4DAELIAdBNGogBCADayAHEBALAkAgACgCCEEATA0AIAcoAhAhCCAA\nKAIgIQlBACEGA0ACQCAIIAZBAnQiA2ooAgAiBSAAKAIQIgxKBEAgAyAJaiAMNgIADAELIAMgCWoh\nAyAAKAIMIgwgBUoEQCADIAw2AgAMAQsgAyAFNgIACyAGQQFqIgYgACgCCCIDSA0ACyADQQBMDQBB\nACEDA0AgAiADQQJ0IgVqIgggASAFaigCACAFIAlqKAIAaiIFNgIAAkAgCAJ/IAAoAhAgBUgEQCAF\nIAAoAhRrDAELIAUgACgCDE4NASAAKAIUIAVqCzYCAAsgA0EBaiIDIAAoAghIDQALCyAAKAI0IR4g\nACgCMCEPQRAQBiIYQgA3AgAgGEIANwIIIAdBADYCCCAHQgA3AwACQCAEBEAgBEGAgICABE8NASAH\nIARBAnQiAxAGIhI2AgAgByADIBJqNgIIIBJBACADEAgaCwJAIAAoAjgiAygCBCADKAIAIh9rIgNB\nBUgNAEECIANBAnUiFCAUQQJMGyEgQQEgFCAUQQFNGyEhIARBfnEhGSAEQQFxIRogBEF8cSEiIARB\nA3EhGyAEQQFrIRwgBEECdCEjIARBBEkhJEEBIR1BASEMA0ACQAJAAkACQCAMICFHBEACfwJAIB8g\nDEECdGooAgAiBUF/Rg0AQQEhDUEBIAVBAWsgBUECaiIDIAVBA3AiCBsiFXQhECAVQQV2IRNBACEJ\nIAhBAEcgA0F/R3IhJSAPKAIAISYgBSEDAkADQAJAICYgA0EDdkH8////AXFqKAIAIAN2QQFxDQAg\nDygCQCgCDCADQQJ0aigCACIIQX9GDQAgCEEBaiIKQQNwIREgHigCACIGIA8oAhwiCyAIQQJ0aigC\nAEECdGooAgAiDiAMTg0AIAYgCyAKIAhBAmsgERtBAnRqKAIAQQJ0aigCACIKIAxODQAgBiALQX9B\nAiAIQQNwGyAIakECdGooAgBBAnRqKAIAIgYgDE4NAAJAIARFDQAgB0EQaiAJQQxsaigCACEIIAQg\nBmwhCyAEIApsIQogBCAObCERQQAhBkEAIRYgHARAA0AgCCAGQQJ0aiACIAYgC2pBAnRqKAIAIAIg\nBiAKakECdGooAgBqIAIgBiARakECdGooAgBrNgIAIAggBkEBciIOQQJ0aiACIAsgDmpBAnRqKAIA\nIAIgCiAOakECdGooAgBqIAIgDiARakECdGooAgBrNgIAIAZBAmohBiAWQQJqIhYgGUcNAAsLIBpF\nDQAgCCAGQQJ0aiACIAYgC2pBAnRqKAIAIAIgBiAKakECdGooAgBqIAIgBiARakECdGooAgBrNgIA\nC0EEIQggCUEBaiIJQQRGDQILAkAgDUEBcQRAIANBAmshBiADQQFqIQhBfyEDIAggBiAIQQNwGyII\nQX9GDQEgDygCACAIQQN2Qfz///8BcWooAgAgCHZBAXENASAPKAJAKAIMIAhBAnRqKAIAIghBf0YN\nASAIQQFqIgMgCEECayADQQNwGyEDDAELAkAgA0EDcARAIANBAWshBgwBCyADQQJqIQZBfyEDIAZB\nf0YNAQtBfyEDIA8oAgAgBkEDdkH8////AXFqKAIAIAZ2QQFxDQAgDygCQCgCDCAGQQJ0aigCACII\nQX9GDQAgCEEDcARAIAhBAWshAwwBCyAIQQJqIQMLAkAgAyAFRg0AAkAgA0F/Rw0AIA1BAXNBAXEN\nACAlRQ0BIA8oAgAgE0ECdGooAgAgEHENASAPKAJAKAIMIBVBAnRqKAIAIgNBf0YNASADQQFrIANB\nAmogA0EDcBshA0EAIQ0LIANBf0cNAQsLIAkiCEEATA0BCyAEBEAgEkEAICMQCBoLIBggCEEBayID\nQQJ0aiERIAAgA0EMbGoiAyEVIANBQGsoAgAhFkEAIQ0gBygCACEDQQAhBQNAIBEgESgCACIJQQFq\nNgIAIAkgFk8NCQJAIBUoAjwgCUEDdkH8////AXFqKAIAIAl2QQFxDQAgBUEBaiEFIARFDQAgB0EQ\naiANQQxsaigCACELQQAhCUEAIQZBACEOICRFBEADQCADIAZBAnQiCmoiECAKIAtqKAIAIBAoAgBq\nNgIAIAMgCkEEciIQaiITIAsgEGooAgAgEygCAGo2AgAgAyAKQQhyIhBqIhMgCyAQaigCACATKAIA\najYCACADIApBDHIiCmoiECAKIAtqKAIAIBAoAgBqNgIAIAZBBGohBiAOQQRqIg4gIkcNAAsLIBtF\nDQADQCADIAZBAnQiCmoiDiAKIAtqKAIAIA4oAgBqNgIAIAZBAWohBiAJQQFqIgkgG0cNAAsLIA1B\nAWoiDSAIRw0ACyAEIAxsIgkgBUUNARogBEUNBUEAIQZBACEDIBwNAwwECyAEIAxsCyEDIAAoAghB\nAEwNBCACIANBAnQiCGohDSACIAxBAWsgBGxBAnRqIQsgFygCACEJQQAhBgNAAkAgCyAGQQJ0IgNq\nKAIAIgUgACgCECIKSgRAIAMgCWogCjYCAAwBCyADIAlqIQMgACgCDCIKIAVKBEAgAyAKNgIADAEL\nIAMgBTYCAAsgBkEBaiIGIAAoAggiBUgNAAtBACEDIAVBAEwNBCABIAhqIQgDQCANIANBAnQiBWoi\nBiAFIAhqKAIAIAUgCWooAgBqIgU2AgACQCAGAn8gACgCECAFSARAIAUgACgCFGsMAQsgBSAAKAIM\nTg0BIAAoAhQgBWoLNgIACyADQQFqIgMgACgCCEgNAAsMBAsQDgALA0AgEiAGQQJ0IghqIg0gDSgC\nACAFbTYCACASIAhBBHJqIgggCCgCACAFbTYCACAGQQJqIQYgA0ECaiIDIBlHDQALCyAaRQ0AIBIg\nBkECdGoiAyADKAIAIAVtNgIACyAAKAIIQQBMDQAgAiAJQQJ0IghqIQ0gFygCACEJQQAhBgNAAkAg\nEiAGQQJ0IgNqKAIAIgUgACgCECILSgRAIAMgCWogCzYCAAwBCyADIAlqIQMgACgCDCILIAVKBEAg\nAyALNgIADAELIAMgBTYCAAsgBkEBaiIGIAAoAggiBUgNAAtBACEDIAVBAEwNACABIAhqIQgDQCAN\nIANBAnQiBWoiBiAFIAhqKAIAIAUgCWooAgBqIgU2AgACQCAGAn8gACgCECAFSARAIAUgACgCFGsM\n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\naiIFIAlHDQALCyAGKAIIKAJAKAIAIAxqIAMgBBAHGiAEIAxqIQwgC0EBaiILIAFHDQALDAULQQAh\nACABQQFHBEAgAUF+cSEFA0AgBigCCCgCQCgCACAAaiADIAQQBxogACAEaiIAIAYoAggoAkAoAgBq\nIAMgBBAHGiAAIARqIQAgAkECaiICIAVHDQALCyABQQFxRQ0EIAYoAggoAkAoAgAgAGogAyAEEAca\nDAQLIAAtABgiAEEBdCIEEAYhAyAGKAIQIgIoAlAEfyACKAIAKAIAIAIoAjBqBUEACyEJIAFFDQMg\nAARAIABB/AFxIQ0gAEEDcSEKQQAhAiAAQQRJIQ4DQEEAIQBBACEFIA5FBEADQCADIABBAXQiB2og\nCSACQQJ0aiIIKAIAOwEAIAMgB0ECcmogCCgCBDsBACADIAdBBHJqIAgoAgg7AQAgAyAHQQZyaiAI\nKAIMOwEAIABBBGohACACQQRqIQIgBUEEaiIFIA1HDQALC0EAIQUgCgRAA0AgAyAAQQF0aiAJIAJB\nAnRqKAIAOwEAIABBAWohACACQQFqIQIgBUEBaiIFIApHDQALCyAGKAIIKAJAKAIAIAtqIAMgBBAH\nGiAEIAtqIQsgDEEBaiIMIAFHDQALDAQLQQAhACABQQFHBEAgAUF+cSEFQQAhAgNAIAYoAggoAkAo\nAgAgAGogAyAEEAcaIAAgBGoiACAGKAIIKAJAKAIAaiADIAQQBxogACAEaiEAIAJBAmoiAiAFRw0A\nCwsgAUEBcUUNAyAGKAIIKAJAKAIAIABqIAMgBBAHGgwDCyAALQAYIgBBAXQiBBAGIQMgBigCECIC\nKAJQBH8gAigCACgCACACKAIwagVBAAshCSABRQ0CIAAEQCAAQfwBcSENIABBA3EhCkEAIQIgAEEE\nSSEOA0BBACEAQQAhBSAORQRAA0AgAyAAQQF0IgdqIAkgAkECdGoiCCgCADsBACADIAdBAnJqIAgo\nAgQ7AQAgAyAHQQRyaiAIKAIIOwEAIAMgB0EGcmogCCgCDDsBACAAQQRqIQAgAkEEaiECIAVBBGoi\nBSANRw0ACwtBACEFIAoEQANAIAMgAEEBdGogCSACQQJ0aigCADsBACAAQQFqIQAgAkEBaiECIAVB\nAWoiBSAKRw0ACwsgBigCCCgCQCgCACALaiADIAQQBxogBCALaiELIAxBAWoiDCABRw0ACwwDC0EA\nIQAgAUEBRwRAIAFBfnEhBUEAIQIDQCAGKAIIKAJAKAIAIABqIAMgBBAHGiAAIARqIgAgBigCCCgC\nQCgCAGogAyAEEAcaIAAgBGohACACQQJqIgIgBUcNAAsLIAFBAXFFDQIgBigCCCgCQCgCACAAaiAD\nIAQQBxoMAgsgAC0AGCIAQQJ0IgQQBiEDIAYoAhAiAigCUAR/IAIoAgAoAgAgAigCMGoFQQALIQkg\nAUUNASAABEAgAEH8AXEhDSAAQQNxIQpBACECIABBBEkhDgNAQQAhAEEAIQUgDkUEQANAIAMgAEEC\ndCIHaiAJIAJBAnRqIggoAgA2AgAgAyAHQQRyaiAIKAIENgIAIAMgB0EIcmogCCgCCDYCACADIAdB\nDHJqIAgoAgw2AgAgAEEEaiEAIAJBBGohAiAFQQRqIgUgDUcNAAsLQQAhBSAKBEADQCADIABBAnRq\nIAkgAkECdGooAgA2AgAgAEEBaiEAIAJBAWohAiAFQQFqIgUgCkcNAAsLIAYoAggoAkAoAgAgC2og\nAyAEEAcaIAQgC2ohCyAMQQFqIgwgAUcNAAsMAgtBACEAIAFBAUcEQCABQX5xIQVBACECA0AgBigC\nCCgCQCgCACAAaiADIAQQBxogACAEaiIAIAYoAggoAkAoAgBqIAMgBBAHGiAAIARqIQAgAkECaiIC\nIAVHDQALCyABQQFxRQ0BIAYoAggoAkAoAgAgAGogAyAEEAcaDAELIAAtABgiAEECdCIEEAYhAyAG\nKAIQIgIoAlAEfyACKAIAKAIAIAIoAjBqBUEACyEJIAFFDQAgAARAIABB/AFxIQ0gAEEDcSEKQQAh\nAiAAQQRJIQ4DQEEAIQBBACEFIA5FBEADQCADIABBAnQiB2ogCSACQQJ0aiIIKAIANgIAIAMgB0EE\ncmogCCgCBDYCACADIAdBCHJqIAgoAgg2AgAgAyAHQQxyaiAIKAIMNgIAIABBBGohACACQQRqIQIg\nBUEEaiIFIA1HDQALC0EAIQUgCgRAA0AgAyAAQQJ0aiAJIAJBAnRqKAIANgIAIABBAWohACACQQFq\nIQIgBUEBaiIFIApHDQALCyAGKAIIKAJAKAIAIAtqIAMgBBAHGiAEIAtqIQsgDEEBaiIMIAFHDQAL\nDAELQQAhACABQQFHBEAgAUF+cSEFQQAhAgNAIAYoAggoAkAoAgAgAGogAyAEEAcaIAAgBGoiACAG\nKAIIKAJAKAIAaiADIAQQBxogACAEaiEAIAJBAmoiAiAFRw0ACwsgAUEBcUUNACAGKAIIKAJAKAIA\nIABqIAMgBBAHGgsgAxAFQQEhAwsgAwuGEwEIfyMAQTBrIgckAAJAIAJBAUcNACAAKAIEIQMgACgC\nDCEFIAdBADYCKCAHQgA3AyAgB0IANwMYIAdCADcDECAHQgA3AwgCfyAHQQhqIQICQAJAIAFBfkYN\nACADKAIEKAIIIAVBAnRqKAIAIQogAyADKAIAKAIIEQAAQQFGBEACfyADLwEkGiMAQSBrIgYkACAD\nKAIEKAIIIAVBAnRqKAIAIQQgAyADKAIAKAIIEQAAIQACQAJAIAFBAWtBBUsNACAAQQFHDQAgAyAD\nKAIAKAIkEQAAIQggAyAFIAMoAgAoAiwRAQAhACAIRQ0AIABFDQAgAyAFIAMoAgAoAigRAQAiBQRA\nIAMoAiwhAyAGIAU2AgwgBiADNgIIIAYgADYCFCAGIABBDGo2AhACfyAGQQhqIQNBACEAAkACQAJA\nAkACQAJAIAFBAWsOBgAEBAECAwQLQTwQBiIAIAQ2AgQgAEGQFzYCACAAIAIpAgA3AgggACACKQII\nNwIQIAAgAikCEDcCGCAAQQA2AiggAEIANwIgIAIoAhwiASACKAIYIgRHBEAgASAEayIBQQBIDQkg\nACABEAYiBTYCICAAIAUgAUF8cWo2AiggACAFIAQgARAHIAFqNgIkCyAAIAMpAgA3AiwgACADKQII\nNwI0IABBzBE2AgAgAAwFC0HwABAGIgAgBDYCBCAAQZAXNgIAIAAgAikCADcCCCAAIAIpAgg3AhAg\nACACKQIQNwIYIABBADYCKCAAQgA3AiAgAigCHCIBIAIoAhgiBEcEQCABIARrIgFBAEgNCCAAIAEQ\nBiIFNgIgIAAgBSABQXxxajYCKCAAIAUgBCABEAcgAWo2AiQLIAAgAykCADcCLCAAIAMpAgg3AjQg\nAEIANwI8IABByBc2AgAgAEIANwJEIABCADcCTCAAQgA3AlQgAEIANwJcIABCADcCZCAAQQA2Amwg\nAAwEC0HoABAGIgAgBDYCBCAAQZAXNgIAIAAgAikCADcCCCAAIAIpAgg3AhAgACACKQIQNwIYIABB\nADYCKCAAQgA3AiAgAigCHCIBIAIoAhgiBEcEQCABIARrIgFBAEgNAyAAIAEQBiIFNgIgIAAgBSAB\nQXxxajYCKCAAIAUgBCABEAcgAWo2AiQLIAAgAykCADcCLCAAIAMpAgg3AjQgAEEANgJUIABCADcC\nTCAAQgA3AjwgAEHAGTYCACAAIAMpAgA3AlggACADKQIINwJgIAAMAwsCf0GAARAGIgAgBDYCBCAA\nQZAXNgIAIAAgAikCADcCCCAAIAIpAgg3AhAgACACKQIQNwIYIABBADYCKCAAQgA3AiACQCACKAIc\nIgEgAigCGCIERwRAIAEgBGsiBEEASA0BIAAgBBAGIgE2AiAgACABNgIkIAAgASAEQXxxajYCKCAA\nIAIoAhwgAigCGCIFayIEQQBKBH8gASAFIAQQByAEagUgAQs2AiQLIABB2BY2AgAgACADKQIANwIs\nIAAgAykCCDcCNCAAQUBrQgA3AgAgAEGgIDYCPCAAQawbNgIAIAAgAykCADcCSCAAIAMpAgg3AlAg\nAEKAgID8czcCaCAAQn83AmAgAEKBgICAcDcCWCAAQZgdNgI8IABCADcCcCAAQgA3AHUgAAwBCxAJ\nAAshAAsgAAwBCwwDCyEJDAELIAMoAiwhAyAGIAg2AgwgBiADNgIIIAYgADYCFCAGIABBDGo2AhAC\nfyAGQQhqIQNBACEAAkACQAJAAkACQAJAIAFBAWsOBgAEBAECAwQLQTwQBiIAIAQ2AgQgAEGQFzYC\nACAAIAIpAgA3AgggACACKQIINwIQIAAgAikCEDcCGCAAQQA2AiggAEIANwIgIAIoAhwiASACKAIY\nIgRHBEAgASAEayIBQQBIDQggACABEAYiBTYCICAAIAUgAUF8cWo2AiggACAFIAQgARAHIAFqNgIk\nCyAAIAMpAgA3AiwgACADKQIINwI0IABBvCA2AgAgAAwFC0HwABAGIgAgBDYCBCAAQZAXNgIAIAAg\nAikCADcCCCAAIAIpAgg3AhAgACACKQIQNwIYIABBADYCKCAAQgA3AiAgAigCHCIBIAIoAhgiBEcE\nQCABIARrIgFBAEgNByAAIAEQBiIFNgIgIAAgBSABQXxxajYCKCAAIAUgBCABEAcgAWo2AiQLIAAg\nAykCADcCLCAAIAMpAgg3AjQgAEIANwI8IABB5CM2AgAgAEIANwJEIABCADcCTCAAQgA3AlQgAEIA\nNwJcIABCADcCZCAAQQA2AmwgAAwEC0HoABAGIgAgBDYCBCAAQZAXNgIAIAAgAikCADcCCCAAIAIp\nAgg3AhAgACACKQIQNwIYIABBADYCKCAAQgA3AiAgAigCHCIBIAIoAhgiBEcEQCABIARrIgFBAEgN\nAyAAIAEQBiIFNgIgIAAgBSABQXxxajYCKCAAIAUgBCABEAcgAWo2AiQLIAAgAykCADcCLCAAIAMp\nAgg3AjQgAEEANgJUIABCADcCTCAAQgA3AjwgAEHQJTYCACAAIAMpAgA3AlggACADKQIINwJgIAAM\nAwsCf0GAARAGIgAgBDYCBCAAQZAXNgIAIAAgAikCADcCCCAAIAIpAgg3AhAgACACKQIQNwIYIABB\nADYCKCAAQgA3AiACQCACKAIcIgEgAigCGCIERwRAIAEgBGsiBEEASA0BIAAgBBAGIgE2AiAgACAB\nNgIkIAAgASAEQXxxajYCKCAAIAIoAhwgAigCGCIFayIEQQBKBH8gASAFIAQQByAEagUgAQs2AiQL\nIABBrCM2AgAgACADKQIANwIsIAAgAykCCDcCNCAAQUBrQgA3AgAgAEH4KzYCPCAAQbAnNgIAIAAg\nAykCADcCSCAAIAMpAgg3AlAgAEKAgID8czcCaCAAQn83AmAgAEKBgICAcDcCWCAAQYwpNgI8IABC\nADcCcCAAQgA3AHUgAAwBCxAJAAshAAsgAAwBCwwCCyEJCyAGQSBqJAAgCQwBCxAJAAsiBg0BC0Es\nEAYiBiAKNgIEIAZBkBc2AgAgBiACKQIANwIIIAYgAikCCDcCECAGIAIpAhA3AhggBkEANgIoIAZC\nADcCICACKAIcIgAgAigCGCIBRwRAIAAgAWsiAEEASA0CIAYgABAGIgI2AiAgBiACIABBfHFqNgIo\nIAYgAiABIAAQByAAajYCJAsgBkGULDYCAAsgBgwBCxAJAAshAyAHKAIgIgBFDQAgByAANgIkIAAQ\nBQsgB0EwaiQAIAMLzwECA38DfgJAIAIpAwgiCCACKQMQIgZXDQAgAigCACIEIAanaiwAACEDIAIg\nBkIBfCIHNwMQAkAgA0F+Rg0AIAcgCFkNASAEIAenaiwAACEEIAIgBkICfDcDECAEQQRrQf8BcUH7\nAUkNASAAIAMgBCAAKAIAKAIoEQMAIQQgACgCFCEDIAAgBDYCFCADRQ0AIAMgAygCACgCBBECAAsg\nACgCFCIDBEAgACADIAAoAgAoAhwRAQBFDQELIAAgASACIAAoAgAoAiQRAwAhBQsgBQsdACAAIAEo\nAgQgASgCAGtBAnUgACgCACgCMBEBAAtEAQF/An9BACAAKAIUIAAoAhAiAmtBAnUgAUwNABpBACAC\nIAFBAnRqKAIAIgFBAEgNABogACgCJCABQQJ0aigCABAzCwvRAQEDfyAAQeAPNgIAIAAoAjwhASAA\nQQA2AjwgAQRAIAEgASgCACgCBBECAAsgACgCMCIBBEAgACABNgI0IAEQBQsgACgCJCIBBEAgACgC\nKCIDIAEiAkcEQANAIANBBGsiAygCACECIANBADYCACACBEAgAiACKAIAKAIEEQIACyABIANHDQAL\nIAAoAiQhAgsgACABNgIoIAIQBQsgAEHwDTYCACAAKAIQIgEEQCAAIAE2AhQgARAFCyAAKAIEIgEE\nQCAAIAE2AgggARAFCyAAEAULzwEBA38gAEHgDzYCACAAKAI8IQEgAEEANgI8IAEEQCABIAEoAgAo\nAgQRAgALIAAoAjAiAQRAIAAgATYCNCABEAULIAAoAiQiAQRAIAAoAigiAyABIgJHBEADQCADQQRr\nIgMoAgAhAiADQQA2AgAgAgRAIAIgAigCACgCBBECAAsgASADRw0ACyAAKAIkIQILIAAgATYCKCAC\nEAULIABB8A02AgAgACgCECIBBEAgACABNgIUIAEQBQsgACgCBCIBBEAgACABNgIIIAEQBQsgAAuK\nAgBBACEAAkACQAJAAkACQCABDgQAAQIDBAtBFBAGIgBC/////w83AgwgAEIANwIEIABBgA82AgAg\nAA8LQRgQBiIAQv////8PNwIMIABCADcCBCAAQYAPNgIAIABBADYCFCAAQdgQNgIAIAAPC0EwEAYi\nAEL/////DzcCDCAAQgA3AgQgAEGADzYCACAAQQA2AhQgAEHYEDYCACAAQdgMNgIYIABBjD42AgAg\nAEIANwIgIABBfzYCHCAAQgA3AiggAA8LQSAQBiIAQv////8PNwIMIABCADcCBCAAQYAPNgIAIABB\nADYCFCAAQdgQNgIAIABBiAg2AhggAEG0LTYCACAAQX82AhwLIAALtwkCEX8BfiMAQRBrIgYkAAJA\nIAAgACgCACgCGBEAACINQQBMDQAgAEEwaiERQQEhDgNAAkACQCAAIAAoAgAoAhwRAAAoAihFDQAg\nCkECdCIDIAAoAiRqKAIAIgQoAgghAiAEEDMiBUUNACAAIAAoAgAoAhwRAAAoAighBCAGIAIoAjg2\n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\nKAIIIAlqKAIAIgMgASADKAIAKAIUEQEAIgggACgCGCAAKAIUIgNrQQJ1IgVJDQAgBSAIQQFqIgZJ\nBEAgByAGIAVrEAogBygCACEDDAELIAUgBk0NACAAIAMgBkECdGo2AhgLIAMgCEECdGogAjYCACAB\nQQFqIgEgCkcNAAsLIAJBAWoiAiAERw0ACwtBACAAIAAoAgAoAhwRAABFDQAaIAAgACgCACgCIBEA\nAAsPC0EAC7ABAQV/AkACQCAAKAIIIgFBAEgNAAJ/IAAoAgQiAigCBCACKAIAIgRrQQJ1IgMgAUkE\nQCACIAEgA2sQCiAAKAIIDAELIAEgASADTw0AGiACIAQgAUECdGo2AgQgAQsiBUEATA0AIAAoAgQi\nAigCBCACKAIAIgNrQQJ1IQRBACEAA0AgACAERg0CIAMgAEECdGogADYCACAAQQFqIgAgBUcNAAsL\nIAFBf3NBH3YPCxAOAAsVACABQQE6AFQgASABKAJENgJIQQELJQEBfyAAQdgMNgIAIAAoAggiAQRA\nIAAgATYCDCABEAULIAAQBQuAAQEDfyAAQbDOADYCACAAKAIUIgIEQCAAIAI2AhggAhAFCyAAKAII\nIgIEQCAAKAIMIgMgAiIBRwRAA0AgA0EEayIDKAIAIQEgA0EANgIAIAEEQCABIAEoAgAoAgQRAgAL\nIAIgA0cNAAsgACgCCCEBCyAAIAI2AgwgARAFCyAAEAULhQIBBn9BwAAQBiEEQQwQBiICIAAoAgQo\nAlA2AgggAkHwzQA2AgAgAkEANgIEIAQgAhB9IQQCQAJAIAFBAEgEQCAEIQIMAQsgAEEIaiEHAkAg\nACgCDCICIAAoAggiBWtBAnUiBiABSg0AIAFBAWohAyABIAZPBEAgByADIAZrEFkMAQsgAyAGTw0A\nIAUgA0ECdGoiBSACRwRAA0AgAkEEayICKAIAIQMgAkEANgIAIAMEQCADIAMoAgAoAgQRAgALIAIg\nBUcNAAsLIAAgBTYCDAsgBygCACABQQJ0aiIAKAIAIQIgACAENgIAIAJFDQELIAIgAigCACgCBBEC\nAAsgAUF/c0EfdgudCgINfwR+IwBBIGsiASQAAkBBASABQRxqIAAoAiAQOEUNAEEBIAFBGGogACgC\nIBA4RQ0AIAEoAhwiBkHVqtWqBUsNACAGrSIQIAAoAiAiAikDCCIPIAIpAxAiDn1CA39WDQAgASgC\n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\nASAAKAIAKAIQEQEACxYAIAAoAjAiACABIAAoAgAoAgwRAQALFAAgACgCMCIAIAAoAgAoAiQRAAAL\nqAEBA38gAEHwPzYCACAAKAIwIQEgAEEANgIwIAEEQCABIAEoAgAoAgQRAgALIABBsM4ANgIAIAAo\nAhQiAQRAIAAgATYCGCABEAULIAAoAggiAQRAIAAoAgwiAyABIgJHBEADQCADQQRrIgMoAgAhAiAD\nQQA2AgAgAgRAIAIgAigCACgCBBECAAsgASADRw0ACyAAKAIIIQILIAAgATYCDCACEAULIAAQBQum\nAQEDfyAAQfA/NgIAIAAoAjAhASAAQQA2AjAgAQRAIAEgASgCACgCBBECAAsgAEGwzgA2AgAgACgC\nFCIBBEAgACABNgIYIAEQBQsgACgCCCIBBEAgACgCDCIDIAEiAkcEQANAIANBBGsiAygCACECIANB\nADYCACACBEAgAiACKAIAKAIEEQIACyABIANHDQALIAAoAgghAgsgACABNgIMIAIQBQsgAAsUACAA\nKAIwIgAgACgCACgCHBEAAAsUACAAKAIwIgAgACgCACgCGBEAAAvVBQICfwF+IAAoAiAiASkDCCAB\nKQMQIgNVBH8gASgCACADp2otAAAhAiABIANCAXw3AxAgACgCMCEBIABBADYCMCABBEAgASABKAIA\nKAIEEQIACwJAAkACfwJAAkAgAg4DAAMBAwtBgAMQBiIBQdzAADYCACABQQRqQQBB0AAQCBogAUIA\nNwNgIAFBfzYCXCABQn83AlQgAUIANwNoIAFCADcDcCABQgA3A3ggAUIANwOAASABQgA3A4gBIAFC\nADcDkAEgAUIANwKcASABQYCAgPwDNgKYASABQgA3AqQBIAFCADcCrAEgAUIANwK0ASABQgA3ArwB\nIAFCADcCxAEgAUIANwLMASABQv////8PNwLUASABQgA3AtwBIAFB6AFqEB4aIAFBkAJqEB4aIAFB\nuAJqIgJCADcCACACQgA3AAUgAUHIAmoQHhogAUEANgL4AiABQgA3A/ACIAEMAQtBuAMQBiIBQZDB\nADYCACABQQRqQQBB0AAQCBogAUIANwNgIAFBfzYCXCABQn83AlQgAUIANwNoIAFCADcDcCABQgA3\nA3ggAUIANwOAASABQgA3A4gBIAFCADcDkAEgAUIANwKcASABQYCAgPwDNgKYASABQgA3AqQBIAFC\n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\nIAwBCyAGQRBqQQxyIAQgA2sgBhAQCyAGQQA2AgACQCAEIAYoAiwgBigCKCIFa0ECdSIDTQRAIAMg\nBE0NASAGIAUgBEECdGo2AiwMAQsgBkEoaiAEIANrIAYQEAsgBkEANgIAAkAgBCAGKAI4IAYoAjQi\nBWtBAnUiA00EQCADIARNDQEgBiAFIARBAnRqNgI4DAELIAZBNGogBCADayAGEBALAkAgACgCCEEA\nTA0AIAYoAhAhCCAAKAIgIQlBACEHA0ACQCAIIAdBAnQiA2ooAgAiBSAAKAIQIgxKBEAgAyAJaiAM\nNgIADAELIAMgCWohAyAAKAIMIgwgBUoEQCADIAw2AgAMAQsgAyAFNgIACyAHQQFqIgcgACgCCCID\nSA0ACyADQQBMDQBBACEDA0AgAiADQQJ0IgVqIgggASAFaigCACAFIAlqKAIAaiIFNgIAAkAgCAJ/\nIAAoAhAgBUgEQCAFIAAoAhRrDAELIAUgACgCDE4NASAAKAIUIAVqCzYCAAsgA0EBaiIDIAAoAghI\nDQALCyAAKAI0IR4gACgCMCEYQRAQBiIXQgA3AgAgF0IANwIIIAZBADYCCCAGQgA3AwACQCAEBEAg\nBEGAgICABE8NASAGIARBAnQiAxAGIhI2AgAgBiADIBJqNgIIIBJBACADEAgaCwJAIAAoAjgiAygC\nBCADKAIAIh9rIgNBBUgNAEECIANBAnUiFSAVQQJMGyEgQQEgFSAVQQFNGyEhIARBfnEhGSAEQQFx\nIRogBEF8cSEiIARBA3EhGyAEQQFrIRwgBEECdCEjIARBBEkhJEEBIR1BASEMA0ACQAJAAkACQCAM\nICFHBEACfwJAIB8gDEECdGooAgAiBUF/Rg0AIBgoAgwiCyAFQQFrIAVBAmoiAyAFQQNwIggbQQJ0\naiEQQQAhCSAIQQBHIANBf0dyIRRBASENIAUhAwJAA0ACQCALIANBAnRqKAIAIghBf0YNAEF/IQog\nHigCACIOIBgoAgAiESAIQQJ0aigCAEECdGohByAIQQFqIg8gCEECayAPQQNwGyIPQX9HBEAgESAP\nQQJ0aigCACEKCyAGQRBqIAlBDGxqKAIAIQ8gBygCACETIA4gCkECdGooAgAhCgJ/AkAgCEEDcARA\nIAhBAWshBwwBC0F/IAhBAmoiB0F/Rg0BGgsgESAHQQJ0aigCAAshCCAMIBNMDQAgCiAMTg0AIA4g\n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\nIAYhBwNAIAlCAYYhCSAHQgdWIQMgB0ICiCEHIAMNAAsMBAsgGSACIBsgHkoEfyAeQQF0BSAbQQBM\nBEAgGUIANwIIDAILIBtBAXRBAmsLQQJ0aiIDKAIANgIIIBkgAygCBDYCDAtBASEaDAQLEA4ACyAG\nIgmnQQFrDQELA0AgBiAJgCAJfEIBiCIJIAl+IAZWDQALCyAZKAIUIhcEQCAZKAIQIBdBAWsiGEED\ndkH8////AXFqKAIAIQMgGSAYNgIUIBkgDSAcrCAPfSIQfiAIIA9+fEIAIAkgBKwgDn0iB34iBn0g\nBiADIBh2QQFxIgMbfCAIfz4CDCAZIAcgDX4gCCAOfnwgCSAQfiIGQgAgBn0gAxt8IAh/PgIICyAX\nQQBHIRoLIBZB0ABqJAAgGkUNAQJAIAAoAghBAEwNACACIBtBA3QiF2ohGCAfKAIAIR1BACEDA0AC\nQCAiIANBAnQiBWooAgAiHCAAKAIQIgRKBEAgBSAdaiAENgIADAELIAUgHWohBSAAKAIMIgQgHEoE\nQCAFIAQ2AgAMAQsgBSAcNgIACyADQQFqIgMgACgCCCIFSA0AC0EAIQQgBUEATA0AIAEgF2ohBQNA\nIBggBEECdCIXaiIDIAUgF2ooAgAgFyAdaigCAGoiFzYCAAJAIAMCfyAAKAIQIBdIBEAgFyAAKAIU\nawwBCyAXIAAoAgxODQEgACgCFCAXags2AgALIARBAWoiBCAAKAIISA0ACwsgG0EBaiIbICBIIQUg\nGyAhRw0ACwsgBUEBcwVBAAtBAXEPCxAOAAsuAQF/AkAgASgCWCIBRQ0AIAEoAgBBAkcNACAAIAEo\nAggoAAA2AgRBASECCyACCwvbUggAQYQIC7E9YAQAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgA\nAAAJAAAACgAAAAsAAAAMAAAADQAAAE41ZHJhY28yOEF0dHJpYnV0ZU9jdGFoZWRyb25UcmFuc2Zv\ncm1FAADYKwAAOAQAAOAGAABfX25leHRfcHJpbWUgb3ZlcmZsb3cAdmVjdG9yAHN0ZDo6ZXhjZXB0\naW9uAHNraXBfYXR0cmlidXRlX3RyYW5zZm9ybQBiYWRfYXJyYXlfbmV3X2xlbmd0aABiYXNpY19z\ndHJpbmcAc3RkOjpiYWRfYWxsb2MARFJBQ08AVXNpbmcgaW5jb21wYXRpYmxlIGRlY29kZXIgZm9y\nIHRoZSBpbnB1dCBnZW9tZXRyeS4ARmFpbGVkIHRvIGRlY29kZSBwb2ludCBhdHRyaWJ1dGVzLgBG\nYWlsZWQgdG8gaW5pdGlhbGl6ZSB0aGUgZGVjb2Rlci4AVW5zdXBwb3J0ZWQgbWlub3IgdmVyc2lv\nbi4AVW5zdXBwb3J0ZWQgbWFqb3IgdmVyc2lvbi4ASW5wdXQgaXMgbm90IGEgbWVzaC4AVW5zdXBw\nb3J0ZWQgZ2VvbWV0cnkgdHlwZS4ATm90IGEgRHJhY28gZmlsZS4AVW5zdXBwb3J0ZWQgZW5jb2Rp\nbmcgbWV0aG9kLgBGYWlsZWQgdG8gZGVjb2RlIG1ldGFkYXRhLgBGYWlsZWQgdG8gZGVjb2RlIGdl\nb21ldHJ5IGRhdGEuAFB1cmUgdmlydHVhbCBmdW5jdGlvbiBjYWxsZWQhAAAAAAAAALQGAAAPAAAA\nEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAALAAAAGAAAABkAAABONWRyYWNvMzBBdHRy\naWJ1dGVRdWFudGl6YXRpb25UcmFuc2Zvcm1FAAAAANgrAACIBgAA4AYAAE41ZHJhY28xOEF0dHJp\nYnV0ZVRyYW5zZm9ybUUAAAAAsCsAAMAGAAAAAAAAbAcAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAA\nACAAAAAhAAAAIgAAACMAAAAkAAAAJQAAAE41ZHJhY28xN0F0dHJpYnV0ZXNEZWNvZGVyRQBONWRy\nYWNvMjZBdHRyaWJ1dGVzRGVjb2RlckludGVyZmFjZUUAAAAAsCsAADwHAADYKwAAIAcAAGQHAAAA\nAAAAzAcAACYAAAAnAAAAKAAAACkAAAAqAAAAKwAAACwAAAAtAAAALgAAAE41ZHJhY28yNlNlcXVl\nbnRpYWxBdHRyaWJ1dGVEZWNvZGVyRQAAAACwKwAApAcAAP////8AAAAARAgAAC8AAAAwAAAAHAAA\nADEAAAAyAAAAHwAAACAAAAAhAAAAMwAAADQAAAA1AAAANgAAADcAAABONWRyYWNvMzdTZXF1ZW50\naWFsQXR0cmlidXRlRGVjb2RlcnNDb250cm9sbGVyRQDYKwAAFAgAAGwHAAAAAAAAuAgAADgAAAA5\nAAAAOgAAACkAAAAqAAAAKwAAADsAAAAtAAAAPAAAAD0AAAA+AAAAPwAAAEAAAABONWRyYWNvMzNT\nZXF1ZW50aWFsSW50ZWdlckF0dHJpYnV0ZURlY29kZXJFANgrAACMCAAAzAcAAAAAAABECwAAQQAA\nAEIAAABDAAAARAAAAEUAAABGAAAARwAAAEgAAABJAAAASgAAAEsAAABMAAAATjVkcmFjbzQwTWVz\naFByZWRpY3Rpb25TY2hlbWVQYXJhbGxlbG9ncmFtRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2No\nZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0\nYUlOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVFRUVFAE41ZHJhY28yN01lc2hQcmVkaWN0\naW9uU2NoZW1lRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNm\nb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1dGVD\nb3JuZXJUYWJsZUVFRUVFAE41ZHJhY28yM1ByZWRpY3Rpb25TY2hlbWVEZWNvZGVySWlOU18zN1By\nZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRUVFAE41ZHJhY28zN1ByZWRp\nY3Rpb25TY2hlbWVUeXBlZERlY29kZXJJbnRlcmZhY2VJaWlFRQBONWRyYWNvMzJQcmVkaWN0aW9u\nU2NoZW1lRGVjb2RlckludGVyZmFjZUUATjVkcmFjbzI1UHJlZGljdGlvblNjaGVtZUludGVyZmFj\nZUUAsCsAAOgKAADYKwAAvQoAAAwLAADYKwAAiQoAABQLAADYKwAANQoAACALAADYKwAAnwkAACwL\nAADYKwAA/AgAADgLAAAAAAAAOAsAAEEAAABNAAAAIwAAAEQAAAAjAAAARgAAAEcAAABIAAAASQAA\nAEoAAABLAAAAIwAAAAAAAAAsCwAAQQAAAE4AAAAjAAAARAAAACMAAABGAAAARwAAAEgAAABJAAAA\nSgAAAEsAAAAjAAAAAAAAAKwMAABPAAAAUAAAAFEAAABEAAAAUgAAAEYAAABHAAAASAAAAEkAAABK\nAAAAUwAAAFQAAABONWRyYWNvNTZNZXNoUHJlZGljdGlvblNjaGVtZUNvbnN0cmFpbmVkTXVsdGlQ\nYXJhbGxlbG9ncmFtRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJh\nbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1\ndGVDb3JuZXJUYWJsZUVFRUVFAADYKwAA+AsAADgLAAAAAAAAmA0AAFUAAABWAAAAVwAAAEQAAABY\nAAAAWQAAAFoAAABbAAAASQAAAEoAAABcAAAAXQAAAE41ZHJhY280NE1lc2hQcmVkaWN0aW9uU2No\nZW1lVGV4Q29vcmRzUG9ydGFibGVEZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVj\nb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0TWVz\naEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUAANgrAADwDAAAOAsAAAAAAACEDgAAXgAAAF8AAABg\nAAAARAAAAGEAAABiAAAAYwAAAGQAAABJAAAASgAAAGUAAABmAAAATjVkcmFjbzQyTWVzaFByZWRp\nY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxEZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVX\ncmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5T\nXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUAAAAA2CsAANwNAAA4CwAAAAAAAAwQAABn\nAAAAaAAAAGkAAABqAAAAawAAAE41ZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmlj\nTm9ybWFsUHJlZGljdG9yQXJlYUlpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJh\nbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1\ndGVDb3JuZXJUYWJsZUVFRUVFAE41ZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmlj\nTm9ybWFsUHJlZGljdG9yQmFzZUlpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJh\nbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1\ndGVDb3JuZXJUYWJsZUVFRUVFAAAAsCsAAFcPAADYKwAArA4AAAQQAAAAAAAABBAAAGcAAABsAAAA\nIwAAAGoAAAAjAAAAAAAAAJgRAABBAAAAbQAAAG4AAABEAAAAbwAAAEYAAABHAAAASAAAAEkAAABK\nAAAASwAAAHAAAABONWRyYWNvNDBNZXNoUHJlZGljdGlvblNjaGVtZVBhcmFsbGVsb2dyYW1EZWNv\nZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0\nTWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQBONWRyYWNvMjdN\nZXNoUHJlZGljdGlvblNjaGVtZURlY29kZXJJaU5TXzM3UHJlZGljdGlvblNjaGVtZVdyYXBEZWNv\nZGluZ1RyYW5zZm9ybUlpaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMTFDb3Ju\nZXJUYWJsZUVFRUVFAADYKwAAAhEAACwLAADYKwAAbBAAAIwRAAAAAAAAjBEAAEEAAABxAAAAIwAA\nAEQAAAAjAAAARgAAAEcAAABIAAAASQAAAEoAAABLAAAAIwAAAAAAAAC8EgAAcgAAAHMAAAB0AAAA\nRAAAAHUAAABGAAAARwAAAEgAAABJAAAASgAAAHYAAAB3AAAATjVkcmFjbzU2TWVzaFByZWRpY3Rp\nb25TY2hlbWVDb25zdHJhaW5lZE11bHRpUGFyYWxsZWxvZ3JhbURlY29kZXJJaU5TXzM3UHJlZGlj\ndGlvblNjaGVtZVdyYXBEZWNvZGluZ1RyYW5zZm9ybUlpaUVFTlNfMjRNZXNoUHJlZGljdGlvblNj\naGVtZURhdGFJTlNfMTFDb3JuZXJUYWJsZUVFRUVFAAAA2CsAABQSAACMEQAAAAAAAJwTAAB4AAAA\neQAAAHoAAABEAAAAewAAAHwAAAB9AAAAfgAAAEkAAABKAAAAfwAAAIAAAABONWRyYWNvNDRNZXNo\nUHJlZGljdGlvblNjaGVtZVRleENvb3Jkc1BvcnRhYmxlRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9u\nU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1l\nRGF0YUlOU18xMUNvcm5lclRhYmxlRUVFRUUAAADYKwAAABMAAIwRAAAAAAAAeBQAAIEAAACCAAAA\ngwAAAEQAAACEAAAAhQAAAIYAAACHAAAASQAAAEoAAACIAAAAiQAAAE41ZHJhY280Mk1lc2hQcmVk\naWN0aW9uU2NoZW1lR2VvbWV0cmljTm9ybWFsRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1l\nV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlO\nU18xMUNvcm5lclRhYmxlRUVFRUUA2CsAAOATAACMEQAAAAAAAOQVAACKAAAAiwAAAIwAAACNAAAA\njgAAAE41ZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmljTm9ybWFsUHJlZGljdG9y\nQXJlYUlpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18y\nNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18xMUNvcm5lclRhYmxlRUVFRUUATjVkcmFjbzQ4\nTWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxQcmVkaWN0b3JCYXNlSWlOU18zN1By\nZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rp\nb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQCwKwAAPhUAANgrAACgFAAA3BUAAAAA\nAADcFQAAigAAAI8AAAAjAAAAjQAAACMAAAAAAAAAoBYAAEEAAACQAAAAkQAAAEQAAACSAAAARgAA\nAEcAAABIAAAASQAAAEoAAABLAAAAkwAAAE41ZHJhY28yOFByZWRpY3Rpb25TY2hlbWVEZWx0YURl\nY29kZXJJaU5TXzM3UHJlZGljdGlvblNjaGVtZVdyYXBEZWNvZGluZ1RyYW5zZm9ybUlpaUVFRUUA\nAAAA2CsAAEQWAAAsCwAAAAAAABQXAACUAAAAlQAAAJYAAAApAAAAKgAAAJcAAAA7AAAALQAAADwA\nAACYAAAAmQAAAJoAAACbAAAATjVkcmFjbzMyU2VxdWVudGlhbE5vcm1hbEF0dHJpYnV0ZURlY29k\nZXJFAADYKwAA6BYAALgIAAAAAAAASBkAAJwAAACdAAAAngAAAJ8AAACgAAAAoQAAAKIAAACjAAAA\npAAAAKUAAACmAAAApwAAAE41ZHJhY280Mk1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmljTm9y\nbWFsRGVjb2RlcklpTlNfNjJQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkNhbm9uaWNh\nbGl6ZWREZWNvZGluZ1RyYW5zZm9ybUlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlO\nU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVFRUVFAE41ZHJhY28yN01lc2hQcmVkaWN0aW9u\nU2NoZW1lRGVjb2RlcklpTlNfNjJQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkNhbm9u\naWNhbGl6ZWREZWNvZGluZ1RyYW5zZm9ybUlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0\nYUlOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVFRUVFAE41ZHJhY28yM1ByZWRpY3Rpb25T\nY2hlbWVEZWNvZGVySWlOU182MlByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uQ2Fub25p\nY2FsaXplZERlY29kaW5nVHJhbnNmb3JtSWlFRUVFAADYKwAAwxgAACALAADYKwAAFRgAADAZAADY\nKwAAWBcAADwZAAAAAAAAABsAAKgAAACpAAAAqgAAAKsAAACsAAAATjVkcmFjbzQ4TWVzaFByZWRp\nY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxQcmVkaWN0b3JBcmVhSWlOU182MlByZWRpY3Rpb25T\nY2hlbWVOb3JtYWxPY3RhaGVkcm9uQ2Fub25pY2FsaXplZERlY29kaW5nVHJhbnNmb3JtSWlFRU5T\nXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxl\nRUVFRUUATjVkcmFjbzQ4TWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxQcmVkaWN0\nb3JCYXNlSWlOU182MlByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uQ2Fub25pY2FsaXpl\nZERlY29kaW5nVHJhbnNmb3JtSWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0\nTWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUAAACwKwAAMxoAANgrAABwGQAA+BoAAAAAAACk\nHAAArQAAAK4AAACvAAAAnwAAALAAAACxAAAAsgAAALMAAACkAAAApQAAALQAAAC1AAAATjVkcmFj\nbzQyTWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxEZWNvZGVySWlOU182MlByZWRp\nY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uQ2Fub25pY2FsaXplZERlY29kaW5nVHJhbnNmb3Jt\nSWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQBO\nNWRyYWNvMjdNZXNoUHJlZGljdGlvblNjaGVtZURlY29kZXJJaU5TXzYyUHJlZGljdGlvblNjaGVt\nZU5vcm1hbE9jdGFoZWRyb25DYW5vbmljYWxpemVkRGVjb2RpbmdUcmFuc2Zvcm1JaUVFTlNfMjRN\nZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMTFDb3JuZXJUYWJsZUVFRUVFAAAAANgrAAD0GwAA\nMBkAANgrAABEGwAAmBwAAAAAAABAHgAAtgAAALcAAAC4AAAAuQAAALoAAABONWRyYWNvNDhNZXNo\nUHJlZGljdGlvblNjaGVtZUdlb21ldHJpY05vcm1hbFByZWRpY3RvckFyZWFJaU5TXzYyUHJlZGlj\ndGlvblNjaGVtZU5vcm1hbE9jdGFoZWRyb25DYW5vbmljYWxpemVkRGVjb2RpbmdUcmFuc2Zvcm1J\naUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMTFDb3JuZXJUYWJsZUVFRUVFAE41\nZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmljTm9ybWFsUHJlZGljdG9yQmFzZUlp\nTlNfNjJQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkNhbm9uaWNhbGl6ZWREZWNvZGlu\nZ1RyYW5zZm9ybUlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18xMUNvcm5lclRh\nYmxlRUVFRUUAsCsAAIIdAADYKwAAzBwAADgeAAAAAAAA+B4AALsAAAC8AAAAvQAAAJ8AAAC+AAAA\nvwAAAMAAAADBAAAApAAAAKUAAADCAAAAwwAAAE41ZHJhY28yOFByZWRpY3Rpb25TY2hlbWVEZWx0\nYURlY29kZXJJaU5TXzYyUHJlZGljdGlvblNjaGVtZU5vcm1hbE9jdGFoZWRyb25DYW5vbmljYWxp\nemVkRGVjb2RpbmdUcmFuc2Zvcm1JaUVFRUUAAAAA2CsAAIQeAAAwGQAAAAAAAHwfAADEAAAAxQAA\nAMYAAAApAAAAKgAAAMcAAAA7AAAALQAAADwAAADIAAAAPgAAAD8AAADJAAAAygAAAMsAAABONWRy\nYWNvMzhTZXF1ZW50aWFsUXVhbnRpemF0aW9uQXR0cmlidXRlRGVjb2RlckUAAAAA2CsAAEgfAAC4\nCAAAAAAAANwfAADMAAAAzQAAAM4AAADPAAAAIwAAANAAAADRAAAA0gAAANMAAADUAAAA1QAAANYA\nAAAjAAAATjVkcmFjbzExTWVzaERlY29kZXJFAAAA2CsAAMQfAACcJwAAAAAAAEggAADXAAAA2AAA\nAM4AAADZAAAA2gAAANAAAADRAAAA0gAAANsAAADcAAAA3QAAAN4AAADfAAAATjVkcmFjbzIyTWVz\naEVkZ2VicmVha2VyRGVjb2RlckUAAAAA2CsAACQgAADcHwAAAAAAADwhAADgAAAA4QAAAOIAAADj\nAAAA5AAAAOUAAADmAAAA5wAAAOgAAADpAAAA/////wAAAACcIQAA6gAAAOsAAADsAAAA7QAAAO4A\nAADvAAAA8AAAAPEAAADyAAAA8wAAAE41ZHJhY28yNk1lc2hFZGdlYnJlYWtlckRlY29kZXJJbXBs\nSU5TXzMxTWVzaEVkZ2VicmVha2VyVHJhdmVyc2FsRGVjb2RlckVFRQBONWRyYWNvMzVNZXNoRWRn\nZWJyZWFrZXJEZWNvZGVySW1wbEludGVyZmFjZUUAAACwKwAABCEAANgrAAC4IAAANCEAAE41ZHJh\nY28yNk1lc2hFZGdlYnJlYWtlckRlY29kZXJJbXBsSU5TXzM4TWVzaEVkZ2VicmVha2VyVHJhdmVy\nc2FsVmFsZW5jZURlY29kZXJFRUUAANgrAABIIQAANCEAAAAAAACYIgAA9AAAAPUAAAD2AAAATjVk\ncmFjbzE5RGVwdGhGaXJzdFRyYXZlcnNlcklOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVO\nU18zNk1lc2hBdHRyaWJ1dGVJbmRpY2VzRW5jb2RpbmdPYnNlcnZlcklTMV9FRUVFAE41ZHJhY28x\nM1RyYXZlcnNlckJhc2VJTlNfMjRNZXNoQXR0cmlidXRlQ29ybmVyVGFibGVFTlNfMzZNZXNoQXR0\ncmlidXRlSW5kaWNlc0VuY29kaW5nT2JzZXJ2ZXJJUzFfRUVFRQCwKwAAKSIAANgrAAC8IQAAkCIA\nAAAAAACQIgAA9wAAAPgAAAD2AEHExQALtgcBAAAAAwAAAAUAAAAHAAAAAAAAAJgjAAD5AAAA+gAA\nAPsAAAD8AAAATjVkcmFjbzIyTWVzaFRyYXZlcnNhbFNlcXVlbmNlcklOU18yOE1heFByZWRpY3Rp\nb25EZWdyZWVUcmF2ZXJzZXJJTlNfMTFDb3JuZXJUYWJsZUVOU18zNk1lc2hBdHRyaWJ1dGVJbmRp\nY2VzRW5jb2RpbmdPYnNlcnZlcklTMl9FRUVFRUUATjVkcmFjbzE1UG9pbnRzU2VxdWVuY2VyRQAA\nAACwKwAAcyMAANgrAADsIgAAkCMAAP////8AAAAAiCQAAP0AAAD+AAAA/wAAAE41ZHJhY28yOE1h\neFByZWRpY3Rpb25EZWdyZWVUcmF2ZXJzZXJJTlNfMTFDb3JuZXJUYWJsZUVOU18zNk1lc2hBdHRy\naWJ1dGVJbmRpY2VzRW5jb2RpbmdPYnNlcnZlcklTMV9FRUVFAE41ZHJhY28xM1RyYXZlcnNlckJh\nc2VJTlNfMTFDb3JuZXJUYWJsZUVOU18zNk1lc2hBdHRyaWJ1dGVJbmRpY2VzRW5jb2RpbmdPYnNl\ncnZlcklTMV9FRUVFAACwKwAAJSQAANgrAAC8IwAAgCQAAAAAAACAJAAAAAEAAAEBAAD/AAAAAAAA\nAEAlAAACAQAAAwEAAAQBAAAFAQAATjVkcmFjbzIyTWVzaFRyYXZlcnNhbFNlcXVlbmNlcklOU18x\nOURlcHRoRmlyc3RUcmF2ZXJzZXJJTlNfMTFDb3JuZXJUYWJsZUVOU18zNk1lc2hBdHRyaWJ1dGVJ\nbmRpY2VzRW5jb2RpbmdPYnNlcnZlcklTMl9FRUVFRUUAAADYKwAAwCQAAJAjAAAAAAAAwCUAAAYB\nAAAHAQAA/wAAAE41ZHJhY28xOURlcHRoRmlyc3RUcmF2ZXJzZXJJTlNfMTFDb3JuZXJUYWJsZUVO\nU18zNk1lc2hBdHRyaWJ1dGVJbmRpY2VzRW5jb2RpbmdPYnNlcnZlcklTMV9FRUVFANgrAABgJQAA\ngCQAAAAAAABwJgAACAEAAAkBAAAKAQAACwEAAE41ZHJhY28yMk1lc2hUcmF2ZXJzYWxTZXF1ZW5j\nZXJJTlNfMTlEZXB0aEZpcnN0VHJhdmVyc2VySU5TXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxl\nRU5TXzM2TWVzaEF0dHJpYnV0ZUluZGljZXNFbmNvZGluZ09ic2VydmVySVMyX0VFRUVFRQAA2CsA\nAOQlAACQIwBBhM0AC80B3CYAAMwAAAAMAQAAzgAAAM8AAAANAQAA0AAAANEAAADSAAAA0wAAANQA\nAADVAAAA1gAAAA4BAABONWRyYWNvMjFNZXNoU2VxdWVudGlhbERlY29kZXJFANgrAAC8JgAA3B8A\nAAAAAAAcJwAADwEAABABAAARAQAAEgEAAE41ZHJhY28xNUxpbmVhclNlcXVlbmNlckUAAADYKwAA\nACcAAJAjAAAAAAAAnCcAAMwAAAATAQAAFAEAAM8AAAAjAAAAFQEAANEAAADSAAAA0wBB4M4AC21G\nYWlsZWQgdG8gcGFyc2UgRHJhY28gaGVhZGVyLgBONWRyYWNvMTdQb2ludENsb3VkRGVjb2RlckUA\nAACwKwAAficAAAEAAAABAAAAAgAAAAIAAAAEAAAABAAAAAgAAAAIAAAABAAAAAgAAAABAEHjzwAL\nhwHAAAAAwAAAAMAAAADA//////////8AAAAAICgAABYBAAAXAQAAGAEAABkBAABONWRyYWNvNE1l\nc2hFAAAA2CsAABAoAABkKAAA/////wAAAAAAAAAAZCgAABoBAAAbAQAAHAEAAB0BAABONWRyYWNv\nMTBQb2ludENsb3VkRQAAAACwKwAATCgAQfTQAAvEBAIAAAADAAAABQAAAAcAAAALAAAADQAAABEA\nAAATAAAAFwAAAB0AAAAfAAAAJQAAACkAAAArAAAALwAAADUAAAA7AAAAPQAAAEMAAABHAAAASQAA\nAE8AAABTAAAAWQAAAGEAAABlAAAAZwAAAGsAAABtAAAAcQAAAH8AAACDAAAAiQAAAIsAAACVAAAA\nlwAAAJ0AAACjAAAApwAAAK0AAACzAAAAtQAAAL8AAADBAAAAxQAAAMcAAADTAAAAAQAAAAsAAAAN\nAAAAEQAAABMAAAAXAAAAHQAAAB8AAAAlAAAAKQAAACsAAAAvAAAANQAAADsAAAA9AAAAQwAAAEcA\nAABJAAAATwAAAFMAAABZAAAAYQAAAGUAAABnAAAAawAAAG0AAABxAAAAeQAAAH8AAACDAAAAiQAA\nAIsAAACPAAAAlQAAAJcAAACdAAAAowAAAKcAAACpAAAArQAAALMAAAC1AAAAuwAAAL8AAADBAAAA\nxQAAAMcAAADRAAAAMDAwMTAyMDMwNDA1MDYwNzA4MDkxMDExMTIxMzE0MTUxNjE3MTgxOTIwMjEy\nMjIzMjQyNTI2MjcyODI5MzAzMTMyMzMzNDM1MzYzNzM4Mzk0MDQxNDI0MzQ0NDU0NjQ3NDg0OTUw\nNTE1MjUzNTQ1NTU2NTc1ODU5NjA2MTYyNjM2NDY1NjY2NzY4Njk3MDcxNzI3Mzc0NzU3Njc3Nzg3\nOTgwODE4MjgzODQ4NTg2ODc4ODg5OTA5MTkyOTM5NDk1OTY5Nzk4OTkAQcTVAAuuBQoAAABkAAAA\n6AMAABAnAACghgEAQEIPAICWmAAA4fUFAMqaO04xMF9fY3h4YWJpdjExNl9fc2hpbV90eXBlX2lu\nZm9FAAAAANgrAADoKgAAbC0AAE4xMF9fY3h4YWJpdjExN19fY2xhc3NfdHlwZV9pbmZvRQAAANgr\nAAAYKwAADCsAAE4xMF9fY3h4YWJpdjExN19fcGJhc2VfdHlwZV9pbmZvRQAAANgrAABIKwAADCsA\nAE4xMF9fY3h4YWJpdjExOV9fcG9pbnRlcl90eXBlX2luZm9FANgrAAB4KwAAbCsAAAAAAAA8KwAA\nHgEAAB8BAAAgAQAAIQEAACIBAAAjAQAAJAEAACUBAAAAAAAAICwAAB4BAAAmAQAAIAEAACEBAAAi\nAQAAJwEAACgBAAApAQAATjEwX19jeHhhYml2MTIwX19zaV9jbGFzc190eXBlX2luZm9FAAAAANgr\nAAD4KwAAPCsAAAAAAACQLAAADgAAACoBAAArAQAAAAAAALgsAAAOAAAALAEAAC0BAAAAAAAAeCwA\nAA4AAAAuAQAALwEAAFN0OWV4Y2VwdGlvbgAAAACwKwAAaCwAAFN0OWJhZF9hbGxvYwAAAADYKwAA\ngCwAAHgsAABTdDIwYmFkX2FycmF5X25ld19sZW5ndGgAAAAA2CsAAJwsAACQLAAAAAAAAOgsAAAB\nAAAAMAEAADEBAABTdDExbG9naWNfZXJyb3IA2CsAANgsAAB4LAAAAAAAABwtAAABAAAAMgEAADEB\nAABTdDEybGVuZ3RoX2Vycm9yAAAAANgrAAAILQAA6CwAAAAAAABQLQAAAQAAADMBAAAxAQAAU3Qx\nMm91dF9vZl9yYW5nZQAAAADYKwAAPC0AAOgsAABTdDl0eXBlX2luZm8AAAAAsCsAAFwtAEH02gAL\nA/AvUA=="}function NodeProducer(){var e=null,t=1e6;this.AddNewNode=function(A,i){A.Level()<t&&(t=A.Level(),e=A),A.Level()===t&&i<1e6&&(i=1e6,e=A)},this.CreateNewNode=function(){null!==e&&e.CreateChildren(),e=null,t=1e3}}function QuadtreeNode2dWMTS(e,t,A,i,o,s,n,r){var a=[],d=new x3dom.nodeTypes.Shape,h=null,g=!1,l=!1,I=t._vf.textureUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.textureFormat.toLowerCase(),c=(t._vf.size.x+t._vf.size.y)/2,f={};function u(){g=!0;for(var e=0;e<d._webgl.texture.length;e++)d._webgl.texture[e].texture.ready||(g=!1);return g}this.CreateChildren=function(){var d,h,g,l,I,c,f;d=Math.sqrt(Math.pow(4,A)),h=Math.sqrt(Math.pow(4,A+1)),g=4*Math.floor(i/d)*d+i%d*2,l=g+1,c=(I=g+h)+1,f=t._vf.size.multiply(.25),a.push(new QuadtreeNode2dWMTS(e,t,A+1,g,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-f.x,f.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n,r)),a.push(new QuadtreeNode2dWMTS(e,t,A+1,l,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(f.x,f.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n,r)),a.push(new QuadtreeNode2dWMTS(e,t,A+1,I,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-f.x,-f.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n+1,r)),a.push(new QuadtreeNode2dWMTS(e,t,A+1,c,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(f.x,-f.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n+1,r))},this.Shape=function(){return d},this.Ready=function(){return void 0!==d._webgl&&void 0!==d._webgl.texture&&u()},this.collectDrawables=function(e,i,s,n,r){if(f.localMatrix=o,r=i.cull(o,f,s,r),g&&l||function(e,t){l=!0;for(var A=0;A<a.length;A++)a[A].Ready()||(l=!1);if(a.length<4)l=!1;else if(l)for(A=0;A<a.length;A++)a[A].Shape()._vf.visible=!0;void 0===d._webgl||void 0===d._webgl.texture?e.context.setupShape(e.gl,{shape:d,transform:t},e.viewarea):u()}(i,o),g&&r>=0){var I=i.viewMatrix.multMatrixPnt(o.multMatrixPnt(h)),_=Math.sqrt(Math.pow(I.x,2)+Math.pow(I.y,2)+Math.pow(I.z,2));if(_<Math.pow(t._vf.maxDepth-A,2)*c/t._vf.factor||A<t._vf.minDepth)if(t.view.isMovingOrAnimating()&&0===a.length||t.view.isMovingOrAnimating()&&A>=t._vf.interactionDepth)d.collectDrawableObjects(o,i,s,n,r,[]);else if(0===a.length)t.nodeProducer.AddNewNode(C,_),d.collectDrawableObjects(o,i,s,n,r,[]);else if(l)for(var m=0;m<a.length;m++)a[m].collectDrawables(o,i,s,n,r);else{d.collectDrawableObjects(o,i,s,n,r,[]);for(m=0;m<a.length;m++)a[m].collectDrawables(o,i,s,n,r),a[m].Shape()._vf.visible=!1}else d.collectDrawableObjects(o,i,s,n,r,[])}},this.getVolume=function(){return d.getVolume()},this.Level=function(){return A};var C=this;!function(){var A=new x3dom.nodeTypes.Appearance(e),i=new x3dom.nodeTypes.ImageTexture(e);d._nameSpace=t._nameSpace;var s=new x3dom.nodeTypes.TextureProperties(e);s._vf.boundaryModeS="CLAMP_TO_EDGE",s._vf.boundaryModeT="CLAMP_TO_EDGE",s._vf.boundaryModeR="CLAMP_TO_EDGE",s._vf.minificationFilter="LINEAR",s._vf.magnificationFilter="LINEAR",i.addChild(s,"textureProperties"),i.nodeChanged(),i._nameSpace=t._nameSpace,i._vf.url[0]=I,h=o.e3(),A.addChild(i),i.nodeChanged(),d.addChild(A),A.nodeChanged(),d.addChild(r),r.nodeChanged(),t.addChild(d),d.nodeChanged(),f.boundedNode=d,f.volume=d.getVolume()}()}function QuadtreeNode2D(e,t,A,i,o,s,n,r,a,d){var h=[],g=new x3dom.nodeTypes.Shape,l=null,I=!1,c=!1,f=t._vf.textureUrl+a+d+"."+t._vf.textureFormat,u=(t._vf.size.x+t._vf.size.y)/2,C={};function _(){I=!0;for(var e=0;e<g._webgl.texture.length;e++)g._webgl.texture[e].texture.ready||(I=!1);return I}this.CreateChildren=function(){var g,l,I,c,f,u,C;g=Math.sqrt(Math.pow(4,A)),l=Math.sqrt(Math.pow(4,A+1)),I=4*Math.floor(i/g)*g+i%g*2,c=I+1,u=(f=I+l)+1,C=t._vf.size.multiply(.25),h.push(new QuadtreeNode2D(e,t,A+1,I,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-C.x,C.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n,r,a+d+"/",1)),h.push(new QuadtreeNode2D(e,t,A+1,c,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(C.x,C.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n,r,a+d+"/",3)),h.push(new QuadtreeNode2D(e,t,A+1,f,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-C.x,-C.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n+1,r,a+d+"/",2)),h.push(new QuadtreeNode2D(e,t,A+1,u,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(C.x,-C.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n+1,r,a+d+"/",4))},this.Shape=function(){return g},this.Ready=function(){return void 0!==g._webgl&&void 0!==g._webgl.texture&&_()},this.collectDrawables=function(e,i,s,n,r){if(C.localMatrix=o,I&&c||function(e,t){c=!0;for(var A=0;A<h.length;A++)h[A].Ready()||(c=!1);if(h.length<4)c=!1;else if(c)for(A=0;A<h.length;A++)h[A].Shape()._vf.visible=!0;void 0===g._webgl||void 0===g._webgl.texture?e.context.setupShape(e.gl,{shape:g,transform:t},e.viewarea):_()}(i,o),I&&(r=i.cull(o,C,s,r))>0){var a=i.viewMatrix.multMatrixPnt(o.multMatrixPnt(l)),d=Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2)+Math.pow(a.z,2));if(d<Math.pow(t._vf.maxDepth-A,2)*u/t._vf.factor||A<t._vf.minDepth)if(t.view.isMovingOrAnimating()&&0===h.length||t.view.isMovingOrAnimating()&&A>=t._vf.interactionDepth)g.collectDrawableObjects(o,i,s,n,r,[]);else if(0===h.length)t.nodeProducer.AddNewNode(m,d),g.collectDrawableObjects(o,i,s,n,r,[]);else if(c)for(var f=0;f<h.length;f++)h[f].collectDrawables(o,i,s,n,r);else{g.collectDrawableObjects(o,i,s,n,r,[]);for(f=0;f<h.length;f++)h[f].collectDrawables(o,i,s,n,r),h[f].Shape()._vf.visible=!1}else g.collectDrawableObjects(o,i,s,n,r,[])}},this.getVolume=function(){return g.getVolume()},this.Level=function(){return A};var m=this;!function(){var A=new x3dom.nodeTypes.Appearance(e),i=new x3dom.nodeTypes.ImageTexture(e);g._nameSpace=t._nameSpace;var s=new x3dom.nodeTypes.TextureProperties(e);s._vf.boundaryModeS="CLAMP_TO_EDGE",s._vf.boundaryModeT="CLAMP_TO_EDGE",s._vf.boundaryModeR="CLAMP_TO_EDGE",s._vf.minificationFilter="LINEAR",s._vf.magnificationFilter="LINEAR",i.addChild(s,"textureProperties"),i.nodeChanged(),i._nameSpace=t._nameSpace,i._vf.url[0]=f,l=o.e3(),A.addChild(i),i.nodeChanged(),g.addChild(A),A.nodeChanged(),g.addChild(r),r.nodeChanged(),t.addChild(g),g.nodeChanged(),C.boundedNode=g,C.volume=g.getVolume()}()}function QuadtreeNode3D(e,t,A,i,o,s,n,r){var a=[],d=[],h=new x3dom.nodeTypes.Shape,g=null,l=t._vf.textureUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.textureFormat.toLowerCase(),I=t._vf.elevationUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.elevationFormat.toLowerCase();if(""!==t._vf.normalUrl)var c=t._vf.normalUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.normalFormat.toLowerCase();var f=!1,u=!1,C=(t._vf.size.x+t._vf.size.y)/2,_={},m=0,p=null;function E(){f=!0;for(var e=0;e<h._webgl.texture.length;e++)h._webgl.texture[e].texture.ready||(f=!1);return f}function B(e,A,i,s,n){for(var r=[],a=0;a<d.length;a++)void 0!==t.nodeList[d[a]]&&t.nodeList[d[a]].ChildrenReady()&&t.nodeList[d[a]].hasHigherRenderLevel(A)?r.push(!0):r.push(!1);var g=0;r[3]?g=r[1]?5:r[0]?6:4:r[2]?g=r[1]?8:r[0]?7:3:r[0]?g=1:r[1]&&(g=2),m===g&&null!==p||(p=h._cf.geometry.node.getTriangulationAttributes(g),m=g),h._tessellationProperties=[p],h.collectDrawableObjects(o,A,i,s,n,[])}this.CreateChildren=function(){var d,h,g,l,I,c,f;d=Math.sqrt(Math.pow(4,A)),h=Math.sqrt(Math.pow(4,A+1)),g=4*Math.floor(i/d)*d+i%d*2,l=g+1,c=(I=g+h)+1,f=t._vf.size.multiply(.25),a.push(new QuadtreeNode3D(e,t,A+1,g,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-f.x,f.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n,r)),a.push(new QuadtreeNode3D(e,t,A+1,l,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(f.x,f.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n,r)),a.push(new QuadtreeNode3D(e,t,A+1,I,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-f.x,-f.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n+1,r)),a.push(new QuadtreeNode3D(e,t,A+1,c,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(f.x,-f.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n+1,r))},this.Shape=function(){return h},this.ChildrenReady=function(){return u},this.Ready=function(){return void 0!==h._webgl&&void 0!==h._webgl.texture&&E()},this.collectDrawables=function(e,i,s,n,r){i.frustumCulling=!1,_.localMatrix=o,f&&u||function(e,t){u=!0;for(var A=0;A<a.length;A++)a[A].Ready()||(u=!1);if(a.length<4)u=!1;else if(u)for(A=0;A<a.length;A++)a[A].Shape()._vf.visible=!0;void 0===h._webgl||void 0===h._webgl.texture?e.context.setupShape(e.gl,{shape:h,transform:t},e.viewarea):E()}(i,o);var d=i.viewMatrix.multMatrixPnt(o.multMatrixPnt(g)),l=Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y,2)+Math.pow(d.z,2));if(f&&d.z-_.volume.diameter/2<0)if(l<Math.pow(t._vf.maxDepth-A,2)*C/t._vf.factor||A<t._vf.minDepth)if(t.view.isMovingOrAnimating()&&(0==a.length||A>=t._vf.interactionDepth))B(o,i,s,n,r);else if(0===a.length)t.nodeProducer.AddNewNode(Q,l),B(o,i,s,n,r);else if(u)for(var I=0;I<a.length;I++)a[I].collectDrawables(o,i,s,n,r);else{B(o,i,s,n,r);for(I=0;I<a.length;I++)a[I].collectDrawables(o,i,s,n,r),a[I].Shape()._vf.visible=!1}else B(o,i,s,n,r)},this.hasHigherRenderLevel=function(e){var i=e.viewMatrix.multMatrixPnt(o.multMatrixPnt(g));return Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2)+Math.pow(i.z,2))<Math.pow(t._vf.maxDepth-A,2)*C/t._vf.factor},this.getVolume=function(){return h.getVolume()},this.Level=function(){return A};var Q=this;!function(){var a=new x3dom.nodeTypes.Appearance(e),f=new x3dom.nodeTypes.MultiTexture(e),u=new x3dom.nodeTypes.ImageTexture(e),C=new x3dom.nodeTypes.ImageTexture(e),m=new x3dom.nodeTypes.ImageTexture(e),p=new x3dom.nodeTypes.ComposedShader(e);h._nameSpace=t._nameSpace,(g=o.e3()).z=t._vf.maxElevation/2;var E=new x3dom.nodeTypes.ShaderPart(e);E._vf.type="vertex",E._vf.url[0]=""!==t._vf.normalUrl?"attribute vec3 position;\nattribute vec3 texcoord;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelViewProjectionMatrix;\nuniform sampler2D texColor;\nuniform sampler2D texHeight;\nuniform float maxElevation;\nuniform sampler2D texNormal;\nvarying vec2 texC;\nvarying vec3 vLight;\nconst float shininess = 32.0;\n\nvoid main(void) {\n    vec3 uLightPosition = vec3(160.0, -9346.0, 4806.0);\n    vec4 colr = texture2D(texColor, vec2(texcoord[0], 1.0-texcoord[1]));\n    vec3 uAmbientMaterial = vec3(1.0, 1.0, 0.9);    vec3 uAmbientLight = vec3(0.5, 0.5, 0.5);    vec3 uDiffuseMaterial = vec3(0.7, 0.7, 0.7);    vec3 uDiffuseLight = vec3(1.0, 1.0, 1.0);    vec4 vertexPositionEye4 = modelViewMatrix * vec4(position, 1.0);    vec3 vertexPositionEye3 = vec3((modelViewMatrix * vec4(vertexPositionEye4.xyz, 1.0)).xyz);    vec3 vectorToLightSource = normalize(uLightPosition - vertexPositionEye3);    vec4 height = texture2D(texHeight, vec2(texcoord[0], 1.0 - texcoord[1]));\n    vec4 normalEye = 2.0 * texture2D(texNormal, vec2(texcoord[0], 1.0-texcoord[1])) - 1.0;\n    float diffuseLightWeighting = max(dot(normalEye.xyz, vectorToLightSource), 0.0);    texC = vec2(texcoord[0], 1.0-texcoord[1]);\n    vec3 diffuseReflectance = uDiffuseMaterial * uDiffuseLight * diffuseLightWeighting;    vec3 uSpecularMaterial = vec3(0.0, 0.0, 0.0);    vec3 uSpecularLight = vec3(1.0, 1.0, 1.0);    vec3 reflectionVector = normalize(reflect(-vectorToLightSource, normalEye.xyz));    vec3 viewVectorEye = -normalize(vertexPositionEye3);    float rdotv = max(dot(reflectionVector, viewVectorEye), 0.0);    float specularLightWeight = pow(rdotv, shininess);    vec3 specularReflection = uSpecularMaterial * uSpecularLight * specularLightWeight;    vLight = vec4(uAmbientMaterial * uAmbientLight + diffuseReflectance + specularReflection, 1.0).xyz;    gl_Position = modelViewProjectionMatrix * vec4(position.xy, height.x * maxElevation, 1.0);\n}\n":"attribute vec3 position;\nattribute vec3 texcoord;\nuniform mat4 modelViewProjectionMatrix;\nuniform sampler2D texHeight;\nuniform float maxElevation;\nvarying vec2 texC;\n\nvoid main(void) {\n    vec4 height = texture2D(texHeight, vec2(texcoord[0], 1.0 - texcoord[1]));\n    texC = vec2(texcoord[0], 1.0-texcoord[1]);\n    gl_Position = modelViewProjectionMatrix * vec4(position.xy, height.x * maxElevation, 1.0);\n}\n";var B=new x3dom.nodeTypes.ShaderPart(e);B._vf.type="fragment",B._vf.url[0]=""!==t._vf.normalUrl?"#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D texColor;\nuniform sampler2D texNormal;\nvarying vec2 texC;\nvarying vec3 vLight;\n\n\nvoid main(void) {\n    vec4 normal = 2.0 * texture2D(texNormal, texC) - 1.0;\n    vec4 colr = texture2D(texColor, texC);\n    gl_FragColor = vec4(colr.xyz * vLight, colr.w);\n}\n":"#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D texColor;\nvarying vec2 texC;\n\n\nvoid main(void) {\n    gl_FragColor = texture2D(texColor, texC);\n}\n",p.addChild(E,"parts"),p.addChild(B,"parts");var x=new x3dom.nodeTypes.TextureProperties(e);x._vf.boundaryModeS="CLAMP_TO_EDGE",x._vf.boundaryModeT="CLAMP_TO_EDGE",x._vf.boundaryModeR="CLAMP_TO_EDGE",x._vf.minificationFilter="LINEAR",x._vf.magnificationFilter="LINEAR",u.addChild(x,"textureProperties"),u.nodeChanged(),u._nameSpace=t._nameSpace,u._vf.url[0]=l,u._vf.repeatT=!1,u._vf.repeatS=!1,f.addChild(u,"texture"),u.nodeChanged();var v=new x3dom.nodeTypes.Field(e);v._vf.name="texColor",v._vf.type="SFInt32",v._vf.value=0,p.addChild(v,"fields"),v.nodeChanged();var y=new x3dom.nodeTypes.TextureProperties(e);y._vf.boundaryModeS="CLAMP_TO_EDGE",y._vf.boundaryModeT="CLAMP_TO_EDGE",y._vf.boundaryModeR="CLAMP_TO_EDGE",y._vf.minificationFilter="NEAREST",y._vf.magnificationFilter="NEAREST",C.addChild(y,"textureProperties"),C.nodeChanged(),C._nameSpace=t._nameSpace,C._vf.url[0]=I,C._vf.repeatT=!1,C._vf.repeatS=!1,C._vf.scale=!1,f.addChild(C,"texture"),C.nodeChanged();var F=new x3dom.nodeTypes.Field(e);if(F._vf.name="texHeight",F._vf.type="SFInt32",F._vf.value=1,p.addChild(F,"fields"),F.nodeChanged(),""!==t._vf.normalUrl){var D=new x3dom.nodeTypes.TextureProperties(e);D._vf.boundaryModeS="CLAMP_TO_EDGE",D._vf.boundaryModeT="CLAMP_TO_EDGE",D._vf.boundaryModeR="CLAMP_TO_EDGE",D._vf.minificationFilter="LINEAR",D._vf.magnificationFilter="LINEAR",m.addChild(D,"textureProperties"),m.nodeChanged(),m._nameSpace=t._nameSpace,m._vf.url[0]=c,m._vf.repeatT=!1,m._vf.repeatS=!1,f.addChild(m,"texture"),m.nodeChanged();var S=new x3dom.nodeTypes.Field(e);S._vf.name="texNormal",S._vf.type="SFInt32",S._vf.value=2,p.addChild(S,"fields"),S.nodeChanged()}var w=new x3dom.nodeTypes.Field(e);w._vf.name="maxElevation",w._vf.type="SFFloat",w._vf.value=t._vf.maxElevation,p.addChild(w,"fields"),w.nodeChanged(),a.addChild(f),f.nodeChanged(),a.addChild(p),p.nodeChanged(),h.addChild(a),a.nodeChanged(),h.addChild(r),t.addChild(h),h.nodeChanged(),_.boundedNode=h,_.volume=h.getVolume(),_.volume.max.z=t._vf.maxElevation,_.volume.min.z=0,_.volume.center=_.volume.min.add(_.volume.max).multiply(.5),_.volume.transform(o),function(){for(var e=0,o=0;o<A;o++)e+=Math.pow(4,o);var r=e+i;t.nodeList[r]=Q;var a=Math.sqrt(Math.pow(4,A));d[0]=e+(Math.ceil((i+1)/a-1)*a+(i+(a-1))%a),d[1]=e+(Math.ceil((i+1)/a-1)*a+(i+1)%a),d[3]=e+(i+a*(a-1))%Math.pow(4,A),d[2]=e+(i+a)%Math.pow(4,A),0===s&&(d[0]=-1);0===n&&(d[3]=-1);s===a-1&&(d[1]=-1);n===a-1&&(d[2]=-1)}()}()}function QuadtreeNodeBin(e,t,A,i,o,s){var n,r,a,d={},h=.1*(.25*Math.pow(A,2)+1.5)*t._vf.factor,g=[],l=!1,I=!1,c=!1,f=t._vf.url+"/"+A+"/"+i+"/",u=f+o+".x3d",C=new x3dom.fields.SFVec3f(0,0,0),_=!1,m=new x3dom.nodeTypes.Shape(e),p=new XMLHttpRequest;p.open("GET",u,!1);try{x3dom.RequestManager.addRequest(p);var E=p.responseXML;if(null!==E){new RegExp('"',"g");!function(A){this._nameSpace=new x3dom.NodeNameSpace("",t._nameSpace.doc),this._nameSpace.setBaseURL(t._nameSpace.baseURL+f);var i=E.getElementsByTagName("Shape")[0];if(m=this._nameSpace.setupTree(i),!t._vf.useNormals){var o=new x3dom.nodeTypes.Appearance(e),s=new x3dom.nodeTypes.Material(e);o.addChild(s),m._cf.appearance=o}C=x3dom.fields.SFVec3f.copy(m._cf.geometry.node._vf.position)}(),B(),_=!0}}catch(e){x3dom.debug.logException("Error loading file '"+u+"': "+e)}function B(){d.boundedNode=m,d.volume=m.getVolume()}function Q(){return I=!0,m._webgl.internalDownloadCount>0&&(I=!1),I}this.Exists=function(){return _},this.Shape=function(){return m},this.CreateChildren=function(){g.push(new QuadtreeNodeBin(e,t,A+1,2*i,2*o,s)),g.push(new QuadtreeNodeBin(e,t,A+1,2*i+1,2*o,s)),g.push(new QuadtreeNodeBin(e,t,A+1,2*i,2*o+1,s)),g.push(new QuadtreeNodeBin(e,t,A+1,2*i+1,2*o+1,s))},this.Ready=function(){return void 0!==m._webgl&&void 0!==m._webgl.internalDownloadCount&&Q()},this.collectDrawables=function(e,i,o,s,f){if(h=.1*(.25*Math.pow(A,2)+1.5)*t._vf.factor,d.localMatrix=e,I&&c||function(e,t){c=!0;for(var A=0;A<g.length;A++)g[A].Ready()||(c=!1);if(c)for(A=0;A<g.length;A++)g[A].Shape()._vf.visible=!0;null!==m._cf.geometry.node&&(void 0===m._webgl||void 0===m._webgl.internalDownloadCount?e.context.setupShape(e.gl,{shape:m,transform:t},e.viewarea):Q())}(i,e),I&&_&&(f=i.cull(e,d,o,f))>0)if(n=i.viewMatrix,r=n.multMatrixPnt(e.multMatrixPnt(C)),(a=Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2)+Math.pow(r.z,2)))<Math.pow(t._vf.maxDepth-A,2)/h*1e3||A<t._vf.minDepth)if(t.view.isMovingOrAnimating()&&A>=t._vf.interactionDepth)m.collectDrawableObjects(e,i,o,s,f,[]);else if(0===g.length)t.nodeProducer.AddNewNode(x,a),m.collectDrawableObjects(e,i,o,s,f,[]);else if(0===g.length&&t.createChildren>0)m.collectDrawableObjects(e,i,o,s,f,[]);else{if(!l)for(var u=0;u<g.length;u++)if(g[u].Exists()){l=!0;break}if(l&&c)for(u=0;u<g.length;u++)g[u].collectDrawables(e,i,o,s,f);else{for(u=0;u<g.length;u++)g[u].collectDrawables(e,i,o,s,f),g[u].Shape()._vf.visible=!1;m.collectDrawableObjects(e,i,o,s,f,[])}}else m.collectDrawableObjects(e,i,o,s,f,[])},this.getVolume=function(){return m.getVolume()},this.Level=function(){return A};var x=this;B()}function BVHNode(e,t,A,i,o,s){var n={},r=(Math.pow(A,2),t._vf.factor,[]),a=t._vf.url+i+o+".x3d",d=(new x3dom.fields.SFVec3f(0,0,0),!1),h=new x3dom.nodeTypes.Shape(e);this.RecalcFactor=function(){.1*(.25*Math.pow(A,2)+1.5)*t._vf.factor;for(var e=0;e<r.length;e++)r[e].RecalcFactor()};var g=new XMLHttpRequest;g.open("GET",a,!1);try{x3dom.RequestManager.addRequest(g);var l=g.responseXML;if(null!==l){new RegExp('"',"g");!function(A){this._nameSpace=new x3dom.NodeNameSpace("",t._nameSpace.doc),this._nameSpace.setBaseURL(t._nameSpace.baseURL+t._vf.url+i);var o=l.getElementsByTagName("Shape")[0];if(h=this._nameSpace.setupTree(o),!t._vf.useNormals){var s=new x3dom.nodeTypes.Appearance(e),n=new x3dom.nodeTypes.Material(e);s.addChild(n),h._cf.appearance=s}x3dom.fields.SFVec3f.copy(h._cf.geometry.node._vf.position)}(),I(),d=!0}}catch(e){x3dom.debug.logException("Error loading file '"+a+"': "+e)}function I(){n.boundedNode=h,n.volume=h.getVolume()}function c(){return h._webgl.internalDownloadCount<=0}this.Exists=function(){return d},this.Shape=function(){return h},this.CreateChildren=function(){!function(){for(var n=0;n<s;n++)r.push(new BVHNode(e,t,A+1,i+o+"/",n+1,s))}()},this.Ready=function(){return void 0!==h._webgl&&void 0!==h._webgl.internalDownloadCount&&c()},this.collectDrawables=function(e,i,o,s,a){.1*(.25*Math.pow(A,2)+1.5)*t._vf.factor,n.localMatrix=e,function(e,t){for(var A=0;A<r.length;A++)!0,r[A].Ready()?r[A].Shape()._vf.visible=!0:!1;null!==h._cf.geometry.node&&(void 0===h._webgl||void 0===h._webgl.internalDownloadCount?e.context.setupShape(e.gl,{shape:h,transform:t},e.viewarea):c())}(i,e)},this.getVolume=function(){return h.getVolume()},this.Level=function(){return A};I()}function QuadtreeNode3D_NEW(e,t,A,i,o,s,n,r){var a,d,h,g,l,I,c=[],f=new x3dom.nodeTypes.Shape,u=null,C=t._vf.textureUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.textureFormat.toLowerCase(),_=t._vf.elevationUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.elevationFormat.toLowerCase(),m=(t._vf.normalUrl,t._vf.normalFormat.toLowerCase(),(t._vf.size.x+t._vf.size.y)/2),p={};this.collectDrawables=function(a,d,h,g,l){if(p.localMatrix=o,(l=d.cull(a,p,h,l))>0){var I=d.viewMatrix.multMatrixPnt(a.multMatrixPnt(u));if(Math.sqrt(Math.pow(I.x,2)+Math.pow(I.y,2)+Math.pow(I.z,2))<Math.pow(t._vf.maxDepth-A,2)*m/t._vf.factor)if(0===c.length&&0===t.createChildren)t.createChildren++,_=Math.sqrt(Math.pow(4,A)),E=Math.sqrt(Math.pow(4,A+1)),B=4*Math.floor(i/_)*_+i%_*2,Q=B+1,v=(x=B+E)+1,y=t._vf.size.multiply(.25),c.push(new QuadtreeNode3D_NEW(e,t,A+1,B,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-y.x,y.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n,r)),c.push(new QuadtreeNode3D_NEW(e,t,A+1,Q,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(y.x,y.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n,r)),c.push(new QuadtreeNode3D_NEW(e,t,A+1,x,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-y.x,-y.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n+1,r)),c.push(new QuadtreeNode3D_NEW(e,t,A+1,v,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(y.x,-y.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n+1,r)),f.collectDrawableObjects(o,d,h,g,l,[]);else if(0===c.length&&t.createChildren>0)f.collectDrawableObjects(o,d,h,g,l,[]);else for(var C=0;C<c.length;C++)c[C].collectDrawables(o,d,h,g,l);else f.collectDrawableObjects(o,d,h,g,l,[])}var _,E,B,Q,x,v,y},this.getVolume=function(){return f.getVolume()},a=new x3dom.nodeTypes.Appearance(e),d=new x3dom.nodeTypes.CommonSurfaceShader(e),h=new x3dom.nodeTypes.SurfaceShaderTexture(e),g=new x3dom.nodeTypes.ImageTexture(e),l=new x3dom.nodeTypes.SurfaceShaderTexture(e),I=new x3dom.nodeTypes.ImageTexture(e),f._nameSpace=t._nameSpace,u=o.e3(),d._vf.displacementFactor=t._vf.maxElevation,g._nameSpace=t._nameSpace,g._vf.url[0]=C,g._vf.repeatT=!1,g._vf.repeatS=!1,h.addChild(g,"texture"),g.nodeChanged(),d.addChild(h,"diffuseTexture"),h.nodeChanged(),I._nameSpace=t._nameSpace,I._vf.url[0]=_,I._vf.repeatT=!1,I._vf.repeatS=!1,l.addChild(I,"texture"),I.nodeChanged(),d.addChild(l,"displacementTexture"),I.nodeChanged(),a.addChild(d,"shaders"),d.nodeChanged(),f.addChild(a),a.nodeChanged(),f.addChild(r),r.nodeChanged(),t.addChild(f),f.nodeChanged(),p.boundedNode=f,p.volume=f.getVolume(),p.volume.max.z=Math.round(t._vf.maxElevation/2),p.volume.min.z=-p.volume.max.z}function OctreeNode(e,t,A,i){var o,s,n=[],r=i.e3(),a=new x3dom.nodeTypes.Shape(e),d={},h=(t._vf.octSize.x+t._vf.octSize.y+t._vf.octSize.z)/3;this.collectDrawables=function(o,s,g,l,I){if(d.localMatrix=i,(I=s.cull(o,d,g,I))>0){var c=s.viewMatrix.multMatrixPnt(o.multMatrixPnt(r));if(Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2)+Math.pow(c.z,2))<Math.pow(t._vf.maxDepth-A,2)*h/t._vf.factor)if(0===n.length)u=t._vf.octSize.multiply(.25),n.push(new OctreeNode(e,t,A+1,i.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-u.x,u.y,u.z))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,.5))))),n.push(new OctreeNode(e,t,A+1,i.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(u.x,u.y,u.z))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,.5))))),n.push(new OctreeNode(e,t,A+1,i.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-u.x,-u.y,u.z))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,.5))))),n.push(new OctreeNode(e,t,A+1,i.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(u.x,-u.y,u.z))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,.5))))),n.push(new OctreeNode(e,t,A+1,i.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-u.x,u.y,-u.z))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,.5))))),n.push(new OctreeNode(e,t,A+1,i.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(u.x,u.y,-u.z))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,.5))))),n.push(new OctreeNode(e,t,A+1,i.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-u.x,-u.y,-u.z))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,.5))))),n.push(new OctreeNode(e,t,A+1,i.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(u.x,-u.y,-u.z))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,.5)))));else for(var f=0;f<n.length;f++)n[f].collectDrawables(i,s,g,l,I);else a.collectDrawableObjects(i,s,g,l,I,[])}var u},this.getVolume=function(){return a.getVolume()},o=new x3dom.nodeTypes.Appearance(e),(s=new x3dom.nodeTypes.Box(e))._vf.size=t._vf.octSize,s.fieldChanged("size"),a._nameSpace=new x3dom.NodeNameSpace("",t._nameSpace.doc),a._nameSpace.setBaseURL(t._nameSpace.baseURL),a.addChild(o),o.nodeChanged(),a.addChild(s),s.nodeChanged(),a.nodeChanged(),d.boundedNode=a,d.volume=a.getVolume()}function QuadtreeNode3D_32bit(e,t,A,i,o,s,n,r){var a=[],d=new x3dom.nodeTypes.Shape,h=null,g=t._vf.textureUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.textureFormat.toLowerCase(),l=t._vf.elevationUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.elevationFormat.toLowerCase(),I=t._vf.normalUrl+"/"+A+"/"+s+"/"+n+"."+t._vf.normalFormat.toLowerCase(),c=(t._vf.size.x+t._vf.size.y)/2,f={};this.collectDrawables=function(g,l,I,u,C){if(f.localMatrix=o,(C=l.cull(g,f,I,C))>0){var _=l.viewMatrix.multMatrixPnt(g.multMatrixPnt(h));if(Math.sqrt(Math.pow(_.x,2)+Math.pow(_.y,2)+Math.pow(_.z,2))<Math.pow(t._vf.maxDepth-A,2)*c/t._vf.factor)if(0===a.length&&0===t.createChildren)t.createChildren++,p=Math.sqrt(Math.pow(4,A)),E=Math.sqrt(Math.pow(4,A+1)),B=4*Math.floor(i/p)*p+i%p*2,Q=B+1,v=(x=B+E)+1,y=t._vf.size.multiply(.25),a.push(new QuadtreeNode3D_32bit(e,t,A+1,B,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-y.x,y.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n,r)),a.push(new QuadtreeNode3D_32bit(e,t,A+1,Q,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(y.x,y.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n,r)),a.push(new QuadtreeNode3D_32bit(e,t,A+1,x,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(-y.x,-y.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s,2*n+1,r)),a.push(new QuadtreeNode3D_32bit(e,t,A+1,v,o.mult(x3dom.fields.SFMatrix4f.translation(new x3dom.fields.SFVec3f(y.x,-y.y,0))).mult(x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(.5,.5,1))),2*s+1,2*n+1,r)),d.collectDrawableObjects(o,l,I,u,C,[]);else if(0===a.length&&t.createChildren>0)d.collectDrawableObjects(o,l,I,u,C,[]);else for(var m=0;m<a.length;m++)a[m].collectDrawables(o,l,I,u,C);else d.collectDrawableObjects(o,l,I,u,C,[])}var p,E,B,Q,x,v,y},this.getVolume=function(){return d.getVolume()},function(){var A=new x3dom.nodeTypes.Appearance(e),i=new x3dom.nodeTypes.MultiTexture(e),s=new x3dom.nodeTypes.ImageTexture(e),n=new x3dom.nodeTypes.ImageTexture(e),a=new x3dom.nodeTypes.ImageTexture(e),c=new x3dom.nodeTypes.ComposedShader(e);d._nameSpace=t._nameSpace,h=o.e3();var u=new x3dom.nodeTypes.ShaderPart(e);u._vf.type="vertex",u._vf.url[0]="attribute vec3 position;\nattribute vec3 texcoord;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelViewProjectionMatrix;\nuniform sampler2D texColor;\nuniform sampler2D texHeight;\nuniform float maxElevation;\nuniform sampler2D texNormal;\nvarying vec2 texC;\nvarying vec3 vLight;\nconst float shininess = 32.0;\n\nvoid main(void) {\n    vec3 uLightPosition = vec3(160.0, -9346.0, 4806.0);\n    vec4 colr = texture2D(texColor, vec2(texcoord[0], 1.0-texcoord[1]));\n    vec3 uAmbientMaterial = vec3(1.0, 1.0, 0.9);    vec3 uAmbientLight = vec3(0.5, 0.5, 0.5);    vec3 uDiffuseMaterial = vec3(0.7, 0.7, 0.7);    vec3 uDiffuseLight = vec3(1.0, 1.0, 1.0);    vec4 vertexPositionEye4 = modelViewMatrix * vec4(position, 1.0);    vec3 vertexPositionEye3 = vec3((modelViewMatrix * vec4(vertexPositionEye4.xyz, 1.0)).xyz);    vec3 vectorToLightSource = normalize(uLightPosition - vertexPositionEye3);    vec4 height = texture2D(texHeight, vec2(texcoord[0], 1.0 - texcoord[1]));\n    vec4 normalEye = 2.0 * texture2D(texNormal, vec2(texcoord[0], 1.0-texcoord[1])) - 1.0;\n    float diffuseLightWeighting = max(dot(normalEye.xyz, vectorToLightSource), 0.0);    texC = vec2(texcoord[0], 1.0-texcoord[1]);\n    vec3 diffuseReflectance = uDiffuseMaterial * uDiffuseLight * diffuseLightWeighting;    vec3 uSpecularMaterial = vec3(0.0, 0.0, 0.0);    vec3 uSpecularLight = vec3(1.0, 1.0, 1.0);    vec3 reflectionVector = normalize(reflect(-vectorToLightSource, normalEye.xyz));    vec3 viewVectorEye = -normalize(vertexPositionEye3);    float rdotv = max(dot(reflectionVector, viewVectorEye), 0.0);    float specularLightWeight = pow(rdotv, shininess);    vec3 specularReflection = uSpecularMaterial * uSpecularLight * specularLightWeight;    vLight = vec4(uAmbientMaterial * uAmbientLight + diffuseReflectance + specularReflection, 1.0).xyz;    gl_Position = modelViewProjectionMatrix * vec4(position.xy, ((height.g * 256.0)+height.b) * maxElevation, 1.0);\n}\n";var C=new x3dom.nodeTypes.ShaderPart(e);C._vf.type="fragment",C._vf.url[0]="#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D texColor;\nuniform sampler2D texNormal;\nvarying vec2 texC;\nvarying vec3 vLight;\n\n\nvoid main(void) {\n    vec4 normal = 2.0 * texture2D(texNormal, texC) - 1.0;\n    vec4 colr = texture2D(texColor, texC);\n    float coler = ((colr.g * 256.0)+colr.b);    gl_FragColor = vec4(vLight * coler, 1.0);\n}\n",c.addChild(u,"parts"),c.addChild(C,"parts"),s._nameSpace=t._nameSpace,s._vf.url[0]=g,s._vf.repeatT=!1,s._vf.repeatS=!1,s._vf.generateMipMaps=!1,i.addChild(s,"texture"),s.nodeChanged();var _=new x3dom.nodeTypes.Field(e);_._vf.name="texColor",_._vf.type="SFInt32",_._vf.value=0,c.addChild(_,"fields"),_.nodeChanged(),n._nameSpace=t._nameSpace,n._vf.url[0]=l,n._vf.repeatT=!1,n._vf.repeatS=!1,i.addChild(n,"texture"),n.nodeChanged();var m=new x3dom.nodeTypes.Field(e);m._vf.name="texHeight",m._vf.type="SFInt32",m._vf.value=1,c.addChild(m,"fields"),m.nodeChanged(),a._nameSpace=t._nameSpace,a._vf.url[0]=I,a._vf.repeatT=!1,a._vf.repeatS=!1,i.addChild(a,"texture"),a.nodeChanged();var p=new x3dom.nodeTypes.Field(e);p._vf.name="texNormal",p._vf.type="SFInt32",p._vf.value=2,c.addChild(p,"fields"),p.nodeChanged();var E=new x3dom.nodeTypes.Field(e);E._vf.name="maxElevation",E._vf.type="SFFloat",E._vf.value=t._vf.maxElevation,c.addChild(E,"fields"),E.nodeChanged(),A.addChild(i),i.nodeChanged(),A.addChild(c),c.nodeChanged(),d.addChild(A),A.nodeChanged(),d.addChild(r),r.nodeChanged(),t.addChild(d),d.nodeChanged(),f.boundedNode=d,f.volume=d.getVolume(),f.volume.max.z=Math.round(t._vf.maxElevation),f.volume.min.z=-f.volume.max.z}()}"object"==typeof exports&&"object"==typeof module?module.exports=DracoDecoderModule:"function"==typeof define&&define.amd?define([],(function(){return DracoDecoderModule})):"object"==typeof exports&&(exports.DracoDecoderModule=DracoDecoderModule),x3dom.DracoDecoderModule=DracoDecoderModule,x3dom.DracoDecoderWASM={arrayBuffer:Uint8Array.from(atob(DracoDecoderWASM_base64()),(function(e){return e.charCodeAt(0)})).buffer},x3dom.registerNodeType("GeoCoordinate","Geospatial",defineClass(x3dom.nodeTypes.X3DCoordinateNode,(function(e){x3dom.nodeTypes.GeoCoordinate.superClass.call(this,e),this.addField_MFVec3f(e,"point",[]),this.addField_MFString(e,"geoSystem",["GD","WE"]),this.addField_SFNode("geoOrigin",x3dom.nodeTypes.GeoOrigin)}),{elipsoideParameters:{AA:["Airy 1830","6377563.396","299.3249646"],AM:["Modified Airy","6377340.189","299.3249646"],AN:["Australian National","6378160","298.25"],BN:["Bessel 1841 (Namibia)","6377483.865","299.1528128"],BR:["Bessel 1841 (Ethiopia Indonesia...)","6377397.155","299.1528128"],CC:["Clarke 1866","6378206.4","294.9786982"],CD:["Clarke 1880","6378249.145","293.465"],EA:["Everest (India 1830)","6377276.345","300.8017"],EB:["Everest (Sabah & Sarawak)","6377298.556","300.8017"],EC:["Everest (India 1956)","6377301.243","300.8017"],ED:["Everest (W. Malaysia 1969)","6377295.664","300.8017"],EE:["Everest (W. Malaysia & Singapore 1948)","6377304.063","300.8017"],EF:["Everest (Pakistan)","6377309.613","300.8017"],FA:["Modified Fischer 1960","6378155","298.3"],HE:["Helmert 1906","6378200","298.3"],HO:["Hough 1960","6378270","297"],ID:["Indonesian 1974","6378160","298.247"],IN:["International 1924","6378388","297"],KA:["Krassovsky 1940","6378245","298.3"],RF:["Geodetic Reference System 1980 (GRS 80)","6378137","298.257222101"],SA:["South American 1969","6378160","298.25"],WD:["WGS 72","6378135","298.26"],WE:["WGS 84","6378137","298.257223563"]},fieldChanged:function(e){"point"!=e&&"geoSystem"!=e||this._parentNodes.forEach((function(e){e.fieldChanged("coord")}))},isLogitudeFirst:function(e){for(var t=0;t<e.length;++t)if("longitude_first"==e[t])return!0;return!1},getElipsoideCode:function(e){for(var t=0;t<e.length;++t){var A=e[t];if(this.elipsoideParameters[A])return A}return"WE"},getElipsoide:function(e){return this.elipsoideParameters[this.getElipsoideCode(e)]},getReferenceFrame:function(e){for(var t=0;t<e.length;++t){var A=e[t];if("GD"==A||"GDC"==A)return"GD";if("GC"==A||"GCC"==A)return"GC";if("UTM"==A)return"UTM";x3dom.debug.logError("Unknown GEO system: ["+e+"]")}return"GD"},getUTMZone:function(e){for(var t=0;t<e.length;++t){var A=e[t];if("Z"==A[0])return A.substring(1)}x3dom.debug.logError("no UTM zone but is required:"+e)},getUTMHemisphere:function(e){for(var t=0;t<e.length;++t){var A=e[t];if("S"==A)return A}return"N"},isUTMEastingFirst:function(e){for(var t=0;t<e.length;++t){if("easting_first"==e[t])return!0}return!1},UTMtoGC:function(e,t){var A=this.getUTMZone(e);if(A<1||A>60||void 0===A)return x3dom.debug.logError("invalid UTM zone: "+A+" in geosystem "+e);for(var i,o,s,n,r,a,d,h,g,l,I,c,f,u,C,_,m,p,E=this.getUTMHemisphere(e),B=this.isUTMEastingFirst(e),Q=this.getElipsoide(e),x=Q[1],v=x*(1-1/Q[2]),y=1-v/x*(v/x),F=Math.sqrt(y),D=(Math.sqrt(1-y),y/(1-y)),S=3+6*(A-1)-180,w=(1-Math.sqrt(1-y))/(1+Math.sqrt(1-y)),N=w*w,T=new x3dom.fields.MFVec3f,b=180/Math.PI,M=1-y*(.25+y*(3/64+5/256*y)),R=w*(1.5-27/32*N),G=N*(21/16-55/32*N),U=0;U<t.length;++U)o=B?t[U].x:t[U].y,s=B?t[U].y:t[U].x,r=(n=("S"==E?s-1e7:s)/.9996/(x*M))+R*Math.sin(2*n)+G*Math.sin(4*n),r+=w*(N*(Math.sin(6*n)*(151/96)+Math.sin(8*n)*(1097/512))),d=D*(a=Math.cos(r))*a,l=(g=(h=Math.tan(r))*h)*g,c=1-(I=F*Math.sin(r))*I,m=(C=(u=(o-5e5)/(.9996*(f=x/Math.sqrt(c))))*u)*(.5-C*(5+3*g+10*d-4*(_=d*d)-9*D)/24),m=r-f*h/(f*(1-y)/c)*(m+=Math.pow(u,6)*(61+90*g+298*d+45*l-252*D-3*_)/720),p=u*(1+C*((-1-2*g-d)/6+C*(5-2*d+28*g-3*_+8*D+24*l)/120))/a,(i=new x3dom.fields.SFVec3f).x=S+b*p,i.y=b*m,i.z=t[U].z,T.push(i);var L=new x3dom.fields.MFString;return L.push("GD"),L.push(this.getElipsoideCode(e)),L.push("longitude_first"),this.GDtoGC(L,T)},GCtoUTM:function(e,t){var A=this.GCtoGD(e,t),i=this.getUTMZone(e);if(i<1||i>60||void 0===i)return x3dom.debug.logError("invalid UTM zone: "+i+" in geosystem "+e);var o,s,n,r,a,d,h,g,l,I,c,f,u,C,_=this.getUTMHemisphere(e),m=this.isUTMEastingFirst(e),p=this.getElipsoide(e),E=p[1],B=E*(1-1/p[2]),Q=1-B/E*(B/E),x=Math.sqrt(Q),v=Q/(1-Q),y=Math.PI/180,F=(3+6*(i-1)-180)*y,D=new x3dom.fields.MFVec3f,S=1-Q*(.25+Q*(3/64+5*Q/256)),w=Q*(3/8+Q*(3/32+45*Q/1024)),N=Q*Q*(15/256+45*Q/1024),T=Q*Q*Q*(35/3072);for(u=0;u<A.length;++u)C=new x3dom.fields.SFVec3f,g=A[u].y*y,l=A[u].x*y,I=Math.cos(g),c=Math.tan(g),o=E/Math.sqrt(1-Math.pow(x*Math.sin(g),2)),s=Math.pow(c,2),n=v*Math.pow(I,2),r=(l-F)*I,a=g*S,a-=Math.sin(2*g)*w,a+=Math.sin(4*g)*N,a-=Math.sin(6*g)*T,d=.9996*o*r*(1+(f=r*r)*((1-s+n)/6+f*(5-s*(18+s)+72*n-58*v)/120)),d+=5e5,(h=.9996*((a*=E)-0+o*c*(f*(.5+f*((5-s+9*n+4*n*n)/24+f*(61-s*(58+s)+600*n-330*v)/720)))))<0&&("N"==_&&x3dom.debug.logError("UTM zone in northern hemisphere but coordinates in southern!"),h=1e7+h),C.x=m?d:h,C.y=m?h:d,C.z=A[u].z,D.push(C);return D},GDtoGC:function(e,t){var A,i,o,s,n,r,a,d,h,g=new x3dom.fields.MFVec3f,l=this.getElipsoide(e),I=l[1],c=l[2],f=this.isLogitudeFirst(e),u=1/c,C=I*(1-u),_=C*C/(I*I),m=u*(2-u);for(A=0;A<t.length;++A)i=new x3dom.fields.SFVec3f,o=.017453292519943295*(1==f?t[A].y:t[A].x),s=.017453292519943295*(1==f?t[A].x:t[A].y),r=(n=Math.sin(o))*n,a=Math.cos(o),h=(d=I/Math.sqrt(1-m*r))+t[A].z,i.x=h*a*Math.cos(s),i.y=h*a*Math.sin(s),i.z=(_*d+t[A].z)*n,g.push(i);return g},GCtoGD:function(e,t){var A,i,o,s,n,r,a,d,h,g,l,I=new x3dom.fields.MFVec3f,c=180/Math.PI,f=this.getElipsoide(e),u=f[1],C=u*(1-1/f[2]),_=1-C/u*(C/u),m=_/(1-_);for(A=0;A<t.length;++A)o=t[A].x,s=t[A].y,n=t[A].z,r=Math.sqrt(o*o+s*s),a=Math.atan(n*u/(r*C)),d=Math.atan((n+m*C*Math.pow(Math.sin(a),3))/(r-_*u*Math.pow(Math.cos(a),3))),h=u/Math.sqrt(1-_*Math.pow(Math.sin(d),2)),g=r/Math.cos(d)-h,l=Math.atan2(s,o),(i=new x3dom.fields.SFVec3f).x=l*c,i.y=d*c,i.z=g,I.push(i);return I},GEOtoGC:function(e,t,A){var i=this.getReferenceFrame(e);if("GD"==i)return this.GDtoGC(e,A);if("UTM"==i)return this.UTMtoGC(e,A);if("GC"==i){if(t.node){for(var o=new x3dom.fields.MFVec3f,s=0;s<A.length;++s){var n=new x3dom.fields.SFVec3f;n.x=A[s].x,n.y=A[s].y,n.z=A[s].z,o.push(n)}return o}return A}return x3dom.debug.logError("Unknown geoSystem: "+e[0]),new x3dom.fields.MFVec3f},GCtoGEO:function(e,t,A){var i=this.getReferenceFrame(e);if("GD"==i){var o=this.GCtoGD(e,A);if(!this.isLogitudeFirst(e))for(var s,n=0;n<o.length;++n)s=o[n].x,o[n].x=o[n].y,o[n].y=s;return o}if("UTM"==i)return this.GCtoUTM(e,A);if("GC"==i){if(t.node){var r=new x3dom.fields.MFVec3f;for(n=0;n<A.length;++n){var a=new x3dom.fields.SFVec3f;a.x=A[n].x,a.y=A[n].y,a.z=A[n].z,r.push(a)}return r}return A}return x3dom.debug.logError("Unknown geoSystem: "+e[0]),new x3dom.fields.MFVec3f},OriginToGC:function(e){var t=e.node._vf.geoCoords,A=e.node._vf.geoSystem,i=new x3dom.fields.SFVec3f;i.x=t.x,i.y=t.y,i.z=t.z;var o=new x3dom.fields.MFVec3f;return o.push(i),this.GEOtoGC(A,e,o)[0]},GCtoX3D:function(e,t,A){var i=A;if(t.node){var o=this.OriginToGC(t),s=x3dom.fields.SFMatrix4f.translation(o.negate());if(t.node._vf.rotateYUp)s=x3dom.nodeTypes.GeoLocation.prototype.getGeoRotMat(e,o).inverse().mult(s);for(var n=0;n<A.length;++n)i[n]=s.multMatrixPnt(A[n])}return i},GEOtoX3D:function(e,t,A){var i=this.GEOtoGC(e,t,A);return this.GCtoX3D(e,t,i)},getPoints:function(){return this.GEOtoX3D(this._vf.geoSystem,this._cf.geoOrigin,this._vf.point)}})),x3dom.registerNodeType("GeoElevationGrid","Geospatial",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.GeoElevationGrid.superClass.call(this,e),this.addField_SFNode("texCoord",x3dom.nodeTypes.X3DTextureCoordinateNode),this.addField_MFString(e,"geoSystem",["GD","WE"]),this.addField_SFVec3f(e,"geoGridOrigin",0,0,0),this.addField_MFDouble(e,"height",0,0),this.addField_SFBool(e,"ccw",!0),this.addField_SFDouble(e,"creaseAngle",0),this.addField_SFInt32(e,"xDimension",0),this.addField_SFDouble(e,"xSpacing",1),this.addField_SFFloat(e,"yScale",1),this.addField_SFInt32(e,"zDimension",0),this.addField_SFDouble(e,"zSpacing",1),this.addField_SFNode("geoOrigin",x3dom.nodeTypes.GeoOrigin),this.addField_SFBool(e,"lit",!0)}),{nodeChanged:function(){var e=this._vf.geoSystem,t=this._cf.geoOrigin,A=this._vf.height,i=this._vf.yScale,o=this._vf.xDimension,s=this._vf.zDimension,n=this._vf.xSpacing,r=this._vf.zSpacing,a=this._vf.geoGridOrigin;A.length!==o*s&&x3dom.debug.logError("GeoElevationGrid: height.length("+A.length+") != x/zDimension("+o+"*"+s+")");var d,h=x3dom.nodeTypes.GeoCoordinate.prototype.isLogitudeFirst(e),g=x3dom.nodeTypes.GeoCoordinate.prototype.isUTMEastingFirst(e),l=this._vf.ccw,I=1/(o-1),c=1/(s-1),f=2,u=this._cf.texCoord.node;x3dom.isa(u,x3dom.nodeTypes.MultiTextureCoordinate)&&u._cf.texCoord.nodes.length&&(u=u._cf.texCoord.nodes[0]),u&&u._vf.point&&(d=u._vf.point,x3dom.isa(u,x3dom.nodeTypes.TextureCoordinate3D)&&(f=3));for(var C=new x3dom.fields.MFVec3f,_=new x3dom.fields.MFVec2f,m=0;m<s;++m)for(var p=0;p<o;++p){var E=new x3dom.fields.SFVec2f;E.x=p*I,E.y=m*c,_.push(E);var B=new x3dom.fields.SFVec3f;h||g?(B.x=p*n,B.y=m*r):(B.x=m*r,B.y=p*n),B.z=A[m*o+p]*i,B=B.add(a),C.push(B)}var Q=new x3dom.fields.MFInt32;for(m=0;m<s-1;m++)for(p=0;p<o-1;p++){var x=p+m*o,v=p+m*o+1,y=p+(m+1)*o+1,F=p+(m+1)*o;l?(Q.push(x),Q.push(v),Q.push(y),Q.push(x),Q.push(y),Q.push(F)):(Q.push(x),Q.push(F),Q.push(y),Q.push(x),Q.push(y),Q.push(v))}var D=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoX3D(e,t,C);if(this._vf.creaseAngle<=x3dom.fields.Eps){var S=this;!function(){var e=new x3dom.fields.MFInt32,t=new x3dom.fields.MFVec3f,A=new x3dom.fields.MFVec2f;d?S.generateNonIndexedTriangleData(Q,D,null,d,null,t,null,A,null):S.generateNonIndexedTriangleData(Q,D,null,_,null,t,null,A,null);for(var i=0;i<t.length;++i)e.push(i);S._mesh._indices[0]=e.toGL(),S._mesh._positions[0]=t.toGL(),S._mesh._texCoords[0]=A.toGL(),S._mesh._numTexComponents=2}(),this._mesh.calcNormals(0)}else this._mesh._indices[0]=Q.toGL(),this._mesh._positions[0]=D.toGL(),this._mesh._texCoords[0]=d?d.toGL():_.toGL(),this._mesh._numTexComponents=f,this._mesh.calcNormals(Math.PI);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},generateNonIndexedTriangleData:function(e,t,A,i,o,s,n,r,a){for(var d=0;d<e.length;d+=3){var h=e[d],g=e[d+1],l=e[d+2];if(t){var I=new x3dom.fields.SFVec3f,c=new x3dom.fields.SFVec3f,f=new x3dom.fields.SFVec3f;I.setValues(t[h]),c.setValues(t[g]),f.setValues(t[l]),s.push(I),s.push(c),s.push(f)}if(A){var u=new x3dom.fields.SFVec3f,C=new x3dom.fields.SFVec3f,_=new x3dom.fields.SFVec3f;u.setValues(A[h]),C.setValues(A[g]),_.setValues(A[l]),n.push(u),n.push(C),n.push(_)}if(i){var m=new x3dom.fields.SFVec2f,p=new x3dom.fields.SFVec2f,E=new x3dom.fields.SFVec2f;m.setValues(i[h]),p.setValues(i[g]),E.setValues(i[l]),r.push(m),r.push(p),r.push(E)}if(o){var B=new x3dom.fields.SFVec3f,Q=new x3dom.fields.SFVec3f,x=new x3dom.fields.SFVec3f;B.setValues(i[h]),Q.setValues(i[g]),Q.setValues(i[l]),a.push(B),a.push(Q),a.push(x)}}}})),x3dom.registerNodeType("GeoLOD","Geospatial",defineClass(x3dom.nodeTypes.X3DBoundedObject,(function(e){x3dom.nodeTypes.GeoLOD.superClass.call(this,e),this.addField_MFString(e,"geoSystem",["GD","WE"]),this.addField_MFString(e,"rootUrl",[]),this.addField_MFString(e,"child1Url",[]),this.addField_MFString(e,"child2Url",[]),this.addField_MFString(e,"child3Url",[]),this.addField_MFString(e,"child4Url",[]),this.addField_SFFloat(e,"range",10),this.addField_SFInt32(e,"level_changed",0),this.addField_SFString(e,"referenceBindableDescription",[]),this.addField_SFNode("geoOrigin",x3dom.nodeTypes.GeoOrigin),this.addField_MFNode("rootNode",x3dom.nodeTypes.X3DChildNode),this.addField_SFVec3f(e,"center",0,0,0),this._eye=new x3dom.fields.SFVec3f(0,0,0),this._x3dcenter=new x3dom.fields.SFVec3f(0,0,0),this._child1added=!1,this._child2added=!1,this._child3added=!1,this._child4added=!1,this._rootNodeLoaded=!0,this._childUrlNodes=new x3dom.fields.MFNode(x3dom.nodeTypes.X3DChildNode),this._lastRangePos=-1}),{collectDrawableObjects:function(e,t,A,i,o,s){A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),this.collectBbox(e,t,A,i,o,s),(o=t.cull(e,this.graphState(),A,o))<=0||(A=!1,this.visitChildren(e,t,A,i,o,s))},visitChildren:function(e,t,A,i,o,s){var n,r,a,d=0,h=t.viewMatrix,g=new x3dom.fields.SFVec3f(0,0,0);if(g=h.inverse().multMatrixPnt(g),this._eye=e.inverse().multMatrixPnt(g),this._x3dcenter.subtract(this._eye).length()>this._vf.range?(d=0,this._rootNodeLoaded||(this._rootNodeLoaded=!0),r=this._cf.rootNode.nodes):(d=1,this._child1added||(this._child1added=!0,this.addInlineChild(this._vf.child1Url)),this._child2added||(this._child2added=!0,this.addInlineChild(this._vf.child2Url)),this._child3added||(this._child3added=!0,this.addInlineChild(this._vf.child3Url)),this._child4added||(this._child4added=!0,this.addInlineChild(this._vf.child4Url)),this._rootNodeLoaded&&(this._rootNodeLoaded=!1),r=this._childUrlNodes.nodes),d!==this._lastRangePos&&this.postMessage("level_changed",d),this._lastRangePos=d,(n=r.length)&&r){var l=this.transformMatrix(e);for(d=0;d<n;d++)(a=r[d])&&a.collectDrawableObjects(l,t,A,i,o,s)}},addInlineChild:function(e){var t=this.newInlineNode(e);this._childUrlNodes.addLink(t)},newInlineNode:function(e){var t=new x3dom.nodeTypes.Inline;return t._vf.url=e,t._nameSpace=this._nameSpace,x3dom.debug.logInfo("add url: "+e),t.nodeChanged(),t},getVolume:function(){var e=this._graph.volume;if(!this.volumeValid()&&(this._vf.bboxDisplay||this.renderFlag&&this.renderFlag()))for(var t,A,i=0,o=this._childNodes.length;i<o;i++)!(t=this._childNodes[i])||t.renderFlag&&!0!==t.renderFlag()&&!t._vf.bboxDisplay||(A=t.getVolume())&&A.isValid()&&e.extendBounds(A.min,A.max);return e},nodeChanged:function(){var e=new x3dom.fields.MFVec3f;if(e.push(this._vf.center),this._x3dcenter=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoX3D(this._vf.geoSystem,this._cf.geoOrigin,e)[0],!this._cf.rootNode.nodes.length){var t=this.newInlineNode(this._vf.rootUrl);this._cf.rootNode.addLink(t)}this.invalidateVolume()},fieldChanged:function(e){if("render"!=e&&"range"!=e||this.invalidateVolume(),"center"==fieldname){var t=new x3dom.fields.MFVec3f;t.push(this._vf.center),this._x3dcenter=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoX3D(this._vf.geoSystem,this._cf.geoOrigin,t)[0],this.invalidateVolume()}}})),x3dom.registerNodeType("GeoLocation","Geospatial",defineClass(x3dom.nodeTypes.X3DTransformNode,(function(e){x3dom.nodeTypes.GeoLocation.superClass.call(this,e),this.addField_MFString(e,"geoSystem",["GD","WE"]),this.addField_SFVec3d(e,"geoCoords",0,0,0),this.addField_SFNode("geoOrigin",x3dom.nodeTypes.GeoOrigin)}),{nodeChanged:function(){var e=this._vf.geoCoords,t=this._vf.geoSystem,A=this._cf.geoOrigin;this._trafo=this.getGeoTransRotMat(t,A,e)},getGeoRotMat:function(e,t){var A=new x3dom.fields.MFVec3f;A.push(t);var i=x3dom.nodeTypes.GeoCoordinate.prototype.GCtoGD(e,A)[0],o=new x3dom.fields.SFVec3f(1,0,0),s=180-i.y,n=Math.PI/180,r=x3dom.fields.Quaternion.axisAngle(o,s*n),a=new x3dom.fields.SFVec3f(0,0,1),d=90+i.x;return x3dom.fields.Quaternion.axisAngle(a,d*n).multiply(r).toMatrix()},getGeoTransRotMat:function(e,t,A){var i=new x3dom.fields.MFVec3f;i.push(A);var o=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoGC(e,t,i)[0],s=this.getGeoRotMat(e,o);if(t.node){var n=x3dom.nodeTypes.GeoCoordinate.prototype.OriginToGC(t);return t.node._vf.rotateYUp?this.getGeoRotMat(e,n).inverse().mult(x3dom.fields.SFMatrix4f.translation(o.subtract(n)).mult(s)):x3dom.fields.SFMatrix4f.translation(o.subtract(n)).mult(s)}return x3dom.fields.SFMatrix4f.translation(o).mult(s)},fieldChanged:function(e){if("geoSystem"==e||"geoCoords"==e||"geoOrigin"==e){var t=this._vf.geoCoords,A=this._vf.geoSystem,i=this._cf.geoOrigin;this._trafo=this.getGeoTransRotMat(A,i,t),this.invalidateVolume()}else"render"==e&&this.invalidateVolume()}})),x3dom.registerNodeType("GeoMetadata","Geospatial",defineClass(x3dom.nodeTypes.X3DInfoNode,(function(e){x3dom.nodeTypes.GeoMetadata.superClass.call(this,e),this.addField_MFString(e,"url",[]),this.addField_MFNode("data",x3dom.nodeTypes.X3DInfoNode),this.addField_MFString(e,"summary",[])}))),x3dom.registerNodeType("GeoOrigin","Geospatial",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.GeoOrigin.superClass.call(this,e),this.addField_MFString(e,"geoSystem",["GD","WE"]),this.addField_SFVec3d(e,"geoCoords",0,0,0),this.addField_SFBool(e,"rotateYUp",!1)}))),x3dom.registerNodeType("GeoPositionInterpolator","Geospatial",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,(function(e){x3dom.nodeTypes.GeoPositionInterpolator.superClass.call(this,e),this.addField_MFString(e,"geoSystem",["GD","WE"]),this.addField_MFVec3f(e,"keyValue",[]),this.addField_SFNode("geoOrigin",x3dom.nodeTypes.GeoOrigin),this.addField_SFBool(e,"onGreatCircle",!1)}),{linearInterpHintKeyValue:function(e,t,A,i,o){var s=A.length;if(e<=A[0])return[0,i[0]];if(e>=A[s-1])return[s-1,i[s-1]];for(var n,r=t,a=0;a<s-1;++a){if(A[n=(r+a)%s]<e&&e<=A[n+1])return[n,o(i[n],i[n+1],(e-A[n])/(A[n+1]-A[n]))];if(A[n=(r-a+s)%s]<e&&e<=A[n+1])return[n,o(i[n],i[n+1],(e-A[n])/(A[n+1]-A[n]))]}return[0,i[0]]},slerp:function(e,t,A){var i,o,s,n=e.dot(t)/(e.length()*t.length());if(i=new x3dom.fields.SFVec3f(t.x,t.y,t.z),1-n>1e-5){var r=Math.acos(n),a=Math.sin(r);o=Math.sin((1-A)*r)/a,s=Math.sin(A*r)/a}else o=1-A,s=A;return e.multiply(o).add(i.multiply(s))},nodeChanged:function(){this._keyValueGC=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoGC(this._vf.geoSystem,this._cf.geoOrigin,this._vf.keyValue),this._keyHint=0},fieldChanged:function(e){if("set_fraction"===e){var t,A,i,o,s;this._vf.onGreatCircle?(A=this.linearInterpHintKeyValue(this._vf.set_fraction,this._keyHint,this._vf.key,this._keyValueGC,x3dom.nodeTypes.GeoPositionInterpolator.prototype.slerp),this._keyHint=A[0],i=A[1],(s=new x3dom.fields.MFVec3f).push(i),t=x3dom.nodeTypes.GeoCoordinate.prototype.GCtoGEO(this._vf.geoSystem,this._cf.geoOrigin,s)[0]):(A=this.linearInterpHintKeyValue(this._vf.set_fraction,this._keyHint,this._vf.key,this._vf.keyValue,(function(e,t,A){return e.multiply(1-A).add(t.multiply(A))})),this._keyHint=A[0],t=A[1],(s=new x3dom.fields.MFVec3f).push(t),i=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoGC(this._vf.geoSystem,this._cf.geoOrigin,s)[0]),(s=new x3dom.fields.MFVec3f).push(i);var n=new x3dom.fields.MFString;n.push("GC"),n.push(x3dom.nodeTypes.GeoCoordinate.prototype.getElipsoideCode(this._vf.geoSystem)),o=x3dom.nodeTypes.GeoCoordinate.prototype.GCtoX3D(n,this._cf.geoOrigin,s)[0],this.postMessage("value_changed",o),this.postMessage("geovalue_changed",t)}}})),x3dom.registerNodeType("GeoTransform","Geospatial",defineClass(x3dom.nodeTypes.X3DTransformNode,(function(e){x3dom.nodeTypes.GeoTransform.superClass.call(this,e),this.addField_SFVec3d(e,"geoCenter",0,0,0),this.addField_SFRotation(e,"rotation",0,0,1,0),this.addField_SFVec3f(e,"scale",1,1,1),this.addField_SFRotation(e,"scaleOrientation",0,0,1,0),this.addField_SFVec3f(e,"translation",0,0,0),this.addField_SFNode("geoOrigin",x3dom.nodeTypes.GeoOrigin),this.addField_MFString(e,"geoSystem",["GD","WE"]),this.addField_SFBool(e,"globalGeoOrigin",!1)}),{nodeChanged:function(){this._trafo=this.getGeoTransform()},getGeoTransform:function(){var e,t,A,i,o,s,n,r,a;if(r=this._vf.geoSystem,a=this._cf.geoOrigin,t=this._vf.geoCenter,A=this._vf.globalGeoOrigin,i=this._vf.scaleOrientation.toMatrix(),(s=new x3dom.fields.MFVec3f).push(t),n=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoGC(r,a,s)[0],e=x3dom.nodeTypes.GeoLocation.prototype.getGeoRotMat(r,n),o=x3dom.fields.SFMatrix4f.translation(n).mult(e).mult(x3dom.fields.SFMatrix4f.translation(this._vf.translation)).mult(this._vf.rotation.toMatrix()).mult(i).mult(x3dom.fields.SFMatrix4f.scale(this._vf.scale)).mult(i.inverse()).mult(e.inverse()).mult(x3dom.fields.SFMatrix4f.translation(n.negate())),a.node){var d=x3dom.nodeTypes.GeoCoordinate.prototype.OriginToGC(a);if(A||(o=o.mult(x3dom.fields.SFMatrix4f.translation(d))),a.node._vf.rotateYUp){var h=x3dom.nodeTypes.GeoLocation.prototype.getGeoRotMat(r,d);A||(o=o.mult(h))}o=x3dom.fields.SFMatrix4f.translation(d.negate()).mult(o),a.node._vf.rotateYUp&&(o=h.inverse().mult(o))}return o},fieldChanged:function(e){"geoCenter"==e||"translation"==e||"rotation"==e||"scale"==e||"scaleOrientation"==e?(this._trafo=this.getGeoTransform(),this.invalidateVolume()):"render"==e&&this.invalidateVolume()}})),x3dom.registerNodeType("GeoViewpoint","Geospatial",defineClass(x3dom.nodeTypes.X3DViewpointNode,(function(e){x3dom.nodeTypes.GeoViewpoint.superClass.call(this,e),this.addField_MFString(e,"geoSystem",["GD","WE"]),this.addField_SFFloat(e,"fieldOfView",.785398),this.addField_SFRotation(e,"orientation",0,0,1,0),this.addField_SFVec3f(e,"centerOfRotation",0,0,0),this.addField_SFVec3d(e,"position",0,0,1e5),this.addField_SFBool(e,"headlight",void 0),this.addField_MFString(e,"navType",void 0),this.addField_SFFloat(e,"speedFactor",1),this.addField_SFFloat(e,"zNear",-1),this.addField_SFFloat(e,"zFar",-1),this.addField_SFBool(e,"elevationScaling",!0),this.addField_SFNode("geoOrigin",x3dom.nodeTypes.GeoOrigin),this._geoCenterOfRotation=this._vf.centerOfRotation,this._viewMatrix=x3dom.fields.SFMatrix4f.identity()}),{activate:function(e){var t=this._nameSpace.doc._viewarea;e&&t.animateTo(this,e._autoGen?null:e),t._needNavigationMatrixUpdate=!0,x3dom.nodeTypes.X3DBindableNode.prototype.activate.call(this,e);var A=t._scene.getNavigationInfo();this._initSpeed=A._vf.speed,this._examineSpeed=A._vf.speed,this._lastSpeed=A._vf.speed,this._userSpeedFactor=1,this._lastNavType=A.getType(),x3dom.debug.logInfo("initial navigation speed: "+this._initSpeed),void 0!==this._vf.headlight&&(A._vf.headlight=this._vf.headlight),void 0!==this._vf.navType&&(A._vf.navType=this._vf.navType)},deactivate:function(e){this._nameSpace.doc._viewarea._scene.getNavigationInfo()._vf.speed=this._examineSpeed,x3dom.debug.logInfo("navigation speed restored to: "+this._examineSpeed),x3dom.nodeTypes.X3DBindableNode.prototype.deactivate.call(this,e)},nodeChanged:function(){this._stack=this._nameSpace.doc._bindableBag.addBindable(this),this._geoOrigin=this._cf.geoOrigin,this._geoSystem=this._vf.geoSystem,this._position=this._vf.position,this._orientation=this._vf.orientation,this._viewMatrix=this.getInitViewMatrix(this._orientation,this._geoSystem,this._geoOrigin,this._position),this._vf.centerOfRotation=this.getGeoCenterOfRotation(this._geoSystem,this._geoOrigin,this._geoCenterOfRotation),this._projMatrix=null,this._lastAspect=1,this._zRatio=1e4,this._zNear=this._vf.zNear,this._zFar=this._vf.zFar,this._imgPlaneHeightAtDistOne=2*Math.tan(this._vf.fieldOfView/2)},fieldChanged:function(e){"position"==e||"orientation"==e?this.resetView():"fieldOfView"==e||"zNear"==e||"zFar"==e?(this._projMatrix=null,this._zNear=this._vf.zNear,this._zFar=this._vf.zFar,this._imgPlaneHeightAtDistOne=2*Math.tan(this._vf.fieldOfView/2)):e.indexOf("bind")>=0&&this.bind(this._vf.bind)},setProjectionMatrix:function(e){this._projMatrix=e},getCenterOfRotation:function(){return this.getCurrentTransform().multMatrixPnt(this._vf.centerOfRotation)},getGeoCenterOfRotation:function(e,t,A){var i=new x3dom.fields.MFVec3f;return i.push(A),x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoX3D(e,t,i)[0]},isExamineMode:function(e){return"examine"==e||"turntable"==e||"lookaround"==e||"lookat"==e},getViewMatrix:function(){if(this._vf.isActive&&this._vf.elevationScaling){var e=this._nameSpace.doc._viewarea,t=e._scene.getNavigationInfo(),A=t.getType();if(this.isExamineMode(A))this.isExamineMode(this._lastNavType)||(t._vf.speed=this._examineSpeed),this._lastNavType=A;else{this.isExamineMode(this._lastNavType)&&(this._examineSpeed=t._vf.speed,x3dom.debug.logInfo("back from examine mode, resume speed: "+this._lastSpeed),t._vf.speed=this._lastSpeed),this._lastNavType=A,t._vf.speed!=this._lastSpeed&&(this._userSpeedFactor*=t._vf.speed/this._lastSpeed,x3dom.debug.logInfo("interactive speed factor changed: "+this._userSpeedFactor));var i=e._scene.getViewpoint().getCurrentTransform(),o=(i=i.inverse().mult(this._viewMatrix)).inverse().e3(),s=this._geoOrigin,n=this._geoSystem,r=o;if(s.node){var a=x3dom.nodeTypes.GeoCoordinate.prototype.OriginToGC(s);if(s.node._vf.rotateYUp)r=x3dom.nodeTypes.GeoLocation.prototype.getGeoRotMat(n,a).multMatrixPnt(o);r=r.add(a)}var d=new x3dom.fields.MFVec3f;d.push(r);var h=x3dom.nodeTypes.GeoCoordinate.prototype.GCtoGD(n,d)[0],g=Math.abs(h.z/10);g=g>1?g:1,t._vf.speed=g*this._vf.speedFactor*this._userSpeedFactor,this._lastSpeed=t._vf.speed}}return this._viewMatrix},getInitViewMatrix:function(e,t,A,i){var o=new x3dom.fields.MFVec3f;o.push(i);var s=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoGC(t,A,o)[0],n=e.toMatrix(),r=x3dom.nodeTypes.GeoLocation.prototype.getGeoRotMat(t,s).mult(n);if(A.node&&A.node._vf.rotateYUp){var a=x3dom.nodeTypes.GeoCoordinate.prototype.OriginToGC(A);r=x3dom.nodeTypes.GeoLocation.prototype.getGeoRotMat(t,a).inverse().mult(r)}var d=x3dom.nodeTypes.GeoCoordinate.prototype.GEOtoX3D(t,A,o)[0];return x3dom.fields.SFMatrix4f.translation(d).mult(r).inverse()},getFieldOfView:function(){return this._vf.fieldOfView},resetView:function(){this._viewMatrix=this.getInitViewMatrix(this._vf.orientation,this._vf.geoSystem,this._cf.geoOrigin,this._vf.position),this._vf.centerOfRotation=this.getGeoCenterOfRotation(this._vf.geoSystem,this._cf.geoOrigin,this._geoCenterOfRotation),this._nameSpace.doc._viewarea&&this._nameSpace.doc._viewarea.resetNavHelpers()},getNear:function(){return this._zNear},getFar:function(){return this._zFar},getImgPlaneHeightAtDistOne:function(){return this._imgPlaneHeightAtDistOne},getProjectionMatrix:function(e){var t=this._vf.fieldOfView,A=this._vf.zFar,i=this._vf.zNear;if(i<=0||A<=0){var o=.8,s=1.2,n=this._nameSpace.doc._viewarea,r=n._scene,a=x3dom.fields.SFVec3f.copy(r._lastMin),d=x3dom.fields.SFVec3f.copy(r._lastMax).subtract(a),h=d.length()/2,g=n.getViewMatrix().inverse(),l=g.e3(),I=new x3dom.fields.SFVec3f(0,0,0),c=new x3dom.fields.SFVec3f(1,1,1),f=new x3dom.fields.Quaternion(0,0,1,0),u=new x3dom.fields.Quaternion(0,0,1,0);g.getTransform(I,f,c,u);var C=c.x,_=c.x;_<c.y&&(_=c.y),C>c.y&&(C=c.y),_<c.z&&(_=c.z),C>c.z&&(C=c.z),_>1?o/=_:C>x3dom.fields.Eps&&C<1&&(s/=C);var m=a.add(d.multiply(.5)),p=l.subtract(m).length();h?(i=p>h?(p-h)*o:0,A=(p+h)*s):(i=.1,A=1e5);var E=A/this._zRatio;i=Math.max(i,Math.max(x3dom.fields.Eps,E)),A>this._vf.zNear&&this._vf.zNear>0&&(i=this._vf.zNear),this._vf.zFar>i&&(A=this._vf.zFar),A<=i&&(A=i+1)}if(null==this._projMatrix)this._projMatrix=x3dom.fields.SFMatrix4f.perspective(t,e,i,A);else if(this._zNear!=i||this._zFar!=A){var B=i-A;this._projMatrix._22=(i+A)/B,this._projMatrix._23=2*i*A/B}else this._lastAspect!=e&&(this._projMatrix._00=1/Math.tan(t/2)/e,this._lastAspect=e);return this._zNear=i,this._zFar=A,this._projMatrix}})),x3dom.registerNodeType("ScreenGroup","Layout",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.ScreenGroup.superClass.call(this,e)}),{collectDrawableObjects:function(e,t,A,i,o,s){if(A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),this.collectBbox(e,t,A,i,o,s),!((o=t.cull(e,this.graphState(),A,o))<0)){var n,r,a,d,h,g,l,I,c,f;A=!1,r=(n=this._nameSpace.doc)._scene.getViewpoint(),d=n._x3dElem.clientHeight/r.getImgPlaneHeightAtDistOne(),g=e,h=new x3dom.fields.SFVec3f(0,0,-1),l=a=new x3dom.fields.SFVec3f(0,0,0),I=t.viewMatrix.multMatrixPnt(g.multMatrixPnt(a)).subtract(l),c=h.dot(I)/d,f=x3dom.fields.SFMatrix4f.scale(new x3dom.fields.SFVec3f(c,c,c));for(var u=this.transformMatrix(g.mult(f)),C=0,_=this._childNodes.length;C<_;C++){var m=this._childNodes[C];m&&m.collectDrawableObjects(u,t,A,i,o,s)}}}})),x3dom.registerNodeType("X3DPlanarGeometryNode","Geometry2D",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.X3DPlanarGeometryNode.superClass.call(this,e)}))),x3dom.registerNodeType("Arc2D","Geometry2D",defineClass(x3dom.nodeTypes.X3DPlanarGeometryNode,(function(e){x3dom.nodeTypes.Arc2D.superClass.call(this,e),this.addField_SFFloat(e,"radius",1),this.addField_SFFloat(e,"startAngle",0),this.addField_SFFloat(e,"endAngle",Math.PI/2),this.addField_SFFloat(e,"subdivision",32),this._mesh._primType="LINES";var t=this._vf.radius,A=this._vf.startAngle,i=this._vf.endAngle,o=2*Math.PI;A-=Math.floor(A/o)*o,(i-=Math.floor(i/o)*o)<=A&&(i+=o);var s="Arc2D_"+t+A+i;if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[s])this._mesh=x3dom.geoCache[s];else{for(var n=this._vf.subdivision,r=(i-A)/n,a=A,d=0;d<=n+1;d++){var h=Math.cos(a)*t,g=Math.sin(a)*t;this._mesh._positions[0].push(h),this._mesh._positions[0].push(g),this._mesh._positions[0].push(0),a+=r}for(var l=0;l<n;l++)this._mesh._indices[0].push(l),this._mesh._indices[0].push(l+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[s]=this._mesh}}),{fieldChanged:function(e){if("radius"==e||"subdivision"==e||"startAngle"==e||"endAngle"==e){this._mesh._positions[0]=[],this._mesh._indices[0]=[];var t=this._vf.radius,A=this._vf.startAngle,i=this._vf.endAngle,o=this._vf.subdivision,s=2*Math.PI;A-=Math.floor(A/s)*s,(i-=Math.floor(i/s)*s)<=A&&(i+=s);for(var n=(i-A)/o,r=A,a=0;a<=o+1;a++){var d=Math.cos(r)*t,h=Math.sin(r)*t;this._mesh._positions[0].push(d),this._mesh._positions[0].push(h),this._mesh._positions[0].push(0),r+=n}for(var g=0;g<o;g++)this._mesh._indices[0].push(g),this._mesh._indices[0].push(g+1);this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e._dirty.positions=!0,e._dirty.indexes=!0,e.invalidateVolume()}))}}})),x3dom.registerNodeType("ArcClose2D","Geometry2D",defineClass(x3dom.nodeTypes.X3DPlanarGeometryNode,(function(e){x3dom.nodeTypes.ArcClose2D.superClass.call(this,e),this.addField_SFString(e,"closureType","PIE"),this.addField_SFFloat(e,"radius",1),this.addField_SFFloat(e,"startAngle",0),this.addField_SFFloat(e,"endAngle",Math.PI/2),this.addField_SFFloat(e,"subdivision",32);var t=this._vf.radius,A=this._vf.startAngle,i=this._vf.endAngle,o=this._vf.subdivision,s=this._vf.ccw,n=2*Math.PI;A-=Math.floor(A/n)*n,(i-=Math.floor(i/n)*n)<=A&&(i+=n);var r=["ArcClose2D",t,A,i,this._vf.closureType,o,s].join("-");if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[r])this._mesh=x3dom.geoCache[r];else{var a=(i-A)/o,d=A,h=s?1:-1;if("PIE"==this._vf.closureType.toUpperCase()){this._mesh._positions[0].push(0),this._mesh._positions[0].push(0),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*h),this._mesh._texCoords[0].push(.5),this._mesh._texCoords[0].push(.5);for(var g=0;g<=o;g++){var l=Math.cos(d)*t,I=Math.sin(d)*t;this._mesh._positions[0].push(l),this._mesh._positions[0].push(I),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*h),this._mesh._texCoords[0].push((l+t)/(2*t)),this._mesh._texCoords[0].push((I+t)/(2*t)),d+=a}for(var c=1;c<=o;c++)this._mesh._indices[0].push(c+1),this._mesh._indices[0].push(0),this._mesh._indices[0].push(c)}else{for(g=0;g<=o;g++){l=Math.cos(d)*t,I=Math.sin(d)*t;this._mesh._positions[0].push(l),this._mesh._positions[0].push(I),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*h),this._mesh._texCoords[0].push((l+t)/(2*t)),this._mesh._texCoords[0].push((I+t)/(2*t)),d+=a}l=(this._mesh._positions[0][0]+this._mesh._positions[0][this._mesh._positions[0].length-3])/2,I=(this._mesh._positions[0][1]+this._mesh._positions[0][this._mesh._positions[0].length-2])/2;this._mesh._positions[0].push(l),this._mesh._positions[0].push(I),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*h),this._mesh._texCoords[0].push((l+t)/(2*t)),this._mesh._texCoords[0].push((I+t)/(2*t));for(c=0;c<o;c++)this._mesh._indices[0].push(c+1),this._mesh._indices[0].push(o+1),this._mesh._indices[0].push(c)}this._mesh._numTexComponents=2,this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[r]=this._mesh}}),{fieldChanged:function(e){var t=this._vf.radius,A=this._vf.startAngle,i=this._vf.endAngle,o=this._vf.subdivision,s=this._vf.ccw,n=2*Math.PI;A-=Math.floor(A/n)*n,(i-=Math.floor(i/n)*n)<=A&&(i+=n);var r=(i-A)/o,a=A;if("radius"===e){if(this._mesh._positions[0]=[],"PIE"==this._vf.closureType.toUpperCase()){this._mesh._positions[0].push(0),this._mesh._positions[0].push(0),this._mesh._positions[0].push(0);for(var d=0;d<=o;d++){var h=Math.cos(a)*t,g=Math.sin(a)*t;this._mesh._positions[0].push(h),this._mesh._positions[0].push(g),this._mesh._positions[0].push(0),a+=r}}else{for(d=0;d<=o;d++){h=Math.cos(a)*t,g=Math.sin(a)*t;this._mesh._positions[0].push(h),this._mesh._positions[0].push(g),this._mesh._positions[0].push(0),a+=r}h=(this._mesh._positions[0][0]+this._mesh._positions[0][this._mesh._positions[0].length-3])/2,g=(this._mesh._positions[0][1]+this._mesh._positions[0][this._mesh._positions[0].length-2])/2;this._mesh._positions[0].push(h),this._mesh._positions[0].push(g),this._mesh._positions[0].push(0)}this.invalidateVolume(),this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))}else if("closureType"==e||"subdivision"==e||"startAngle"==e||"endAngle"==e){if(this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],"PIE"==this._vf.closureType.toUpperCase()){this._mesh._positions[0].push(0),this._mesh._positions[0].push(0),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*s),this._mesh._texCoords[0].push(.5),this._mesh._texCoords[0].push(.5);for(d=0;d<=o;d++){h=Math.cos(a)*t,g=Math.sin(a)*t;this._mesh._positions[0].push(h),this._mesh._positions[0].push(g),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*s),this._mesh._texCoords[0].push((h+t)/(2*t)),this._mesh._texCoords[0].push((g+t)/(2*t)),a+=r}for(var l=1;l<=o;l++)this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(0),this._mesh._indices[0].push(l)}else{for(d=0;d<=o;d++){h=Math.cos(a)*t,g=Math.sin(a)*t;this._mesh._positions[0].push(h),this._mesh._positions[0].push(g),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*s),this._mesh._texCoords[0].push((h+t)/(2*t)),this._mesh._texCoords[0].push((g+t)/(2*t)),a+=r}h=(this._mesh._positions[0][0]+this._mesh._positions[0][this._mesh._positions[0].length-3])/2,g=(this._mesh._positions[0][1]+this._mesh._positions[0][this._mesh._positions[0].length-2])/2;this._mesh._positions[0].push(h),this._mesh._positions[0].push(g),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*s),this._mesh._texCoords[0].push((h+t)/(2*t)),this._mesh._texCoords[0].push((g+t)/(2*t));for(l=0;l<o;l++)this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(o+1),this._mesh._indices[0].push(l)}this._mesh._numTexComponents=2,this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e.setAllDirty()}))}}})),x3dom.registerNodeType("Circle2D","Geometry2D",defineClass(x3dom.nodeTypes.X3DPlanarGeometryNode,(function(e){x3dom.nodeTypes.Circle2D.superClass.call(this,e),this.addField_SFFloat(e,"radius",1),this.addField_SFFloat(e,"subdivision",32),this._mesh._primType="LINES";var t=this._vf.radius,A="Circle2D_"+t;if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[A])this._mesh=x3dom.geoCache[A];else{for(var i=this._vf.subdivision,o=0;o<=i;o++){var s=o*(2*Math.PI/i),n=Math.cos(s)*t,r=Math.sin(s)*t;this._mesh._positions[0].push(n),this._mesh._positions[0].push(r),this._mesh._positions[0].push(0)}for(o=0;o<i;o++)this._mesh._indices[0].push(o),o+1==i?this._mesh._indices[0].push(0):this._mesh._indices[0].push(o+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[A]=this._mesh}}),{fieldChanged:function(e){if("radius"==e||"subdivision"==e){var t=this._vf.radius,A=this._vf.subdivision;this._mesh._positions[0]=[],this._mesh._indices[0]=[];for(var i=0;i<=A;i++){var o=i*(2*Math.PI/A),s=Math.cos(o)*t,n=Math.sin(o)*t;this._mesh._positions[0].push(s),this._mesh._positions[0].push(n),this._mesh._positions[0].push(0)}for(i=0;i<A;i++)this._mesh._indices[0].push(i),i+1==A?this._mesh._indices[0].push(0):this._mesh._indices[0].push(i+1);this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e._dirty.positions=!0,e._dirty.indexes=!0,e.invalidateVolume()}))}}})),x3dom.registerNodeType("Disk2D","Geometry2D",defineClass(x3dom.nodeTypes.X3DPlanarGeometryNode,(function(e){x3dom.nodeTypes.Disk2D.superClass.call(this,e),this.addField_SFFloat(e,"innerRadius",0),this.addField_SFFloat(e,"outerRadius",1),this.addField_SFFloat(e,"subdivision",32);var t=this._vf.innerRadius,A=this._vf.outerRadius,i=this._vf.subdivision,o=this._vf.ccw,s=["Disk2D",t,A,i,o].join("-");if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[s])this._mesh=x3dom.geoCache[s];else{for(var n=o?1:-1,r=0;r<=i;r++){var a=r*(2*Math.PI/i),d=Math.cos(a)*A,h=Math.sin(a)*A,g=Math.cos(a)*t,l=Math.sin(a)*t;this._mesh._positions[0].push(d),this._mesh._positions[0].push(h),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*n),this._mesh._texCoords[0].push((d+A)/(2*A)),this._mesh._texCoords[0].push((h+A)/(2*A)),this._mesh._positions[0].push(g),this._mesh._positions[0].push(l),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*n),this._mesh._texCoords[0].push((g+A)/(2*A)),this._mesh._texCoords[0].push((l+A)/(2*A))}for(r=0;r<2*i;r+=2)r==2*i-2?(this._mesh._indices[0].push(r+1),this._mesh._indices[0].push(r),this._mesh._indices[0].push(1),this._mesh._indices[0].push(1),this._mesh._indices[0].push(r),this._mesh._indices[0].push(0)):(this._mesh._indices[0].push(r+1),this._mesh._indices[0].push(r),this._mesh._indices[0].push(r+3),this._mesh._indices[0].push(r+3),this._mesh._indices[0].push(r),this._mesh._indices[0].push(r+2));this._mesh._numTexComponents=2,this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[s]=this._mesh}}),{fieldChanged:function(e){var t=this._vf.ccw?1:-1;if("innerRadius"==e||"outerRadius"==e||"subdivision"==e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];for(var A=this._vf.innerRadius,i=this._vf.outerRadius,o=this._vf.subdivision,s=0;s<=o;s++){var n=s*(2*Math.PI/o),r=Math.cos(n)*i,a=Math.sin(n)*i,d=Math.cos(n)*A,h=Math.sin(n)*A;this._mesh._positions[0].push(r),this._mesh._positions[0].push(a),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*t),this._mesh._texCoords[0].push((r+i)/(2*i)),this._mesh._texCoords[0].push((a+i)/(2*i)),this._mesh._positions[0].push(d),this._mesh._positions[0].push(h),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1*t),this._mesh._texCoords[0].push((d+i)/(2*i)),this._mesh._texCoords[0].push((h+i)/(2*i))}for(s=0;s<2*o;s+=2)s==2*o-2?(this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s),this._mesh._indices[0].push(1),this._mesh._indices[0].push(1),this._mesh._indices[0].push(s),this._mesh._indices[0].push(0)):(this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+3),this._mesh._indices[0].push(s+3),this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+2));this._mesh._numTexComponents=2,this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e.setAllDirty()}))}}})),x3dom.registerNodeType("Polyline2D","Geometry2D",defineClass(x3dom.nodeTypes.X3DPlanarGeometryNode,(function(e){x3dom.nodeTypes.Polyline2D.superClass.call(this,e),this.addField_MFVec2f(e,"lineSegments",[]),this._mesh._primType="LINES";var t=0,A=0;this._vf.lineSegments.length&&(t=this._vf.lineSegments[0].x,A=this._vf.lineSegments[0].y);var i="Polyline2D_"+t+"-"+A;if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[i])this._mesh=x3dom.geoCache[i];else{for(var o=0;o<this._vf.lineSegments.length;o++)t=this._vf.lineSegments[o].x,A=this._vf.lineSegments[o].y,this._mesh._positions[0].push(t),this._mesh._positions[0].push(A),this._mesh._positions[0].push(0);for(var s=0;s<this._vf.lineSegments.length-1;s++)this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[i]=this._mesh}}),{fieldChanged:function(e){if("lineSegments"==e){var t,A;this._mesh._positions[0]=[],this._mesh._indices[0]=[];for(var i=0;i<this._vf.lineSegments.length;i++)t=this._vf.lineSegments[i].x,A=this._vf.lineSegments[i].y,this._mesh._positions[0].push(t),this._mesh._positions[0].push(A),this._mesh._positions[0].push(0);for(var o=0;o<this._vf.lineSegments.length-1;o++)this._mesh._indices[0].push(o),this._mesh._indices[0].push(o+1);this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/2,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e._dirty.positions=!0,e._dirty.indexes=!0,e.invalidateVolume()}))}}})),x3dom.registerNodeType("Polypoint2D","Geometry2D",defineClass(x3dom.nodeTypes.X3DPlanarGeometryNode,(function(e){x3dom.nodeTypes.Polypoint2D.superClass.call(this,e),this.addField_MFVec2f(e,"point",[]),this._mesh._primType="POINTS";var t=0,A=0;this._vf.point.length&&(t=this._vf.point[0].x,A=this._vf.point[0].y);var i="Polypoint2D_"+t+"-"+A;if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[i])this._mesh=x3dom.geoCache[i];else{for(var o=0;o<this._vf.point.length;o++)t=this._vf.point[o].x,A=this._vf.point[o].y,this._mesh._positions[0].push(t),this._mesh._positions[0].push(A),this._mesh._positions[0].push(0);this._mesh._invalidate=!0,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[i]=this._mesh}}),{fieldChanged:function(e){if("point"==e){this._mesh._positions[0]=[],this._mesh._indices[0]=[];for(var t=0;t<this._vf.point.length;t++){var A=this._vf.point[t].x,i=this._vf.point[t].y;this._mesh._positions[0].push(A),this._mesh._positions[0].push(i),this._mesh._positions[0].push(0)}this.invalidateVolume(),this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}))}}})),x3dom.registerNodeType("Rectangle2D","Geometry2D",defineClass(x3dom.nodeTypes.X3DPlanarGeometryNode,(function(e){x3dom.nodeTypes.Rectangle2D.superClass.call(this,e),this.addField_SFVec2f(e,"size",2,2),this.addField_SFVec2f(e,"subdivision",1,1);var t=this._vf.size.x,A=this._vf.size.y,i=this._vf.subdivision.x,o=this._vf.subdivision.y,s=this._vf.ccw,n=["Rectangle2D",t,A,i,o,s].join("-");if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[n])this._mesh=x3dom.geoCache[n];else{var r=t/i,a=A/o,d=s?1:-1;t/=2,A/=2;for(var h=0;h<=i;h++)for(var g=0;g<=o;g++)this._mesh._positions[0].push(h*r-t,g*a-A,0),this._mesh._normals[0].push(0,0,1*d),this._mesh._texCoords[0].push(h/i,g/o);for(h=1;h<=o;h++)for(g=0;g<i;g++)this._mesh._indices[0].push((h-1)*(i+1)+g+1),this._mesh._indices[0].push((h-1)*(i+1)+g),this._mesh._indices[0].push(h*(i+1)+g),this._mesh._indices[0].push((h-1)*(i+1)+g+1),this._mesh._indices[0].push(h*(i+1)+g),this._mesh._indices[0].push(h*(i+1)+g+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[n]=this._mesh}}),{fieldChanged:function(e){if("size"==e){this._mesh._positions[0]=[];var t=this._vf.size,A=t.x/2,i=t.y/2,o=A/(a=this._vf.subdivision.x),s=i/(d=this._vf.subdivision.y);A/=2,i/=2;for(var n=0;n<=a;n++)for(var r=0;r<=d;r++)this._mesh._positions[0].push(n*o-A,r*s-i,0);this.invalidateVolume(),this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e.setAllDirty()}))}else if("subdivision"==e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];A=this._vf.size.x/2,i=this._vf.size.y/2,o=A/(a=this._vf.subdivision.x),s=i/(d=this._vf.subdivision.y);var a,d,h=this._vf.ccw?1:-1;A/=2,i/=2;for(n=0;n<=a;n++)for(r=0;r<=d;r++)this._mesh._positions[0].push(n*o-A,r*s-i,0),this._mesh._normals[0].push(0,0,1*h),this._mesh._texCoords[0].push(n/a,r/d);for(n=1;n<=d;n++)for(r=0;r<a;r++)this._mesh._indices[0].push((n-1)*(a+1)+r+1),this._mesh._indices[0].push((n-1)*(a+1)+r),this._mesh._indices[0].push(n*(a+1)+r),this._mesh._indices[0].push((n-1)*(a+1)+r+1),this._mesh._indices[0].push(n*(a+1)+r),this._mesh._indices[0].push(n*(a+1)+r+1);this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e.setAllDirty()}))}}})),x3dom.registerNodeType("TriangleSet2D","Geometry2D",defineClass(x3dom.nodeTypes.X3DPlanarGeometryNode,(function(e){x3dom.nodeTypes.TriangleSet2D.superClass.call(this,e),this.addField_MFVec2f(e,"vertices",[]);var t=0,A=0;this._vf.vertices.length&&(t=this._vf.vertices[0].x,A=this._vf.vertices[0].y);var i="TriangleSet2D_"+t+"-"+A;if(this._vf.useGeoCache&&void 0!==x3dom.geoCache[i])this._mesh=x3dom.geoCache[i];else{var o=0,s=0,n=0,r=0;this._vf.vertices.length&&(o=this._vf.vertices[0].x,s=this._vf.vertices[0].y,n=this._vf.vertices[0].x,r=this._vf.vertices[0].y);for(var a=0;a<this._vf.vertices.length;a++)this._vf.vertices[a].x<o&&(o=this._vf.vertices[a].x),this._vf.vertices[a].y<s&&(s=this._vf.vertices[a].y),this._vf.vertices[a].x>n&&(n=this._vf.vertices[a].x),this._vf.vertices[a].y>r&&(r=this._vf.vertices[a].y);for(a=0;a<this._vf.vertices.length;a++)t=this._vf.vertices[a].x,A=this._vf.vertices[a].y,this._mesh._positions[0].push(t),this._mesh._positions[0].push(A),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1),this._mesh._texCoords[0].push((t-o)/(n-o)),this._mesh._texCoords[0].push((A-s)/(r-s));for(var d=0;d<this._vf.vertices.length;d+=3)this._mesh._indices[0].push(d),this._mesh._indices[0].push(d+2),this._mesh._indices[0].push(d+1);this._mesh._numTexComponents=2,this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[i]=this._mesh}}),{fieldChanged:function(e){if("vertices"==e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];for(var t=this._vf.vertices[0].x,A=this._vf.vertices[0].y,i=this._vf.vertices[0].x,o=this._vf.vertices[0].y,s=0;s<this._vf.vertices.length;s++)this._vf.vertices[s].x<t&&(t=this._vf.vertices[s].x),this._vf.vertices[s].y<A&&(A=this._vf.vertices[s].y),this._vf.vertices[s].x>i&&(i=this._vf.vertices[s].x),this._vf.vertices[s].y>o&&(o=this._vf.vertices[s].y);for(s=0;s<this._vf.vertices.length;s++){var n=this._vf.vertices[s].x,r=this._vf.vertices[s].y;this._mesh._positions[0].push(n),this._mesh._positions[0].push(r),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1),this._mesh._texCoords[0].push((n-t)/(i-t)),this._mesh._texCoords[0].push((r-A)/(o-A))}for(var a=0;a<this._vf.vertices.length;a+=3)this._mesh._indices[0].push(a),this._mesh._indices[0].push(a+2),this._mesh._indices[0].push(a+1);this._mesh._numTexComponents=2,this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,this._parentNodes.forEach((function(e){e.setAllDirty()}))}}})),x3dom.registerNodeType("X3DVolumeDataNode","VolumeRendering",defineClass(x3dom.nodeTypes.X3DShapeNode,(function(e){x3dom.nodeTypes.X3DVolumeDataNode.superClass.call(this,e),this.addField_SFVec3f(e,"dimensions",1,1,1),this.addField_SFNode("voxels",x3dom.nodeTypes.Texture),this.addField_SFBool(e,"allowViewpointInside",!0),this._textureID=0,this._first=!0,this._styleList=[],this.surfaceNormalsNeeded=!1,this.normalTextureProvided=!1,this.fragmentPreamble="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n\n"}),{getTextureSize:function(e){var t,A={w:0,h:0,valid:!1},i=this._webgl?this._webgl.texture:null,o=e&&i?i.length:0;for(t=0;t<o;t++)if(e==i[t].node&&i[t].texture){A.w=i[t].texture.width,A.h=i[t].texture.height,A.w&&A.h&&(A.valid=!0);break}return A},vertexShaderText:function(e){var t="attribute vec3 position;\nuniform vec3 dimensions;\nuniform mat4 modelViewProjectionMatrix;\nvarying vec4 vertexPosition;\nvarying vec4 pos;\n";return(x3dom.nodeTypes.X3DLightNode.lightID>0||!0===e)&&(t+="uniform mat4 modelViewMatrix;\nvarying vec4 position_eye;\n"),t+="\nvoid main()\n{\n  vertexPosition = modelViewProjectionMatrix * vec4(position, 1.0);\n",(x3dom.nodeTypes.X3DLightNode.lightID>0||!0===e)&&(t+="  position_eye = modelViewMatrix * vec4(position, 1.0);\n"),t+="  pos = vec4((position/dimensions)+0.5, 1.0);\n  gl_Position = vertexPosition;\n}"},defaultUniformsShaderText:function(e,t,A,i){var o="uniform sampler2D uVolData;\nuniform vec3 dimensions;\nuniform vec3 offset;\nuniform mat4 modelViewMatrix;\nuniform mat4 modelViewMatrixInverse;\nvarying vec4 vertexPosition;\nvarying vec4 pos;\n";(x3dom.nodeTypes.X3DLightNode.lightID>0||!0===i)&&(o+="varying vec4 position_eye;\n");for(var s=0;s<x3dom.nodeTypes.X3DLightNode.lightID;s++)o+="uniform float light"+s+"_On;\nuniform float light"+s+"_Type;\nuniform vec3  light"+s+"_Location;\nuniform vec3  light"+s+"_Direction;\nuniform vec3  light"+s+"_Color;\nuniform vec3  light"+s+"_Attenuation;\nuniform float light"+s+"_Radius;\nuniform float light"+s+"_Intensity;\nuniform float light"+s+"_AmbientIntensity;\nuniform float light"+s+"_BeamWidth;\nuniform float light"+s+"_CutOffAngle;\nuniform float light"+s+"_ShadowIntensity;\n";return o+="const float Steps = 85.0;\nconst float numberOfSlices = "+e.toPrecision(5)+";\nconst float slicesOverX = "+t.toPrecision(5)+";\nconst float slicesOverY = "+A.toPrecision(5)+";\n"},texture3DFunctionShaderText:"vec4 cTexture3D(sampler2D vol, vec3 volpos, float nS, float nX, float nY)\n{\n  float s1,s2;\n  float dx1,dy1;\n  float dx2,dy2;\n  vec2 texpos1,texpos2;\n  s1 = floor(volpos.z*nS);\n  s2 = s1+1.0;\n  dx1 = fract(s1/nX);\n  dy1 = floor(s1/nX)/nY;\n  dx2 = fract(s2/nX);\n  dy2 = floor(s2/nX)/nY;\n  texpos1.x = dx1+(volpos.x/nX);\n  texpos1.y = dy1+(volpos.y/nY);\n  texpos2.x = dx2+(volpos.x/nX);\n  texpos2.y = dy2+(volpos.y/nY);\n  return mix( texture2D(vol,texpos1), texture2D(vol,texpos2), (volpos.z*nS)-s1);\n}\n\n",normalFunctionShaderText:function(){return this.surfaceNormalsNeeded?"vec4 getNormalFromTexture(sampler2D sampler, vec3 pos, float nS, float nX, float nY) {\n   vec4 n = (2.0*cTexture3D(sampler, pos, nS, nX, nY)-1.0);\n   return vec4(normalize(n.xyz), length(n.xyz));\n}\n\nvec4 getNormalOnTheFly(sampler2D sampler, vec3 voxPos, float nS, float nX, float nY){\n   float v0 = cTexture3D(sampler, voxPos + vec3(offset.x, 0, 0), nS, nX, nY).r;\n   float v1 = cTexture3D(sampler, voxPos - vec3(offset.x, 0, 0), nS, nX, nY).r;\n   float v2 = cTexture3D(sampler, voxPos + vec3(0, offset.y, 0), nS, nX, nY).r;\n   float v3 = cTexture3D(sampler, voxPos - vec3(0, offset.y, 0), nS, nX, nY).r;\n   float v4 = cTexture3D(sampler, voxPos + vec3(0, 0, offset.z), nS, nX, nY).r;\n   float v5 = cTexture3D(sampler, voxPos - vec3(0, 0, offset.z), nS, nX, nY).r;\n   vec3 grad = vec3(v0-v1, v2-v3, v4-v5)*0.5;\n   return vec4(normalize(grad), length(grad));\n}\n\n":""},defaultLoopFragmentShaderText:function(e,t,A){A=void 0!==A?A:"";var i="void main()\n{\n  vec3 cam_pos = vec3(modelViewMatrixInverse[3][0], modelViewMatrixInverse[3][1], modelViewMatrixInverse[3][2]);\n  vec3 cam_cube = cam_pos/dimensions+0.5;\n  vec3 dir = normalize(pos.xyz-cam_cube);\n";return this._vf.allowViewpointInside?i+="  float cam_inside = float(all(bvec2(all(lessThan(cam_cube, vec3(1.0))),all(greaterThan(cam_cube, vec3(0.0))))));\n  vec3 ray_pos = mix(pos.xyz, cam_cube, cam_inside);\n":i+="  vec3 ray_pos = pos.xyz;\n",i+="  vec4 accum  = vec4(0.0, 0.0, 0.0, 0.0);\n  vec4 sample = vec4(0.0, 0.0, 0.0, 0.0);\n  vec4 value  = vec4(0.0, 0.0, 0.0, 0.0);\n  float cont = 0.0;\n  vec3 step_size = (dir*1.4142)/Steps;\n",x3dom.nodeTypes.X3DLightNode.lightID>0?i+="  vec3 ambient = vec3(0.0, 0.0, 0.0);\n  vec3 diffuse = vec3(0.0, 0.0, 0.0);\n  vec3 specular = vec3(0.0, 0.0, 0.0);\n  vec4 step_eye = modelViewMatrix * vec4(step_size, 0.0);\n  vec4 positionE = position_eye;\n  float lightFactor = 1.0;\n":i+="  float lightFactor = 1.2;\n",i+=A+"  float opacityFactor = 10.0;\n  float t_near;\n  float t_far;\n  for(float i = 0.0; i < Steps; i+=1.0)\n  {\n    value = cTexture3D(uVolData, ray_pos, numberOfSlices, slicesOverX, slicesOverY);\n    value = value.rgbr;\n",this.surfaceNormalsNeeded&&(this.normalTextureProvided?i+="    vec4 gradEye = getNormalFromTexture(uSurfaceNormals, ray_pos, numberOfSlices, slicesOverX, slicesOverY);\n":i+="    vec4 gradEye = getNormalOnTheFly(uVolData, ray_pos, numberOfSlices, slicesOverX, slicesOverY);\n",i+="    vec4 grad = vec4((modelViewMatrix * vec4(gradEye.xyz, 0.0)).xyz, gradEye.a);\n"),i+=e,x3dom.nodeTypes.X3DLightNode.lightID>0&&(i+=t),i+="    sample.a = value.a * opacityFactor * (1.0/Steps);\n    sample.rgb = value.rgb * sample.a * lightFactor;\n    accum.rgb += (1.0 - accum.a) * sample.rgb;\n    accum.a += (1.0 - accum.a) * sample.a;\n    ray_pos.xyz += step_size;\n",x3dom.nodeTypes.X3DLightNode.lightID>0&&(i+="    positionE += step_eye;\n"),i+="    if(accum.a >= 1.0 || ray_pos.x < 0.0 || ray_pos.y < 0.0 || ray_pos.z < 0.0 || ray_pos.x > 1.0 || ray_pos.y > 1.0 || ray_pos.z > 1.0)\n      break;\n  }\n  gl_FragColor = accum;\n}"}})),x3dom.registerNodeType("X3DVolumeRenderStyleNode","VolumeRendering",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.X3DVolumeRenderStyleNode.superClass.call(this,e),this.addField_SFBool(e,"enabled",!0),this._styleID=0,this._first=!1,this._volumeDataParent=null}),{nodeChanged:function(){this._styleID||(this._styleID=++x3dom.nodeTypes.X3DVolumeRenderStyleNode.styleID)},updateProperties:function(e){if(this._cf.renderStyle)if(this._cf.renderStyle.nodes)for(var t=0;t<this._cf.renderStyle.nodes.length;t++)null!=this._cf.renderStyle.nodes[t].updateProperties&&this._cf.renderStyle.nodes[t].updateProperties(e);else this._cf.renderStyle.node&&this._cf.renderStyle.node.updateProperties(e);this._volumeDataParent=e,-1!=this._volumeDataParent._styleList.indexOf(this.typeName())?this._first=!1:(this._first=!0,this._volumeDataParent._styleList.push(this.typeName()))},initializeValues:function(){return""},styleUniformsShaderText:function(){return""},styleShaderText:function(){return""},inlineStyleShaderText:function(){return""},lightAssigment:function(){for(var e="",t=0;t<x3dom.nodeTypes.X3DLightNode.lightID;t++)e+="    lighting(light"+t+"_Type, light"+t+"_Location, light"+t+"_Direction, light"+t+"_Color, light"+t+"_Attenuation, light"+t+"_Radius, light"+t+"_Intensity, light"+t+"_AmbientIntensity, light"+t+"_BeamWidth, light"+t+"_CutOffAngle, grad.xyz, positionE.xyz, ambient, diffuse, specular);\n";return e+="    value.rgb = ambient*value.rgb + diffuse*value.rgb + specular;\n"},lightEquationShaderText:function(){return x3dom.nodeTypes.X3DLightNode.lightID>0?"void lighting(in float lType, in vec3 lLocation, in vec3 lDirection, in vec3 lColor, in vec3 lAttenuation, in float lRadius, in float lIntensity, in float lAmbientIntensity, in float lBeamWidth, in float lCutOffAngle, in vec3 N, in vec3 V, inout vec3 ambient, inout vec3 diffuse, inout vec3 specular)\n{\n   vec3 L;\n   float spot = 1.0, attentuation = 0.0;\n   if(lType == 0.0) {\n       L = -normalize(lDirection);\n       V = normalize(V);\n       attentuation = 1.0;\n   } else{\n       L = (lLocation - (-V));\n       float d = length(L);\n       L = normalize(L);\n       V = normalize(V);\n       if(lRadius == 0.0 || d <= lRadius) {\n           attentuation = 1.0 / max(lAttenuation.x + lAttenuation.y * d + lAttenuation.z * (d * d), 1.0);\n       }\n       if(lType == 2.0) {\n           float spotAngle = acos(max(0.0, dot(-L, normalize(lDirection))));\n           if(spotAngle >= lCutOffAngle) spot = 0.0;\n           else if(spotAngle <= lBeamWidth) spot = 1.0;\n           else spot = (spotAngle - lCutOffAngle ) / (lBeamWidth - lCutOffAngle);\n       }\n   }\n   vec3  H = normalize( L + V );\n   float NdotL = max(0.0, dot(L, N));\n   float NdotH = max(0.0, dot(H, N));\n   float ambientFactor  = lAmbientIntensity;\n   float diffuseFactor  = lIntensity * NdotL;\n   float specularFactor = lIntensity * pow(NdotH,128.0);\n   ambient  += lColor * ambientFactor * attentuation * spot;\n   diffuse  += lColor * diffuseFactor * attentuation * spot;\n   specular += lColor * specularFactor * attentuation * spot;\n}\n\n":""}})),x3dom.nodeTypes.X3DVolumeRenderStyleNode.styleID=0,x3dom.registerNodeType("X3DComposableVolumeRenderStyleNode","VolumeRendering",defineClass(x3dom.nodeTypes.X3DVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode.superClass.call(this,e),this.addField_SFNode("surfaceNormals",x3dom.nodeTypes.Texture)}),{})),x3dom.registerNodeType("BlendedVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.BlendedVolumeStyle.superClass.call(this,e),this.addField_SFNode("renderStyle",x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode),this.addField_SFNode("voxels",x3dom.nodeTypes.X3DVolumeDataNode),this.addField_SFFloat(e,"weightConstant1",.5),this.addField_SFFloat(e,"weightConstant2",.5),this.addField_SFString(e,"weightFunction1","CONSTANT"),this.addField_SFString(e,"weightFunction2","CONSTANT"),this.addField_SFNode("weightTransferFunction1",x3dom.nodeTypes.X3DTexture2DNode),this.addField_SFNode("weightTransferFunction2",x3dom.nodeTypes.X3DTexture2DNode),this.uniformFloatWeightConstant1=new x3dom.nodeTypes.Uniform(e),this.uniformFloatWeightConstant2=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DVoxels=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DWeightTransferFunction1=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DWeightTransferFunction2=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"weightConstant1":this.uniformFloatWeightConstant1._vf.value=this._vf.weightConstant1,this.uniformFloatWeightConstant1.fieldChanged("value");break;case"weightConstant2":this.uniformFloatWeightConstant2._vf.value=this._vf.weightConstant2,this.uniformFloatWeightConstant2.fieldChanged("value")}},uniforms:function(){var e=[];if((this._cf.voxels.node||this._cf.weightTransferFunction1.node||this._cf.weightTransferFunction2.node)&&(this.uniformSampler2DVoxels._vf.name="uVolBlendData",this.uniformSampler2DVoxels._vf.type="SFInt32",this.uniformSampler2DVoxels._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DVoxels),this._cf.weightTransferFunction1.node&&(this.uniformSampler2DWeightTransferFunction1._vf.name="uWeightTransferFunctionA",this.uniformSampler2DWeightTransferFunction1._vf.type="SFInt32",this.uniformSampler2DWeightTransferFunction1._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DWeightTransferFunction1)),this._cf.weightTransferFunction2.node&&(this.uniformSampler2DWeightTransferFunction2._vf.name="uWeightTransferFunctionB",this.uniformSampler2DWeightTransferFunction2._vf.type="SFInt32",this.uniformSampler2DWeightTransferFunction2._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DWeightTransferFunction2))),this.uniformFloatWeightConstant1._vf.name="uWeightConstantA",this.uniformFloatWeightConstant1._vf.type="SFFloat",this.uniformFloatWeightConstant1._vf.value=this._vf.weightConstant1,e.push(this.uniformFloatWeightConstant1),this.uniformFloatWeightConstant2._vf.name="uWeightConstantB",this.uniformFloatWeightConstant2._vf.type="SFFloat",this.uniformFloatWeightConstant2._vf.value=this._vf.weightConstant2,e.push(this.uniformFloatWeightConstant2),this._cf.renderStyle.node){var t=this._cf.renderStyle.node.uniforms();t.forEach((function(e){e._vf.name=e._vf.name.replace(/uSurfaceNormals/,"uBlendSurfaceNormals")})),e=e.concat(t)}return e},textures:function(){var e,t=[];this._cf.voxels.node&&((e=this._cf.voxels.node)._vf.repeatS=!1,e._vf.repeatT=!1,t.push(e));this._cf.weightTransferFunction1.node&&((e=this._cf.weightTransferFunction1.node)._vf.repeatS=!1,e._vf.repeatT=!1,t.push(e));this._cf.weightTransferFunction2.node&&((e=this._cf.weightTransferFunction2.node)._vf.repeatS=!1,e._vf.repeatT=!1,t.push(e));if(this._cf.renderStyle.node){var A=this._cf.renderStyle.node.textures();t=t.concat(A)}return t},initializeValues:function(){var e="";return x3dom.nodeTypes.X3DLightNode.lightID>0&&(e+="  vec3 ambientBlend = vec3(0.0, 0.0, 0.0);\n  vec3 diffuseBlend = vec3(0.0, 0.0, 0.0);\n  vec3 specularBlend = vec3(0.0, 0.0, 0.0);\n"),e},styleUniformsShaderText:function(){var e="uniform float uWeightConstantA;\nuniform float uWeightConstantB;\nuniform sampler2D uBlendSurfaceNormals;\n";return this._cf.voxels.node&&(e+="uniform sampler2D uVolBlendData;\n"),this._cf.weightTransferFunction1.node&&(e+="uniform sampler2D uWeightTransferFunctionA;\n"),this._cf.weightTransferFunction2.node&&(e+="uniform sampler2D uWeightTransferFunctionB;\n"),this._cf.renderStyle.node&&(e+=this._cf.renderStyle.node.styleUniformsShaderText()),e},styleShaderText:function(){var e="";return this._cf.renderStyle.node&&null!=this._cf.renderStyle.node.styleShaderText&&(e+=this._cf.renderStyle.node.styleShaderText()),e},inlineStyleShaderText:function(){var e=this._cf.voxels.node._vf.numberOfSlices.toPrecision(5),t=this._cf.voxels.node._vf.slicesOverX.toPrecision(5),A=this._cf.voxels.node._vf.slicesOverY.toPrecision(5),i="    vec4 blendValue = cTexture3D(uVolBlendData, ray_pos, "+e+", "+t+", "+A+");\n    blendValue = vec4(blendValue.rgb,(0.299*blendValue.r)+(0.587*blendValue.g)+(0.114*blendValue.b));\n";(this._cf.renderStyle.node&&this._cf.renderStyle.node._cf.surfaceNormals.node?i+="    vec4 blendGradEye = getNormalFromTexture(uBlendSurfaceNormals, ray_pos, "+e+", "+t+", "+A+");\n":i+="    vec4 blendGradEye = getNormalOnTheFly(uVolBlendData, ray_pos, "+e+", "+t+", "+A+");\n",i+="    vec4 blendGrad = vec4((modelViewMatrix * vec4(blendGradEye.xyz, 0.0)).xyz, blendGradEye.a);\n",this._cf.renderStyle.node)&&(i+=this._cf.renderStyle.node.inlineStyleShaderText().replace(/value/gm,"blendValue").replace(/grad/gm,"blendGrad").replace(/ambient/gm,"ambientBlend").replace(/diffuse/gm,"diffuseBlend").replace(/specular/gm,"specularBlend"));switch(this._vf.weightFunction1.toUpperCase()){case"CONSTANT":i+="    float wA = uWeightConstantA;\n";break;case"ALPHA0":i+="    float wA = value.a;\n";break;case"ALPHA1":i+="    float wA = blendValue.a;\n";break;case"ONE_MINUS_ALPHA0":i+="    float wA = 1.0 - value.a;\n";break;case"ONE_MINUS_ALPHA1":i+="    float wA = 1.0 - blendValue.a;\n";break;case"TABLE":this._cf.weightTransferFunction1?i+="    float wA = texture2D(uWeightTransferFunctionA, vec2(value.a, blendValue.a));\n":(i+="    float wA = value.a;\n",x3dom.debug.logWarning("[VolumeRendering][BlendedVolumeStyle] TABLE specified on weightFunction1 but not weightTrnafer function provided, using ALPHA0."))}switch(this._vf.weightFunction2.toUpperCase()){case"CONSTANT":i+="    float wB = uWeightConstantB;\n";break;case"ALPHA0":i+="    float wB = value.a;\n";break;case"ALPHA1":i+="    float wB = blendValue.a;\n";break;case"ONE_MINUS_ALPHA0":i+="    float wB = 1.0 - value.a;\n";break;case"ONE_MINUS_ALPHA1":i+="    float wB = 1.0 - blendValue.a;\n";break;case"TABLE":this._cf.weightTransferFunction2?i+="    float wB = texture2D(uWeightTransferFunctionB, vec2(value.a, blendValue.a));\n":(i+="    float wB = value.a;\n",x3dom.debug.logWarning("[VolumeRendering][BlendedVolumeStyle] TABLE specified on weightFunction2 but not weightTrasnferFunction provided, using ALPHA0."))}return 0==x3dom.nodeTypes.X3DLightNode.lightID&&(i+="    value = clamp(value * wA + blendValue * wB, 0.0, 1.0);\n"),i},lightAssigment:function(){var e="";if(x3dom.nodeTypes.X3DLightNode.lightID>0)if(this._cf.renderStyle.node){e+=this._cf.renderStyle.node.lightAssigment().replace(/value/gm,"blendValue").replace(/grad/gm,"blendGrad").replace(/ambient/gm,"ambientBlend").replace(/diffuse/gm,"diffuseBlend").replace(/specular/gm,"specularBlend")}else{for(var t=0;t<x3dom.nodeTypes.X3DLightNode.lightID;t++)e+="    lighting(light"+t+"_Type, light"+t+"_Location, light"+t+"_Direction, light"+t+"_Color, light"+t+"_Attenuation, light"+t+"_Radius, light"+t+"_Intensity, light"+t+"_AmbientIntensity, light"+t+"_BeamWidth, light"+t+"_CutOffAngle, blendGradEye.xyz, -positionE.xyz, ambientBlend, diffuseBlend, specularBlend);\n";e+="    blendValue.rgb = ambientBlend*blendValue.rgb + diffuseBlend*blendValue.rgb + specularBlend;\n"}return e+="    value.rgb = clamp(value.rgb * wA + blendValue.rgb * wB, 0.0, 1.0);\n    value.a = clamp(value.a * wA + blendValue.a * wB, 0.0, 1.0);\n"}})),x3dom.registerNodeType("BoundaryEnhancementVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.BoundaryEnhancementVolumeStyle.superClass.call(this,e),this.addField_SFFloat(e,"retainedOpacity",1),this.addField_SFFloat(e,"boundaryOpacity",0),this.addField_SFFloat(e,"opacityFactor",1),this.uniformFloatRetainedOpacity=new x3dom.nodeTypes.Uniform(e),this.uniformFloatBoundaryOpacity=new x3dom.nodeTypes.Uniform(e),this.uniformFloatOpacityFactor=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DSurfaceNormals=new x3dom.nodeTypes.Uniform(e),this.uniformBoolEnableBoundary=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"retainedOpacity":this.uniformFloatRetainedOpacity._vf.value=this._vf.retainedOpacity,this.uniformFloatRetainedOpacity.fieldChanged("value");break;case"boundaryOpacity":this.uniformFloatBoundaryOpacity._vf.value=this._vf.boundaryOpacity,this.uniformFloatBoundaryOpacity.fieldChanged("value");break;case"opacityFactor":this.uniformFloatOpacityFactor._vf.value=this._vf.opacityFactor,this.uniformFloatOpacityFactor.fieldChanged("value")}},uniforms:function(){var e=[];if(this._cf.surfaceNormals.node){for(var t=this._parentNodes[0];!x3dom.isa(t,x3dom.nodeTypes.X3DVolumeDataNode)||!x3dom.isa(t,x3dom.nodeTypes.X3DNode);)t=t._parentNodes[0];0==x3dom.isa(t,x3dom.nodeTypes.X3DVolumeDataNode)&&(x3dom.debug.logError("[VolumeRendering][BoundaryEnhancementVolumeStyle] Not VolumeData parent found!"),t=null),this.uniformSampler2DSurfaceNormals._vf.name="uSurfaceNormals",this.uniformSampler2DSurfaceNormals._vf.type="SFInt32",this.uniformSampler2DSurfaceNormals._vf.value=t._textureID++,e.push(this.uniformSampler2DSurfaceNormals)}return this.uniformFloatRetainedOpacity._vf.name="uRetainedOpacity"+this._styleID,this.uniformFloatRetainedOpacity._vf.type="SFFloat",this.uniformFloatRetainedOpacity._vf.value=this._vf.retainedOpacity,e.push(this.uniformFloatRetainedOpacity),this.uniformFloatBoundaryOpacity._vf.name="uBoundaryOpacity"+this._styleID,this.uniformFloatBoundaryOpacity._vf.type="SFFloat",this.uniformFloatBoundaryOpacity._vf.value=this._vf.boundaryOpacity,e.push(this.uniformFloatBoundaryOpacity),this.uniformFloatOpacityFactor._vf.name="uOpacityFactor"+this._styleID,this.uniformFloatOpacityFactor._vf.type="SFFloat",this.uniformFloatOpacityFactor._vf.value=this._vf.opacityFactor,e.push(this.uniformFloatOpacityFactor),this.uniformBoolEnableBoundary._vf.name="uEnableBoundary"+this._styleID,this.uniformBoolEnableBoundary._vf.type="SFBool",this.uniformBoolEnableBoundary._vf.value=this._vf.enabled,e.push(this.uniformBoolEnableBoundary),e},textures:function(){var e=[];if(null!=this._cf.surfaceNormals.node){var t=this._cf.surfaceNormals.node;t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)}return e},styleUniformsShaderText:function(){return"uniform float uRetainedOpacity"+this._styleID+";\nuniform float uBoundaryOpacity"+this._styleID+";\nuniform float uOpacityFactor"+this._styleID+";\nuniform bool uEnableBoundary"+this._styleID+";\n"},styleShaderText:function(){return this._first?"void boundaryEnhancement(inout vec4 original_color, in float gradientMagnitude, in float retainedOpacity, in float boundaryOpacity, in float opacityFactor){\n   original_color.a = original_color.a * (retainedOpacity + (boundaryOpacity * pow(gradientMagnitude, opacityFactor)));\n}\n":""},inlineStyleShaderText:function(){return"    if(uEnableBoundary"+this._styleID+"){\n    boundaryEnhancement(value, grad.w, uRetainedOpacity"+this._styleID+", uBoundaryOpacity"+this._styleID+", uOpacityFactor"+this._styleID+");\n}\n"}})),x3dom.registerNodeType("CartoonVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.CartoonVolumeStyle.superClass.call(this,e),this.addField_SFColor(e,"parallelColor",0,0,0),this.addField_SFColor(e,"orthogonalColor",1,1,1),this.addField_SFInt32(e,"colorSteps",4),this.uniformParallelColor=new x3dom.nodeTypes.Uniform(e),this.uniformOrthogonalColor=new x3dom.nodeTypes.Uniform(e),this.uniformIntColorSteps=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DSurfaceNormals=new x3dom.nodeTypes.Uniform(e),this.uniformBoolEnableCartoon=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"parallelColor":this.uniformParallelColor._vf.value=this._vf.parallelColor,this.uniformParallelColor.fieldChanged("value");break;case"orthogonalColor":this.uniformOrthogonalColor._vf.value=this._vf.orthogonalColor,this.uniformOrthogonalColor.fieldChanged("value");break;case"colorSteps":this.uniformIntColorSteps._vf.value=this._vf.colorSteps,this.uniformIntColorSteps.fieldChanged("value")}},uniforms:function(){var e=[];return this._cf.surfaceNormals.node&&(this.uniformSampler2DSurfaceNormals._vf.name="uSurfaceNormals",this.uniformSampler2DSurfaceNormals._vf.type="SFInt32",this.uniformSampler2DSurfaceNormals._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DSurfaceNormals)),this.uniformParallelColor._vf.name="uParallelColor"+this._styleID,this.uniformParallelColor._vf.type="SFColor",this.uniformParallelColor._vf.value=this._vf.parallelColor,e.push(this.uniformParallelColor),this.uniformOrthogonalColor._vf.name="uOrthogonalColor"+this._styleID,this.uniformOrthogonalColor._vf.type="SFColor",this.uniformOrthogonalColor._vf.value=this._vf.orthogonalColor,e.push(this.uniformOrthogonalColor),this.uniformIntColorSteps._vf.name="uColorSteps"+this._styleID,this.uniformIntColorSteps._vf.type="SFInt32",this.uniformIntColorSteps._vf.value=this._vf.colorSteps,e.push(this.uniformIntColorSteps),this.uniformBoolEnableCartoon._vf.name="uEnableCartoon"+this._styleID,this.uniformBoolEnableCartoon._vf.type="SFBool",this.uniformBoolEnableCartoon._vf.value=this._vf.enabled,e.push(this.uniformBoolEnableCartoon),e},textures:function(){var e=[];if(this._cf.surfaceNormals.node){var t=this._cf.surfaceNormals.node;t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)}return e},styleShaderText:function(){return this._first?"//Convert RGBA color to HSVA\nvec4 rgba2hsva(vec4 rgba){\n   float zat, izen;\n   float R = rgba.r, G = rgba.g, B = rgba.b;\n   float minim = min(R, min(G, B)), maxim = max(R, max(G, B));\n   float delta = maxim-minim;\n   if(minim == maxim){\n       return vec4(0.0, 0.0, maxim, rgba.a);\n   }else{\n       zat = (R == maxim) ? G - B : ((G == maxim) ? B - R : R - G);\n       izen = (R == maxim) ? ((G<B) ? 6.0 : 0.0) : ((G == maxim) ? 2.0 : 4.0);\n        return vec4((zat/delta + izen)/6.0, delta/maxim, maxim, rgba.a);\n    }\n}\n\n//Convert RGB color to HSV\nvec3 rgb2hsv(vec3 rgb){\n    return rgba2hsva(vec4(rgb, 1.0)).rgb;\n}\n\n//Convert HSVA color to RGBA\nvec4 hsva2rgba(vec4 hsva){\n   float r, g, b;\n   float h=hsva.x, s=hsva.y, v=hsva.z;\n   float i = floor(h * 6.0);\n   float f = h * 6.0 - i;\n   float p = v * (1.0 - s);\n   float q = v * (1.0 - f * s);\n   float t = v * (1.0 - (1.0 - f) * s);\n   i = mod(i,6.0);\n   if( i == 6.0 || i == 0.0 ) r = v, g = t, b = p;\n   else if( i == 1.0) r = q, g = v, b = p;\n   else if( i == 2.0) r = p, g = v, b = t;\n   else if( i == 3.0) r = p, g = q, b = v;\n   else if( i == 4.0) r = t, g = p, b = v;\n   else if( i == 5.0) r = v, g = p, b = q;\n   return vec4(r,g,b,hsva.w);\n}\n\n//Convert HSV color to RGB\nvec3 hsv2rgb(vec3 hsv){\n   return hsva2rgba(vec4(hsv, 1.0)).rgb;\n}\nvoid getCartoonStyle(inout vec4 outputColor, vec3 orthogonalColor, vec3 parallelColor, int colorSteps, vec4 surfNormal, vec3 V)\n{\n   float steps = clamp(float(colorSteps), 1.0,64.0);\n   float range_size = pi_half / steps;\n   float cos_angle = abs(dot(surfNormal.xyz, V));\n   float interval = clamp(floor(cos_angle / range_size),0.0,steps);\n   float ang = interval * range_size;\n   outputColor.rgb = hsv2rgb(mix(orthogonalColor, parallelColor, ang));\n}\n\n":""},styleUniformsShaderText:function(){var e="uniform vec3 uParallelColor"+this._styleID+";\nuniform vec3 uOrthogonalColor"+this._styleID+";\nuniform int uColorSteps"+this._styleID+";\nuniform bool uEnableCartoon"+this._styleID+";\n";return this._first&&(e+="const float pi_half = "+(Math.PI/2).toPrecision(5)+";\n"),e},inlineStyleShaderText:function(){return"  if(uEnableCartoon"+this._styleID+"){\n      getCartoonStyle(value, rgb2hsv(uOrthogonalColor"+this._styleID+"), rgb2hsv(uParallelColor"+this._styleID+"), uColorSteps"+this._styleID+", gradEye, dir);\n  }\n"}})),x3dom.registerNodeType("ComposedVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.ComposedVolumeStyle.superClass.call(this,e),this.addField_MFNode("renderStyle",x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode),this.normalTextureProvided=!1}),{uniforms:function(){var e,t=[],A=this._cf.renderStyle.nodes.length;for(e=0;e<A;e++){this._cf.renderStyle.nodes[e].uniforms().forEach((function(e){var A=!1;t.forEach((function(t){t._vf.name==e._vf.name&&(A=!0)})),0==A&&(t=t.concat(e))}))}return t},textures:function(){var e,t=[],A=this._cf.renderStyle.nodes.length;for(e=0;e<A;e++)this._cf.renderStyle.nodes[e].textures().forEach((function(e){var A=!1;t.forEach((function(t){t._vf.url[0]==e._vf.url[0]&&(A=!0)})),0==A&&(t=t.concat(e))}));return t},initializeValues:function(){for(var e="",t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)null!=this._cf.renderStyle.nodes[A].initializeValues&&(e+=this._cf.renderStyle.nodes[A].initializeValues()+"\n");return e},styleUniformsShaderText:function(){var e="",t=this._cf.renderStyle.nodes.length;1!=t||x3dom.isa(this._cf.renderStyle.nodes[0],x3dom.nodeTypes.OpacityMapVolumeStyle)||(this.surfaceNormalsNeeded=!0);for(var A=0;A<t;A++)e+=this._cf.renderStyle.nodes[A].styleUniformsShaderText()+"\n",this._cf.renderStyle.nodes[A]._cf.surfaceNormals&&null!=this._cf.renderStyle.nodes[A]._cf.surfaceNormals.node&&(this.normalTextureProvided=!0,this._cf.surfaceNormals.node=this._cf.renderStyle.nodes[A]._cf.surfaceNormals.node);return e},styleShaderText:function(){for(var e="",t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)null!=this._cf.renderStyle.nodes[A].styleShaderText&&(e+=this._cf.renderStyle.nodes[A].styleShaderText()+"\n");return e},inlineStyleShaderText:function(){for(var e="",t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)e+=this._cf.renderStyle.nodes[A].inlineStyleShaderText();return e},lightAssigment:function(){var e,t=!1;return this._cf.renderStyle.nodes.forEach((function(A){x3dom.isa(A,x3dom.nodeTypes.BlendedVolumeStyle)&&(t=!0,e=A.lightAssigment())})),t?this._cf.renderStyle.nodes[0].lightAssigment()+e:this._cf.renderStyle.nodes[0].lightAssigment()},lightEquationShaderText:function(){return this._cf.renderStyle.nodes[0].lightEquationShaderText()}})),x3dom.registerNodeType("EdgeEnhancementVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.EdgeEnhancementVolumeStyle.superClass.call(this,e),this.addField_SFColor(e,"edgeColor",0,0,0),this.addField_SFFloat(e,"gradientThreshold",.4),this.uniformColorEdgeColor=new x3dom.nodeTypes.Uniform(e),this.uniformFloatGradientThreshold=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DSurfaceNormals=new x3dom.nodeTypes.Uniform(e),this.uniformBoolEdgeEnable=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){"edgeColor"==e?(this.uniformColorEdgeColor._vf.value=this._vf.edgeColor,this.uniformColorEdgeColor.fieldChanged("value")):"gradientThreshold"==e&&(this.uniformFloatGradientThreshold._vf.value=this._vf.gradientThreshold,this.uniformFloatGradientThreshold.fieldChanged("value"))},uniforms:function(){var e=[];return this._cf.surfaceNormals.node&&(this.uniformSampler2DSurfaceNormals._vf.name="uSurfaceNormals",this.uniformSampler2DSurfaceNormals._vf.type="SFInt32",this.uniformSampler2DSurfaceNormals._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DSurfaceNormals)),this.uniformColorEdgeColor._vf.name="uEdgeColor"+this._styleID,this.uniformColorEdgeColor._vf.type="SFColor",this.uniformColorEdgeColor._vf.value=this._vf.edgeColor,e.push(this.uniformColorEdgeColor),this.uniformFloatGradientThreshold._vf.name="uGradientThreshold"+this._styleID,this.uniformFloatGradientThreshold._vf.type="SFFloat",this.uniformFloatGradientThreshold._vf.value=this._vf.gradientThreshold,e.push(this.uniformFloatGradientThreshold),this.uniformBoolEdgeEnable._vf.name="uEnableEdge"+this._styleID,this.uniformBoolEdgeEnable._vf.type="SFBool",this.uniformBoolEdgeEnable._vf.value=this._vf.enabled,e.push(this.uniformBoolEdgeEnable),e},textures:function(){var e=[];if(this._cf.surfaceNormals.node){var t=this._cf.surfaceNormals.node;t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)}return e},styleUniformsShaderText:function(){return"uniform vec3 uEdgeColor"+this._styleID+";\nuniform float uGradientThreshold"+this._styleID+";\nuniform bool uEnableEdge"+this._styleID+";\n"},styleShaderText:function(){return this._first?"void edgeEnhancement(inout vec4 originalColor, in vec4 gradient, in vec3 V, in vec3 edgeColor, in float gradientT)\n{\n   if(gradient.a > 0.05){\n       float angle_dif = abs(dot(gradient.xyz,V));\n       if(angle_dif > cos(gradientT)){\n           originalColor.rgb = mix(edgeColor, originalColor.rgb, angle_dif);\n       }\n   }\n}\n":""},inlineStyleShaderText:function(){return"   if(uEnableEdge"+this._styleID+"){\n       edgeEnhancement(value, gradEye, dir, uEdgeColor"+this._styleID+", uGradientThreshold"+this._styleID+");\n   }\n"}})),x3dom.registerNodeType("IsoSurfaceVolumeData","VolumeRendering",defineClass(x3dom.nodeTypes.X3DVolumeDataNode,(function(e){x3dom.nodeTypes.IsoSurfaceVolumeData.superClass.call(this,e),this.addField_MFNode("renderStyle",x3dom.nodeTypes.X3DVolumeRenderStyleNode),this.addField_SFNode("gradients",x3dom.nodeTypes.Texture),this.addField_MFFloat(e,"surfaceValues",[0]),this.addField_SFFloat(e,"contourStepSize",0),this.addField_SFFloat(e,"surfaceTolerance",0),this.uniformSampler2DGradients=new x3dom.nodeTypes.Uniform(e),this.uniformFloatContourStepSize=new x3dom.nodeTypes.Uniform(e),this.uniformFloatSurfaceTolerance=new x3dom.nodeTypes.Uniform(e),this.uniformFloatArraySurfaceValues=new x3dom.nodeTypes.Uniform(e),this.vrcMultiTexture=new x3dom.nodeTypes.MultiTexture(e),this.vrcVolumeTexture=null,this.vrcSinglePassShader=new x3dom.nodeTypes.ComposedShader(e),this.vrcSinglePassShaderVertex=new x3dom.nodeTypes.ShaderPart(e),this.vrcSinglePassShaderFragment=new x3dom.nodeTypes.ShaderPart(e),this.vrcSinglePassShaderFieldVolData=new x3dom.nodeTypes.Field(e),this.vrcSinglePassShaderFieldOffset=new x3dom.nodeTypes.Field(e),this.vrcSinglePassShaderFieldDimensions=new x3dom.nodeTypes.Field(e)}),{fieldChanged:function(e){switch(e){case"surfaceValues":this.uniformFloatArraySurfaceValues._vf.value=this._vf.surfaceValues,this.uniformFloatArraySurfaceValues.fieldChanged("value");break;case"surfaceTolerance":this.uniformFloatSurfaceTolerance._vf.value=this._vf.surfaceTolerance,this.uniformFloatSurfaceTolerance.fieldChanged("value")}},uniforms:function(){var e=[];if(this._cf.gradients.node&&(this.uniformSampler2DGradients._vf.name="uSurfaceNormals",this.uniformSampler2DGradients._vf.type="SFInt32",this.uniformSampler2DGradients._vf.value=this._textureID++,e.push(this.uniformSampler2DGradients)),this.uniformFloatArraySurfaceValues._vf.name="uSurfaceValues",this.uniformFloatArraySurfaceValues._vf.type="MFFloat",this.uniformFloatArraySurfaceValues._vf.value=this._vf.surfaceValues,e.push(this.uniformFloatArraySurfaceValues),this.uniformFloatSurfaceTolerance._vf.name="uSurfaceTolerance",this.uniformFloatSurfaceTolerance._vf.type="MFFloat",this.uniformFloatSurfaceTolerance._vf.value=this._vf.surfaceTolerance,e.push(this.uniformFloatSurfaceTolerance),this._cf.renderStyle.nodes)for(var t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)this._cf.renderStyle.nodes[A].uniforms().forEach((function(t){var A=!1;e.forEach((function(e){e._vf.name==t._vf.name&&(A=!0)})),0==A&&(e=e.concat(t))}));return e},textures:function(){var e=[];if(this._cf.gradients.node){var t=this._cf.gradients.node;t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)}var A,i=this._cf.renderStyle.nodes.length;for(A=0;A<i;A++)this._cf.renderStyle.nodes[A].textures().forEach((function(t){var A=!1;e.forEach((function(e){e._vf.url[0]==t._vf.url[0]&&(A=!0)})),0==A&&(e=e.concat(t))}));return e},initializeValues:function(){for(var e="  float previous_value = 0.0;\n",t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)null!=this._cf.renderStyle.nodes[A].initializeValues&&(e+=this._cf.renderStyle.nodes[A].initializeValues()+"\n");return e},styleUniformsShaderText:function(){var e="uniform float uSurfaceTolerance;\nuniform float uSurfaceValues["+this._vf.surfaceValues.length+"];\n";this._cf.gradients.node&&(e+="uniform sampler2D uSurfaceNormals;\n");for(var t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)e+=this._cf.renderStyle.nodes[A].styleUniformsShaderText()+"\n",this._cf.renderStyle.nodes[A]._cf.surfaceNormals&&null!=this._cf.renderStyle.nodes[A]._cf.surfaceNormals.node&&(this.normalTextureProvided=!0,this.surfaceNormals=this._cf.renderStyle.nodes[A]._cf.surfaceNormals.node);return this.surfaceNormalsNeeded=!0,e},inlineStyleShaderText:function(){var e="    sample = value.r;\n";if(1==this._vf.surfaceValues.length)if(0==this._vf.contourStepSize)e+="   if(((sample>=uSurfaceValues[0] && previous_value<uSurfaceValues[0])||(sample<uSurfaceValues[0] && previous_value>=uSurfaceValues[0])) && (grad.a>=uSurfaceTolerance)){\n       value = vec4(vec3(uSurfaceValues[0]),1.0);\n",this._cf.renderStyle.nodes&&(e+=this._cf.renderStyle.nodes[0].inlineStyleShaderText()),e+="       accum.rgb += (1.0 - accum.a) * (value.rgb * value.a);\n       accum.a += (1.0 - accum.a) * value.a;\n   }\n";else{for(var t=this._vf.surfaceValues[0],A=[t],i=[],o=[];t+this._vf.contourStepSize<=1;)t+=this._vf.contourStepSize,A.push(t);for(t=this._vf.surfaceValues[0];t-this._vf.contourStepSize>=0;)t-=this._vf.contourStepSize,i.unshift(t);o=i.concat(A);for(var s=0;s<=o.length-1;s++){var n=o[s].toPrecision(3);e+=" if(((sample>="+n+" && previous_value<"+n+")||(sample<"+n+" && previous_value>="+n+")) && (grad.a>=uSurfaceTolerance)){\n       value = vec4(vec3("+n+"),1.0);\n",this._cf.renderStyle.nodes&&(e+=this._cf.renderStyle.nodes[0].inlineStyleShaderText()),e+="       accum.rgb += (1.0 - accum.a) * (value.rgb * value.a);\n       accum.a += (1.0 - accum.a) * value.a;\n   }\n"}}else{var r=this._cf.renderStyle.nodes.length-1,a=this._vf.surfaceValues.length;for(s=0;s<a;s++){var d=Math.min(s,r);e+="   if(((sample>=uSurfaceValues["+s+"] && previous_value<uSurfaceValues["+s+"])||(sample<uSurfaceValues["+s+"] && previous_value>=uSurfaceValues["+s+"])) && (grad.a>=uSurfaceTolerance)){\n       value = vec4(vec3(uSurfaceValues["+s+"]),1.0);\n",this._cf.renderStyle.nodes&&(e+=this._cf.renderStyle.nodes[d].inlineStyleShaderText()),e+="   accum.rgb += (1.0 - accum.a) * (value.rgb * value.a);\n   accum.a += (1.0 - accum.a) * value.a;\n   }\n"}}return e+="    previous_value = sample;\n"},styleShaderText:function(){for(var e="",t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)null!=this._cf.renderStyle.nodes[A].styleShaderText&&(e+=this._cf.renderStyle.nodes[A].styleShaderText()+"\n");return e},lightAssigment:function(){return this._cf.renderStyle.nodes[0].lightAssigment()},lightEquationShaderText:function(){return this._cf.renderStyle.nodes[0].lightEquationShaderText()},nodeChanged:function(){if(!this._cf.appearance.node){this.addChild(new x3dom.nodeTypes.Appearance),this.vrcVolumeTexture=this._cf.voxels.node,this.vrcVolumeTexture._vf.repeatS=!1,this.vrcVolumeTexture._vf.repeatT=!1,this.vrcMultiTexture._nameSpace=this._nameSpace,this.vrcMultiTexture.addChild(this.vrcVolumeTexture,"texture"),this.vrcVolumeTexture.nodeChanged();var e=this.textures();for(t=0;t<e.length;t++)this.vrcMultiTexture.addChild(e[t],"texture"),this.vrcVolumeTexture.nodeChanged();this._cf.appearance.node.addChild(this.vrcMultiTexture),this.vrcMultiTexture.nodeChanged();for(var t=0;t<this._cf.renderStyle.nodes.length;t++)this._cf.renderStyle.nodes[t].updateProperties(this);this.vrcSinglePassShaderVertex._vf.type="vertex",this.vrcSinglePassShaderVertex._vf.url[0]=this.vertexShaderText(),this.vrcSinglePassShaderFragment._vf.type="fragment";var A=this.fragmentPreamble+this.defaultUniformsShaderText(this.vrcVolumeTexture._vf.numberOfSlices,this.vrcVolumeTexture._vf.slicesOverX,this.vrcVolumeTexture._vf.slicesOverY)+this.styleUniformsShaderText()+this.styleShaderText()+this.texture3DFunctionShaderText+this.normalFunctionShaderText()+this.lightEquationShaderText();A+="void main()\n{\n  vec3 cam_pos = vec3(modelViewMatrixInverse[3][0], modelViewMatrixInverse[3][1], modelViewMatrixInverse[3][2]);\n  vec3 cam_cube = cam_pos/dimensions+0.5;\n  vec3 dir = normalize(pos.xyz-cam_cube);\n",this._vf.allowViewpointInside?A+="  float cam_inside = float(all(bvec2(all(lessThan(cam_cube, vec3(1.0))),all(greaterThan(cam_cube, vec3(0.0))))));\n  vec3 ray_pos = mix(pos.xyz, cam_cube, cam_inside);\n":A+="  vec3 ray_pos = pos.xyz;\n",A+="  vec4 accum  = vec4(0.0, 0.0, 0.0, 0.0);\n  float sample = 0.0;\n  vec4 value  = vec4(0.0, 0.0, 0.0, 0.0);\n  float cont = 0.0;\n  vec3 step = dir/Steps;\n",x3dom.nodeTypes.X3DLightNode.lightID>0?A+="  vec3 ambient = vec3(0.0, 0.0, 0.0);\n  vec3 diffuse = vec3(0.0, 0.0, 0.0);\n  vec3 specular = vec3(0.0, 0.0, 0.0);\n  vec4 step_eye = modelViewMatrix * vec4(step, 0.0);\n  vec4 positionE = position_eye;\n  float lightFactor = 1.0;\n":A+="  float lightFactor = 1.2;\n",A+=this.initializeValues()+"  float opacityFactor = 6.0;\n  float t_near;\n  float t_far;\n  for(float i = 0.0; i < Steps; i+=1.0)\n  {\n    value = cTexture3D(uVolData, ray_pos, numberOfSlices, slicesOverX, slicesOverY);\n    value = value.rgbr;\n",this._cf.gradients.node?A+="    vec4 gradEye = getNormalFromTexture(uSurfaceNormals, ray_pos, numberOfSlices, slicesOverX, slicesOverY);\n":A+="    vec4 gradEye = getNormalOnTheFly(uVolData, ray_pos, numberOfSlices, slicesOverX, slicesOverY);\n",A+="    vec4 grad = vec4((modelViewMatrix * vec4(gradEye.xyz, 0.0)).xyz, gradEye.a);\n";for(var i=0;i<x3dom.nodeTypes.X3DLightNode.lightID;i++)A+="    lighting(light"+i+"_Type, light"+i+"_Location, light"+i+"_Direction, light"+i+"_Color, light"+i+"_Attenuation, light"+i+"_Radius, light"+i+"_Intensity, light"+i+"_AmbientIntensity, light"+i+"_BeamWidth, light"+i+"_CutOffAngle, grad.xyz, positionE.xyz, ambient, diffuse, specular);\n";A+=this.inlineStyleShaderText(),x3dom.nodeTypes.X3DLightNode.lightID>0&&(A+=this.lightAssigment()),A+="    //advance the current position\n    ray_pos.xyz += step;\n",x3dom.nodeTypes.X3DLightNode.lightID>0&&(A+="    positionE += step_eye;\n"),A+="    //break if the position is greater than <1, 1, 1>\n    if(ray_pos.x > 1.0 || ray_pos.y > 1.0 || ray_pos.z > 1.0 || ray_pos.x <= 0.0 || ray_pos.y <= 0.0 || ray_pos.z <= 0.0 || accum.a>=1.0)\n      break;\n  }\n  gl_FragColor = accum;\n}",this.vrcSinglePassShaderFragment._vf.url[0]=A,this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderVertex,"parts"),this.vrcSinglePassShaderVertex.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFragment,"parts"),this.vrcSinglePassShaderFragment.nodeChanged(),this.vrcSinglePassShaderFieldVolData._vf.name="uVolData",this.vrcSinglePassShaderFieldVolData._vf.type="SFInt32",this.vrcSinglePassShaderFieldVolData._vf.value=this._textureID++,this.vrcSinglePassShaderFieldDimensions._vf.name="dimensions",this.vrcSinglePassShaderFieldDimensions._vf.type="SFVec3f",this.vrcSinglePassShaderFieldDimensions._vf.value=this._vf.dimensions,this.vrcSinglePassShaderFieldOffset._vf.name="offset",this.vrcSinglePassShaderFieldOffset._vf.type="SFVec3f",this.vrcSinglePassShaderFieldOffset._vf.value="0.01 0.01 0.01",this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldVolData,"fields"),this.vrcSinglePassShaderFieldVolData.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldDimensions,"fields"),this.vrcSinglePassShaderFieldDimensions.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldOffset,"fields"),this.offsetInterval=window.setInterval((s=this.vrcVolumeTexture,n=this,function(){x3dom.debug.logInfo("[VolumeRendering][IsoSurfaceVolumeData] Looking for Volume Texture size...");var e=n.getTextureSize(s);e.valid&&(clearInterval(n.offsetInterval),n.vrcSinglePassShaderFieldOffset._vf.value=new x3dom.fields.SFVec3f(1/(e.w/s._vf.slicesOverX),1/(e.h/s._vf.slicesOverY),1/s._vf.numberOfSlices),n.vrcSinglePassShader.nodeChanged(),x3dom.debug.logInfo("[VolumeRendering][IsoSurfaceVolumeData] Volume Texture size obtained"))}),1e3);var o=this.uniforms();for(t=0;t<o.length;t++)this.vrcSinglePassShader.addChild(o[t],"fields");this._cf.appearance.node.addChild(this.vrcSinglePassShader),this.vrcSinglePassShader.nodeChanged(),this._cf.appearance.node.nodeChanged()}var s,n;this._cf.geometry.node||(this.addChild(new x3dom.nodeTypes.Box),this._cf.geometry.node._vf.solid=!1,this._cf.geometry.node._vf.hasHelperColors=!1,this._cf.geometry.node._vf.size=new x3dom.fields.SFVec3f(this._vf.dimensions.x,this._vf.dimensions.y,this._vf.dimensions.z),this._cf.geometry.node.fieldChanged("size"))}})),x3dom.registerNodeType("MPRVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.MPRVolumeStyle.superClass.call(this,e),this.addField_SFNode("transferFunction",x3dom.nodeTypes.Texture),this.addField_SFBool(e,"forceOpaque",!0),this.addField_MFNode("planes",x3dom.nodeTypes.MPRPlane),this.uniformSampler2DTransferFunction=new x3dom.nodeTypes.Uniform(e),this.uniformBoolForceOpaque=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"forceOpaque":this.uniformBoolForceOpaque._vf.value=this._vf.forceOpaque,this.uniformBoolForceOpaque.fieldChanged("value")}},uniforms:function(){var e=[];this._cf.transferFunction.node&&(this.uniformSampler2DTransferFunction._vf.name="uTransferFunction",this.uniformSampler2DTransferFunction._vf.type="SFInt32",this.uniformSampler2DTransferFunction._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DTransferFunction)),this.uniformBoolForceOpaque._vf.name="forceOpaque",this.uniformBoolForceOpaque._vf.type="SFBool",this.uniformBoolForceOpaque._vf.value=this._vf.forceOpaque,e.push(this.uniformBoolForceOpaque);var t,A=this._cf.planes.nodes.length;for(t=0;t<A;t++){this._cf.planes.nodes[t].uniforms().forEach((function(t){var A=!1;e.forEach((function(e){e._vf.name==t._vf.name&&(A=!0)})),0==A&&(e=e.concat(t))}))}return e},textures:function(){var e=[],t=this._cf.transferFunction.node;return t&&(t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)),e},styleUniformsShaderText:function(){var e="uniform bool forceOpaque;\n";this._cf.transferFunction.node&&(e+="uniform sampler2D uTransferFunction;\n");for(var t=0;t<this._cf.planes.nodes.length;t++)e+=this._cf.planes.nodes[t].styleUniformsShaderText();return e},fragmentShaderText:function(e,t,A){for(var i=this._parentNodes[0].fragmentPreamble+this._parentNodes[0].defaultUniformsShaderText(e,t,A)+this.styleUniformsShaderText()+this._parentNodes[0].texture3DFunctionShaderText+"void main()\n{\n  vec3 cam_pos = vec3(modelViewMatrixInverse[3][0], modelViewMatrixInverse[3][1], modelViewMatrixInverse[3][2]);\n  cam_pos = cam_pos/dimensions+0.5;\n  vec3 dir = normalize(pos.xyz-cam_pos);\n  float cam_inside = float(all(bvec2(all(lessThan(cam_pos, vec3(1.0))),all(greaterThan(cam_pos, vec3(0.0))))));\n  vec3 ray_pos = mix(pos.xyz, cam_pos, cam_inside);\n  float d = 1000.0;",o=0;o<this._cf.planes.nodes.length;o++)i+=this._cf.planes.nodes[o].styleShaderText();return i+="  vec4 color = vec4(0.0,0.0,0.0,0.0);\n  vec3 pos = d*dir+ray_pos;\n  if (!(any(bvec2(any(lessThan(pos.xyz, vec3(0.0))),any(greaterThan(pos.xyz, vec3(1.0))))))){\n    pos = clamp(pos, vec3(0.0), vec3(1.0));\n    vec4 intesity = cTexture3D(uVolData,pos.rgb,numberOfSlices,slicesOverX,slicesOverY);\n",this._cf.transferFunction.node?i+="    if (forceOpaque){\n      color = vec4(texture2D(uTransferFunction, vec2(intesity.r,0.5)).rgb, 1.0);\n    }else{\n      color = texture2D(uTransferFunction, vec2(intesity.r,0.5)).rgba;\n    }\n":i+="    if (forceOpaque){\n      color = vec4(intesity.rgb,1.0);\n    }else{\n      color = intesity;\n    }\n",i+="  }\n  gl_FragColor = color;\n}"}})),x3dom.registerNodeType("MPRPlane","VolumeRendering",defineClass(x3dom.nodeTypes.X3DNode,(function(e){x3dom.nodeTypes.MPRPlane.superClass.call(this,e),this.addField_SFBool(e,"enabled",!0),this.addField_SFVec3f(e,"normal",0,1,0),this.addField_SFFloat(e,"position",.5),this.uniformBooleanEnabled=new x3dom.nodeTypes.Uniform(e),this.uniformVec3fNormal=new x3dom.nodeTypes.Uniform(e),this.uniformFloatPosition=new x3dom.nodeTypes.Uniform(e),this._planeID=0}),{nodeChanged:function(){this._planeID||(this._planeID=++x3dom.nodeTypes.MPRPlane.planeID)},fieldChanged:function(e){switch(e){case"enabled":this.uniformBooleanEnabled._vf.value=this._vf.enabled.toString(),this.uniformBooleanEnabled.fieldChanged("value");break;case"position":this.uniformFloatPosition._vf.value=Math.min(Math.max(this._vf.position,.001),.999),this.uniformFloatPosition.fieldChanged("value");break;case"normal":this.uniformVec3fNormal._vf.value=this._vf.normal,this.uniformVec3fNormal.fieldChanged("value")}},uniforms:function(){var e=[];return this.uniformBooleanEnabled._vf.name="enabledPlane"+this._planeID,this.uniformBooleanEnabled._vf.type="SFBool",this.uniformBooleanEnabled._vf.value=this._vf.enabled,e.push(this.uniformBooleanEnabled),this.uniformVec3fNormal._vf.name="normalPlane"+this._planeID,this.uniformVec3fNormal._vf.type="SFVec3f",this.uniformVec3fNormal._vf.value=this._vf.normal,e.push(this.uniformVec3fNormal),this.uniformFloatPosition._vf.name="positionPlane"+this._planeID,this.uniformFloatPosition._vf.type="SFFloat",this.uniformFloatPosition._vf.value=this._vf.position,e.push(this.uniformFloatPosition),e},styleUniformsShaderText:function(){return"uniform vec3 normalPlane"+this._planeID+";\nuniform float positionPlane"+this._planeID+";\nuniform bool enabledPlane"+this._planeID+";\n"},styleShaderText:function(){return"  if(enabledPlane"+this._planeID+"){\n   vec3 pointLine"+this._planeID+" = normalPlane"+this._planeID+"*positionPlane"+this._planeID+";\n   float d"+this._planeID+" = dot(pointLine"+this._planeID+"-ray_pos,normalPlane"+this._planeID+")/dot(dir,normalPlane"+this._planeID+");\n   float f"+this._planeID+" = step(0.0, d"+this._planeID+");\n   d"+this._planeID+" = (1.0 - f"+this._planeID+") * 1000.0 + f"+this._planeID+" * d"+this._planeID+";\n   d = min(d"+this._planeID+",d);\n  }\n"}})),x3dom.nodeTypes.MPRPlane.planeID=0,x3dom.registerNodeType("OpacityMapVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.OpacityMapVolumeStyle.superClass.call(this,e),this.addField_SFNode("transferFunction",x3dom.nodeTypes.Texture),this.addField_SFString(e,"type","simple"),this.addField_SFFloat(e,"opacityFactor",6),this.addField_SFFloat(e,"lightFactor",1.2),this.uniformFloatOpacityFactor=new x3dom.nodeTypes.Uniform(e),this.uniformFloatLightFactor=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DTransferFunction=new x3dom.nodeTypes.Uniform(e),this.uniformBoolEnableOpacityMap=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"opacityFactor":this.uniformFloatOpacityFactor._vf.value=this._vf.opacityFactor,this.uniformFloatOpacityFactor.fieldChanged("value");break;case"lightFactor":this.uniformFloatLightFactor._vf.value=this._vf.lightFactor,this.uniformFloatLightFactor.fieldChanged("value")}},uniforms:function(){var e=[];return this._cf.transferFunction.node&&(this.uniformSampler2DTransferFunction._vf.name="uTransferFunction"+this._styleID,this.uniformSampler2DTransferFunction._vf.type="SFInt32",this.uniformSampler2DTransferFunction._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DTransferFunction)),this.uniformFloatOpacityFactor._vf.name="uOpacityFactor"+this._styleID,this.uniformFloatOpacityFactor._vf.type="SFFloat",this.uniformFloatOpacityFactor._vf.value=this._vf.opacityFactor,e.push(this.uniformFloatOpacityFactor),this.uniformFloatLightFactor._vf.name="uLightFactor"+this._styleID,this.uniformFloatLightFactor._vf.type="SFFloat",this.uniformFloatLightFactor._vf.value=this._vf.lightFactor,e.push(this.uniformFloatLightFactor),this.uniformBoolEnableOpacityMap._vf.name="uEnableOpacityMap"+this._styleID,this.uniformBoolEnableOpacityMap._vf.type="SFBool",this.uniformBoolEnableOpacityMap._vf.value=this._vf.enabled,e.push(this.uniformBoolEnableOpacityMap),e},textures:function(){var e=[],t=this._cf.transferFunction.node;return t&&(t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)),e},styleUniformsShaderText:function(){var e="uniform float uOpacityFactor"+this._styleID+";\nuniform float uLightFactor"+this._styleID+";\nuniform bool uEnableOpacityMap"+this._styleID+";\n";return this._cf.transferFunction.node&&(e+="uniform sampler2D uTransferFunction"+this._styleID+";\n"),e},inlineStyleShaderText:function(){var e="    if(uEnableOpacityMap"+this._styleID+"){\n       opacityFactor = uOpacityFactor"+this._styleID+";\n       lightFactor = uLightFactor"+this._styleID+";\n";return this._cf.transferFunction.node&&(e+="       value = texture2D(uTransferFunction"+this._styleID+",vec2(value.r,0.5));\n"),e+="    }\n"}})),x3dom.registerNodeType("ProjectionVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.ProjectionVolumeStyle.superClass.call(this,e),this.addField_SFFloat(e,"intensityThreshold",0),this.addField_SFString(e,"type","MAX"),this.uniformIntensityThreshold=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){"intensityThreshold"===e&&(this.uniformIntensityThreshold._vf.value=this._vf.intensityThreshold,this.uniformIntensityThreshold.fieldChanged("value"))},uniforms:function(){var e=[];return this.uniformIntensityThreshold._vf.name="uIntensityThreshold",this.uniformIntensityThreshold._vf.type="SFFloat",this.uniformIntensityThreshold._vf.value=this._vf.intensityThreshold,e.push(this.uniformIntensityThreshold),e},styleUniformsShaderText:function(){return"uniform int uType;\nuniform float uIntensityThreshold;\n"},fragmentShaderText:function(e,t,A){var i=this._parentNodes[0].fragmentPreamble+this._parentNodes[0].defaultUniformsShaderText(e,t,A)+this.styleUniformsShaderText()+this._parentNodes[0].texture3DFunctionShaderText+"void main()\n{\n  vec3 cam_pos = vec3(modelViewMatrixInverse[3][0], modelViewMatrixInverse[3][1], modelViewMatrixInverse[3][2]);\n  cam_pos = cam_pos/dimensions+0.5;\n  vec3 dir = normalize(pos.xyz-cam_pos);\n  vec3 ray_pos = pos.xyz;\n  vec4 accum  = vec4(0.0, 0.0, 0.0, 0.0);\n  vec4 sample = vec4(0.0, 0.0, 0.0, 0.0);\n  vec4 value  = vec4(0.0, 0.0, 0.0, 0.0);\n  vec4 color  = vec4(0.0);\n";if("max"===this._vf.type.toLowerCase()?i+="vec2 previous_value = vec2(0.0);\n":i+="vec2 previous_value = vec2(1.0);\n",i+="  float cont = 0.0;\n  vec3 step_size = (dir*1.4142)/Steps;\n  const float lightFactor = 1.3;\n  const float opacityFactor = 3.0;\n  for(float i = 0.0; i < Steps; i+=1.0)\n  {\n    value = cTexture3D(uVolData,ray_pos,numberOfSlices,slicesOverX,slicesOverY);\n    value = vec4(value.rgb,(0.299*value.r)+(0.587*value.g)+(0.114*value.b));\n    //Process the volume sample\n    sample.a = value.a * opacityFactor * (1.0/Steps);\n    sample.rgb = value.rgb * sample.a * lightFactor;\n    accum.a += (1.0-accum.a)*sample.a;\n",this._vf.enabled)switch(this._vf.type.toLowerCase()){case"max":i+="if(value.r > uIntensityThreshold && value.r <= previous_value.x){\n   break;\n}\ncolor.rgb = vec3(max(value.r, previous_value.x));\ncolor.a = (value.r > previous_value.x) ? accum.a : previous_value.y;\n";break;case"min":i+="if(value.r < uIntensityThreshold && value.r >= previous_value.x){\n   break;\n}\ncolor.rgb = vec3(min(value.r, previous_value.x));\ncolor.a = (value.r < previous_value.x) ? accum.a : previous_value.y;\n";break;case"average":i+="color.rgb += (1.0 - accum.a) * sample.rgb;\ncolor.a = accum.a;\n"}return i+="    //update the previous value and keeping the accumulated alpha\n    previous_value.x = color.r;\n    previous_value.y = accum.a;\n    //advance the current position\n    ray_pos.xyz += step_size;\n    //break if the position is greater than <1, 1, 1>\n    if(ray_pos.x > 1.0 || ray_pos.y > 1.0 || ray_pos.z > 1.0 || ray_pos.x <= 0.0 || ray_pos.y <= 0.0 || ray_pos.z <= 0.0 || accum.a>=1.0){\n","average"==this._vf.type.toLowerCase()&&this._vf.enabled&&(i+="     if((i > 0.0) && (i < Steps-1.0)){\ncolor.rgb = color.rgb/i;\n}\n"),i+="      break;\n    }\n }\n gl_FragColor = color;\n}"}})),x3dom.registerNodeType("SegmentedVolumeData","VolumeRendering",defineClass(x3dom.nodeTypes.X3DVolumeDataNode,(function(e){x3dom.nodeTypes.SegmentedVolumeData.superClass.call(this,e),this.addField_MFNode("renderStyle",x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode),this.addField_SFNode("segmentIdentifiers",x3dom.nodeTypes.Texture),this.addField_SFFloat(e,"numberOfMaxSegments",10),this.uniformSampler2DSegmentIdentifiers=new x3dom.nodeTypes.Uniform(e),this.normalTextureProvided=!1,this.vrcMultiTexture=new x3dom.nodeTypes.MultiTexture(e),this.vrcVolumeTexture=null,this.vrcSinglePassShader=new x3dom.nodeTypes.ComposedShader(e),this.vrcSinglePassShaderVertex=new x3dom.nodeTypes.ShaderPart(e),this.vrcSinglePassShaderFragment=new x3dom.nodeTypes.ShaderPart(e),this.vrcSinglePassShaderFieldBackCoord=new x3dom.nodeTypes.Field(e),this.vrcSinglePassShaderFieldVolData=new x3dom.nodeTypes.Field(e),this.vrcSinglePassShaderFieldOffset=new x3dom.nodeTypes.Field(e),this.vrcSinglePassShaderFieldDimensions=new x3dom.nodeTypes.Field(e)}),{fieldChanged:function(e){"numberOfMaxSegments"===e||fieldname},uniforms:function(){var e=[];if(this._cf.segmentIdentifiers.node&&(this.uniformSampler2DSegmentIdentifiers._vf.name="uSegmentIdentifiers",this.uniformSampler2DSegmentIdentifiers._vf.type="SFInt32",this.uniformSampler2DSegmentIdentifiers._vf.value=this._textureID++,e.push(this.uniformSampler2DSegmentIdentifiers)),this._cf.renderStyle.nodes){var t,A=this._cf.renderStyle.nodes.length;for(t=0;t<A;t++){this._cf.renderStyle.nodes[t].uniforms().forEach((function(t){var A=!1;e.forEach((function(e){e._vf.name==t._vf.name&&(A=!0)})),0==A&&(e=e.concat(t))}))}}return e},textures:function(){var e=[];if(this._cf.segmentIdentifiers.node){var t=this._cf.segmentIdentifiers.node;t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)}var A,i=this._cf.renderStyle.nodes.length;for(A=0;A<i;A++)this._cf.renderStyle.nodes[A].textures().forEach((function(t){var A=!1;e.forEach((function(e){e._vf.url[0]==t._vf.url[0]&&(A=!0)})),0==A&&(e=e.concat(t))}));return e},initializeValues:function(){for(var e="",t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)null!=this._cf.renderStyle.nodes[A].initializeValues&&(e+=this._cf.renderStyle.nodes[A].initializeValues()+"\n");return e},styleUniformsShaderText:function(){for(var e="const float maxSegments = "+this._vf.numberOfMaxSegments.toPrecision(3)+";\nuniform sampler2D uSegmentIdentifiers;\n",t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)e+=this._cf.renderStyle.nodes[A].styleUniformsShaderText()+"\n",this._cf.renderStyle.nodes[A]._cf.surfaceNormals&&null!=this._cf.renderStyle.nodes[A]._cf.surfaceNormals.node&&(e+="uniform sampler2D uSurfaceNormals;\n",this.normalTextureProvided=!0,this.surfaceNormals=this._cf.renderStyle.nodes[A]._cf.surfaceNormals.node),x3dom.isa(this._cf.renderStyle.nodes[A],x3dom.nodeTypes.OpacityMapVolumeStyle)||(this.surfaceNormalsNeeded=!0);return e},styleShaderText:function(){for(var e="",t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)null!=this._cf.renderStyle.nodes[A].styleShaderText&&(e+=this._cf.renderStyle.nodes[A].styleShaderText()+"\n");return e},inlineStyleShaderText:function(){var e="";this._cf.segmentIdentifiers.node?(e+="    float t_id = cTexture3D(uSegmentIdentifiers, ray_pos, numberOfSlices, slicesOverX, slicesOverY).r;\n    int s_id = int(clamp(floor(t_id*maxSegments-0.5),0.0,maxSegments));\n    opacityFactor = 10.0;\n",x3dom.nodeTypes.X3DLightNode.lightID>0?e+="    lightFactor = 1.0;\n":e+="    lightFactor = 1.2;\n"):e+="    int s_id = 0;\n";for(var t=this._cf.renderStyle.nodes.length,A=0;A<t;A++)e+="    if (s_id == "+A+"){\n"+this._cf.renderStyle.nodes[A].inlineStyleShaderText()+"    }\n";return e},lightAssigment:function(){return this._cf.renderStyle.nodes[0].lightAssigment()},lightEquationShaderText:function(){return this._cf.renderStyle.nodes[0].lightEquationShaderText()},nodeChanged:function(){if(!this._cf.appearance.node){this.addChild(new x3dom.nodeTypes.Appearance),this.vrcVolumeTexture=this._cf.voxels.node,this.vrcVolumeTexture._vf.repeatS=!1,this.vrcVolumeTexture._vf.repeatT=!1,this.vrcMultiTexture._nameSpace=this._nameSpace,this.vrcMultiTexture.addChild(this.vrcVolumeTexture,"texture"),this.vrcVolumeTexture.nodeChanged();var e=this.textures();for(t=0;t<e.length;t++)this.vrcMultiTexture.addChild(e[t],"texture"),this.vrcVolumeTexture.nodeChanged();this._cf.appearance.node.addChild(this.vrcMultiTexture),this.vrcMultiTexture.nodeChanged();for(var t=0;t<this._cf.renderStyle.nodes.length;t++)this._cf.renderStyle.nodes[t].updateProperties(this);this.vrcSinglePassShaderVertex._vf.type="vertex",this.vrcSinglePassShaderVertex._vf.url[0]=this.vertexShaderText(),this.vrcSinglePassShaderFragment._vf.type="fragment";var A=this.fragmentPreamble+this.defaultUniformsShaderText(this.vrcVolumeTexture._vf.numberOfSlices,this.vrcVolumeTexture._vf.slicesOverX,this.vrcVolumeTexture._vf.slicesOverY)+this.styleUniformsShaderText()+this.styleShaderText()+this.texture3DFunctionShaderText+this.normalFunctionShaderText()+this.lightEquationShaderText()+this.defaultLoopFragmentShaderText(this.inlineStyleShaderText(),this.lightAssigment(),this.initializeValues());this.vrcSinglePassShaderFragment._vf.url[0]=A,this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderVertex,"parts"),this.vrcSinglePassShaderVertex.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFragment,"parts"),this.vrcSinglePassShaderFragment.nodeChanged(),this.vrcSinglePassShaderFieldVolData._vf.name="uVolData",this.vrcSinglePassShaderFieldVolData._vf.type="SFInt32",this.vrcSinglePassShaderFieldVolData._vf.value=this._textureID++,this.vrcSinglePassShaderFieldDimensions._vf.name="dimensions",this.vrcSinglePassShaderFieldDimensions._vf.type="SFVec3f",this.vrcSinglePassShaderFieldDimensions._vf.value=this._vf.dimensions,this.vrcSinglePassShaderFieldOffset._vf.name="offset",this.vrcSinglePassShaderFieldOffset._vf.type="SFVec3f",this.vrcSinglePassShaderFieldOffset._vf.value="0.01 0.01 0.01",this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldVolData,"fields"),this.vrcSinglePassShaderFieldVolData.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldDimensions,"fields"),this.vrcSinglePassShaderFieldDimensions.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldOffset,"fields"),this.offsetInterval=window.setInterval((o=this.vrcVolumeTexture,s=this,function(){x3dom.debug.logInfo("[VolumeRendering][SegmentedVolumeData] Looking for Volume Texture size...");var e=s.getTextureSize(o);e.valid&&(clearInterval(s.offsetInterval),s.vrcSinglePassShaderFieldOffset._vf.value=new x3dom.fields.SFVec3f(1/(e.w/o._vf.slicesOverX),1/(e.h/o._vf.slicesOverY),1/o._vf.numberOfSlices),s.vrcSinglePassShader.nodeChanged(),x3dom.debug.logInfo("[VolumeRendering][SegmentedVolumeData] Volume Texture size obtained"))}),1e3);var i=this.uniforms();for(t=0;t<i.length;t++)this.vrcSinglePassShader.addChild(i[t],"fields");this._cf.appearance.node.addChild(this.vrcSinglePassShader),this.vrcSinglePassShader.nodeChanged(),this._cf.appearance.node.nodeChanged()}var o,s;this._cf.geometry.node||(this.addChild(new x3dom.nodeTypes.Box),this._cf.geometry.node._vf.solid=!1,this._cf.geometry.node._vf.hasHelperColors=!1,this._cf.geometry.node._vf.size=new x3dom.fields.SFVec3f(this._vf.dimensions.x,this._vf.dimensions.y,this._vf.dimensions.z),this._cf.geometry.node.fieldChanged("size"))}})),x3dom.registerNodeType("ShadedVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.ShadedVolumeStyle.superClass.call(this,e),this.addField_SFNode("material",x3dom.nodeTypes.X3DMaterialNode),this.addField_SFBool(e,"lighting",!1),this.addField_SFBool(e,"shadows",!1),this.addField_SFString(e,"phaseFunction","Henyey-Greenstein"),this.uniformBoolLigthning=new x3dom.nodeTypes.Uniform(e),this.uniformBoolShadows=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DSurfaceNormals=new x3dom.nodeTypes.Uniform(e),this.uniformColorSpecular=new x3dom.nodeTypes.Uniform(e),this.uniformFloatAmbientIntensity=new x3dom.nodeTypes.Uniform(e),this.uniformFloatShininess=new x3dom.nodeTypes.Uniform(e),this.uniformFloatTransparency=new x3dom.nodeTypes.Uniform(e),this.uniformColorEmissive=new x3dom.nodeTypes.Uniform(e),this.uniformColorDiffuse=new x3dom.nodeTypes.Uniform(e),this.uniformBoolEnableShaded=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"lightning":this.uniformBoolLightning._vf.value=this._vf.lightning,this.uniformBoolLightning.fieldChanged("value");break;case"shadows":this.uniformBoolShadows._vf.value=this._vf.shadows,this.uniformBoolShadows.fieldChanged("value")}},uniforms:function(){var e=[];return this._cf.surfaceNormals.node&&(this.uniformSampler2DSurfaceNormals._vf.name="uSurfaceNormals",this.uniformSampler2DSurfaceNormals._vf.type="SFInt32",this.uniformSampler2DSurfaceNormals._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DSurfaceNormals)),this.uniformBoolLigthning._vf.name="uLightning"+this._styleID,this.uniformBoolLigthning._vf.type="SFBool",this.uniformBoolLigthning._vf.value=this._vf.lighting,e.push(this.uniformBoolLigthning),this.uniformBoolShadows._vf.name="uShadows"+this._styleID,this.uniformBoolShadows._vf.type="SFBool",this.uniformBoolShadows._vf.value=this._vf.shadows,e.push(this.uniformBoolShadows),null!=this._cf.material.node&&(this.uniformColorSpecular._vf.name="specularColor"+this._styleID,this.uniformColorSpecular._vf.type="SFColor",this.uniformColorSpecular._vf.value=this._cf.material.node._vf.specularColor,e.push(this.uniformColorSpecular),this.uniformColorDiffuse._vf.name="diffuseColor"+this._styleID,this.uniformColorDiffuse._vf.type="SFColor",this.uniformColorDiffuse._vf.value=this._cf.material.node._vf.diffuseColor,e.push(this.uniformColorDiffuse),this.uniformColorEmissive._vf.name="emissiveColor"+this._styleID,this.uniformColorEmissive._vf.type="SFColor",this.uniformColorEmissive._vf.value=this._cf.material.node._vf.emissiveColor,e.push(this.uniformColorEmissive),this.uniformFloatAmbientIntensity._vf.name="ambientIntensity"+this._styleID,this.uniformFloatAmbientIntensity._vf.type="SFFloat",this.uniformFloatAmbientIntensity._vf.value=this._cf.material.node._vf.ambientIntensity,e.push(this.uniformFloatAmbientIntensity),this.uniformFloatShininess._vf.name="shininess"+this._styleID,this.uniformFloatShininess._vf.type="SFFloat",this.uniformFloatShininess._vf.value=this._cf.material.node._vf.shininess,e.push(this.uniformFloatShininess),this.uniformFloatTransparency._vf.name="transparency"+this._styleID,this.uniformFloatTransparency._vf.type="SFFloat",this.uniformFloatTransparency._vf.value=this._cf.material.node._vf.transperency,e.push(this.uniformFloatTransparency)),this.uniformBoolEnableShaded._vf.name="uEnableShaded"+this._styleID,this.uniformBoolEnableShaded._vf.type="SFBool",this.uniformBoolEnableShaded._vf.value=this._vf.enabled,e.push(this.uniformBoolEnableShaded),e},textures:function(){var e=[];if(this._cf.surfaceNormals.node){var t=this._cf.surfaceNormals.node;t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)}return e},styleUniformsShaderText:function(){var e="uniform bool uLightning"+this._styleID+";\nuniform bool uShadows"+this._styleID+";\nuniform float fogRange;\nuniform vec3 fogColor;\nuniform float fogType;\nuniform bool uEnableShaded"+this._styleID+";\n";return this._cf.material.node&&(e+="uniform vec3  diffuseColor"+this._styleID+";\nuniform vec3  specularColor"+this._styleID+";\nuniform vec3  emissiveColor"+this._styleID+";\nuniform float shininess"+this._styleID+";\nuniform float transparency"+this._styleID+";\nuniform float ambientIntensity"+this._styleID+";\n"),e},styleShaderText:function(){return this._first?"float computeFogInterpolant(float distanceFromPoint)\n{\n  if (distanceFromPoint > fogRange){\n    return 0.0;\n  }else if (fogType == 0.0){\n    return clamp((fogRange-distanceFromPoint) / fogRange, 0.0, 1.0);\n  }else{\n    return clamp(exp(-distanceFromPoint / (fogRange-distanceFromPoint)), 0.0, 1.0);\n  }\n}\n":""},lightEquationShaderText:function(){return this._first?"void lighting(in float lType, in vec3 lLocation, in vec3 lDirection, in vec3 lColor, in vec3 lAttenuation, in float lRadius, in float lIntensity, in float lAmbientIntensity, in float lBeamWidth, in float lCutOffAngle, in float ambientIntensity, in float shininess, in vec3 N, in vec3 V, inout vec3 ambient, inout vec3 diffuse, inout vec3 specular)\n{\n   vec3 L;\n   float spot = 1.0, attentuation = 0.0;\n   if(lType == 0.0) {\n       L = -normalize(lDirection);\n       V = normalize(V);\n       attentuation = 1.0;\n   } else{\n       L = (lLocation - (-V));\n       float d = length(L);\n       L = normalize(L);\n       V = normalize(V);\n       if(lRadius == 0.0 || d <= lRadius) {\n           attentuation = 1.0 / max(lAttenuation.x + lAttenuation.y * d + lAttenuation.z * (d * d), 1.0);\n       }\n       if(lType == 2.0) {\n           float spotAngle = acos(max(0.0, dot(-L, normalize(lDirection))));\n           if(spotAngle >= lCutOffAngle) spot = 0.0;\n           else if(spotAngle <= lBeamWidth) spot = 1.0;\n           else spot = (spotAngle - lCutOffAngle ) / (lBeamWidth - lCutOffAngle);\n       }\n   }\n   vec3 H = normalize( L + V );\n   float NdotL = max(0.0, dot(L, N));\n   float NdotH = max(0.0, dot(H, N));\n   float ambientFactor = lAmbientIntensity * ambientIntensity;\n   float diffuseFactor = lIntensity * NdotL;\n   float specularFactor = lIntensity * pow(NdotH, shininess*128.0);\n   ambient += lColor * ambientFactor * attentuation * spot;\n   diffuse += lColor * diffuseFactor * attentuation * spot;\n   specular += lColor * specularFactor * attentuation * spot;\n}\n":""},inlineStyleShaderText:function(){return this._first?"    float fogFactor = computeFogInterpolant(length(cam_pos-ray_pos));\n":""},lightAssigment:function(){for(var e="    if(uEnableShaded"+this._styleID+"){\n",t=0;t<x3dom.nodeTypes.X3DLightNode.lightID;t++)e+="    lighting(light"+t+"_Type, light"+t+"_Location, light"+t+"_Direction, light"+t+"_Color, light"+t+"_Attenuation, light"+t+"_Radius, light"+t+"_Intensity, light"+t+"_AmbientIntensity, light"+t+"_BeamWidth, light"+t+"_CutOffAngle, ambientIntensity"+this._styleID+", shininess"+this._styleID+", grad.xyz, positionE.xyz, ambient, diffuse, specular);\n";return 1==this._vf.lighting&&(this._cf.material.node?e+="      value.rgb = (fogColor*(1.0-fogFactor))+fogFactor*(emissiveColor"+this._styleID+" + ambient*value.rgb + diffuse*diffuseColor"+this._styleID+"*value.rgb + specular*specularColor"+this._styleID+");\n      value.a = value.a*(1.0-transparency"+this._styleID+");\n":e+="      value.rgb = (fogColor*(1.0-fogFactor))+fogFactor*(ambient*value.rgb + diffuse*value.rgb + specular);\n"),e+="    }\n"}})),x3dom.registerNodeType("SilhouetteEnhancementVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.SilhouetteEnhancementVolumeStyle.superClass.call(this,e),this.addField_SFFloat(e,"silhouetteBoundaryOpacity",0),this.addField_SFFloat(e,"silhouetteRetainedOpacity",1),this.addField_SFFloat(e,"silhouetteSharpness",.5),this.uniformFloatBoundaryOpacity=new x3dom.nodeTypes.Uniform(e),this.uniformFloatRetainedOpacity=new x3dom.nodeTypes.Uniform(e),this.uniformFloatSilhouetteSharpness=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DSurfaceNormals=new x3dom.nodeTypes.Uniform(e),this.uniformBoolEnableSilhouette=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"silhouetteBoundaryOpacity":this.uniformFloatBoundaryOpacity._vf.value=this._vf.silhouetteBoundaryOpacity,this.uniformFloatBoundaryOpacity.fieldChanged("value");break;case"silhouetteRetainedOpacity":this.uniformFloatRetainedOpacity._vf.value=this._vf.silhouetteRetainedOpacity,this.uniformFloatRetainedOpacity.fieldChanged("value");break;case"silhouetteSharpness":this.uniformFloatSilhouetteSharpness._vf.value=this._vf.silhouetteSharpness,this.uniformFloatSilhouetteSharpness.fieldChanged("value")}},uniforms:function(){var e=[];return this._cf.surfaceNormals.node&&(this.uniformSampler2DSurfaceNormals._vf.name="uSurfaceNormals",this.uniformSampler2DSurfaceNormals._vf.type="SFInt32",this.uniformSampler2DSurfaceNormals._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DSurfaceNormals)),this.uniformFloatBoundaryOpacity._vf.name="uSilhouetteBoundaryOpacity"+this._styleID,this.uniformFloatBoundaryOpacity._vf.type="SFFloat",this.uniformFloatBoundaryOpacity._vf.value=this._vf.silhouetteBoundaryOpacity,e.push(this.uniformFloatBoundaryOpacity),this.uniformFloatRetainedOpacity._vf.name="uSilhouetteRetainedOpacity"+this._styleID,this.uniformFloatRetainedOpacity._vf.type="SFFloat",this.uniformFloatRetainedOpacity._vf.value=this._vf.silhouetteRetainedOpacity,e.push(this.uniformFloatRetainedOpacity),this.uniformFloatSilhouetteSharpness._vf.name="uSilhouetteSharpness"+this._styleID,this.uniformFloatSilhouetteSharpness._vf.type="SFFloat",this.uniformFloatSilhouetteSharpness._vf.value=this._vf.silhouetteSharpness,e.push(this.uniformFloatSilhouetteSharpness),this.uniformBoolEnableSilhouette._vf.name="uEnableSilhouette"+this._styleID,this.uniformBoolEnableSilhouette._vf.type="SFBool",this.uniformBoolEnableSilhouette._vf.value=this._vf.enabled,e.push(this.uniformBoolEnableSilhouette),e},textures:function(){var e=[];if(null!=this._cf.surfaceNormals.node){var t=this._cf.surfaceNormals.node;t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)}return e},styleUniformsShaderText:function(){return"uniform float uSilhouetteBoundaryOpacity"+this._styleID+";\nuniform float uSilhouetteRetainedOpacity"+this._styleID+";\nuniform float uSilhouetteSharpness"+this._styleID+";\nuniform bool uEnableSilhouette"+this._styleID+";\n"},styleShaderText:function(){return this._first?"void silhouetteEnhancement(inout vec4 orig_color, in vec4 normal, in vec3 V, in float sBoundary, in float sRetained, in float sSharpness)\n{\n   if(normal.w > 0.02){\n       orig_color.a = orig_color.a * (sRetained + sBoundary * pow((1.0-abs(dot(normal.xyz, V))), sSharpness));\n   }\n}\n\n":""},inlineStyleShaderText:function(){return"  if(uEnableSilhouette"+this._styleID+"){\n       silhouetteEnhancement(value, gradEye, dir, uSilhouetteBoundaryOpacity"+this._styleID+", uSilhouetteRetainedOpacity"+this._styleID+", uSilhouetteSharpness"+this._styleID+");\n   }\n"}})),x3dom.registerNodeType("StippleVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.StippleVolumeStyle.superClass.call(this,e),this.addField_SFFloat(e,"distanceFactor",1),this.addField_SFFloat(e,"interiorFactor",1),this.addField_SFFloat(e,"lightingFactor",1),this.addField_SFFloat(e,"gradientThreshold",.4),this.addField_SFFloat(e,"gradientRetainedOpacity",1),this.addField_SFFloat(e,"gradientBoundaryOpacity",0),this.addField_SFFloat(e,"gradientOpacityFactor",1),this.addField_SFFloat(e,"silhouetteRetainedOpacity",1),this.addField_SFFloat(e,"silhouetteBoundaryOpacity",0),this.addField_SFFloat(e,"silhouetteOpacityFactor",1),this.addField_SFFloat(e,"resolutionFactor",1)}))),x3dom.registerNodeType("ToneMappedVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.ToneMappedVolumeStyle.superClass.call(this,e),this.addField_SFColor(e,"coolColor",0,0,1),this.addField_SFColor(e,"warmColor",1,1,0),this.uniformCoolColor=new x3dom.nodeTypes.Uniform(e),this.uniformWarmColor=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DSurfaceNormals=new x3dom.nodeTypes.Uniform(e),this.uniformBoolEnableToneMapped=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"coolColor":this.uniformCoolColor._vf.value=this._vf.coolColor,this.uniformCoolColor.fieldChanged("value");break;case"warmColor":this.uniformWarmColor._vf.value=this._vf.warmColor,this.uniformWarmColor.fieldChanged("value")}},uniforms:function(){var e=[];return this._cf.surfaceNormals.node&&(this.uniformSampler2DSurfaceNormals._vf.name="uSurfaceNormals",this.uniformSampler2DSurfaceNormals._vf.type="SFInt32",this.uniformSampler2DSurfaceNormals._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DSurfaceNormals)),this.uniformCoolColor._vf.name="uCoolColor"+this._styleID,this.uniformCoolColor._vf.type="SFColor",this.uniformCoolColor._vf.value=this._vf.coolColor,e.push(this.uniformCoolColor),this.uniformWarmColor._vf.name="uWarmColor"+this._styleID,this.uniformWarmColor._vf.type="SFColor",this.uniformWarmColor._vf.value=this._vf.warmColor,e.push(this.uniformWarmColor),this.uniformBoolEnableToneMapped._vf.name="uEnableToneMapped"+this._styleID,this.uniformBoolEnableToneMapped._vf.type="SFBool",this.uniformBoolEnableToneMapped._vf.value=this._vf.enabled,e.push(this.uniformBoolEnableToneMapped),e},textures:function(){var e=[];if(this._cf.surfaceNormals.node){var t=this._cf.surfaceNormals.node;t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)}return e},styleUniformsShaderText:function(){return"uniform vec3 uCoolColor"+this._styleID+";\nuniform vec3 uWarmColor"+this._styleID+";\nuniform bool uEnableToneMapped"+this._styleID+";\n"},styleShaderText:function(){return this._first?"void toneMapped(inout vec4 original_color, inout vec3 accum_color, in vec4 surfNormal, in vec3 lightDir, in vec3 cColor, in vec3 wColor)\n{\n   if(surfNormal.a > 0.02){\n       float color_factor = (1.0 + dot(lightDir, surfNormal.xyz))*0.5;\n       accum_color += mix(wColor, cColor, color_factor);\n       original_color.rgb = accum_color;\n   }else{\n       accum_color += mix(wColor, cColor, 0.5);\n       original_color.rgb = accum_color;\n   }\n}\n":""},inlineStyleShaderText:function(){for(var e="    if(uEnableToneMapped"+this._styleID+"){\n       vec3 toneColor = vec3(0.0, 0.0, 0.0);\n       vec3 L = vec3(0.0, 0.0, 0.0);\n",t=0;t<x3dom.nodeTypes.X3DLightNode.lightID;t++)e+="       L = (light"+t+"_Type == 1.0) ? normalize(light"+t+"_Location - positionE.xyz) : -light"+t+"_Direction;\n       toneMapped(value, toneColor, grad, L, uCoolColor"+this._styleID+", uWarmColor"+this._styleID+");\n";return e+="    }\n"},lightAssigment:function(){return""}})),x3dom.registerNodeType("RadarVolumeStyle","VolumeRendering",defineClass(x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode,(function(e){x3dom.nodeTypes.RadarVolumeStyle.superClass.call(this,e),this.addField_SFNode("transferFunction",x3dom.nodeTypes.Texture),this.addField_SFString(e,"type","simple"),this.addField_SFFloat(e,"opacityFactor",6),this.addField_SFFloat(e,"lightFactor",1.2),this.uniformFloatOpacityFactor=new x3dom.nodeTypes.Uniform(e),this.uniformFloatLightFactor=new x3dom.nodeTypes.Uniform(e),this.uniformSampler2DTransferFunction=new x3dom.nodeTypes.Uniform(e),this.uniformBoolEnableOpacityMap=new x3dom.nodeTypes.Uniform(e)}),{fieldChanged:function(e){switch(e){case"opacityFactor":this.uniformFloatOpacityFactor._vf.value=this._vf.opacityFactor,this.uniformFloatOpacityFactor.fieldChanged("value");break;case"lightFactor":this.uniformFloatLightFactor._vf.value=this._vf.lightFactor,this.uniformFloatLightFactor.fieldChanged("value")}},uniforms:function(){var e=[];return this._cf.transferFunction.node&&(this.uniformSampler2DTransferFunction._vf.name="uTransferFunction"+this._styleID,this.uniformSampler2DTransferFunction._vf.type="SFInt32",this.uniformSampler2DTransferFunction._vf.value=this._volumeDataParent._textureID++,e.push(this.uniformSampler2DTransferFunction)),this.uniformFloatOpacityFactor._vf.name="uOpacityFactor"+this._styleID,this.uniformFloatOpacityFactor._vf.type="SFFloat",this.uniformFloatOpacityFactor._vf.value=this._vf.opacityFactor,e.push(this.uniformFloatOpacityFactor),this.uniformFloatLightFactor._vf.name="uLightFactor"+this._styleID,this.uniformFloatLightFactor._vf.type="SFFloat",this.uniformFloatLightFactor._vf.value=this._vf.lightFactor,e.push(this.uniformFloatLightFactor),this.uniformBoolEnableOpacityMap._vf.name="uEnableOpacityMap"+this._styleID,this.uniformBoolEnableOpacityMap._vf.type="SFBool",this.uniformBoolEnableOpacityMap._vf.value=this._vf.enabled,e.push(this.uniformBoolEnableOpacityMap),e},textures:function(){var e=[],t=this._cf.transferFunction.node;return t&&(t._vf.repeatS=!1,t._vf.repeatT=!1,e.push(t)),e},styleUniformsShaderText:function(){var e="uniform float uOpacityFactor"+this._styleID+";\nuniform float uLightFactor"+this._styleID+";\nuniform bool uEnableOpacityMap"+this._styleID+";\n";return this._cf.transferFunction.node&&(e+="uniform sampler2D uTransferFunction"+this._styleID+";\n"),e},inlineStyleShaderText:function(){var e="    if(uEnableOpacityMap"+this._styleID+"){\n       opacityFactor = uOpacityFactor"+this._styleID+";\n       lightFactor = uLightFactor"+this._styleID+";\n";return this._cf.transferFunction.node&&(e+="       if(value.r > 0.3){\n",e+="         value = texture2D(uTransferFunction"+this._styleID+",vec2(value.r,0.5));\n",e+="       }else{\n",e+="         value.a = 0.0;\n",e+="       }\n"),e+="    }\n"}})),x3dom.registerNodeType("VolumeData","VolumeRendering",defineClass(x3dom.nodeTypes.X3DVolumeDataNode,(function(e){x3dom.nodeTypes.VolumeData.superClass.call(this,e),this.addField_SFNode("renderStyle",x3dom.nodeTypes.X3DVolumeRenderStyleNode),this.vrcMultiTexture=new x3dom.nodeTypes.MultiTexture(e),this.vrcVolumeTexture=null,this.vrcSinglePassShader=new x3dom.nodeTypes.ComposedShader(e),this.vrcSinglePassShaderVertex=new x3dom.nodeTypes.ShaderPart(e),this.vrcSinglePassShaderFragment=new x3dom.nodeTypes.ShaderPart(e),this.vrcSinglePassShaderFieldBackCoord=new x3dom.nodeTypes.Field(e),this.vrcSinglePassShaderFieldVolData=new x3dom.nodeTypes.Field(e),this.vrcSinglePassShaderFieldOffset=new x3dom.nodeTypes.Field(e),this.vrcSinglePassShaderFieldDimensions=new x3dom.nodeTypes.Field(e)}),{initializeValues:function(){var e="";return null!=this._cf.renderStyle.node.initializeValues&&(e+=this._cf.renderStyle.node.initializeValues()),e},styleUniformsShaderText:function(){var e=this._cf.renderStyle.node.styleUniformsShaderText();return this.surfaceNormalsNeeded=!0,this._cf.renderStyle.node._cf.surfaceNormals&&null!=this._cf.renderStyle.node._cf.surfaceNormals.node?(e+="uniform sampler2D uSurfaceNormals;\n",this.normalTextureProvided=!0,this.surfaceNormals=this._cf.renderStyle.node._cf.surfaceNormals.node):x3dom.isa(this._cf.renderStyle.node,x3dom.nodeTypes.OpacityMapVolumeStyle)&&(this.surfaceNormalsNeeded=!1,this.normalTextureProvided=!1),e},styleShaderText:function(){var e="";return null!=this._cf.renderStyle.node.styleShaderText&&(e+=this._cf.renderStyle.node.styleShaderText()),e},inlineStyleShaderText:function(){return this._cf.renderStyle.node.inlineStyleShaderText()},lightAssigment:function(){return this._cf.renderStyle.node.lightAssigment()},lightEquationShaderText:function(){return this._cf.renderStyle.node.lightEquationShaderText()},nodeChanged:function(){if(!this._cf.appearance.node){var e;if(this.addChild(new x3dom.nodeTypes.Appearance),this.vrcVolumeTexture=this._cf.voxels.node,this.vrcVolumeTexture._vf.repeatS=!1,this.vrcVolumeTexture._vf.repeatT=!1,this.vrcMultiTexture._nameSpace=this._nameSpace,this.vrcMultiTexture.addChild(this.vrcVolumeTexture,"texture"),this.vrcVolumeTexture.nodeChanged(),this._cf.renderStyle.node.textures){var t=this._cf.renderStyle.node.textures();for(e=0;e<t.length;e++)this.vrcMultiTexture.addChild(t[e],"texture"),this.vrcVolumeTexture.nodeChanged()}this._cf.appearance.node.addChild(this.vrcMultiTexture),this.vrcMultiTexture.nodeChanged(),this._cf.renderStyle.node.updateProperties(this),this.vrcSinglePassShaderVertex._vf.type="vertex",this.vrcSinglePassShaderVertex._vf.url[0]=this.vertexShaderText(x3dom.isa(this._cf.renderStyle.node,x3dom.nodeTypes.RadarVolumeStyle)),this.vrcSinglePassShaderFragment._vf.type="fragment";var A="";x3dom.isa(this._cf.renderStyle.node,x3dom.nodeTypes.X3DComposableVolumeRenderStyleNode)?A+=this.fragmentPreamble+this.defaultUniformsShaderText(this.vrcVolumeTexture._vf.numberOfSlices,this.vrcVolumeTexture._vf.slicesOverX,this.vrcVolumeTexture._vf.slicesOverY)+this.styleUniformsShaderText()+this.styleShaderText()+this.texture3DFunctionShaderText+this.normalFunctionShaderText()+this.lightEquationShaderText()+this.defaultLoopFragmentShaderText(this.inlineStyleShaderText(),this.lightAssigment(),this.initializeValues()):A+=this._cf.renderStyle.node.fragmentShaderText(this.vrcVolumeTexture._vf.numberOfSlices,this.vrcVolumeTexture._vf.slicesOverX,this.vrcVolumeTexture._vf.slicesOverY),this.vrcSinglePassShaderFragment._vf.url[0]=A,this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderVertex,"parts"),this.vrcSinglePassShaderVertex.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFragment,"parts"),this.vrcSinglePassShaderFragment.nodeChanged(),this.vrcSinglePassShaderFieldVolData._vf.name="uVolData",this.vrcSinglePassShaderFieldVolData._vf.type="SFInt32",this.vrcSinglePassShaderFieldVolData._vf.value=this._textureID++,this.vrcSinglePassShaderFieldDimensions._vf.name="dimensions",this.vrcSinglePassShaderFieldDimensions._vf.type="SFVec3f",this.vrcSinglePassShaderFieldDimensions._vf.value=this._vf.dimensions,this.vrcSinglePassShaderFieldOffset._vf.name="offset",this.vrcSinglePassShaderFieldOffset._vf.type="SFVec3f",this.vrcSinglePassShaderFieldOffset._vf.value="0.01 0.01 0.01",this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldVolData,"fields"),this.vrcSinglePassShaderFieldVolData.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldDimensions,"fields"),this.vrcSinglePassShaderFieldDimensions.nodeChanged(),this.vrcSinglePassShader.addChild(this.vrcSinglePassShaderFieldOffset,"fields"),this.offsetInterval=window.setInterval((o=this.vrcVolumeTexture,s=this,function(){x3dom.debug.logInfo("[VolumeRendering][VolumeData] Looking for Volume Texture size...");var e=s.getTextureSize(o);e.valid&&(clearInterval(s.offsetInterval),s.vrcSinglePassShaderFieldOffset._vf.value=new x3dom.fields.SFVec3f(1/(e.w/o._vf.slicesOverX),1/(e.h/o._vf.slicesOverY),1/o._vf.numberOfSlices),s.vrcSinglePassShader.nodeChanged(),x3dom.debug.logInfo("[VolumeRendering][VolumeData] Volume Texture size obtained"))}),1e3);var i=this._cf.renderStyle.node.uniforms();for(e=0;e<i.length;e++)this.vrcSinglePassShader.addChild(i[e],"fields");this._cf.appearance.node.addChild(this.vrcSinglePassShader),this.vrcSinglePassShader.nodeChanged(),this._cf.appearance.node.nodeChanged()}var o,s;this._cf.geometry.node||(this.addChild(new x3dom.nodeTypes.Box),this._cf.geometry.node._vf.solid=!1,this._cf.geometry.node._vf.hasHelperColors=!1,this._cf.geometry.node._vf.size=new x3dom.fields.SFVec3f(this._vf.dimensions.x,this._vf.dimensions.y,this._vf.dimensions.z),this._cf.geometry.node.fieldChanged("size"))}})),x3dom.registerNodeType("IndexedQuadSet","CADGeometry",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,(function(e){x3dom.nodeTypes.IndexedQuadSet.superClass.call(this,e),this.addField_MFInt32(e,"index",[])}),{nodeChanged:function(){var e=(new Date).getTime();this.handleAttribs();var t,A,i,o,s=this._vf.colorPerVertex,n=this._vf.normalPerVertex,r=this._vf.index,a=!1,d=!1,h=!1,g=this._cf.coord.node;x3dom.debug.assert(g),t=g._vf.point;var l=this._cf.normal.node;l?(a=!0,A=l._vf.vector):a=!1;var I="",c=2,f=this._cf.texCoord.node;x3dom.isa(f,x3dom.nodeTypes.MultiTextureCoordinate)&&f._cf.texCoord.nodes.length&&(f=f._cf.texCoord.nodes[0]),f?f._vf.point?(d=!0,i=f._vf.point,x3dom.isa(f,x3dom.nodeTypes.TextureCoordinate3D)&&(c=3)):f._vf.mode&&(I=f._vf.mode):d=!1;var u,C,_=3,m=this._cf.color.node;for(m?(h=!0,o=m._vf.color,x3dom.isa(m,x3dom.nodeTypes.ColorRGBA)&&(_=4)):h=!1,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];t.length%4>0;)t.push(t.length-1);for(t.length,C=0,u=0;u<r.length;u++)u>0&&u%4==3?(C++,this._mesh._indices[0].push(r[u-3]),this._mesh._indices[0].push(r[u-1]),this._mesh._indices[0].push(r[u])):this._mesh._indices[0].push(r[u]),!n&&a&&(this._mesh._normals[0].push(A[C].x),this._mesh._normals[0].push(A[C].y),this._mesh._normals[0].push(A[C].z)),!s&&h&&(this._mesh._colors[0].push(o[C].r),this._mesh._colors[0].push(o[C].g),this._mesh._colors[0].push(o[C].b),4===_&&this._mesh._colors[0].push(o[C].a));for(this._mesh._positions[0]=t.toGL(),a?this._mesh._normals[0]=A.toGL():this._mesh.calcNormals(n?Math.PI:0),d?(this._mesh._texCoords[0]=i.toGL(),this._mesh._numTexComponents=c):this._mesh.calcTexCoords(I),h&&s&&(this._mesh._colors[0]=o.toGL(),this._mesh._numColComponents=_),this.invalidateVolume(),this._mesh._numFaces=0,this._mesh._numCoords=0,u=0;u<this._mesh._indices.length;u++)this._mesh._numFaces+=this._mesh._indices[u].length/3,this._mesh._numCoords+=this._mesh._positions[u].length/3;(new Date).getTime()},fieldChanged:function(e){var t=this._cf.coord.node._vf.point;if(t.length>x3dom.Utils.maxIndexableCoords)x3dom.debug.logWarning("IndexedQuadSet: fieldChanged with too many coordinates not yet implemented!");else if("coord"==e)this._mesh._positions[0]=t.toGL(),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}));else if("color"==e){if(t=this._cf.color.node._vf.color,this._vf.colorPerVertex)this._mesh._colors[0]=t.toGL();else if(!this._vf.colorPerVertex){var A=0,i=3;x3dom.isa(this._cf.color.node,x3dom.nodeTypes.ColorRGBA)&&(i=4),this._mesh._colors[0]=[];var o,s=this._vf.index;for(o=0;o<s.length;++o)o>0&&o%3==0&&A++,this._mesh._colors[0].push(t[A].r),this._mesh._colors[0].push(t[A].g),this._mesh._colors[0].push(t[A].b),4===i&&this._mesh._colors[0].push(t[A].a)}this._parentNodes.forEach((function(e){e._dirty.colors=!0}))}else if("normal"==e){if(t=this._cf.normal.node._vf.vector,this._vf.normalPerVertex)this._mesh._normals[0]=t.toGL();else if(!this._vf.normalPerVertex){s=this._vf.index;this._mesh._normals[0]=[];A=0;for(o=0;o<s.length;++o)o>0&&o%3==0&&A++,this._mesh._normals[0].push(t[A].x),this._mesh._normals[0].push(t[A].y),this._mesh._normals[0].push(t[A].z)}this._parentNodes.forEach((function(e){e._dirty.normals=!0}))}else if("texCoord"==e){var n=this._cf.texCoord.node;x3dom.isa(n,x3dom.nodeTypes.MultiTextureCoordinate)&&n._cf.texCoord.nodes.length&&(n=n._cf.texCoord.nodes[0]),t=n._vf.point,this._mesh._texCoords[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.texcoords=!0}))}}})),x3dom.registerNodeType("QuadSet","CADGeometry",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,(function(e){x3dom.nodeTypes.QuadSet.superClass.call(this,e)}),{nodeChanged:function(){var e=(new Date).getTime();this.handleAttribs();var t,A,i,o,s=this._vf.colorPerVertex,n=this._vf.normalPerVertex,r=!1,a=!1,d=!1,h=this._cf.coord.node;x3dom.debug.assert(h),t=h._vf.point;var g=this._cf.normal.node;g?(r=!0,A=g._vf.vector):r=!1;var l="",I=2,c=this._cf.texCoord.node;x3dom.isa(c,x3dom.nodeTypes.MultiTextureCoordinate)&&c._cf.texCoord.nodes.length&&(c=c._cf.texCoord.nodes[0]),c?c._vf.point?(a=!0,i=c._vf.point,x3dom.isa(c,x3dom.nodeTypes.TextureCoordinate3D)&&(I=3)):c._vf.mode&&(l=c._vf.mode):a=!1;var f,u,C=3,_=this._cf.color.node;for(_?(d=!0,o=_._vf.color,x3dom.isa(_,x3dom.nodeTypes.ColorRGBA)&&(C=4)):d=!1,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];t.length%4>0;)t.push(t.length-1);for(t.length,u=0,f=0;f<t.length;f++)f>0&&f%4==3?(u++,this._mesh._indices[0].push(f-3),this._mesh._indices[0].push(f-1),this._mesh._indices[0].push(f)):this._mesh._indices[0].push(f),!n&&r&&(this._mesh._normals[0].push(A[u].x),this._mesh._normals[0].push(A[u].y),this._mesh._normals[0].push(A[u].z)),!s&&d&&(this._mesh._colors[0].push(o[u].r),this._mesh._colors[0].push(o[u].g),this._mesh._colors[0].push(o[u].b),4===C&&this._mesh._colors[0].push(o[u].a));for(this._mesh._positions[0]=t.toGL(),r?this._mesh._normals[0]=A.toGL():this._mesh.calcNormals(n?Math.PI:0),a?(this._mesh._texCoords[0]=i.toGL(),this._mesh._numTexComponents=I):this._mesh.calcTexCoords(l),d&&s&&(this._mesh._colors[0]=o.toGL(),this._mesh._numColComponents=C),this.invalidateVolume(),this._mesh._numFaces=0,this._mesh._numCoords=0,f=0;f<this._mesh._indices.length;f++)this._mesh._numFaces+=this._mesh._indices[f].length/3,this._mesh._numCoords+=this._mesh._positions[f].length/3;(new Date).getTime()},fieldChanged:function(e){var t=this._cf.coord.node._vf.point;if(t.length>x3dom.Utils.maxIndexableCoords)x3dom.debug.logWarning("QuadSet: fieldChanged with too many coordinates not yet implemented!");else if("coord"==e)this._mesh._positions[0]=t.toGL(),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()}));else if("color"==e){if(t=this._cf.color.node._vf.color,this._vf.colorPerVertex)this._mesh._colors[0]=t.toGL();else if(!this._vf.colorPerVertex){var A=0,i=3;x3dom.isa(this._cf.color.node,x3dom.nodeTypes.ColorRGBA)&&(i=4),this._mesh._colors[0]=[];var o,s=this._vf.index;for(o=0;o<s.length;++o)o>0&&o%3==0&&A++,this._mesh._colors[0].push(t[A].r),this._mesh._colors[0].push(t[A].g),this._mesh._colors[0].push(t[A].b),4===i&&this._mesh._colors[0].push(t[A].a)}this._parentNodes.forEach((function(e){e._dirty.colors=!0}))}else if("normal"==e){if(t=this._cf.normal.node._vf.vector,this._vf.normalPerVertex)this._mesh._normals[0]=t.toGL();else if(!this._vf.normalPerVertex){s=this._vf.index;this._mesh._normals[0]=[];A=0;for(o=0;o<s.length;++o)o>0&&o%3==0&&A++,this._mesh._normals[0].push(t[A].x),this._mesh._normals[0].push(t[A].y),this._mesh._normals[0].push(t[A].z)}this._parentNodes.forEach((function(e){e._dirty.normals=!0}))}else if("texCoord"==e){var n=this._cf.texCoord.node;x3dom.isa(n,x3dom.nodeTypes.MultiTextureCoordinate)&&n._cf.texCoord.nodes.length&&(n=n._cf.texCoord.nodes[0]),t=n._vf.point,this._mesh._texCoords[0]=t.toGL(),this._parentNodes.forEach((function(e){e._dirty.texcoords=!0}))}}})),x3dom.registerNodeType("CADLayer","CADGeometry",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.CADLayer.superClass.call(this,e),this.addField_SFString(e,"name","")}))),x3dom.registerNodeType("CADAssembly","CADGeometry",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.CADAssembly.superClass.call(this,e),this.addField_SFString(e,"name","")}))),x3dom.registerNodeType("CADPart","CADGeometry",defineClass(x3dom.nodeTypes.Transform,(function(e){x3dom.nodeTypes.CADPart.superClass.call(this,e),this.addField_SFString(e,"name","")}))),x3dom.registerNodeType("CADFace","CADGeometry",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.CADFace.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_SFNode("shape",x3dom.nodeTypes.X3DShapeNode)}),{getVolume:function(){var e=this._graph.volume;if(!this.volumeValid()&&(this._vf.bboxDisplay||this.renderFlag&&this.renderFlag())){var t=this._cf.shape.node,A=t&&(t._vf.bboxDisplay||t.renderFlag&&t.renderFlag())?t.getVolume():null;A&&A.isValid()&&e.extendBounds(A.min,A.max)}return e},collectDrawableObjects:function(e,t,A,i,o,s){var n,r;(A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),this.collectBbox(e,t,A,i,o,s),!this._cf.shape.node||(o=t.cull(e,this.graphState(),A,o))<0)||(A?(this._graph.globalMatrix||(this._graph.globalMatrix=this.transformMatrix(e)),r=this._graph.globalMatrix):r=this.transformMatrix(e),(n=this._cf.shape.node)&&n.collectDrawableObjects(r,t,A,i,o,s))}})),x3dom.registerNodeType("Patch","BVHRefiner",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Patch.superClass.call(this,e),this.addField_SFVec2f(e,"size",2,2),this.addField_SFVec2f(e,"subdivision",1,1),this.addField_SFVec3f(e,"center",0,0,0),this.addField_MFString(e,"primType",["TRIANGLES"]);var t=this._vf.size.x,A=this._vf.size.y,i=this._vf.subdivision.x,o=this._vf.subdivision.y;this._indexBufferTriangulationParts=[];var s=0,n=0,r=t/i/2,a=A/o/2;t/=2,A/=2;var d=2*i+1,h=2*o+1;for(n=0;n<=2*o;n++)for(s=0;s<=2*i;s++)this._mesh._positions[0].push(this._vf.center.x+s*r-t),this._mesh._positions[0].push(this._vf.center.y+n*a-A),this._mesh._positions[0].push(this._vf.center.z),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1),this._mesh._texCoords[0].push(s/(2*i)),this._mesh._texCoords[0].push(n/(2*o));for(n=0;n<h-2;n+=2)for(s=0;s<d-2;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(this._indexBufferTriangulationParts.push({offset:0,count:i*o*6}),n=0;n<h-2;n+=2)for(s=0;s<2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=0;n<h-2;n+=2)for(s=2;s<d-2;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(this._indexBufferTriangulationParts.push({offset:this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].offset+2*this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].count,count:i*o*6+9*o}),n=0;n<h-2;n+=2)for(s=d-3;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=0;n<h-2;n+=2)for(s=0;s<d-4;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(this._indexBufferTriangulationParts.push({offset:this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].offset+2*this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].count,count:i*o*6+9*o}),n=2;n<h-2;n+=2)for(s=0;s<d-2;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(n=0;n<2;n+=2)for(s=0;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(this._indexBufferTriangulationParts.push({offset:this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].offset+2*this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].count,count:i*o*6+9*i}),n=h-3;n<h-2;n+=2)for(s=0;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=0;n<h-4;n+=2)for(s=0;s<d-2;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(this._indexBufferTriangulationParts.push({offset:this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].offset+2*this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].count,count:i*o*6+9*i}),n=h-3;n<h-2;n+=2)for(s=d-3;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=0;n<h-4;n+=2)for(s=0;s<d-4;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(n=0;n<h-4;n+=2)for(s=d-3;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=h-3;n<h-2;n+=2)for(s=0;s<d-4;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(this._indexBufferTriangulationParts.push({offset:this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].offset+2*this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].count,count:i*o*6+9*i+9*(o-1)+3}),n=h-3;n<h-2;n+=2)for(s=0;s<2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=0;n<h-4;n+=2)for(s=2;s<d-2;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(n=h-3;n<h-2;n+=2)for(s=2;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=0;n<h-4;n+=2)for(s=0;s<2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(this._indexBufferTriangulationParts.push({offset:this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].offset+2*this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].count,count:i*o*6+9*i+9*(o-1)+3}),n=0;n<2;n+=2)for(s=0;s<2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=2;n<h-2;n+=2)for(s=2;s<d-2;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(n=2;n<h-2;n+=2)for(s=0;s<2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=0;n<2;n+=2)for(s=2;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(this._indexBufferTriangulationParts.push({offset:this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].offset+2*this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].count,count:i*o*6+9*i+9*(o-1)+3}),n=0;n<2;n+=2)for(s=d-3;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=2;n<h-2;n+=2)for(s=0;s<d-4;s+=2)this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+(n+2)*d);for(n=2;n<h-2;n+=2)for(s=d-3;s<d-2;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+2+(n+1)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);for(n=0;n<2;n+=2)for(s=0;s<d-4;s+=2)this._mesh._indices[0].push(s+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+2+(n+2)*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+2+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+n*d),this._mesh._indices[0].push(s+1+(n+1)*d),this._mesh._indices[0].push(s+n*d);this._indexBufferTriangulationParts.push({offset:this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].offset+2*this._indexBufferTriangulationParts[this._indexBufferTriangulationParts.length-1].count,count:i*o*6+9*i+9*(o-1)+3}),this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3}),{hasIndexOffset:function(){return!0},getTriangulationAttributes:function(e){return this._indexBufferTriangulationParts[e]}})),x3dom.registerNodeType("BVHRefiner","BVHRefiner",defineClass(x3dom.nodeTypes.X3DLODNode,(function(e){x3dom.nodeTypes.BVHRefiner.superClass.call(this,e),this.addField_SFFloat(e,"factor",1),this.addField_SFInt32(e,"maxDepth",3),this.addField_SFInt32(e,"minDepth",0),this.addField_SFInt32(e,"smoothLoading",1),this.addField_SFInt32(e,"interactionDepth",this._vf.maxDepth),this.addField_SFVec2f(e,"size",1,1),this.addField_SFVec3f(e,"octSize",1,1,1),this.addField_SFVec2f(e,"subdivision",1,1),this.addField_SFString(e,"url",""),this.addField_SFString(e,"elevationUrl",""),this.addField_SFString(e,"textureUrl",""),this.addField_SFString(e,"normalUrl",""),this.addField_SFString(e,"mode","3d"),this.addField_SFString(e,"subMode","wmts"),this.addField_SFString(e,"elevationFormat","png"),this.addField_SFString(e,"textureFormat","png"),this.addField_SFString(e,"normalFormat","png"),this.addField_SFFloat(e,"maxElevation",1),this.addField_SFBool(e,"useNormals",!0),this.addField_SFBool(e,"lit",!0),this.addField_SFInt32(e,"bvhCount",8),this.creationSmooth=0,this.togglePoints=!0,this.nodeProducer=new NodeProducer;for(var t=0,A=0;A<=this._vf.maxDepth;A++)t+=Math.pow(4,A);if(this.nodeList=new Array(t),"bin"===this._vf.mode)this.rootNode=new QuadtreeNodeBin(e,this,0,0,0,null);else if("3d"===this._vf.mode||"2d"===this._vf.mode){var i=new x3dom.nodeTypes.Plane(e);i._vf.subdivision.setValues(this._vf.subdivision),i.fieldChanged("subdivision"),i._vf.size.setValues(this._vf.size),"2d"===this._vf.mode?"wmts"===this._vf.subMode?this.rootNode=new QuadtreeNode2dWMTS(e,this,0,0,x3dom.fields.SFMatrix4f.identity(),0,0,i):this.rootNode=new QuadtreeNode2D(e,this,0,0,x3dom.fields.SFMatrix4f.identity(),0,0,i,"/",1):"32bit"===this._vf.subMode?this.rootNode=new QuadtreeNode3D_32bit(e,this,0,0,x3dom.fields.SFMatrix4f.identity(),0,0,i):(i=new x3dom.nodeTypes.Patch(e),this.rootNode=new QuadtreeNode3D(e,this,0,0,x3dom.fields.SFMatrix4f.identity(),0,0,i))}else"bvh"===this._vf.mode?this.rootNode=new BVHNode(e,this,0,"/",1,this._vf.bvhCount):x3dom.debug.logError("Error attribute mode. Value: '"+this._vf.mode+"' isn't conform. Please use type 'bin', '2d' or '3d'")}),{visitChildren:function(e,t,A,i,o){var s=this._nameSpace.doc._x3dElem;"oct"===this._vf.mode?(s.runtime.isReady&&this.togglePoints&&(s.runtime.togglePoints(),this.togglePoints=!1,this.view=t.viewarea),this.creationSmooth++,A=!1,i=!0,this.rootNode.collectDrawables(e,t,A,i,o),this.view.isMovingOrAnimating()||this.creationSmooth%this._vf.smoothLoading!=0||this.nodeProducer.CreateNewNode()):(s.runtime.isReady&&this.togglePoints&&(this.view=s.runtime.canvas.doc._viewarea,this.togglePoints=!1),this.createChildren=0,this.creationSmooth++,A=!1,i=!0,this.rootNode.collectDrawables(e,t,A,i,o),this.view.isMovingOrAnimating()||this.creationSmooth%this._vf.smoothLoading!=0||this.nodeProducer.CreateNewNode())},getVolume:function(){var e=this._graph.volume;if(!this.volumeValid()&&(this._vf.bboxDisplay||this.renderFlag&&this.renderFlag())){var t=this.rootNode.getVolume();t&&t.isValid()&&e.extendBounds(t.min,t.max)}return e}})),x3dom.registerNodeType("Snout","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Snout.superClass.call(this,e),this.addField_SFFloat(e,"dbottom",1),this.addField_SFFloat(e,"dtop",.5),this.addField_SFFloat(e,"height",1),this.addField_SFFloat(e,"xoff",.25),this.addField_SFFloat(e,"yoff",.25),this.addField_SFBool(e,"bottom",!0),this.addField_SFBool(e,"top",!0),this.addField_SFFloat(e,"subdivision",32),this.rebuildGeometry()}),{rebuildGeometry:function(){this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._indices[0]=[];var e,t,A,i,o,s=this._vf.dbottom/2,n=this._vf.height,r=this._vf.dtop/2,a=this._vf.subdivision,d=2*Math.PI/a,h=(s-r)/n,g=1/Math.sqrt(1+h*h),l=0,I=0;if(n>0){var c=0,f=0;for(l=0,I=0;l<=a;l++)e=l*d,t=Math.sin(e),A=-Math.cos(e),c=t*r+this._vf.xoff,f=A*r+this._vf.yoff,this._mesh._positions[0].push(c,n/2,f),this._mesh._normals[0].push(t/g,h/g,A/g),this._mesh._texCoords[0].push(1-l/a,1),this._mesh._positions[0].push(t*s,-n/2,A*s),this._mesh._normals[0].push(t/g,h/g,A/g),this._mesh._texCoords[0].push(1-l/a,0),l>0&&(this._mesh._indices[0].push(I),this._mesh._indices[0].push(I+2),this._mesh._indices[0].push(I+1),this._mesh._indices[0].push(I+1),this._mesh._indices[0].push(I+2),this._mesh._indices[0].push(I+3),I+=2)}if(s>0&&this._vf.bottom){for(o=this._mesh._positions[0].length/3,l=a-1;l>=0;l--)e=l*d,t=s*Math.sin(e),A=-s*Math.cos(e),this._mesh._positions[0].push(t,-n/2,A),this._mesh._normals[0].push(0,-1,0),this._mesh._texCoords[0].push(t/s/2+.5,A/s/2+.5);for(i=o+1,l=2;l<a;l++)this._mesh._indices[0].push(i),this._mesh._indices[0].push(o),i=o+l,this._mesh._indices[0].push(i)}if(r>x3dom.fields.Eps&&this._vf.top){for(o=this._mesh._positions[0].length/3,l=a-1;l>=0;l--)e=l*d,t=r*Math.sin(e),A=-r*Math.cos(e),this._mesh._positions[0].push(t+this._vf.xoff,n/2,A+this._vf.yoff),this._mesh._normals[0].push(0,1,0),this._mesh._texCoords[0].push(t/r/2+.5,1-A/r/2+.5);for(i=o+1,l=2;l<a;l++)this._mesh._indices[0].push(o),this._mesh._indices[0].push(i),i=o+l,this._mesh._indices[0].push(i)}this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){"dtop"!=e&&"dbottom"!=e&&"height"!=e&&"subdivision"!=e&&"xoff"!=e&&"yoff"!=e&&"bottom"!=e&&"top"!=e||(this.rebuildGeometry(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("Dish","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Dish.superClass.call(this,e),this.addField_SFFloat(e,"diameter",2),this.addField_SFFloat(e,"height",1),this.addField_SFFloat(e,"radius",this._vf.diameter/2),this.addField_SFBool(e,"bottom",!0),this.addField_SFVec2f(e,"subdivision",24,24),this.rebuildGeometry()}),{rebuildGeometry:function(){this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._indices[0]=[];var e=2*Math.PI,t=Math.PI/2,A=this._vf.diameter/2,i=this._vf.radius;i=0==i||Math.abs(A-i)<=x3dom.fields.Eps?A:i;var o,s,n,r,a,d,h,g,l,I,c,f,u=Math.min(this._vf.height,i),C=i-u,_=A,m=i,p=A,E=this._vf.subdivision.x,B=this._vf.subdivision.y,Q=this._vf.ccw?1:-1,x=t-Math.asin(1-u/i),v=Math.ceil(E/t*x),y=[],F=[];for(o=0;o<=E;o++){for(n=v==o?x:o*t/E,r=Math.sin(n),a=Math.cos(n),s=0;s<=B;s++)d=s*e/B,h=Math.sin(d),g=_*(-Math.cos(d)*r),l=m*a,I=p*(-h*r),c=.25-s/B,f=o/E,this._mesh._positions[0].push(g,l-C,I),this._mesh._texCoords[0].push(c,f),this._mesh._normals[0].push(Q*g/(_*_),Q*l/(m*m),Q*I/(p*p)),o!=E&&v!=o||(y.push(g,l-C,I),F.push(c,f));if(v==o)break}for(o=0;o<E&&v!=o;o++)for(s=0;s<B;s++){var D=o*(B+1)+s,S=D+B+1;this._mesh._indices[0].push(D+1),this._mesh._indices[0].push(S),this._mesh._indices[0].push(D),this._mesh._indices[0].push(D+1),this._mesh._indices[0].push(S+1),this._mesh._indices[0].push(S)}if(this._vf.bottom)for(var w=this._mesh._positions[0].length/3,N=w+1,T=0,b=y.length/3;T<b;T++){var M=3*T;this._mesh._positions[0].push(y[M]),this._mesh._positions[0].push(y[M+1]),this._mesh._positions[0].push(y[M+2]),M=2*T,this._mesh._texCoords[0].push(F[M]),this._mesh._texCoords[0].push(F[M+1]),this._mesh._normals[0].push(0,-1*Q,0),T>=2&&(this._mesh._indices[0].push(w),this._mesh._indices[0].push(N),N=w+T,this._mesh._indices[0].push(N))}this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){"radius"!=e&&"height"!=e&&"diameter"!=e&&"subdivision"!=e&&"bottom"!=e||(this.rebuildGeometry(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("Pyramid","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Pyramid.superClass.call(this,e),this.addField_SFFloat(e,"xbottom",1),this.addField_SFFloat(e,"ybottom",1),this.addField_SFFloat(e,"xtop",.5),this.addField_SFFloat(e,"ytop",.5),this.addField_SFFloat(e,"height",1),this.addField_SFFloat(e,"xoff",.25),this.addField_SFFloat(e,"yoff",.25);var t=this._vf.xtop/2,A=this._vf.ytop/2,i=this._vf.xbottom/2,o=this._vf.ybottom/2,s=this._vf.xoff,n=this._vf.yoff,r=this._vf.height/2;this._mesh._positions[0]=[-i,-r,-o,-t+s,r,-A+n,t+s,r,-A+n,i,-r,-o,-i,-r,o,-t+s,r,A+n,t+s,r,A+n,i,-r,o,-i,-r,-o,-i,-r,o,-t+s,r,A+n,-t+s,r,-A+n,i,-r,-o,i,-r,o,t+s,r,A+n,t+s,r,-A+n,-t+s,r,-A+n,-t+s,r,A+n,t+s,r,A+n,t+s,r,-A+n,-i,-r,-o,-i,-r,o,i,-r,o,i,-r,-o],this._mesh._texCoords[0]=[1,0,1,1,0,1,0,0,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1,1,0,0,0,0,1,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,1,0],this._mesh._indices[0]=[0,1,2,2,3,0,6,5,4,4,7,6,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20],this._mesh.calcNormals(Math.PI,this._vf.ccw),this._mesh._invalidate=!0,this._mesh._numFaces=12,this._mesh._numCoords=24}),{fieldChanged:function(e){if("xbottom"==e||"ybottom"==e||"xtop"==e||"ytop"==e||"xoff"==e||"yoff"==e||"height"==e){var t=this._vf.xtop/2,A=this._vf.ytop/2,i=this._vf.xbottom/2,o=this._vf.ybottom/2,s=this._vf.xoff,n=this._vf.yoff,r=this._vf.height/2;this._mesh._positions[0]=[-i,-r,-o,-t+s,r,-A+n,t+s,r,-A+n,i,-r,-o,-i,-r,o,-t+s,r,A+n,t+s,r,A+n,i,-r,o,-i,-r,-o,-i,-r,o,-t+s,r,A+n,-t+s,r,-A+n,i,-r,-o,i,-r,o,t+s,r,A+n,t+s,r,-A+n,-t+s,r,-A+n,-t+s,r,A+n,t+s,r,A+n,t+s,r,-A+n,-i,-r,-o,-i,-r,o,i,-r,o,i,-r,-o],this._mesh._normals[0]=[],this._mesh.calcNormals(Math.PI,this._vf.ccw),this.invalidateVolume(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()}))}}})),x3dom.registerNodeType("RectangularTorus","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.RectangularTorus.superClass.call(this,e),this.addField_SFFloat(e,"innerRadius",.5),this.addField_SFFloat(e,"outerRadius",1),this.addField_SFFloat(e,"height",1),this.addField_SFFloat(e,"angle",2*Math.PI),this.addField_SFBool(e,"caps",!0),this.addField_SFFloat(e,"subdivision",32),this._origCCW=this._vf.ccw,this.rebuildGeometry()}),{rebuildGeometry:function(){this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._indices[0]=[];var e=2*Math.PI;if(this._vf.ccw=!this._origCCW,this._vf.angle<0?this._vf.angle=0:this._vf.angle>e&&(this._vf.angle=e),this._vf.innerRadius>this._vf.outerRadius){var t=this._vf.innerRadius;this._vf.innerRadius=this._vf.outerRadius,this._vf.outerRadius=t}var A,i,o,s,n,r,a,d=this._vf.innerRadius,h=this._vf.outerRadius,g=this._vf.height/2,l=this._vf.angle,I=this._vf.subdivision,c=l/I;for(n=0,s=0;n<=I;n++)A=n*c,i=h*(r=Math.cos(A)),o=h*(a=-Math.sin(A)),this._mesh._positions[0].push(i,-g,o),this._mesh._normals[0].push(r,0,a),this._mesh._positions[0].push(i,g,o),this._mesh._normals[0].push(r,0,a),n>0&&(this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+3),s+=2);for(n=0,s+=2;n<=I;n++)A=n*c,i=d*(r=Math.cos(A)),o=d*(a=-Math.sin(A)),this._mesh._positions[0].push(i,-g,o),this._mesh._normals[0].push(-r,0,-a),this._mesh._positions[0].push(i,g,o),this._mesh._normals[0].push(-r,0,-a),n>0&&(this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+3),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+2),s+=2);for(n=0,s+=2;n<=I;n++)A=n*c,i=h*(r=Math.cos(A)),o=h*(a=-Math.sin(A)),this._mesh._positions[0].push(i,g,o),this._mesh._normals[0].push(0,1,0),i=d*r,o=d*a,this._mesh._positions[0].push(i,g,o),this._mesh._normals[0].push(0,1,0),n>0&&(this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+3),s+=2);for(n=0,s+=2;n<=I;n++)A=n*c,i=h*(r=Math.cos(A)),o=h*(a=-Math.sin(A)),this._mesh._positions[0].push(i,-g,o),this._mesh._normals[0].push(0,-1,0),i=d*r,o=d*a,this._mesh._positions[0].push(i,-g,o),this._mesh._normals[0].push(0,-1,0),n>0&&(this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+3),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+2),s+=2);l<e&&1==this._vf.caps&&(s+=2,i=h,o=0,this._mesh._positions[0].push(i,g,o),this._mesh._normals[0].push(0,0,1),this._mesh._positions[0].push(i,-g,o),this._mesh._normals[0].push(0,0,1),i=d,o=0,this._mesh._positions[0].push(i,g,o),this._mesh._normals[0].push(0,0,1),this._mesh._positions[0].push(i,-g,o),this._mesh._normals[0].push(0,0,1),this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+3),s+=4,i=h*(r=Math.cos(l)),o=h*(a=-Math.sin(l)),this._mesh._positions[0].push(i,g,o),this._mesh._normals[0].push(a,0,-r),this._mesh._positions[0].push(i,-g,o),this._mesh._normals[0].push(a,0,-r),i=d*r,o=d*a,this._mesh._positions[0].push(i,g,o),this._mesh._normals[0].push(a,0,-r),this._mesh._positions[0].push(i,-g,o),this._mesh._normals[0].push(a,0,-r),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+3),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+2)),this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){"innerRadius"!=e&&"outerRadius"!=e&&"height"!=e&&"angle"!=e&&"subdivision"!=e&&"caps"!=e||(this.rebuildGeometry(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("SlopedCylinder","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.SlopedCylinder.superClass.call(this,e),this.addField_SFFloat(e,"radius",1),this.addField_SFFloat(e,"height",2),this.addField_SFBool(e,"bottom",!0),this.addField_SFBool(e,"top",!0),this.addField_SFFloat(e,"xtshear",.26179),this.addField_SFFloat(e,"ytshear",0),this.addField_SFFloat(e,"xbshear",.26179),this.addField_SFFloat(e,"ybshear",0),this.addField_SFFloat(e,"subdivision",32),this.rebuildGeometry()}),{rebuildGeometry:function(){this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._indices[0]=[];var e,t,A,i,o,s,n,r,a=this._vf.xtshear,d=this._vf.ytshear,h=this._vf.xbshear,g=this._vf.ybshear,l=this._vf.subdivision,I=this._vf.radius,c=this._vf.height/2,f=2*Math.PI/l;for(o=0,s=0;o<=l;o++)e=o*f,t=Math.sin(e),i=-Math.cos(e),this._mesh._positions[0].push(t*I,t*h-c+i*g,i*I),this._mesh._texCoords[0].push(1-o/l,0),this._mesh._positions[0].push(t*I,c+t*a+i*d,i*I),this._mesh._texCoords[0].push(1-o/l,1),o>0&&(this._mesh._indices[0].push(s),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+2),this._mesh._indices[0].push(s+1),this._mesh._indices[0].push(s+3),s+=2);if(this._vf.top&&I>0){for(r=this._mesh._positions[0].length/3,o=l-1;o>=0;o--)s=6*o,t=this._mesh._positions[0][s+3],A=this._mesh._positions[0][s+4],i=this._mesh._positions[0][s+5],this._mesh._positions[0].push(t,A,i),this._mesh._texCoords[0].push(t/2+.5,-i/2+.5);for(n=r+1,o=2;o<l;o++)this._mesh._indices[0].push(r),this._mesh._indices[0].push(n),n=r+o,this._mesh._indices[0].push(n)}if(this._vf.bottom&&I>0){for(r=this._mesh._positions[0].length/3,o=l-1;o>=0;o--)s=6*o,t=this._mesh._positions[0][s],A=this._mesh._positions[0][s+1],i=this._mesh._positions[0][s+2],this._mesh._positions[0].push(t,A,i),this._mesh._texCoords[0].push(t/2+.5,i/2+.5);for(n=r+1,o=2;o<l;o++)this._mesh._indices[0].push(n),this._mesh._indices[0].push(r),n=r+o,this._mesh._indices[0].push(n)}this._mesh.calcNormals(Math.PI,this._vf.ccw);var u=new x3dom.fields.SFVec3f(this._mesh._normals[0][0],this._mesh._normals[0][1],this._mesh._normals[0][2]),C=new x3dom.fields.SFVec3f(this._mesh._normals[0][3],this._mesh._normals[0][4],this._mesh._normals[0][5]);s=6*l;var _=new x3dom.fields.SFVec3f(this._mesh._normals[0][s],this._mesh._normals[0][s+1],this._mesh._normals[0][s+2]),m=new x3dom.fields.SFVec3f(this._mesh._normals[0][s+3],this._mesh._normals[0][s+4],this._mesh._normals[0][s+5]),p=u.add(_).normalize(),E=C.add(m).normalize();this._mesh._normals[0][0]=p.x,this._mesh._normals[0][1]=p.y,this._mesh._normals[0][2]=p.z,this._mesh._normals[0][3]=E.x,this._mesh._normals[0][4]=E.y,this._mesh._normals[0][5]=E.z,this._mesh._normals[0][s]=p.x,this._mesh._normals[0][s+1]=p.y,this._mesh._normals[0][s+2]=p.z,this._mesh._normals[0][s+3]=E.x,this._mesh._normals[0][s+4]=E.y,this._mesh._normals[0][s+5]=E.z,this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){"xtshear"!=e&&"ytshear"!=e&&"xbshear"!=e&&"ybshear"!=e&&"radius"!=e&&"height"!=e&&"bottom"!=e&&"top"!=e&&"subdivision"!=e||(this.rebuildGeometry(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("Nozzle","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.Nozzle.superClass.call(this,e),this.addField_SFFloat(e,"nozzleHeight",.1),this.addField_SFFloat(e,"nozzleRadius",.6),this.addField_SFFloat(e,"height",1),this.addField_SFFloat(e,"outerRadius",.5),this.addField_SFFloat(e,"innerRadius",.4),this.addField_SFFloat(e,"subdivision",32),this.rebuildGeometry()}),{rebuildGeometry:function(){this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._indices[0]=[];var e=2*Math.PI,t=this._vf.subdivision,A=this._vf.height,i=A/2;if(this._vf.innerRadius>this._vf.outerRadius){var o=this._vf.innerRadius;this._vf.innerRadius=this._vf.outerRadius,this._vf.outerRadius=o}var s=this._vf.innerRadius,n=this._vf.outerRadius;this._vf.nozzleRadius<n&&(this._vf.nozzleRadius=n);var r=this._vf.nozzleRadius;this._vf.nozzleHeight>A&&(this._vf.nozzleHeight=A);var a,d,h,g,l,I,c,f,u=this._vf.nozzleHeight;for(d=e/t,I=0,l=0;I<=t;I++)a=I*d,h=n*(c=Math.sin(a)),g=n*(f=-Math.cos(a)),this._mesh._positions[0].push(h,-i,g),this._mesh._normals[0].push(c,0,f),this._mesh._positions[0].push(h,A-u-i,g),this._mesh._normals[0].push(c,0,f),I>0&&(this._mesh._indices[0].push(l),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+3),l+=2);for(I=0,l+=2;I<=t;I++)a=I*d,h=s*(c=Math.sin(a)),g=s*(f=-Math.cos(a)),this._mesh._positions[0].push(h,-i,g),this._mesh._normals[0].push(-c,0,-f),this._mesh._positions[0].push(h,A-u-i,g),this._mesh._normals[0].push(-c,0,-f),I>0&&(this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l),this._mesh._indices[0].push(l+3),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+2),l+=2);for(I=0,l+=2;I<=t;I++)a=I*d,h=n*(c=Math.sin(a)),g=n*(f=-Math.cos(a)),this._mesh._positions[0].push(h,-i,g),this._mesh._normals[0].push(0,-1,0),h=s*c,g=s*f,this._mesh._positions[0].push(h,-i,g),this._mesh._normals[0].push(0,-1,0),I>0&&(this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l),this._mesh._indices[0].push(l+3),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+2),l+=2);for(I=0,l+=2;I<=t;I++)a=I*d,h=r*(c=Math.sin(a)),g=r*(f=-Math.cos(a)),this._mesh._positions[0].push(h,A-u-i,g),this._mesh._normals[0].push(c,0,f),this._mesh._positions[0].push(h,i,g),this._mesh._normals[0].push(c,0,f),I>0&&(this._mesh._indices[0].push(l),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+3),l+=2);for(I=0,l+=2;I<=t;I++)a=I*d,h=s*(c=Math.sin(a)),g=s*(f=-Math.cos(a)),this._mesh._positions[0].push(h,A-u-i,g),this._mesh._normals[0].push(-c,0,-f),this._mesh._positions[0].push(h,i,g),this._mesh._normals[0].push(-c,0,-f),I>0&&(this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l),this._mesh._indices[0].push(l+3),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+2),l+=2);for(I=0,l+=2;I<=t;I++)a=I*d,h=r*(c=Math.sin(a)),g=r*(f=-Math.cos(a)),this._mesh._positions[0].push(h,A-u-i,g),this._mesh._normals[0].push(0,-1,0),h=n*c,g=n*f,this._mesh._positions[0].push(h,A-u-i,g),this._mesh._normals[0].push(0,-1,0),I>0&&(this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l),this._mesh._indices[0].push(l+3),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+2),l+=2);for(I=0,l+=2;I<=t;I++)a=I*d,h=r*(c=Math.sin(a)),g=r*(f=-Math.cos(a)),this._mesh._positions[0].push(h,i,g),this._mesh._normals[0].push(0,1,0),h=s*c,g=s*f,this._mesh._positions[0].push(h,i,g),this._mesh._normals[0].push(0,1,0),I>0&&(this._mesh._indices[0].push(l),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+2),this._mesh._indices[0].push(l+1),this._mesh._indices[0].push(l+3),l+=2);this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){"nozzleHeight"!=e&&"nozzleRadius"!=e&&"height"!=e&&"outerRadius"!=e&&"innerRadius"!=e&&"subdivision"!=e||(this.rebuildGeometry(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("SolidOfRevolution","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.SolidOfRevolution.superClass.call(this,e),this.addField_SFFloat(e,"creaseAngle",0),this.addField_MFVec2f(e,"crossSection",[]),this.addField_SFFloat(e,"angle",2*Math.PI),this.addField_SFBool(e,"caps",!0),this.addField_SFFloat(e,"subdivision",32),this._origCCW=this._vf.ccw,this.rebuildGeometry()}),{rebuildGeometry:function(){this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._indices[0]=[];var e=2*Math.PI;this._vf.angle<-e?this._vf.angle=-e:this._vf.angle>e&&(this._vf.angle=e);var t,A,i,o,s=this._vf.crossSection,n=this._vf.angle,r=this._vf.subdivision,a=s.length;if(a<1)x3dom.debug.logWarning("SolidOfRevolution requires crossSection curve.");else{var d,h=a>2&&s[0].equals(s[a-1],x3dom.fields.Eps),g=e-Math.abs(n)<=x3dom.fields.Eps,l=n/r,I=[],c=[];this._vf.ccw=n<0?this._origCCW:!this._origCCW,h||(Math.abs(s[a-1].y)>x3dom.fields.Eps&&s.push(new x3dom.fields.SFVec2f(s[a-1].x,0)),Math.abs(s[0].y)>x3dom.fields.Eps&&s.unshift(new x3dom.fields.SFVec2f(s[0].x,0)),a=s.length);var f=null,u=null,C=null,_=[];for(A=0;A<a;A++)f&&(u&&(C=u),u=f),f=new x3dom.fields.SFVec3f(s[A].x,0,s[A].y),A>=2&&(d=(d=f.subtract(u).normalize()).dot(u.subtract(C).normalize()),(d=Math.abs(Math.cos(d)))>this._vf.creaseAngle&&(c.push(x3dom.fields.SFVec3f.copy(u)),_.push(!0))),c.push(f),_.push(!1);for(a=c.length,t=0,d=0;t<=r;t++,d+=l){var m=x3dom.fields.SFMatrix4f.rotationX(d);for(A=0;A<a;A++)f=m.multMatrixPnt(c[A]),I.push(f),this._mesh._positions[0].push(f.x,f.y,f.z),t>0&&A>0&&(this._mesh._indices[0].push((t-1)*a+(A-1),(t-1)*a+A,t*a+A),this._mesh._indices[0].push(t*a+A,t*a+(A-1),(t-1)*a+(A-1)))}if(!g&&1==this._vf.caps){var p=new x3dom.DoublyLinkedList;for(o=this._mesh._positions[0].length/3,A=0,t=0;A<a;A++)_[A]||(p.appendNode(new x3dom.DoublyLinkedList.ListNode(I[A],t++)),f=I[A],this._mesh._positions[0].push(f.x,f.y,f.z));var E=x3dom.EarClipping.getIndexes(p);for(A=E.length-1;A>=0;A--)this._mesh._indices[0].push(o+E[A]);for(o=this._mesh._positions[0].length/3,A=0;A<a;A++)_[A]||(f=I[a*r+A],this._mesh._positions[0].push(f.x,f.y,f.z));for(A=0;A<E.length;A++)this._mesh._indices[0].push(o+E[A])}if(this._mesh.calcNormals(Math.PI,this._vf.ccw),g)for(o=3*a*r,A=0;A<a;A++)i=3*A,this._mesh._normals[0][o+i]=this._mesh._normals[0][i],this._mesh._normals[0][o+i+1]=this._mesh._normals[0][i+1],this._mesh._normals[0][o+i+2]=this._mesh._normals[0][i+2];this._mesh.calcTexCoords(""),this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3}},fieldChanged:function(e){"crossSection"!=e&&"angle"!=e&&"caps"!=e&&"subdivision"!=e&&"creaseAngle"!=e||(this.rebuildGeometry(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("SphereSegment","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DSpatialGeometryNode,(function(e){x3dom.nodeTypes.SphereSegment.superClass.call(this,e),this.addField_SFFloat(e,"radius",1),this.addField_MFFloat(e,"longitude",[]),this.addField_MFFloat(e,"latitude",[]),this.addField_SFVec2f(e,"stepSize",1,1);var t,A,i,o,s,n,r,a,d,h,g,l,I,c,f=this._vf.radius,u=this._vf.longitude,C=this._vf.latitude,_=this._vf.ccw?1:-1,m=u.length,p=C.length,E=m;for(i=0;i<=p;i++)for(s=(C[i]+90)*Math.PI/180,n=Math.sin(s),r=Math.cos(s),o=0;o<=E;o++)a=u[o]*Math.PI/180,d=Math.sin(a),h=-Math.cos(a)*n,g=-r,l=-d*n,I=o/(E-1),c=i/(p-1),this._mesh._positions[0].push(f*h,f*g,f*l),this._mesh._normals[0].push(_*h,_*g,_*l),this._mesh._texCoords[0].push(I,c);for(i=0;i<p;i++)for(o=0;o<E;o++)A=(t=i*(E+1)+o)+E+1,this._mesh._indices[0].push(t),this._mesh._indices[0].push(A),this._mesh._indices[0].push(t+1),this._mesh._indices[0].push(A),this._mesh._indices[0].push(A+1),this._mesh._indices[0].push(t+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3}))),x3dom.registerNodeType("ElevationGrid","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.ElevationGrid.superClass.call(this,e),this.addField_SFBool(e,"colorPerVertex",!0),this.addField_SFBool(e,"normalPerVertex",!0),this.addField_SFFloat(e,"creaseAngle",0),this.addField_MFNode("attrib",x3dom.nodeTypes.X3DVertexAttributeNode),this.addField_SFNode("normal",x3dom.nodeTypes.Normal),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this.addField_SFNode("texCoord",x3dom.nodeTypes.X3DTextureCoordinateNode),this.addField_MFFloat(e,"height",[]),this.addField_SFInt32(e,"xDimension",0),this.addField_SFFloat(e,"xSpacing",1),this.addField_SFInt32(e,"zDimension",0),this.addField_SFFloat(e,"zSpacing",1)}),{nodeChanged:function(){this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];var e=0,t=0,A=this._vf.xDimension-1,i=this._vf.zDimension-1,o=this._vf.height;x3dom.debug.assert(o.length>=this._vf.xDimension*this._vf.zDimension,"Too few height values for given x/zDimension!");var s=null,n=null,r=null;this._cf.normal.node&&(s=this._cf.normal.node._vf.vector);var a,d=2,h=this._cf.texCoord.node;x3dom.isa(h,x3dom.nodeTypes.MultiTextureCoordinate)&&h._cf.texCoord.nodes.length&&(h=h._cf.texCoord.nodes[0]),h&&(h._vf.point?(n=h._vf.point,x3dom.isa(h,x3dom.nodeTypes.TextureCoordinate3D)&&(d=3)):h._vf.mode&&(a=h._vf.mode));var g=3;this._cf.color.node&&(r=this._cf.color.node._vf.color,x3dom.isa(this._cf.color.node,x3dom.nodeTypes.ColorRGBA)&&(g=4));var l=0;for(t=0;t<=i;t++)for(e=0;e<=A;e++)this._mesh._positions[0].push(e*this._vf.xSpacing),this._mesh._positions[0].push(o[l]),this._mesh._positions[0].push(t*this._vf.zSpacing),s&&this._vf.normalPerVertex&&(this._mesh._normals[0].push(s[l].x),this._mesh._normals[0].push(s[l].y),this._mesh._normals[0].push(s[l].z)),n?(this._mesh._texCoords[0].push(n[l].x),this._mesh._texCoords[0].push(n[l].y),3===d&&this._mesh._texCoords[0].push(n[l].z)):(this._mesh._texCoords[0].push(e/A),this._mesh._texCoords[0].push(t/i)),r&&this._vf.colorPerVertex&&(this._mesh._colors[0].push(r[l].r),this._mesh._colors[0].push(r[l].g),this._mesh._colors[0].push(r[l].b),4===g&&this._mesh._colors[0].push(r[l].a)),l++;for(t=1;t<=i;t++)for(e=0;e<A;e++)this._mesh._indices[0].push((t-1)*(A+1)+e),this._mesh._indices[0].push(t*(A+1)+e),this._mesh._indices[0].push((t-1)*(A+1)+e+1),this._mesh._indices[0].push(t*(A+1)+e),this._mesh._indices[0].push(t*(A+1)+e+1),this._mesh._indices[0].push((t-1)*(A+1)+e+1);s||this._mesh.calcNormals(Math.PI,this._vf.ccw),a&&this._mesh.calcTexCoords(a),this.invalidateVolume(),this._mesh._numTexComponents=d,this._mesh._numColComponents=g,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){var t,A,i=null;if(this._cf.normal.node&&(i=this._cf.normal.node._vf.vector),"height"==e){A=this._mesh._positions[0].length/3;var o=this._vf.height;for(t=0;t<A;t++)this._mesh._positions[0][3*t+1]=o[t];i||(this._mesh._normals[0]=[],this._mesh.calcNormals(Math.PI,this._vf.ccw)),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,i||(e._dirty.normals=!0),e.invalidateVolume()}))}else if("xSpacing"==e||"zSpacing"==e){for(var s=0;s<this._vf.zDimension;s++)for(var n=0;n<this._vf.xDimension;n++){var r=3*(s*this._vf.xDimension+n);this._mesh._positions[0][r]=n*this._vf.xSpacing,this._mesh._positions[0][r+2]=s*this._vf.zSpacing}i||(this._mesh._normals[0]=[],this._mesh.calcNormals(Math.PI,this._vf.ccw)),this.invalidateVolume(),this._parentNodes.forEach((function(e){e._dirty.positions=!0,i||(e._dirty.normals=!0),e.invalidateVolume()}))}else if("xDimension"==e||"zDimension"==e)this.nodeChanged(),this._parentNodes.forEach((function(e){e.setGeoDirty(),e.invalidateVolume()}));else if("color"==e){A=this._mesh._colors[0].length/3;var a=this._cf.color.node._vf.color;for(t=0;t<A;t++)this._mesh._colors[0][3*t]=a[t].r,this._mesh._colors[0][3*t+1]=a[t].g,this._mesh._colors[0][3*t+2]=a[t].b;this._parentNodes.forEach((function(e){e._dirty.colors=!0}))}}})),x3dom.registerNodeType("Extrusion","Geometry3DExt",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.Extrusion.superClass.call(this,e),this.addField_SFBool(e,"beginCap",!0),this.addField_SFBool(e,"endCap",!0),this.addField_SFBool(e,"convex",!0),this.addField_SFFloat(e,"creaseAngle",0),this.addField_MFVec2f(e,"crossSection",[new x3dom.fields.SFVec2f(1,1),new x3dom.fields.SFVec2f(1,-1),new x3dom.fields.SFVec2f(-1,-1),new x3dom.fields.SFVec2f(-1,1),new x3dom.fields.SFVec2f(1,1)]),this.addField_MFRotation(e,"orientation",[new x3dom.fields.Quaternion(0,0,0,1)]),this.addField_MFVec2f(e,"scale",[new x3dom.fields.SFVec2f(1,1)]),this.addField_MFVec3f(e,"spine",[new x3dom.fields.SFVec3f(0,0,0),new x3dom.fields.SFVec3f(0,1,0)]),this.addField_SFFloat(e,"height",0),this.rebuildGeometry()}),{rebuildGeometry:function(){this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._indices[0]=[];var e,t,A,i,o,s,n,r,a=1,d=1,h=this._vf.spine,g=this._vf.scale,l=this._vf.orientation,I=this._vf.crossSection,c=[],f=0;i=h.length,A=I.length,this._vf.height>0&&(h[0]=new x3dom.fields.SFVec3f(0,0,0),h[1]=new x3dom.fields.SFVec3f(0,this._vf.height,0),i=2);var u=new x3dom.fields.SFVec3f(0,0,1);if(i>2)for(e=1;e<i-1;e++){var C=h[e+1].subtract(h[e]).cross(h[e-1].subtract(h[e]));if(C.length()>x3dom.fields.Eps){u=x3dom.fields.SFVec3f.copy(C.normalize());break}}var _=0,m=[0];for(e=1;e<i;e++){_+=h[e].subtract(h[e-1]).length(),m[e]=_}var p=0,E=[0],B=0,Q=0,x=0,v=0;for(t=1;t<A;t++){p+=I[t].subtract(I[t-1]).length(),E[t]=p,1==t&&(B=Q=I[t-1].x,x=v=I[t-1].y),B<I[t].x&&(B=I[t].x),Q>I[t].x&&(Q=I[t].x),x<I[t].y&&(x=I[t].y),v>I[t].y&&(v=I[t].y)}if(Math.abs(B-Q)<Math.abs(x-v)){var y=B,F=Q;B=x,Q=v,x=y,v=F}var D=Math.abs(B-Q),S=Math.abs(x-v),w=i>2&&h[0].equals(h[h.length-1],x3dom.fields.Eps);for(e=0;e<i;e++){for((o=g.length)>0&&(e<o?(a=g[e].x,d=g[e].y):(a=g[o-1].x,d=g[o-1].y)),t=0;t<A;t++){var N=new x3dom.fields.SFVec3f(I[t].x*a+h[e].x,h[e].y,I[t].y*d+h[e].z);if(i>2){0==e?(w?(n=h[1].subtract(h[i-2]),r=h[1].subtract(h[0]).cross(h[i-2].subtract(h[0]))):(n=h[1].subtract(h[0]),r=h[2].subtract(h[1]).cross(h[0].subtract(h[1]))),r.length()>x3dom.fields.Eps&&(u=x3dom.fields.SFVec3f.copy(r))):e==i-1?w?(n=h[1].subtract(h[i-2]),r=h[1].subtract(h[0]).cross(h[i-2].subtract(h[0]))):(n=h[i-1].subtract(h[i-2]),r=x3dom.fields.SFVec3f.copy(u)):r=(n=h[e+1].subtract(h[e-1])).cross(h[e-1].subtract(h[e])),r.dot(u)<0&&(r=r.negate()),n=n.normalize(),(r=r.normalize()).length()<=x3dom.fields.Eps&&(r=x3dom.fields.SFVec3f.copy(u)),0!=e&&(u=x3dom.fields.SFVec3f.copy(r)),s=n.cross(r).normalize();var T=x3dom.fields.SFMatrix4f.identity();T.setValue(s,n,r);var b=e<l.length?l[e].toMatrix():l.length>0?l[l.length-1].toMatrix():x3dom.fields.SFMatrix4f.identity();N=N.subtract(h[e]),N=(N=T.multMatrixPnt(b.multMatrixPnt(N))).add(h[e])}if(N.crossSection=I[t],c.push(N),this._vf.creaseAngle<=x3dom.fields.Eps){if(e>0&&t>0){var M=(e-1)*A+(t-1);this._mesh._positions[0].push(c[M].x,c[M].y,c[M].z),this._mesh._texCoords[0].push(E[t-1]/p,m[e-1]/_),M=(e-1)*A+t,this._mesh._positions[0].push(c[M].x,c[M].y,c[M].z),this._mesh._texCoords[0].push(E[t]/p,m[e-1]/_),M=e*A+t,this._mesh._positions[0].push(c[M].x,c[M].y,c[M].z),this._mesh._texCoords[0].push(E[t]/p,m[e]/_),this._mesh._indices[0].push(f++,f++,f++),this._mesh._positions[0].push(c[M].x,c[M].y,c[M].z),this._mesh._texCoords[0].push(E[t]/p,m[e]/_),M=e*A+(t-1),this._mesh._positions[0].push(c[M].x,c[M].y,c[M].z),this._mesh._texCoords[0].push(E[t-1]/p,m[e]/_),M=(e-1)*A+(t-1),this._mesh._positions[0].push(c[M].x,c[M].y,c[M].z),this._mesh._texCoords[0].push(E[t-1]/p,m[e-1]/_),this._mesh._indices[0].push(f++,f++,f++)}}else this._mesh._positions[0].push(N.x,N.y,N.z),this._mesh._texCoords[0].push(E[t]/p,m[e]/_),e>0&&t>0&&(this._mesh._indices[0].push((e-1)*A+(t-1),(e-1)*A+t,e*A+t),this._mesh._indices[0].push(e*A+t,e*A+(t-1),(e-1)*A+(t-1)))}if(e==i-1){var R,G,U,L,k;if(this._vf.beginCap){for(L=new x3dom.DoublyLinkedList,G=this._mesh._positions[0].length/3,t=0;t<A;t++)L.appendNode(new x3dom.DoublyLinkedList.ListNode(c[t],t)),this._vf.creaseAngle>x3dom.fields.Eps&&(R=c[t],this._mesh._positions[0].push(R.x,R.y,R.z),this._mesh._texCoords[0].push((R.crossSection.x-Q)/D,(R.crossSection.y-v)/S));for(0==this._vf.ccw&&L.invert(),t=(k=x3dom.EarClipping.getIndexes(L)).length-1;t>=0;t--)this._vf.creaseAngle>x3dom.fields.Eps?this._mesh._indices[0].push(G+k[t]):(R=c[k[t]],this._mesh._positions[0].push(R.x,R.y,R.z),this._mesh._texCoords[0].push((R.crossSection.x-Q)/D,(R.crossSection.y-v)/S),this._mesh._indices[0].push(f++))}if(this._vf.endCap){for(L=new x3dom.DoublyLinkedList,U=(i-1)*A,G=this._mesh._positions[0].length/3,t=0;t<A;t++)L.appendNode(new x3dom.DoublyLinkedList.ListNode(c[U+t],U+t)),this._vf.creaseAngle>x3dom.fields.Eps&&(R=c[U+t],this._mesh._positions[0].push(R.x,R.y,R.z),this._mesh._texCoords[0].push((R.crossSection.x-Q)/D,(R.crossSection.y-v)/S));for(0==this._vf.ccw&&L.invert(),k=x3dom.EarClipping.getIndexes(L),t=0;t<k.length;t++)this._vf.creaseAngle>x3dom.fields.Eps?this._mesh._indices[0].push(G+(k[t]-U)):(R=c[k[t]],this._mesh._positions[0].push(R.x,R.y,R.z),this._mesh._texCoords[0].push((R.crossSection.x-Q)/D,(R.crossSection.y-v)/S),this._mesh._indices[0].push(f++))}}}this._mesh.calcNormals(this._vf.creaseAngle,this._vf.ccw),this.invalidateVolume(),this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){"beginCap"!=e&&"endCap"!=e&&"crossSection"!=e&&"orientation"!=e&&"scale"!=e&&"spine"!=e&&"height"!=e&&"creaseAngle"!=e||(this.rebuildGeometry(),this._parentNodes.forEach((function(e){e.setAllDirty(),e.invalidateVolume()})))}})),x3dom.registerNodeType("HAnimDisplacer","H-Anim",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,(function(e){x3dom.nodeTypes.HAnimDisplacer.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_SFFloat(e,"weight",0),this.addField_MFInt32(e,"coordIndex",[]),this.addField_MFVec3f(e,"displacements",[]),x3dom.debug.logWarning("HAnimDisplacer in Segments NYI.")}))),x3dom.registerNodeType("HAnimJoint","H-Anim",defineClass(x3dom.nodeTypes.Transform,(function(e){x3dom.nodeTypes.HAnimJoint.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_MFNode("displacers",x3dom.nodeTypes.HAnimDisplacer),this.addField_SFRotation(e,"limitOrientation","0 0 1 0"),this.addField_MFFloat(e,"llimit",[]),this.addField_MFFloat(e,"ulimit",[]),this.addField_MFInt32(e,"skinCoordIndex",[]),this.addField_MFFloat(e,"skinCoordWeight",[]),this.addField_MFFloat(e,"stiffness",[0,0,0])}),{nodeChanged:function(){this._humanoid=function e(t){var A=t.parentNode._x3domNode;if(x3dom.isa(A,x3dom.nodeTypes.Scene))return!1;if(x3dom.isa(A,x3dom.nodeTypes.HAnimHumanoid))return A;return e(A._xmlNode)}(this._xmlNode)},collectDrawableObjects:function(e,t,A,i,o,s){A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),this.collectBbox(e,t,A,i,o,s),o=t.cull(e,this.graphState(),A,o);var n=this._humanoid._cf.skinCoord.node;if(!(o<0)||n){var r,a;A?(this._graph.globalMatrix||(this._graph.globalMatrix=this.transformMatrix(e)),a=this._graph.globalMatrix):a=this.transformMatrix(e);var d,h,g,l,I,c=this._childNodes.length;if(x3dom.nodeTypes.ClipPlane.count>0){for(var f=[],u=0;u<c;u++)(r=this._childNodes[u])&&x3dom.isa(r,x3dom.nodeTypes.ClipPlane)&&r._vf.on&&r._vf.enabled&&f.push({plane:r,trafo:a});s=f.concat(s)}n&&(g=this._humanoid,l=g.getCurrentTransform().inverse().mult(a),0!==(I=this._cf.displacers.nodes).length&&I.forEach((function(e){var t=e._vf.weight,A=e._vf.displacements,i=A.length;0!==i&&e._vf.coordIndex.forEach((function(e,o){n._vf.point[e]=n._vf.point[e].addScaled(l.multMatrixVec(A[o%i]),t)}))})),0!==(d=this._vf.skinCoordIndex).length&&(h=this._vf.skinCoordWeight,d.forEach((function(e,t){var A=g._restCoords[e];n._vf.point[e]=n._vf.point[e].add(l.multMatrixPnt(A).subtract(A).multiply(h[Math.min(t,h.length-1)]))}))));var C=this._humanoid._cf.skinNormal.node;C&&0!==(d=this._vf.skinCoordIndex).length&&(h=this._vf.skinCoordWeight,g=this._humanoid,l=g.getCurrentTransform().inverse().mult(a).inverse().transpose(),d.forEach((function(e,t){var A=g._restNormals[e];C._vf.vector[e]=C._vf.vector[e].add(l.multMatrixVec(A).subtract(A).multiply(h[Math.min(t,h.length-1)]))})));for(var _=0;_<c;_++)(r=this._childNodes[_])&&r.collectDrawableObjects(a,t,A,i,o,s)}}})),x3dom.registerNodeType("HAnimSegment","H-Anim",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.HAnimSegment.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_SFVec3f(e,"centerOfMass",0,0,0),this.addField_SFFloat(e,"mass",0),this.addField_MFFloat(e,"momentsOfInertia",[0,0,0,0,0,0,0,0,0]),this.addField_SFNode("coord",x3dom.nodeTypes.X3DCoordinateNode),this.addField_MFNode("displacers",x3dom.nodeTypes.HAnimDisplacer)}),{})),x3dom.registerNodeType("HAnimSite","H-Anim",defineClass(x3dom.nodeTypes.Transform,(function(e){x3dom.nodeTypes.HAnimSite.superClass.call(this,e),this.addField_SFString(e,"name","")}))),x3dom.registerNodeType("HAnimHumanoid","H-Anim",defineClass(x3dom.nodeTypes.Transform,(function(e){x3dom.nodeTypes.HAnimHumanoid.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_SFString(e,"version",""),this.addField_MFString(e,"info",[]),this.addField_MFNode("joints",x3dom.nodeTypes.HAnimJoint),this.addField_MFNode("segments",x3dom.nodeTypes.HAnimSegment),this.addField_MFNode("sites",x3dom.nodeTypes.HAnimSite),this.addField_MFNode("skeleton",x3dom.nodeTypes.HAnimJoint),this.addField_MFNode("skin",x3dom.nodeTypes.X3DChildNode),this.addField_SFNode("skinCoord",x3dom.nodeTypes.X3DCoordinateNode),this.addField_SFNode("skinNormal",x3dom.nodeTypes.X3DNormalNode),this.addField_MFNode("viewpoints",x3dom.nodeTypes.HAnimSite),this.addField_SFString(e,"skeletalConfiguration","BASIC"),this.addField_MFVec3f(e,"jointBindingPositions",[0,0,0]),this.addField_MFRotation(e,"jointBindingRotations",[0,0,1,0]),this.addField_MFVec3f(e,"jointBindingScales",[1,1,1]),this.addField_MFVec3f(e,"skinBindingCoords",[]),this.addField_MFVec3f(e,"skinBindingNormals",[])}),{collectDrawableObjects:function(e,t,A,i,o,s){if(A&&this._parentNodes.length>1&&(A=!1),A&&(i=i||this.cacheInvalid())&&this.invalidateCache(),this.collectBbox(e,t,A,i,o,s),!((o=t.cull(e,this.graphState(),A,o))<0)){var n,r;A?(this._graph.globalMatrix||(this._graph.globalMatrix=this.transformMatrix(e)),r=this._graph.globalMatrix):r=this.transformMatrix(e);var a=this._childNodes.length;if(x3dom.nodeTypes.ClipPlane.count>0){for(var d=[],h=0;h<a;h++)(n=this._childNodes[h])&&x3dom.isa(n,x3dom.nodeTypes.ClipPlane)&&n._vf.on&&n._vf.enabled&&d.push({plane:n,trafo:r});s=d.concat(s)}this._cf.skinCoord.node&&this._cf.skinCoord.node._vf.point.setValues(this._restCoords),this._cf.skinNormal.node&&this._cf.skinNormal.node._vf.vector.setValues(this._restNormals),this._cf.skeleton.nodes.forEach((function(e){e.collectDrawableObjects(r,t,A,i,o,s)})),this._cf.skin.nodes.forEach((function(e){e.collectDrawableObjects(r,t,A,i,o,s)})),this._cf.skinCoord.node&&this._cf.skinCoord.node._parentNodes.forEach((function(e){e.fieldChanged("coord")}))}},nodeChanged:function(){this._cf.skinCoord.node&&(this._restCoords=this._cf.skinCoord.node._vf.point.copy()),this._cf.skinNormal.node&&(this._restNormals=this._cf.skinNormal.node._vf.vector.copy())}})),x3dom.registerNodeType("X3DParametricGeometryNode","NURBS",defineClass(x3dom.nodeTypes.X3DGeometryNode,(function(e){x3dom.nodeTypes.X3DParametricGeometryNode.superClass.call(this,e)}),{})),x3dom.registerNodeType("X3DNurbsSurfaceGeometryNode","NURBS",defineClass(x3dom.nodeTypes.X3DParametricGeometryNode,(function(e){x3dom.nodeTypes.X3DParametricGeometryNode.superClass.call(this,e),this.addField_SFInt32(e,"uDimension",0),this.addField_SFInt32(e,"vDimension",0),this.addField_SFInt32(e,"uOrder",3),this.addField_SFInt32(e,"vOrder",3),this.addField_SFFloat(e,"uTessellation",0),this.addField_SFFloat(e,"vTessellation",0),this.addField_MFDouble(e,"uKnot",[]),this.addField_MFDouble(e,"vKnot",[]),this.addField_MFDouble(e,"weight",[]),this.addField_SFNode("controlPoint",x3dom.nodeTypes.X3DCoordinateNode),this.addField_SFBool(e,"uClosed",!1),this.addField_SFBool(e,"vClosed",!1),this.addField_SFNode("texCoord",x3dom.nodeTypes.X3DTextureCoordinateNode),this.addField_SFBool(e,"solid",!1),this.addField_SFBool(e,"normalPerVertex",!0),this._needReRender=!0,this.basisFunsCache=new Map,this.uv=[],this.lastTime=-1}),{nodeChanged:function(){if(this._needReRender=!0,this._vf.ccw=!1,this._vf.solid=!1,this._vf.useGeoCache=!1,!this._hasCoarseMesh){var e=this.createCoarseITS(this);this._mesh=e._mesh,this._hasCoarseMesh=!0}this._vf.uKnot.length!==this._vf.uDimension+this._vf.uOrder&&(this._vf.uKnot=this.createDefaultKnots(this._vf.uDimension,this._vf.uOrder)),this._vf.vKnot.length!==this._vf.vDimension+this._vf.vOrder&&(this._vf.vKnot=this.createDefaultKnots(this._vf.vDimension,this._vf.vOrder));var t=[];if(this._cf.trimmingContour&&this._cf.trimmingContour.nodes.length)for(var A=this._cf.trimmingContour.nodes.length,i=0;i<A;i++){var o=this._cf.trimmingContour.nodes[i];if(o._cf.children){t[i]=[];for(var s=o._cf.children.nodes,n=0;n<s.length;n++){var r=s[n];if(r._vf.order||(r._vf.order=2),!r._vf.knot){var a=[];a.push(0),a.push(0);for(var d=2;d<r._vf.controlPoint.length;d++)a.push(d-1);a.push(a[a.length-1]+1),a.push(a[a.length-1]),r._vf.knot=a}t[i].push([r._vf.controlPoint.length-1,r._vf.order-1,r._vf.knot,r._vf.controlPoint,r._vf.weight])}}}var h=this._cf.controlPoint.node,g=[this._vf.uDimension-1,this._vf.vDimension-1,this._vf.uOrder-1,this._vf.vOrder-1,this._vf.uKnot,this._vf.vKnot,h.getPoints(),this._vf.weight,this._vf.uTessellation,this._vf.vTessellation,t,this.basisFunsCache,this.uv,performance.now()];this.workerTask&&(this.workerTask.discard=!0),this.workerTask=new x3dom.WorkerTask(x3dom.tessWorkerScript,this,(function(e){if(e.data.length>=3&&e.data[5]>this.caller.lastTime){if(this.caller.uv.length){for(var t=e.data[1],A=new x3dom.fields.MFVec3f,i=0;i<t.length;i++)A.push(new x3dom.fields.SFVec3f(t[i][0],t[i][1],t[i][2]));this.caller._mesh._positions[0]=A.toGL()}else{var o=this.caller.createITS(e.data,this.caller);if(this.caller.workerTask=null,this.caller._mesh=o._mesh,this.caller._nameSpace){var s=x3dom.tessWorkerPool.taskQueue.length;this.caller._nameSpace.doc._x3dElem.runtime.canvas.progressText=0==s?"":"Tesselation tasks: "+s}}this.caller._cleanupGLObjects&&this.caller._cleanupGLObjects(!0),this.caller._parentNodes.forEach((function(e){e.setAllDirty()})),this.caller.basisFunsCache=e.data[3],this.caller.uv=e.data[4],this.caller.lastTime=e.data[5]}}),g),x3dom.tessWorkerPool.addWorkerTask(this.workerTask)},fieldChanged:function(e){if("order"==e||"knot"==e||e.includes("Tessellation"))return this.basisFunsCache=new Map,this.uv=[],void this.nodeChanged();this.uv.length&&this.nodeChanged()},createDefaultKnots:function(e,t){for(var A=Array(e+t).fill(0),i=t;i<e;i++)A[i]=(i-1)/(e-1);for(i=A.length-t;i<A.length;i++)A[i]=1;return A},createCoarseITS:function(e){var t=e._vf.uDimension,A=e._vf.vDimension,i=e._cf.controlPoint.node,o=new x3dom.nodeTypes.IndexedTriangleSet;o._nameSpace=e._nameSpace,o._vf.solid=!1,o._vf.ccw=!1,o._cf.texCoord=e._cf.texCoord;for(var s=[],n=0,r=t,a=0;a<A-1;a++){for(var d=0;d<t-1;d++)s.push(n),s.push(n+1),s.push(r),s.push(r),s.push(n+1),s.push(r+1),n++,r++;n++,r++}return o._vf.index=s,o.addChild(i),o.nodeChanged(),o._xmlNode=e._xmlNode,o},createITS:function(e,t){var A=new x3dom.nodeTypes.IndexedTriangleSet;A._nameSpace=t._nameSpace,A._vf.normalPerVertex=t._vf.normalPerVertex,A._vf.solid=!1,A._vf.ccw=!1,A._vf.index=e[0];var i=new x3dom.nodeTypes.Coordinate;i._nameSpace=t._nameSpace,i._vf.point=new x3dom.fields.MFVec3f;for(var o=0;o<e[1].length;o++)i._vf.point.push(new x3dom.fields.SFVec3f(e[1][o][0],e[1][o][1],e[1][o][2]));if(A.addChild(i),null!==t._cf.texCoord.node)A._cf.texCoord=t._cf.texCoord;else{var s=new x3dom.nodeTypes.TextureCoordinate;s._nameSpace=t._nameSpace,s._vf.point=new x3dom.fields.MFVec2f;for(o=0;o<e[2].length;o++)s._vf.point.push(new x3dom.fields.SFVec2f(e[2][o][0],e[2][o][1]));A.addChild(s)}return A.nodeChanged(),A._xmlNode=t._xmlNode,A}})),x3dom.registerNodeType("NurbsPatchSurface","NURBS",defineClass(x3dom.nodeTypes.X3DNurbsSurfaceGeometryNode,(function(e){x3dom.nodeTypes.NurbsPatchSurface.superClass.call(this,e),this._needReRender=!0}),{nodeChanged:function(){x3dom.nodeTypes.NurbsTrimmedSurface.prototype.nodeChanged.call(this)}})),x3dom.registerNodeType("NurbsCurve","NURBS",defineClass(x3dom.nodeTypes.X3DParametricGeometryNode,(function(e){x3dom.nodeTypes.NurbsCurve.superClass.call(this,e),this.addField_SFInt32(e,"order",3),this.addField_MFDouble(e,"knot",[]),this.addField_SFNode("controlPoint",x3dom.nodeTypes.X3DCoordinateNode),this.addField_MFDouble(e,"weight",[]),this.addField_SFInt32(e,"tessellation",0),this.addField_SFBool(e,"closed",!1),this.points=[],this.uList=[],this.basisFunsCache={},this.ils=new x3dom.nodeTypes.IndexedLineSet,this.ils.addChild(new x3dom.nodeTypes.Coordinate)}),{nodeChanged:function(){if(this._needReRender=!0,this._vf.useGeoCache=!1,!this._hasCoarseMesh){var e=this.createCoarseILS(this);this._mesh=e._mesh,this._hasCoarseMesh=!0}this.generateGeometry()},fieldChanged:function(e){switch(this._parentNodes.forEach((function(e){e._dirty.positions=!0,e.invalidateVolume()})),e){case"tessellation":this.uList=[];break;case"knot":case"order":case"closed":this.uList=[],this.basisFunsCache={}}this.generateGeometry()},generateGeometry:function(){this.points=this._cf.controlPoint.node._vf.point;var e=this.points.length;this._vf.knot.length!==e+this._vf.order&&this.createDefaultKnots(),this._vf.weight.length!=e&&(this._vf.weight=Array(e).fill(1));var t=this.calcTessPoints(this._vf.tessellation,e);0==this.uList.length&&(this.uList=this.listPoints(t,this._vf.knot));var A=this.tessellate();this.createILS(A,this),this._mesh=this.ils._mesh},createDefaultKnots:function(){for(var e=Array(this.points.length+this._vf.order).fill(0),t=this._vf.order;t<this.points.length;t++)e[t]=t-1;for(t=e.length-this._vf.order;t<e.length;t++)e[t]=this.points.length-1;this._vf.knot=e},calcTessPoints:function(e,t){return e>0?e+1:0==e?2*t+1:-e*t+1},listPoints:function(e,t){var A=t[t.length-1]-t[0];A/=e-1;for(var i=[],o=0;o<e;o++)i.push(t[0]+o*A);return i},tessellate:function(){var e={dimension:this.points.length-1,u:this.uList,degree:this._vf.order-1,knots:this._vf.knot,points:this.points,weights:this._vf.weight,closed:this._vf.closed};return e.u.map((function(t){return this.curvePoint3DH(e.dimension,e.degree,e.knots,e.points,e.weights,t)}),this)},curvePoint3DH:function(e,t,A,i,o,s){var n,r,a,d,h,g=[0,0,0,0];for(n=this.findSpan(e,t,s,A),h=this.basisFuns(n,s,t,A),r=n-t,a=0;a<=t;a++)d=r+a,g[0]+=h[a]*i[d].x,g[1]+=h[a]*i[d].y,g[2]+=h[a]*i[d].z,g[3]+=h[a]*o[d];return new x3dom.fields.SFVec3f(g[0]/g[3],g[1]/g[3],g[2]/g[3])},findSpan:function(e,t,A,i){var o,s,n;if(A>=i[e])return e;if(A<=i[t])return t;for(o=0,n=e+1,s=Math.floor((o+n)/2);A<i[s]||A>=i[s+1];)A<i[s]?n=s:o=s,s=Math.floor((o+n)/2);return s},basisFuns:function(e,t,A,i){var o=Math.floor(1e11*t);if(this.basisFunsCache[o])return this.basisFunsCache[o];var s,n,r,a,d=[],h=[],g=[];for(d[0]=1,r=0;r<=A;r++)h[r]=0,g[r]=0;for(r=1;r<=A;r++){for(h[r]=t-i[e+1-r],g[r]=i[e+r]-t,s=0,a=0;a<r;a++)n=d[a]/(g[a+1]+h[r-a]),d[a]=s+g[a+1]*n,s=h[r-a]*n;d[r]=s}return this.basisFunsCache[o]=d,d},createCoarseILS:function(e){var t=e._cf.controlPoint.node,A=new x3dom.nodeTypes.IndexedLineSet;A._nameSpace=e._nameSpace;for(var i=[],o=0;o<t._vf.point.length;o++)i.push(o);return i.push(-1),A._vf.coordIndex=i,A.addChild(t),A.nodeChanged(),A._xmlNode=e._xmlNode,A},createILS:function(e,t){this.ils._nameSpace=t._nameSpace,this.ils._vf.coordIndex=[];var A=this.ils._cf.coord.node;A._nameSpace=t._nameSpace,A._vf.point=new x3dom.fields.MFVec3f;for(var i=0;i<e.length;i++)A._vf.point.push(e[i]),this.ils._vf.coordIndex.push(i);return this.ils.nodeChanged(),this.ils._xmlNode=t._xmlNode,this.ils}})),x3dom.registerNodeType("NurbsPositionInterpolator","NURBS",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.NurbsPositionInterpolator.superClass.call(this,e),this.addField_SFInt32(e,"order",3),this.addField_MFDouble(e,"knot",[]),this.addField_SFNode("controlPoint",x3dom.nodeTypes.X3DCoordinateNode),this.addField_MFDouble(e,"weight",[]),this.addField_SFFloat(e,"set_fraction",0),this.points=[]}),{fieldChanged:function(e){if("set_fraction"===e){var t=this.getValue(this._vf.set_fraction);this.postMessage("value_changed",t)}},getValue:function(e){this.points=this._cf.controlPoint.node._vf.point;var t=this.points.length;return this._vf.knot.length!==t+this._vf.order&&this.createDefaultKnots(),this._vf.weight.length!=t&&(this._vf.weight=Array(t).fill(1)),this.curvePoint(e)},createDefaultKnots:function(){for(var e=this.points.length,t=Array(e+this._vf.order).fill(0),A=this._vf.order;A<e;A++)t[A]=(A-1)/(e-1);for(A=t.length-this._vf.order;A<t.length;A++)t[A]=1;this._vf.knot=t},curvePoint:function(e){var t={dimension:this.points.length-1,degree:this._vf.order-1,knots:this._vf.knot,points:this.points,weights:this._vf.weight};return x3dom.nodeTypes.NurbsCurve.prototype.curvePoint3DH.call(this,t.dimension,t.degree,t.knots,t.points,t.weights,e)},findSpan:function(e,t,A,i){return x3dom.nodeTypes.NurbsCurve.prototype.findSpan(e,t,A,i)},basisFuns:function(e,t,A,i){var o,s,n,r,a=[],d=[],h=[];for(a[0]=1,n=0;n<=A;n++)d[n]=0,h[n]=0;for(n=1;n<=A;n++){for(d[n]=t-i[e+1-n],h[n]=i[e+n]-t,o=0,r=0;r<n;r++)s=a[r]/(h[r+1]+d[n-r]),a[r]=o+h[r+1]*s,o=d[n-r]*s;a[n]=o}return a}})),x3dom.registerNodeType("NurbsOrientationInterpolator","NURBS",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.NurbsOrientationInterpolator.superClass.call(this,e),this.addField_SFInt32(e,"order",3),this.addField_MFDouble(e,"knot",[]),this.addField_SFNode("controlPoint",x3dom.nodeTypes.X3DCoordinateNode),this.addField_MFDouble(e,"weight",[]),this.addField_SFFloat(e,"set_fraction",0),this.points=[],this._fractionalShift=.01,this._downZ=new x3dom.fields.SFVec3f(0,0,-1)}),{fieldChanged:function(e){if("set_fraction"===e){var t=this.getValue(this._vf.set_fraction);this.postMessage("value_changed",t)}},getValue:function(e){this.points=this._cf.controlPoint.node._vf.point;var t=this.points.length,A=this._vf.knot;A.length!==t+this._vf.order&&x3dom.nodeTypes.NurbsPositionInterpolator.prototype.createDefaultKnots.call(this),this._vf.weight.length!=t&&(this._vf.weight=Array(t).fill(1));var i=(A[A.length-1]-A[0])*this._fractionalShift,o=this.curvePoint(e).subtract(this.curvePoint(e+i));return x3dom.fields.Quaternion.rotateFromTo(this._downZ,o)},curvePoint:function(e){return x3dom.nodeTypes.NurbsPositionInterpolator.prototype.curvePoint.call(this,e)},findSpan:function(e,t,A,i){return x3dom.nodeTypes.NurbsCurve.prototype.findSpan(e,t,A,i)},basisFuns:function(e,t,A,i){return x3dom.nodeTypes.NurbsPositionInterpolator.prototype.basisFuns(e,t,A,i)}})),x3dom.registerNodeType("NurbsSurfaceInterpolator","NURBS",defineClass(x3dom.nodeTypes.X3DChildNode,(function(e){x3dom.nodeTypes.NurbsSurfaceInterpolator.superClass.call(this,e),this.addField_SFInt32(e,"uDimension",0),this.addField_SFInt32(e,"vDimension",0),this.addField_MFDouble(e,"uKnot",[]),this.addField_MFDouble(e,"vKnot",[]),this.addField_SFInt32(e,"uOrder",3),this.addField_SFInt32(e,"vOrder",3),this.addField_SFNode("controlPoint",x3dom.nodeTypes.X3DCoordinateNode),this.addField_MFDouble(e,"weight",[]),this.addField_SFVec2f(e,"set_fraction",0,0),this.points=[],this._fractionalShift=.01}),{nodeChanged:function(){this.points=this._cf.controlPoint.node._vf.point,this.pointsLength=this.points.length},fieldChanged:function(e){if("set_fraction"===e){var t=this.getValue(this._vf.set_fraction);this.postMessage("position_changed",t.position),this.postMessage("normal_changed",t.normal)}},getValue:function(e){var t=e.x,A=e.y;this.points=this._cf.controlPoint.node._vf.point;var i=this._vf.uKnot,o=this._vf.vKnot;i.length!==this._vf.uDimension+this._vf.uOrder&&(i=this.createDefaultKnots(this._vf.uDimension,this._vf.uOrder)),o.length!==this._vf.vDimension+this._vf.vOrder&&(o=this.createDefaultKnots(this._vf.vDimension,this._vf.vOrder)),this._vf.weight.length!=this.pointsLength&&(this._vf.weight=Array(this.pointsLength).fill(1));var s=(i[i.length-1]-i[0])*this._fractionalShift,n=(o[o.length-1]-o[0])*this._fractionalShift,r=this.surfacePoint(t+s,A).subtract(this.surfacePoint(t,A)),a=this.surfacePoint(t,A+n).subtract(this.surfacePoint(t,A));return{position:this.surfacePoint(t,A),normal:r.cross(a).normalize()}},createDefaultKnots:function(e,t){for(var A=Array(e+t).fill(0),i=t;i<e;i++)A[i]=(i-1)/(e-1);for(i=A.length-t;i<A.length;i++)A[i]=1;return A},surfacePoint:function(e,t){return this.surfacePoint3DH(this._vf.uDimension-1,this._vf.vDimension-1,this._vf.uOrder-1,this._vf.vOrder-1,this._vf.uKnot,this._vf.vKnot,this.points,this._vf.weight,e,t)},findSpan:function(e,t,A,i){return x3dom.nodeTypes.NurbsCurve.prototype.findSpan(e,t,A,i)},basisFuns:function(e,t,A,i){return x3dom.nodeTypes.NurbsPositionInterpolator.prototype.basisFuns(e,t,A,i)},surfacePoint3DH:function(e,t,A,i,o,s,n,r,a,d){var h,g,l,I,c,f,u,C,_,m=0,p=[],E=[0,0,0,0],B=[];for(h=this.findSpan(e,A,a,o),C=this.basisFuns(h,a,A,o),g=this.findSpan(t,i,d,s),_=this.basisFuns(g,d,i,s),l=h-A,c=0;c<=i;c++){for(I=g-i+c,f=0;f<4;f++)B[m+f]=0;for(f=0;f<=A;f++)u=l+f+I*(e+1),B[m+0]+=C[f]*n[u].x,B[m+1]+=C[f]*n[u].y,B[m+2]+=C[f]*n[u].z,B[m+3]+=C[f]*r[u];m+=4}for(m=0,c=0;c<=i;c++)E[0]+=_[c]*B[m+0],E[1]+=_[c]*B[m+1],E[2]+=_[c]*B[m+2],E[3]+=_[c]*B[m+3],m+=4;for(m=0;m<3;m++)p[m]=E[m]/E[3];return new x3dom.fields.SFVec3f(p[0],p[1],p[2])}})),x3dom.registerNodeType("NurbsCurve2D","NURBS",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.NurbsCurve2D.superClass.call(this,e),this.addField_SFInt32(e,"order",3),this.addField_MFDouble(e,"knot",[]),this.addField_MFVec2f(e,"controlPoint",[]),this.addField_MFDouble(e,"weight",[]),this.addField_SFBool(e,"closed",!1)}),{})),x3dom.registerNodeType("NurbsTrimmedSurface","NURBS",defineClass(x3dom.nodeTypes.X3DNurbsSurfaceGeometryNode,(function(e){x3dom.nodeTypes.NurbsTrimmedSurface.superClass.call(this,e),this.addField_MFNode("trimmingContour",x3dom.nodeTypes.Contour2D),this._needReRender=!0}),{})),x3dom.registerNodeType("ContourPolyline2D","NURBS",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.ContourPolyline2D.superClass.call(this,e),this.addField_MFVec2f(e,"controlPoint",[])}),{})),x3dom.registerNodeType("Contour2D","NURBS",defineClass(x3dom.nodeTypes.X3DGroupingNode,(function(e){x3dom.nodeTypes.Contour2D.superClass.call(this,e),this.addField_MFNode("children",x3dom.nodeTypes.X3DChildNode)}),{})),function(){var e;x3dom.tessWorkerScript=URL.createObjectURL(new Blob(["("+function(){function t(e,t,A,i){var o,s,n;if(A>=i[e])return e;if(A<=i[t])return t;for(o=0,n=e+1,s=Math.floor((o+n)/2);A<i[s]||A>=i[s+1];)A<i[s]?n=s:o=s,s=Math.floor((o+n)/2);return s}function A(t,A,i,o){var s=Object.values(o).toString()+Math.floor(1e11*A);if(e.has(s))return e.get(s);var n,r,a,d,h=[],g=[],l=[];for(h[0]=1,a=0;a<=i;a++)g[a]=0,l[a]=0;for(a=1;a<=i;a++){for(g[a]=A-o[t+1-a],l[a]=o[t+a]-A,n=0,d=0;d<a;d++)r=h[d]/(l[d+1]+g[a-d]),h[d]=n+l[d+1]*r,n=g[a-d]*r;h[a]=n}return e.set(s,h),h}function i(e){this.bbox_split=4,this.use_objectspace=!0,this.edge_thresh=.1,this.trim_thresh=.1,this.split_bias=.5,this.skew_thresh=.01,this.max_rec=5,this.w=e[0],this.h=e[1],this.p=e[2],this.q=e[3],this.U=e[4],this.V=e[5],this.P=e[6],this.W=e[7],this.tloops=e[10],this.useUV=e[12],this.surfaceHash=[],this.indexHash=[],this.curveHash=null,this.coordinates=[],this.texcoords=[],this.indices=[],this.uv=[],this.coordIndex=0,this.u0=0,this.u1=1,this.v0=0,this.v1=1,this.deform=function(){this.useUV.forEach((function(e){this.computeSurface(e,!1)}),this)},this.tessellate=function(){this.W&&this.W.length!=(this.w+1)*(this.h+1)&&(this.W={}),this.u0=this.U[this.p],this.u1=this.U[this.U.length-this.p-1];var e=.5*(this.u0+this.u1);this.v0=this.V[this.q],this.v1=this.V[this.V.length-this.q-1];var t=.5*(this.v0+this.v1);this.tessTri([[this.u0,this.v0],[this.u0,t],[e,this.v0]]),this.tessTri([[this.u0,t],[e,t],[e,this.v0]]),this.tessTri([[this.u0,t],[this.u0,this.v1],[e,t]]),this.tessTri([[this.u0,this.v1],[e,this.v1],[e,t]]),this.tessTri([[e,this.v0],[e,t],[this.u1,this.v0]]),this.tessTri([[e,t],[this.u1,t],[this.u1,this.v0]]),this.tessTri([[e,t],[e,this.v1],[this.u1,t]]),this.tessTri([[e,this.v1],[this.u1,this.v1],[this.u1,t]])},this.adjustThresholds=function(e,t){if(e<0){this.use_objectspace=!1,t>=0&&(t=e);var A=2/(this.w+1),i=2/(this.h+1);A*=this.U[this.U.length-this.p-1]-this.U[this.p],i*=this.V[this.V.length-this.q-1]-this.V[this.q],this.edge_thresh_u=-e*A,this.edge_thresh_v=-t*i}else{for(var o=Number.MAX_VALUE,s=-Number.MAX_VALUE,n=[o,o,o,s,s,s],r=0;r<this.P.length;r++)this.P[r].x<n[0]&&(n[0]=this.P[r].x),this.P[r].y<n[1]&&(n[1]=this.P[r].y),this.P[r].z<n[2]&&(n[2]=this.P[r].z),this.P[r].x>n[3]&&(n[3]=this.P[r].x),this.P[r].y>n[4]&&(n[4]=this.P[r].y),this.P[r].z>n[5]&&(n[5]=this.P[r].z);var a=Math.sqrt((n[0]-n[3])*(n[0]-n[3])+(n[1]-n[4])*(n[1]-n[4])+(n[2]-n[5])*(n[2]-n[5]))/this.bbox_split;e<=1e-5&&(e=1),this.edge_thresh*=a*e,this.trim_thresh*=a*e}},this.tessTri=function(e){for(var t=[e];t.length;){var A=t.splice(0,1);t=this.refineTri(A[0]).concat(t)}},this.refineTri=function(e){if(this.tloops&&this.inOut(e)<0)return[];var t=e[0][0]*e[1][1]-e[1][0]*e[0][1]+e[1][0]*e[2][1]-e[2][0]*e[1][1]+e[2][0]*e[0][1]-e[0][0]*e[2][1];t<0&&(t=-t);var A=[],i=[];A[0]=e[0][0]-e[1][0],A[1]=e[0][1]-e[1][1];var o=A[0]*A[0]+A[1]*A[1];if(A[0]=e[1][0]-e[2][0],A[1]=e[1][1]-e[2][1],o+=A[0]*A[0]+A[1]*A[1],A[0]=e[2][0]-e[0][0],A[1]=e[2][1]-e[0][1],(t/=o+=A[0]*A[0]+A[1]*A[1])<=this.skew_thresh)return this.diceTri(e),[];var s=[];o=0;for(var n=0;n<3;n++){var r=(n+2)%3;A=e[g=(n+1)%3],i=e[r],s[n]=this.splitEdge(A,i),s[n]>o&&(o=s[n])}o*=this.split_bias;var a=[],d=[],h=0;for(n=0;n<3;n++){var g=(n+1)%3;r=(n+2)%3;s[n]>this.edge_thresh&&s[n]>=o?(h++,d[n]=[],d[n][0]=.5*(e[g][0]+e[r][0]),d[n][1]=.5*(e[g][1]+e[r][1]),a[n]=n-3):s[g]>s[r]?(d[n]=e[g],a[n]=g):(d[n]=e[r],a[n]=r)}var l=[];if(h){var I=++h;for(n=0;n<3;n++){g=(n+1)%3;a[r=(n+2)%3]!=n&&a[g]!=n&&(l[--I]=[e[n],d[r],d[g]])}if(I){if(a[0]==a[1]||a[1]==a[2]||a[2]==a[0])return[];l[0]=[d[0],d[1],d[2]]}return l}return this.trimFinal(e),[]},this.diceTri=function(e){var t=[];t[0]=(e[0][0]+e[1][0]+e[2][0])/3,t[1]=(e[0][1]+e[1][1]+e[2][1])/3,this.computeSurface(t);for(var A=0;A<3;A++){var i=[],o=[],s=(A+1)%3;o[0]=e[s][0]-e[A][0],o[1]=e[s][1]-e[A][1],i[0]=1;for(var n=0;i.length;){var r=[],a=[],d=i[0];if(r[0]=e[A][0]+o[0]*n,r[1]=e[A][1]+o[1]*n,a[0]=e[A][0]+o[0]*d,a[1]=e[A][1]+o[1]*d,this.splitEdge(r,a)>this.edge_thresh)i.splice(0,0,.5*(n+d));else{this.computeSurface(r),this.computeSurface(a);var h=[t,r,a];this.trimFinal(h),i.splice(0,1),n=d}}}},this.computeSurface=function(e,i){var o,s=Math.floor(1e11*e[0]),n=Math.floor(1e11*e[1]);if(this.surfaceHash[s]){var r=this.surfaceHash[s][n];if(r)return r}return o=Object.keys(this.W).length?function(e,i,o,s,n,r,a,d,h,g){var l,I,c,f,u,C,_,m,p,E=0,B=[],Q=[0,0,0,0],x=[];for(m=A(l=t(e,o,h,n),h,o,n),p=A(I=t(i,s,g,r),g,s,r),c=l-o,u=0;u<=s;u++){for(f=I-s+u,C=0;C<4;C++)x[E+C]=0;for(C=0;C<=o;C++)_=c+C+f*(e+1),x[E+0]+=m[C]*a[_].x,x[E+1]+=m[C]*a[_].y,x[E+2]+=m[C]*a[_].z,x[E+3]+=m[C]*d[_];E+=4}for(E=0,u=0;u<=s;u++)Q[0]+=p[u]*x[E+0],Q[1]+=p[u]*x[E+1],Q[2]+=p[u]*x[E+2],Q[3]+=p[u]*x[E+3],E+=4;for(E=0;E<3;E++)B[E]=Q[E]/Q[3];return B}(this.w,this.h,this.p,this.q,this.U,this.V,this.P,this.W,e[0],e[1]):function(e,i,o,s,n,r,a,d,h){var g,l,I,c,f,u,C,_,m,p=0,E=[0,0,0],B=[];for(_=A(g=t(e,o,d,n),d,o,n),m=A(l=t(i,s,h,r),h,s,r),I=g-o,f=0;f<=s;f++){for(c=l-s+f,B[p+0]=0,B[p+1]=0,B[p+2]=0,u=0;u<=o;u++)C=I+u+c*(e+1),B[p+0]+=_[u]*a[C].x,B[p+1]+=_[u]*a[C].y,B[p+2]+=_[u]*a[C].z;p+=3}for(p=0,f=0;f<=s;f++)E[0]+=m[f]*B[p+0],E[1]+=m[f]*B[p+1],E[2]+=m[f]*B[p+2],p+=3;return E}(this.w,this.h,this.p,this.q,this.U,this.V,this.P,e[0],e[1]),this.curveHash?o:(this.surfaceHash[s]||(this.surfaceHash[s]=[]),this.surfaceHash[s][n]=o,i?o:(this.indexHash[s]||(this.indexHash[s]=[]),this.indexHash[s][n]=this.coordIndex,this.coordIndex++,this.coordinates.push(o),this.texcoords.push([(e[0]+this.u0)/(this.u1-this.u0),(e[1]+this.v0)/(this.v1-this.v0)]),this.uv.push(e),o))},this.computeCurve=function(e,i,o){var s=Math.floor(1e11*o);if(this.curveHash[e][i]){var n=this.curveHash[e][i][s];if(n)return n}var r,a=this.tloops[e][i];return r=a[4]&&a[4].length?function(e,i,o,s,n,r){var a,d,h,g,l=0,I=0,c=0;for(g=A(a=t(e,i,r,o),r,i,o),d=0;d<=i;d++)h=a-i+d,l+=g[d]*s[h].x,I+=g[d]*s[h].y,c+=g[d]*n[h];return[l/c,I/c]}(a[0],a[1],a[2],a[3],a[4],o):function(e,i,o,s,n){var r,a,d,h,g=0,l=0;for(h=A(r=t(e,i,n,o),n,i,o),a=0;a<=i;a++)d=r-i+a,g+=h[a]*s[d].x,l+=h[a]*s[d].y;return[g,l]}(a[0],a[1],a[2],a[3],o),this.curveHash[e][i]||(this.curveHash[e][i]=[]),this.curveHash[e][i][s]=r,r},this.splitEdge=function(e,t){var A=this.computeSurface(e),i=this.computeSurface(t);if(!this.use_objectspace)return Math.sqrt((e[0]-t[0])*(e[0]-t[0])/this.edge_thresh_u+(e[1]-t[1])*(e[1]-t[1])/this.edge_thresh_v);if(Math.abs(A[0]-i[0])>1e-5||Math.abs(A[1]-i[1])>1e-5||Math.abs(A[2]-i[2])>1e-5){var o=Math.sqrt((A[0]-i[0])*(A[0]-i[0])+(A[1]-i[1])*(A[1]-i[1])+(A[2]-i[2])*(A[2]-i[2]));if(o<this.edge_thresh){var s=[e[0]+.5*(t[0]-e[0]),e[1]+.5*(t[1]-e[1])],n=this.computeSurface(s,!1),r=0;(Math.abs(A[0]-n[0])>1e-5||Math.abs(A[1]-n[1])>1e-5||Math.abs(A[2]-n[2])>1e-5)&&(r+=Math.sqrt((A[0]-n[0])*(A[0]-n[0])+(A[1]-n[1])*(A[1]-n[1])+(A[2]-n[2])*(A[2]-n[2]))),(Math.abs(i[0]-n[0])>1e-5||Math.abs(i[1]-n[1])>1e-5||Math.abs(i[2]-n[2])>1e-5)&&(r+=Math.sqrt((i[0]-n[0])*(i[0]-n[0])+(i[1]-n[1])*(i[1]-n[1])+(i[2]-n[2])*(i[2]-n[2]))),r>1.01*o&&(o+=r)}return o}return 0},this.splitCenter=function(e){var t=[];this.curveHash=[],t[0]=(e[0][0]+e[1][0]+e[2][0])/3,t[1]=(e[0][1]+e[1][1]+e[2][1])/3;for(var A=0,i=0;i<3;i++)A+=this.splitEdge(e[i],t);return this.curveHash=null,.5*A>this.edge_thresh&&(this.computeSurface(t),!0)},this.renderFinal=function(e){for(var t=0;t<3;t++){var A=e[t],i=Math.floor(1e11*A[0]),o=Math.floor(1e11*A[1]);this.indexHash[i]&&this.indices.push(this.indexHash[i][o])}},this.intersectTrim=function(e,t,A){var i=0,o=0;A&&(i=A[2],o=A[3]+1);for(var s=i;s<this.ttloops.length;s++){for(var n=this.ttloops[s],r=o;r<n.length-1;r++){var a=n[r],d=n[r+1];if(Math.abs(e[0]-a[0])<1e-5&&Math.abs(e[1]-a[1])<1e-5||Math.abs(e[0]-d[0])<1e-5&&Math.abs(e[1]-d[1])<1e-5)return[];if(Math.abs(t[0]-a[0])<1e-5&&Math.abs(t[1]-a[1])<1e-5||Math.abs(t[0]-d[0])<1e-5&&Math.abs(t[1]-d[1])<1e-5)return[];var h=(t[0]-e[0])*(d[1]-a[1])-(t[1]-e[1])*(d[0]-a[0]);if(!(Math.abs(h)<1e-5)){var g=((e[1]-a[1])*(d[0]-a[0])-(e[0]-a[0])*(d[1]-a[1]))/h;if(!(g<1e-5||g>.99999)){var l=((e[1]-a[1])*(t[0]-e[0])-(e[0]-a[0])*(t[1]-e[1]))/h;if(!(l<1e-5||l>.99999))return[e[0]+g*(t[0]-e[0]),e[1]+g*(t[1]-e[1]),s,r]}}}if(A)return[]}return[]},this.renderDiced=function(e,t,A,i,o,s){var n=o,r=s;(e[0]-o[0])*(e[0]-o[0])+(e[1]-o[1])*(e[1]-o[1])>(e[0]-s[0])*(e[0]-s[0])+(e[1]-s[1])*(e[1]-s[1])&&(n=s,r=o),this.renderFinal([e,i,A]),this.renderFinal([e,n,i]),this.renderFinal([t,A,i]),this.renderFinal([t,i,r])},this.renderComplex=function(e,t,A,i){this.diceTri([e[0],t,i]),this.diceTri([t,e[1],A]),this.diceTri([t,A,i]),this.diceTri([i,A,e[2]])},this.renderTrimmed=function(e){var t=.3,A=this.intersectTrim(e[0],e[1]),i=this.intersectTrim(e[1],e[2]),o=this.intersectTrim(e[2],e[0]),s=(A.length>0)+(i.length>0)+(o.length>0);if(1==s){for(var n=[A,i,o],r=0;r<3;r++)if(n[r].length&&(Math.abs(e[r][0]-n[r][0])<1e-5&&Math.abs(e[r][1]-n[r][1])<1e-5||Math.abs(e[(r+1)%3][0]-n[r][0])<1e-5&&Math.abs(e[(r+1)%3][1]-n[r][1])<1e-5))return void this.renderFinal(e);if(A.length){var a=this.intersectTrim(e[0],e[1],A);if(a.length){var d=this.ttloops[a[2]][a[3]];return this.computeSurface(d),this.computeSurface(A),this.computeSurface(a),void(this.inOut([e[2],[e[2][0]+(e[1][0]-e[2][0])*t,e[2][1]+(e[1][1]-e[2][1])*t],[e[2][0]+(e[0][0]-e[2][0])*t,e[2][1]+(e[0][1]-e[2][1])*t]])>0?this.renderDiced(e[0],e[1],e[2],d,A,a):this.renderFinal([A,d,a]))}}else if(i.length){var h=this.intersectTrim(e[1],e[2],i);if(h.length){d=this.ttloops[h[2]][h[3]];return this.computeSurface(d),this.computeSurface(i),this.computeSurface(h),void(this.inOut([e[0],[e[0][0]+(e[1][0]-e[0][0])*t,e[0][1]+(e[1][1]-e[0][1])*t],[e[0][0]+(e[2][0]-e[0][0])*t,e[0][1]+(e[2][1]-e[0][1])*t]])>0?this.renderDiced(e[1],e[2],e[0],d,i,h):this.renderFinal([i,d,h]))}}else if(o.length){var g=this.intersectTrim(e[2],e[0],o);if(g.length){d=this.ttloops[g[2]][g[3]];return this.computeSurface(d),this.computeSurface(o),this.computeSurface(g),void(this.inOut([e[1],[e[1][0]+(e[0][0]-e[1][0])*t,e[1][1]+(e[0][1]-e[1][1])*t],[e[1][0]+(e[2][0]-e[1][0])*t,e[1][1]+(e[2][1]-e[1][1])*t]])>0?this.renderDiced(e[2],e[0],e[1],d,o,g):this.renderFinal([o,d,g]))}}if(this.max_rec)return this.max_rec--,this.diceTri(e),void this.max_rec++}if(2!=s){if(3==s)return void this.renderComplex(e,A,i,o);var l=0;if(this.inOut([e[0],[e[0][0]+(e[1][0]-e[0][0])*t,e[0][1]+(e[1][1]-e[0][1])*t],[e[0][0]+(e[2][0]-e[0][0])*t,e[0][1]+(e[2][1]-e[0][1])*t]])<0&&l++,this.inOut([e[1],[e[1][0]+(e[0][0]-e[1][0])*t,e[1][1]+(e[0][1]-e[1][1])*t],[e[1][0]+(e[2][0]-e[1][0])*t,e[1][1]+(e[2][1]-e[1][1])*t]])<0&&l++,this.inOut([e[2],[e[2][0]+(e[1][0]-e[2][0])*t,e[2][1]+(e[1][1]-e[2][1])*t],[e[2][0]+(e[0][0]-e[2][0])*t,e[2][1]+(e[0][1]-e[2][1])*t]])<0&&l++,l>0)return;this.renderFinal(e)}else A.length?i.length?(this.computeSurface(A),this.computeSurface(i),this.inOut([e[1],[e[1][0]+(A[0]-e[1][0])*t,e[1][1]+(A[1]-e[1][1])*t],[e[1][0]+(i[0]-e[1][0])*t,e[1][1]+(i[1]-e[1][1])*t]])<=0?(this.renderFinal([e[0],A,i]),this.renderFinal([e[0],i,e[2]])):this.renderFinal([e[1],i,A])):(this.computeSurface(A),this.computeSurface(o),this.inOut([e[0],[e[0][0]+(o[0]-e[0][0])*t,e[0][1]+(o[1]-e[0][1])*t],[e[0][0]+(A[0]-e[0][0])*t,e[0][1]+(A[1]-e[0][1])*t]])<=0?(this.renderFinal([e[1],o,A]),this.renderFinal([e[1],e[2],o])):this.renderFinal([e[0],A,o])):(this.computeSurface(i),this.computeSurface(o),this.inOut([e[2],[e[2][0]+(o[0]-e[2][0])*t,e[2][1]+(o[1]-e[2][1])*t],[e[2][0]+(i[0]-e[2][0])*t,e[2][1]+(i[1]-e[2][1])*t]])<=0?(this.renderFinal([e[0],i,o]),this.renderFinal([e[0],e[1],i])):this.renderFinal([e[2],o,i]))},this.inOut=function(e){for(var t=[],A=[],i=[],o=[],s=[],n=0;n<3;n++){t[n]=[];var r=e[n],a=e[(n+1)%3];t[n][0]=r[1]-a[1],t[n][1]=a[0]-r[0],A[n]=t[n][0]*r[0]+t[n][1]*r[1],i[n]=o[n]=0,s[n]=Math.abs(t[n][0])>Math.abs(t[n][1])?1:0}for(var d=0;d<this.ttloops.length;d++)for(var h=this.ttloops[d],g=0;g<h.length-1;g++){var l=h[g],I=h[g+1],c=0;for(n=0;n<3;n++){var f=l[0]*t[n][0]+l[1]*t[n][1]-A[n],u=I[0]*t[n][0]+I[1]*t[n][1]-A[n];if(c+=f<0?1:-1,!(f<0?u<0:u>=0)){var C=(I[s[n]]*f-l[s[n]]*u)/(f-u),_=C<e[n][s[n]],m=C<e[(n+1)%3][s[n]];if(_&&m)i[n]++;else{if(_||m)return 0;o[n]++}}}if(3==c||-3==c)return 0}return 1&i[0]&&1&i[1]&&1&i[2]?1:1&i[0]||1&i[1]||1&i[2]?0:-1},this.refineTrim=function(e,t,A){var i=this.computeCurve(e,Math.floor(t),t),o=this.computeCurve(e,Math.floor(A),A);return this.splitEdge(i,o)>this.edge_thresh},this.initTrims=function(){this.ttloops=[],this.curveHash=[];var e=this.edge_thresh;this.edge_thresh=this.trim_thresh;for(var t=0;t<this.tloops.length;t++){var A=this.tloops[t];this.curveHash[t]=[],this.ttloops[t]=[];for(var i,o=[],s=0;s<A.length;s++){var n=A[s][2],r=1/(n[n.length-1]-n[0]);if(Math.abs(1-r)>1e-11)for(var a=0;a<n.length;a++)n[a]=n[a]*r;var d=n[0]-s;if(Math.abs(d)>1e-11)for(a=0;a<n.length;a++)n[a]=n[a]-d;var h=A[s][1],g=n[h];for(i=n[n.length-h-1];g<i;){for(this.ttloops[t].push(this.computeCurve(t,s,g)),o.push(g),h++;Math.abs(g-n[h])<1e-5;)h++;g=n[h]}}for(var l=this.ttloops[t],I=0;I<l.length;){var c=o[I],f=Math.floor(c),u=I+1;u==l.length&&(u=0);var C=o[u];if(A[f][1]>1&&this.refineTrim(t,c,C)){var _;0==u?(_=.5*(c+i),u=I+1):_=.5*(c+C);var m=this.computeCurve(t,f,_);l.splice(u,0,m),o.splice(u,0,_)}else{if(0==u)break;I=u}}l.push(l[0])}this.curveHash=null,this.edge_thresh=e},this.trimFinal=function(e){if(this.tloops){if(this.inOut(e)>=0)return void this.renderTrimmed(e);var t=.3,A=0;if(this.inOut([e[0],[e[0][0]+(e[1][0]-e[0][0])*t,e[0][1]+(e[1][1]-e[0][1])*t],[e[0][0]+(e[2][0]-e[0][0])*t,e[0][1]+(e[2][1]-e[0][1])*t]])<0&&A++,this.inOut([e[1],[e[1][0]+(e[0][0]-e[1][0])*t,e[1][1]+(e[0][1]-e[1][1])*t],[e[1][0]+(e[2][0]-e[1][0])*t,e[1][1]+(e[2][1]-e[1][1])*t]])<0&&A++,this.inOut([e[2],[e[2][0]+(e[1][0]-e[2][0])*t,e[2][1]+(e[1][1]-e[2][1])*t],[e[2][0]+(e[0][0]-e[2][0])*t,e[2][1]+(e[0][1]-e[2][1])*t]])<0&&A++,A>0)return}this.renderFinal(e)}}onmessage=function(t){e=t.data[11]?t.data[11]:new Map;var A=new i(t.data);if(t.data[12]&&t.data[12].length?A.deform():(A.adjustThresholds(t.data[8],t.data[9]),t.data[10]&&t.data[10].length?A.initTrims():A.tloops=null,A.tessellate()),A.have_transferables){for(var o=new Uint32Array(A.indices.length),s=0;s<A.indices.length;s++)o[s]=A.indices[s];postMessage(o.buffer,[o.buffer]);var n=new Float64Array(A.coordinates.length);for(s=0;s<A.coordinates.length;s++)n[s]=A.coordinates[s];postMessage(n.buffer,[n.buffer]);var r=new Float64Array(A.texcoords.length);for(s=0;s<A.texcoords.length;s++)r[s]=A.texcoords[s];postMessage(r.buffer,[r.buffer])}else postMessage([A.indices,A.coordinates,A.texcoords,e,A.uv,t.data[13]]);close()}}.toString()+")()"],{type:"application/javascript"}))}(),x3dom.WorkerPool=function(e){var t=this;this.taskQueue=[],this.workerQueue=[],this.poolSize=e,this.init=function(){for(var e=0;e<this.poolSize;e++)t.workerQueue.push(new x3dom.WorkerThread(t))},this.addWorkerTask=function(e){t.workerQueue.length>0?t.workerQueue.shift().run(e):t.taskQueue.push(e)},this.freeWorkerThread=function(e){if(t.taskQueue.length>0){var A=t.taskQueue.shift();if(A.discard)return this.freeWorkerThread(e);e.run(A)}else t.workerQueue.push(e)}},x3dom.WorkerThread=function(e){var t=this;this.workerPool=e,this.workerTask={},this.run=function(e){t.workerTask=e;var A=new Worker(e.script);A.caller=e.caller,A.onmessage=function(e){t.workerTask.callback(e),t.workerPool.freeWorkerThread(t)},A.postMessage(e.startMessage)}},x3dom.WorkerTask=function(e,t,A,i){this.script=e,this.caller=t,this.callback=A,this.startMessage=i},function(){var e=1;navigator.hardwareConcurrency&&(e=Math.max(1,navigator.hardwareConcurrency-1)),x3dom.tessWorkerPool=new x3dom.WorkerPool(e),x3dom.tessWorkerPool.init()}();